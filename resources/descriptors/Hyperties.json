{
  "HypertyChat": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCkuZGVmYXVsdH19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciK28rIiciKTt0aHJvdyBmLmNvZGU9Ik1PRFVMRV9OT1RfRk9VTkQiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgovLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXIKCnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTsKdmFyIHF1ZXVlID0gW107CnZhciBkcmFpbmluZyA9IGZhbHNlOwp2YXIgY3VycmVudFF1ZXVlOwp2YXIgcXVldWVJbmRleCA9IC0xOwoKZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkgewogICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgZHJhaW5pbmcgPSBmYWxzZTsKICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7CiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcXVldWVJbmRleCA9IC0xOwogICAgfQogICAgaWYgKHF1ZXVlLmxlbmd0aCkgewogICAgICAgIGRyYWluUXVldWUoKTsKICAgIH0KfQoKZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHsKICAgIGlmIChkcmFpbmluZykgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChjbGVhblVwTmV4dFRpY2spOwogICAgZHJhaW5pbmcgPSB0cnVlOwoKICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7CiAgICB3aGlsZSAobGVuKSB7CiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7CiAgICAgICAgcXVldWUgPSBbXTsKICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBxdWV1ZUluZGV4ID0gLTE7CiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoOwogICAgfQogICAgY3VycmVudFF1ZXVlID0gbnVsbDsKICAgIGRyYWluaW5nID0gZmFsc2U7CiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7Cn0KCnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7CiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHsKICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTsKICAgICAgICB9CiAgICB9CiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpOwogICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHsKICAgICAgICBzZXRUaW1lb3V0KGRyYWluUXVldWUsIDApOwogICAgfQp9OwoKLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0cwpmdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHsKICAgIHRoaXMuZnVuID0gZnVuOwogICAgdGhpcy5hcnJheSA9IGFycmF5Owp9Ckl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpOwp9Owpwcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInOwpwcm9jZXNzLmJyb3dzZXIgPSB0cnVlOwpwcm9jZXNzLmVudiA9IHt9Owpwcm9jZXNzLmFyZ3YgPSBbXTsKcHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzCnByb2Nlc3MudmVyc2lvbnMgPSB7fTsKCmZ1bmN0aW9uIG5vb3AoKSB7fQoKcHJvY2Vzcy5vbiA9IG5vb3A7CnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wOwpwcm9jZXNzLm9uY2UgPSBub29wOwpwcm9jZXNzLm9mZiA9IG5vb3A7CnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wOwpwcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7CnByb2Nlc3MuZW1pdCA9IG5vb3A7Cgpwcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkgewogICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpOwp9OwoKcHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gJy8nOwp9Owpwcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikgewogICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTsKfTsKcHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAwOwp9OwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CihmdW5jdGlvbiAoZ2xvYmFsKXsKInVzZSBzdHJpY3QiOwoKdmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovLyBEaXN0cmlidXRpb24gZmlsZSBmb3IgSHlwZXJ0eURpc2NvdmVyeS5qcwovLyB2ZXJzaW9uOiAwLjIuMAoKIWZ1bmN0aW9uIChlKSB7CiAgaWYgKCJvYmplY3QiID09ICh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpICYmICJ1bmRlZmluZWQiICE9IHR5cGVvZiBtb2R1bGUpIG1vZHVsZS5leHBvcnRzID0gZSgpO2Vsc2UgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoW10sIGUpO2Vsc2UgewogICAgdmFyIHQ7dCA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgZ2xvYmFsID8gZ2xvYmFsIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIHNlbGYgPyBzZWxmIDogdGhpcywgdC5IeXBlcnR5RGlzY292ZXJ5ID0gZSgpOwogIH0KfShmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIGUodCwgciwgbikgewogICAgZnVuY3Rpb24gbyhjLCBzKSB7CiAgICAgIGlmICghcltjXSkgewogICAgICAgIGlmICghdFtjXSkgewogICAgICAgICAgdmFyIHUgPSAiZnVuY3Rpb24iID09IHR5cGVvZiByZXF1aXJlICYmIHJlcXVpcmU7aWYgKCFzICYmIHUpIHJldHVybiB1KGMsICEwKTtpZiAoaSkgcmV0dXJuIGkoYywgITApO3ZhciBhID0gbmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIgKyBjICsgIiciKTt0aHJvdyBhLmNvZGUgPSAiTU9EVUxFX05PVF9GT1VORCIsIGE7CiAgICAgICAgfXZhciBmID0gcltjXSA9IHsgZXhwb3J0czoge30gfTt0W2NdWzBdLmNhbGwoZi5leHBvcnRzLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIHIgPSB0W2NdWzFdW2VdO3JldHVybiBvKHIgPyByIDogZSk7CiAgICAgICAgfSwgZiwgZi5leHBvcnRzLCBlLCB0LCByLCBuKTsKICAgICAgfXJldHVybiByW2NdLmV4cG9ydHM7CiAgICB9Zm9yICh2YXIgaSA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHJlcXVpcmUgJiYgcmVxdWlyZSwgYyA9IDA7IGMgPCBuLmxlbmd0aDsgYysrKSB7CiAgICAgIG8obltjXSk7CiAgICB9cmV0dXJuIG87CiAgfSh7IDE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL2pzb24vc3RyaW5naWZ5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vanNvbi9zdHJpbmdpZnkiOiA2IH1dLCAyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDcgfV0sIDM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL3Byb21pc2UiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlIjogOCB9XSwgNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgci5fX2VzTW9kdWxlID0gITAsIHJbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfTsKICAgIH0sIHt9XSwgNTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1yLl9fZXNNb2R1bGUgPSAhMDt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksCiAgICAgICAgICBpID0gbihvKTtyWyJkZWZhdWx0Il0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZShlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IHQubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgdmFyIG4gPSB0W3JdO24uZW51bWVyYWJsZSA9IG4uZW51bWVyYWJsZSB8fCAhMSwgbi5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiBuICYmIChuLndyaXRhYmxlID0gITApLCAoMCwgaVsiZGVmYXVsdCJdKShlLCBuLmtleSwgbik7CiAgICAgICAgICB9CiAgICAgICAgfXJldHVybiBmdW5jdGlvbiAodCwgciwgbikgewogICAgICAgICAgcmV0dXJuIHIgJiYgZSh0LnByb3RvdHlwZSwgciksIG4gJiYgZSh0LCBuKSwgdDsKICAgICAgICB9OwogICAgICB9KCk7CiAgICB9LCB7ICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDIgfV0sIDY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKSwKICAgICAgICAgIG8gPSBuLkpTT04gfHwgKG4uSlNPTiA9IHsgc3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeSB9KTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBvLnN0cmluZ2lmeS5hcHBseShvLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy9fY29yZSI6IDE2IH1dLCA3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSIpO3ZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy9fY29yZSIpLk9iamVjdDt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBuLmRlZmluZVByb3BlcnR5KGUsIHQsIHIpOwogICAgICB9OwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy9fY29yZSI6IDE2LCAiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSI6IDcxIH1dLCA4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgZSgiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyIpLCBlKCIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiKSwgZSgiLi4vbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlIiksIGUoIi4uL21vZHVsZXMvZXM2LnByb21pc2UiKSwgdC5leHBvcnRzID0gZSgiLi4vbW9kdWxlcy9fY29yZSIpLlByb21pc2U7CiAgICB9LCB7ICIuLi9tb2R1bGVzL19jb3JlIjogMTYsICIuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIjogNzIsICIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIjogNzMsICIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOiA3NCwgIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSI6IDc1IH1dLCA5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgZSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhIGZ1bmN0aW9uISIpO3JldHVybiBlOwogICAgICB9OwogICAgfSwge31dLCAxMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHt9OwogICAgfSwge31dLCAxMTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBuKSB7CiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIHQpIHx8IHZvaWQgMCAhPT0gbiAmJiBuIGluIGUpIHRocm93IFR5cGVFcnJvcihyICsgIjogaW5jb3JyZWN0IGludm9jYXRpb24hIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDEyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19pcy1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmICghbihlKSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhbiBvYmplY3QhIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7ICIuL19pcy1vYmplY3QiOiAzMyB9XSwgMTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX3RvLWlvYmplY3QiKSwKICAgICAgICAgIG8gPSBlKCIuL190by1sZW5ndGgiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1pbmRleCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0LCByLCBjKSB7CiAgICAgICAgICB2YXIgcywKICAgICAgICAgICAgICB1ID0gbih0KSwKICAgICAgICAgICAgICBhID0gbyh1Lmxlbmd0aCksCiAgICAgICAgICAgICAgZiA9IGkoYywgYSk7aWYgKGUgJiYgciAhPSByKSB7CiAgICAgICAgICAgIGZvciAoOyBhID4gZjspIHsKICAgICAgICAgICAgICBpZiAocyA9IHVbZisrXSwgcyAhPSBzKSByZXR1cm4gITA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBmb3IgKDsgYSA+IGY7IGYrKykgewogICAgICAgICAgICBpZiAoKGUgfHwgZiBpbiB1KSAmJiB1W2ZdID09PSByKSByZXR1cm4gZSB8fCBmIHx8IDA7CiAgICAgICAgICB9cmV0dXJuICFlICYmIC0xOwogICAgICAgIH07CiAgICAgIH07CiAgICB9LCB7ICIuL190by1pbmRleCI6IDYxLCAiLi9fdG8taW9iamVjdCI6IDYzLCAiLi9fdG8tbGVuZ3RoIjogNjQgfV0sIDE0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19jb2YiKSwKICAgICAgICAgIG8gPSBlKCIuL193a3MiKSgidG9TdHJpbmdUYWciKSwKICAgICAgICAgIGkgPSAiQXJndW1lbnRzIiA9PSBuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gYXJndW1lbnRzOwogICAgICB9KCkpLAogICAgICAgICAgYyA9IGZ1bmN0aW9uIGMoZSwgdCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gZVt0XTsKICAgICAgICB9IGNhdGNoIChyKSB7fQogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQsIHIsIHM7cmV0dXJuIHZvaWQgMCA9PT0gZSA/ICJVbmRlZmluZWQiIDogbnVsbCA9PT0gZSA/ICJOdWxsIiA6ICJzdHJpbmciID09IHR5cGVvZiAociA9IGModCA9IE9iamVjdChlKSwgbykpID8gciA6IGkgPyBuKHQpIDogIk9iamVjdCIgPT0gKHMgPSBuKHQpKSAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiB0LmNhbGxlZSA/ICJBcmd1bWVudHMiIDogczsKICAgICAgfTsKICAgIH0sIHsgIi4vX2NvZiI6IDE1LCAiLi9fd2tzIjogNjggfV0sIDE1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS50b1N0cmluZzt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSkuc2xpY2UoOCwgLTEpOwogICAgICB9OwogICAgfSwge31dLCAxNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0geyB2ZXJzaW9uOiAiMi40LjAiIH07Im51bWJlciIgPT0gdHlwZW9mIF9fZSAmJiAoX19lID0gbik7CiAgICB9LCB7fV0sIDE3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19hLWZ1bmN0aW9uIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICBpZiAobihlKSwgdm9pZCAwID09PSB0KSByZXR1cm4gZTtzd2l0Y2ggKHIpIHtjYXNlIDE6CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgIHJldHVybiBlLmNhbGwodCwgcik7CiAgICAgICAgICAgIH07Y2FzZSAyOgogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHIsIG4pIHsKICAgICAgICAgICAgICByZXR1cm4gZS5jYWxsKHQsIHIsIG4pOwogICAgICAgICAgICB9O2Nhc2UgMzoKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChyLCBuLCBvKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGUuY2FsbCh0LCByLCBuLCBvKTsKICAgICAgICAgICAgfTt9cmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBlLmFwcGx5KHQsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2EtZnVuY3Rpb24iOiA5IH1dLCAxODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKHZvaWQgMCA9PSBlKSB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNhbGwgbWV0aG9kIG9uICAiICsgZSk7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDE5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gIWUoIi4vX2ZhaWxzIikoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiA3ICE9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICAgIH0gfSkuYTsKICAgICAgfSk7CiAgICB9LCB7ICIuL19mYWlscyI6IDIzIH1dLCAyMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faXMtb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi9fZ2xvYmFsIikuZG9jdW1lbnQsCiAgICAgICAgICBpID0gbihvKSAmJiBuKG8uY3JlYXRlRWxlbWVudCk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gaSA/IG8uY3JlYXRlRWxlbWVudChlKSA6IHt9OwogICAgICB9OwogICAgfSwgeyAiLi9fZ2xvYmFsIjogMjUsICIuL19pcy1vYmplY3QiOiAzMyB9XSwgMjE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAiY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mIi5zcGxpdCgiLCIpOwogICAgfSwge31dLCAyMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fZ2xvYmFsIiksCiAgICAgICAgICBvID0gZSgiLi9fY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vX2N0eCIpLAogICAgICAgICAgYyA9IGUoIi4vX2hpZGUiKSwKICAgICAgICAgIHMgPSAicHJvdG90eXBlIiwKICAgICAgICAgIHUgPSBmdW5jdGlvbiB1KGUsIHQsIHIpIHsKICAgICAgICB2YXIgYSwKICAgICAgICAgICAgZiwKICAgICAgICAgICAgXywKICAgICAgICAgICAgbCA9IGUgJiB1LkYsCiAgICAgICAgICAgIGQgPSBlICYgdS5HLAogICAgICAgICAgICBwID0gZSAmIHUuUywKICAgICAgICAgICAgdiA9IGUgJiB1LlAsCiAgICAgICAgICAgIHkgPSBlICYgdS5CLAogICAgICAgICAgICBoID0gZSAmIHUuVywKICAgICAgICAgICAgYiA9IGQgPyBvIDogb1t0XSB8fCAob1t0XSA9IHt9KSwKICAgICAgICAgICAgbSA9IGJbc10sCiAgICAgICAgICAgIGcgPSBkID8gbiA6IHAgPyBuW3RdIDogKG5bdF0gfHwge30pW3NdO2QgJiYgKHIgPSB0KTtmb3IgKGEgaW4gcikgewogICAgICAgICAgZiA9ICFsICYmIGcgJiYgdm9pZCAwICE9PSBnW2FdLCBmICYmIGEgaW4gYiB8fCAoXyA9IGYgPyBnW2FdIDogclthXSwgYlthXSA9IGQgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgZ1thXSA/IHJbYV0gOiB5ICYmIGYgPyBpKF8sIG4pIDogaCAmJiBnW2FdID09IF8gPyBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgdCA9IGZ1bmN0aW9uIHQoX3QsIHIsIG4pIHsKICAgICAgICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIGUpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge2Nhc2UgMDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGUoKTtjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBlKF90KTtjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBlKF90LCByKTt9cmV0dXJuIG5ldyBlKF90LCByLCBuKTsKICAgICAgICAgICAgICB9cmV0dXJuIGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgfTtyZXR1cm4gdFtzXSA9IGVbc10sIHQ7CiAgICAgICAgICB9KF8pIDogdiAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBfID8gaShGdW5jdGlvbi5jYWxsLCBfKSA6IF8sIHYgJiYgKChiLnZpcnR1YWwgfHwgKGIudmlydHVhbCA9IHt9KSlbYV0gPSBfLCBlICYgdS5SICYmIG0gJiYgIW1bYV0gJiYgYyhtLCBhLCBfKSkpOwogICAgICAgIH0KICAgICAgfTt1LkYgPSAxLCB1LkcgPSAyLCB1LlMgPSA0LCB1LlAgPSA4LCB1LkIgPSAxNiwgdS5XID0gMzIsIHUuVSA9IDY0LCB1LlIgPSAxMjgsIHQuZXhwb3J0cyA9IHU7CiAgICB9LCB7ICIuL19jb3JlIjogMTYsICIuL19jdHgiOiAxNywgIi4vX2dsb2JhbCI6IDI1LCAiLi9faGlkZSI6IDI3IH1dLCAyMzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiAhIWUoKTsKICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICByZXR1cm4gITA7CiAgICAgICAgfQogICAgICB9OwogICAgfSwge31dLCAyNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fY3R4IiksCiAgICAgICAgICBvID0gZSgiLi9faXRlci1jYWxsIiksCiAgICAgICAgICBpID0gZSgiLi9faXMtYXJyYXktaXRlciIpLAogICAgICAgICAgYyA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgcyA9IGUoIi4vX3RvLWxlbmd0aCIpLAogICAgICAgICAgdSA9IGUoIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIiksCiAgICAgICAgICBhID0ge30sCiAgICAgICAgICBmID0ge30sCiAgICAgICAgICByID0gdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIsIF8sIGwpIHsKICAgICAgICB2YXIgZCwKICAgICAgICAgICAgcCwKICAgICAgICAgICAgdiwKICAgICAgICAgICAgeSwKICAgICAgICAgICAgaCA9IGwgPyBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZTsKICAgICAgICB9IDogdShlKSwKICAgICAgICAgICAgYiA9IG4ociwgXywgdCA/IDIgOiAxKSwKICAgICAgICAgICAgbSA9IDA7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGgpIHRocm93IFR5cGVFcnJvcihlICsgIiBpcyBub3QgaXRlcmFibGUhIik7aWYgKGkoaCkpIHsKICAgICAgICAgIGZvciAoZCA9IHMoZS5sZW5ndGgpOyBkID4gbTsgbSsrKSB7CiAgICAgICAgICAgIGlmICh5ID0gdCA/IGIoYyhwID0gZVttXSlbMF0sIHBbMV0pIDogYihlW21dKSwgeSA9PT0gYSB8fCB5ID09PSBmKSByZXR1cm4geTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgZm9yICh2ID0gaC5jYWxsKGUpOyAhKHAgPSB2Lm5leHQoKSkuZG9uZTspIHsKICAgICAgICAgIGlmICh5ID0gbyh2LCBiLCBwLnZhbHVlLCB0KSwgeSA9PT0gYSB8fCB5ID09PSBmKSByZXR1cm4geTsKICAgICAgICB9CiAgICAgIH07ci5CUkVBSyA9IGEsIHIuUkVUVVJOID0gZjsKICAgIH0sIHsgIi4vX2FuLW9iamVjdCI6IDEyLCAiLi9fY3R4IjogMTcsICIuL19pcy1hcnJheS1pdGVyIjogMzIsICIuL19pdGVyLWNhbGwiOiAzNCwgIi4vX3RvLWxlbmd0aCI6IDY0LCAiLi9jb3JlLmdldC1pdGVyYXRvci1tZXRob2QiOiA2OSB9XSwgMjU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IHQuZXhwb3J0cyA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93Lk1hdGggPT0gTWF0aCA/IHdpbmRvdyA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBzZWxmICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiA6IEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCk7Im51bWJlciIgPT0gdHlwZW9mIF9fZyAmJiAoX19nID0gbik7CiAgICB9LCB7fV0sIDI2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS5oYXNPd25Qcm9wZXJ0eTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7fV0sIDI3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19vYmplY3QtZHAiKSwKICAgICAgICAgIG8gPSBlKCIuL19wcm9wZXJ0eS1kZXNjIik7dC5leHBvcnRzID0gZSgiLi9fZGVzY3JpcHRvcnMiKSA/IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIG4uZihlLCB0LCBvKDEsIHIpKTsKICAgICAgfSA6IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIGVbdF0gPSByLCBlOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVzY3JpcHRvcnMiOiAxOSwgIi4vX29iamVjdC1kcCI6IDQzLCAiLi9fcHJvcGVydHktZGVzYyI6IDUwIH1dLCAyODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vX2dsb2JhbCIpLmRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgIH0sIHsgIi4vX2dsb2JhbCI6IDI1IH1dLCAyOTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9ICFlKCIuL19kZXNjcmlwdG9ycyIpICYmICFlKCIuL19mYWlscyIpKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gNyAhPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSgiLi9fZG9tLWNyZWF0ZSIpKCJkaXYiKSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICAgIH0gfSkuYTsKICAgICAgfSk7CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fZG9tLWNyZWF0ZSI6IDIwLCAiLi9fZmFpbHMiOiAyMyB9XSwgMzA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHZhciBuID0gdm9pZCAwID09PSByO3N3aXRjaCAodC5sZW5ndGgpIHtjYXNlIDA6CiAgICAgICAgICAgIHJldHVybiBuID8gZSgpIDogZS5jYWxsKHIpO2Nhc2UgMToKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0pIDogZS5jYWxsKHIsIHRbMF0pO2Nhc2UgMjoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0pO2Nhc2UgMzoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0sIHRbMl0pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0sIHRbMl0pO2Nhc2UgNDoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0sIHRbMl0sIHRbM10pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0sIHRbMl0sIHRbM10pO31yZXR1cm4gZS5hcHBseShyLCB0KTsKICAgICAgfTsKICAgIH0sIHt9XSwgMzE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2NvZiIpO3QuZXhwb3J0cyA9IE9iamVjdCgieiIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApID8gT2JqZWN0IDogZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIlN0cmluZyIgPT0gbihlKSA/IGUuc3BsaXQoIiIpIDogT2JqZWN0KGUpOwogICAgICB9OwogICAgfSwgeyAiLi9fY29mIjogMTUgfV0sIDMyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19pdGVyYXRvcnMiKSwKICAgICAgICAgIG8gPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIGkgPSBBcnJheS5wcm90b3R5cGU7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBlICYmIChuLkFycmF5ID09PSBlIHx8IGlbb10gPT09IGUpOwogICAgICB9OwogICAgfSwgeyAiLi9faXRlcmF0b3JzIjogMzksICIuL193a3MiOiA2OCB9XSwgMzM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAib2JqZWN0IiA9PSAodHlwZW9mIGUgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGUpKSA/IG51bGwgIT09IGUgOiAiZnVuY3Rpb24iID09IHR5cGVvZiBlOwogICAgICB9OwogICAgfSwge31dLCAzNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fYW4tb2JqZWN0Iik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIsIG8pIHsKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIG8gPyB0KG4ocilbMF0sIHJbMV0pIDogdChyKTsKICAgICAgICB9IGNhdGNoIChpKSB7CiAgICAgICAgICB2YXIgYyA9IGVbInJldHVybiJdO3Rocm93IHZvaWQgMCAhPT0gYyAmJiBuKGMuY2FsbChlKSksIGk7CiAgICAgICAgfQogICAgICB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIgfV0sIDM1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vX29iamVjdC1jcmVhdGUiKSwKICAgICAgICAgIG8gPSBlKCIuL19wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBpID0gZSgiLi9fc2V0LXRvLXN0cmluZy10YWciKSwKICAgICAgICAgIGMgPSB7fTtlKCIuL19oaWRlIikoYywgZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSksIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZS5wcm90b3R5cGUgPSBuKGMsIHsgbmV4dDogbygxLCByKSB9KSwgaShlLCB0ICsgIiBJdGVyYXRvciIpOwogICAgICB9OwogICAgfSwgeyAiLi9faGlkZSI6IDI3LCAiLi9fb2JqZWN0LWNyZWF0ZSI6IDQyLCAiLi9fcHJvcGVydHktZGVzYyI6IDUwLCAiLi9fc2V0LXRvLXN0cmluZy10YWciOiA1NSwgIi4vX3drcyI6IDY4IH1dLCAzNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4gPSBlKCIuL19saWJyYXJ5IiksCiAgICAgICAgICBvID0gZSgiLi9fZXhwb3J0IiksCiAgICAgICAgICBpID0gZSgiLi9fcmVkZWZpbmUiKSwKICAgICAgICAgIGMgPSBlKCIuL19oaWRlIiksCiAgICAgICAgICBzID0gZSgiLi9faGFzIiksCiAgICAgICAgICB1ID0gZSgiLi9faXRlcmF0b3JzIiksCiAgICAgICAgICBhID0gZSgiLi9faXRlci1jcmVhdGUiKSwKICAgICAgICAgIGYgPSBlKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpLAogICAgICAgICAgXyA9IGUoIi4vX29iamVjdC1ncG8iKSwKICAgICAgICAgIGwgPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIGQgPSAhKFtdLmtleXMgJiYgIm5leHQiIGluIFtdLmtleXMoKSksCiAgICAgICAgICBwID0gIkBAaXRlcmF0b3IiLAogICAgICAgICAgdiA9ICJrZXlzIiwKICAgICAgICAgIHkgPSAidmFsdWVzIiwKICAgICAgICAgIGggPSBmdW5jdGlvbiBoKCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBiLCBtLCBnLCBqKSB7CiAgICAgICAgYShyLCB0LCBiKTt2YXIgeCwKICAgICAgICAgICAgdywKICAgICAgICAgICAgaywKICAgICAgICAgICAgTyA9IGZ1bmN0aW9uIE8oZSkgewogICAgICAgICAgaWYgKCFkICYmIGUgaW4gRSkgcmV0dXJuIEVbZV07c3dpdGNoIChlKSB7Y2FzZSB2OgogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICAgICAgfTtjYXNlIHk6CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcih0aGlzLCBlKTsKICAgICAgICAgICAgICB9O31yZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgICAgIE0gPSB0ICsgIiBJdGVyYXRvciIsCiAgICAgICAgICAgIFAgPSBtID09IHksCiAgICAgICAgICAgIFMgPSAhMSwKICAgICAgICAgICAgRSA9IGUucHJvdG90eXBlLAogICAgICAgICAgICBUID0gRVtsXSB8fCBFW3BdIHx8IG0gJiYgRVttXSwKICAgICAgICAgICAgQSA9IFQgfHwgTyhtKSwKICAgICAgICAgICAgVSA9IG0gPyBQID8gTygiZW50cmllcyIpIDogQSA6IHZvaWQgMCwKICAgICAgICAgICAgQyA9ICJBcnJheSIgPT0gdCA/IEUuZW50cmllcyB8fCBUIDogVDtpZiAoQyAmJiAoayA9IF8oQy5jYWxsKG5ldyBlKCkpKSwgayAhPT0gT2JqZWN0LnByb3RvdHlwZSAmJiAoZihrLCBNLCAhMCksIG4gfHwgcyhrLCBsKSB8fCBjKGssIGwsIGgpKSksIFAgJiYgVCAmJiBULm5hbWUgIT09IHkgJiYgKFMgPSAhMCwgQSA9IGZ1bmN0aW9uIEEoKSB7CiAgICAgICAgICByZXR1cm4gVC5jYWxsKHRoaXMpOwogICAgICAgIH0pLCBuICYmICFqIHx8ICFkICYmICFTICYmIEVbbF0gfHwgYyhFLCBsLCBBKSwgdVt0XSA9IEEsIHVbTV0gPSBoLCBtKSBpZiAoeCA9IHsgdmFsdWVzOiBQID8gQSA6IE8oeSksIGtleXM6IGcgPyBBIDogTyh2KSwgZW50cmllczogVSB9LCBqKSBmb3IgKHcgaW4geCkgewogICAgICAgICAgdyBpbiBFIHx8IGkoRSwgdywgeFt3XSk7CiAgICAgICAgfSBlbHNlIG8oby5QICsgby5GICogKGQgfHwgUyksIHQsIHgpO3JldHVybiB4OwogICAgICB9OwogICAgfSwgeyAiLi9fZXhwb3J0IjogMjIsICIuL19oYXMiOiAyNiwgIi4vX2hpZGUiOiAyNywgIi4vX2l0ZXItY3JlYXRlIjogMzUsICIuL19pdGVyYXRvcnMiOiAzOSwgIi4vX2xpYnJhcnkiOiA0MCwgIi4vX29iamVjdC1ncG8iOiA0NiwgIi4vX3JlZGVmaW5lIjogNTIsICIuL19zZXQtdG8tc3RyaW5nLXRhZyI6IDU1LCAiLi9fd2tzIjogNjggfV0sIDM3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIG8gPSAhMTt0cnkgewogICAgICAgIHZhciBpID0gWzddW25dKCk7aVsicmV0dXJuIl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBvID0gITA7CiAgICAgICAgfSwgQXJyYXkuZnJvbShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aHJvdyAyOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChjKSB7fXQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCF0ICYmICFvKSByZXR1cm4gITE7dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgdmFyIGkgPSBbN10sCiAgICAgICAgICAgICAgYyA9IGlbbl0oKTtjLm5leHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB7IGRvbmU6IHIgPSAhMCB9OwogICAgICAgICAgfSwgaVtuXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGM7CiAgICAgICAgICB9LCBlKGkpOwogICAgICAgIH0gY2F0Y2ggKHMpIHt9cmV0dXJuIHI7CiAgICAgIH07CiAgICB9LCB7ICIuL193a3MiOiA2OCB9XSwgMzg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiB7IHZhbHVlOiB0LCBkb25lOiAhIWUgfTsKICAgICAgfTsKICAgIH0sIHt9XSwgMzk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7fTsKICAgIH0sIHt9XSwgNDA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAhMDsKICAgIH0sIHt9XSwgNDE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2dsb2JhbCIpLAogICAgICAgICAgbyA9IGUoIi4vX3Rhc2siKS5zZXQsCiAgICAgICAgICBpID0gbi5NdXRhdGlvbk9ic2VydmVyIHx8IG4uV2ViS2l0TXV0YXRpb25PYnNlcnZlciwKICAgICAgICAgIGMgPSBuLnByb2Nlc3MsCiAgICAgICAgICBzID0gbi5Qcm9taXNlLAogICAgICAgICAgdSA9ICJwcm9jZXNzIiA9PSBlKCIuL19jb2YiKShjKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUsCiAgICAgICAgICAgIHQsCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIGEgPSBmdW5jdGlvbiBhKCkgewogICAgICAgICAgdmFyIG4sIG87Zm9yICh1ICYmIChuID0gYy5kb21haW4pICYmIG4uZXhpdCgpOyBlOykgewogICAgICAgICAgICBvID0gZS5mbiwgZSA9IGUubmV4dDt0cnkgewogICAgICAgICAgICAgIG8oKTsKICAgICAgICAgICAgfSBjYXRjaCAoaSkgewogICAgICAgICAgICAgIHRocm93IGUgPyByKCkgOiB0ID0gdm9pZCAwLCBpOwogICAgICAgICAgICB9CiAgICAgICAgICB9dCA9IHZvaWQgMCwgbiAmJiBuLmVudGVyKCk7CiAgICAgICAgfTtpZiAodSkgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICBjLm5leHRUaWNrKGEpOwogICAgICAgIH07ZWxzZSBpZiAoaSkgewogICAgICAgICAgdmFyIGYgPSAhMCwKICAgICAgICAgICAgICBfID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpO25ldyBpKGEpLm9ic2VydmUoXywgeyBjaGFyYWN0ZXJEYXRhOiAhMCB9KSwgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICAgIF8uZGF0YSA9IGYgPSAhZjsKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIGlmIChzICYmIHMucmVzb2x2ZSkgewogICAgICAgICAgdmFyIGwgPSBzLnJlc29sdmUoKTtyID0gZnVuY3Rpb24gcigpIHsKICAgICAgICAgICAgbC50aGVuKGEpOwogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICBvLmNhbGwobiwgYSk7CiAgICAgICAgfTtyZXR1cm4gZnVuY3Rpb24gKG4pIHsKICAgICAgICAgIHZhciBvID0geyBmbjogbiwgbmV4dDogdm9pZCAwIH07dCAmJiAodC5uZXh0ID0gbyksIGUgfHwgKGUgPSBvLCByKCkpLCB0ID0gbzsKICAgICAgICB9OwogICAgICB9OwogICAgfSwgeyAiLi9fY29mIjogMTUsICIuL19nbG9iYWwiOiAyNSwgIi4vX3Rhc2siOiA2MCB9XSwgNDI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX29iamVjdC1kcHMiKSwKICAgICAgICAgIGkgPSBlKCIuL19lbnVtLWJ1Zy1rZXlzIiksCiAgICAgICAgICBjID0gZSgiLi9fc2hhcmVkLWtleSIpKCJJRV9QUk9UTyIpLAogICAgICAgICAgcyA9IGZ1bmN0aW9uIHMoKSB7fSwKICAgICAgICAgIHUgPSAicHJvdG90eXBlIiwKICAgICAgICAgIF9hID0gZnVuY3Rpb24gYSgpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IGUoIi4vX2RvbS1jcmVhdGUiKSgiaWZyYW1lIiksCiAgICAgICAgICAgIG4gPSBpLmxlbmd0aCwKICAgICAgICAgICAgbyA9ICI+Ijtmb3IgKHIuc3R5bGUuZGlzcGxheSA9ICJub25lIiwgZSgiLi9faHRtbCIpLmFwcGVuZENoaWxkKHIpLCByLnNyYyA9ICJqYXZhc2NyaXB0OiIsIHQgPSByLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQsIHQub3BlbigpLCB0LndyaXRlKCI8c2NyaXB0PmRvY3VtZW50LkY9T2JqZWN0PC9zY3JpcHQiICsgbyksIHQuY2xvc2UoKSwgX2EgPSB0LkY7IG4tLTspIHsKICAgICAgICAgIGRlbGV0ZSBfYVt1XVtpW25dXTsKICAgICAgICB9cmV0dXJuIF9hKCk7CiAgICAgIH07dC5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHZhciByO3JldHVybiBudWxsICE9PSBlID8gKHNbdV0gPSBuKGUpLCByID0gbmV3IHMoKSwgc1t1XSA9IG51bGwsIHJbY10gPSBlKSA6IHIgPSBfYSgpLCB2b2lkIDAgPT09IHQgPyByIDogbyhyLCB0KTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2FuLW9iamVjdCI6IDEyLCAiLi9fZG9tLWNyZWF0ZSI6IDIwLCAiLi9fZW51bS1idWcta2V5cyI6IDIxLCAiLi9faHRtbCI6IDI4LCAiLi9fb2JqZWN0LWRwcyI6IDQ0LCAiLi9fc2hhcmVkLWtleSI6IDU2IH1dLCA0MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fYW4tb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi9faWU4LWRvbS1kZWZpbmUiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1wcmltaXRpdmUiKSwKICAgICAgICAgIGMgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7ci5mID0gZSgiLi9fZGVzY3JpcHRvcnMiKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgaWYgKG4oZSksIHQgPSBpKHQsICEwKSwgbihyKSwgbykgdHJ5IHsKICAgICAgICAgIHJldHVybiBjKGUsIHQsIHIpOwogICAgICAgIH0gY2F0Y2ggKHMpIHt9aWYgKCJnZXQiIGluIHIgfHwgInNldCIgaW4gcikgdGhyb3cgVHlwZUVycm9yKCJBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEiKTtyZXR1cm4gInZhbHVlIiBpbiByICYmIChlW3RdID0gci52YWx1ZSksIGU7CiAgICAgIH07CiAgICB9LCB7ICIuL19hbi1vYmplY3QiOiAxMiwgIi4vX2Rlc2NyaXB0b3JzIjogMTksICIuL19pZTgtZG9tLWRlZmluZSI6IDI5LCAiLi9fdG8tcHJpbWl0aXZlIjogNjYgfV0sIDQ0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19vYmplY3QtZHAiKSwKICAgICAgICAgIG8gPSBlKCIuL19hbi1vYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19vYmplY3Qta2V5cyIpO3QuZXhwb3J0cyA9IGUoIi4vX2Rlc2NyaXB0b3JzIikgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgbyhlKTtmb3IgKHZhciByLCBjID0gaSh0KSwgcyA9IGMubGVuZ3RoLCB1ID0gMDsgcyA+IHU7KSB7CiAgICAgICAgICBuLmYoZSwgciA9IGNbdSsrXSwgdFtyXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIsICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fb2JqZWN0LWRwIjogNDMsICIuL19vYmplY3Qta2V5cyI6IDQ4IH1dLCA0NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fb2JqZWN0LXBpZSIpLAogICAgICAgICAgbyA9IGUoIi4vX3Byb3BlcnR5LWRlc2MiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1pb2JqZWN0IiksCiAgICAgICAgICBjID0gZSgiLi9fdG8tcHJpbWl0aXZlIiksCiAgICAgICAgICBzID0gZSgiLi9faGFzIiksCiAgICAgICAgICB1ID0gZSgiLi9faWU4LWRvbS1kZWZpbmUiKSwKICAgICAgICAgIGEgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO3IuZiA9IGUoIi4vX2Rlc2NyaXB0b3JzIikgPyBhIDogZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoZSA9IGkoZSksIHQgPSBjKHQsICEwKSwgdSkgdHJ5IHsKICAgICAgICAgIHJldHVybiBhKGUsIHQpOwogICAgICAgIH0gY2F0Y2ggKHIpIHt9cmV0dXJuIHMoZSwgdCkgPyBvKCFuLmYuY2FsbChlLCB0KSwgZVt0XSkgOiB2b2lkIDA7CiAgICAgIH07CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9faGFzIjogMjYsICIuL19pZTgtZG9tLWRlZmluZSI6IDI5LCAiLi9fb2JqZWN0LXBpZSI6IDQ5LCAiLi9fcHJvcGVydHktZGVzYyI6IDUwLCAiLi9fdG8taW9iamVjdCI6IDYzLCAiLi9fdG8tcHJpbWl0aXZlIjogNjYgfV0sIDQ2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19oYXMiKSwKICAgICAgICAgIG8gPSBlKCIuL190by1vYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIiksCiAgICAgICAgICBjID0gT2JqZWN0LnByb3RvdHlwZTt0LmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZSA9IG8oZSksIG4oZSwgaSkgPyBlW2ldIDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgZS5jb25zdHJ1Y3RvciAmJiBlIGluc3RhbmNlb2YgZS5jb25zdHJ1Y3RvciA/IGUuY29uc3RydWN0b3IucHJvdG90eXBlIDogZSBpbnN0YW5jZW9mIE9iamVjdCA/IGMgOiBudWxsOwogICAgICB9OwogICAgfSwgeyAiLi9faGFzIjogMjYsICIuL19zaGFyZWQta2V5IjogNTYsICIuL190by1vYmplY3QiOiA2NSB9XSwgNDc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2hhcyIpLAogICAgICAgICAgbyA9IGUoIi4vX3RvLWlvYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19hcnJheS1pbmNsdWRlcyIpKCExKSwKICAgICAgICAgIGMgPSBlKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB2YXIgciwKICAgICAgICAgICAgcyA9IG8oZSksCiAgICAgICAgICAgIHUgPSAwLAogICAgICAgICAgICBhID0gW107Zm9yIChyIGluIHMpIHsKICAgICAgICAgIHIgIT0gYyAmJiBuKHMsIHIpICYmIGEucHVzaChyKTsKICAgICAgICB9Zm9yICg7IHQubGVuZ3RoID4gdTspIHsKICAgICAgICAgIG4ocywgciA9IHRbdSsrXSkgJiYgKH5pKGEsIHIpIHx8IGEucHVzaChyKSk7CiAgICAgICAgfXJldHVybiBhOwogICAgICB9OwogICAgfSwgeyAiLi9fYXJyYXktaW5jbHVkZXMiOiAxMywgIi4vX2hhcyI6IDI2LCAiLi9fc2hhcmVkLWtleSI6IDU2LCAiLi9fdG8taW9iamVjdCI6IDYzIH1dLCA0ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwiKSwKICAgICAgICAgIG8gPSBlKCIuL19lbnVtLWJ1Zy1rZXlzIik7dC5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbihlLCBvKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2VudW0tYnVnLWtleXMiOiAyMSwgIi4vX29iamVjdC1rZXlzLWludGVybmFsIjogNDcgfV0sIDQ5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgci5mID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7CiAgICB9LCB7fV0sIDUwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICByZXR1cm4geyBlbnVtZXJhYmxlOiAhKDEgJiBlKSwgY29uZmlndXJhYmxlOiAhKDIgJiBlKSwgd3JpdGFibGU6ICEoNCAmIGUpLCB2YWx1ZTogdCB9OwogICAgICB9OwogICAgfSwge31dLCA1MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faGlkZSIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZm9yICh2YXIgbyBpbiB0KSB7CiAgICAgICAgICByICYmIGVbb10gPyBlW29dID0gdFtvXSA6IG4oZSwgbywgdFtvXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9OwogICAgfSwgeyAiLi9faGlkZSI6IDI3IH1dLCA1MjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vX2hpZGUiKTsKICAgIH0sIHsgIi4vX2hpZGUiOiAyNyB9XSwgNTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2lzLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgaSA9IGZ1bmN0aW9uIGkoZSwgdCkgewogICAgICAgIGlmIChvKGUpLCAhbih0KSAmJiBudWxsICE9PSB0KSB0aHJvdyBUeXBlRXJyb3IodCArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7CiAgICAgIH07dC5leHBvcnRzID0geyBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoIl9fcHJvdG9fXyIgaW4ge30gPyBmdW5jdGlvbiAodCwgciwgbikgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbiA9IGUoIi4vX2N0eCIpKEZ1bmN0aW9uLmNhbGwsIGUoIi4vX29iamVjdC1nb3BkIikuZihPYmplY3QucHJvdG90eXBlLCAiX19wcm90b19fIikuc2V0LCAyKSwgbih0LCBbXSksIHIgPSAhKHQgaW5zdGFuY2VvZiBBcnJheSk7CiAgICAgICAgICB9IGNhdGNoIChvKSB7CiAgICAgICAgICAgIHIgPSAhMDsKICAgICAgICAgIH1yZXR1cm4gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgcmV0dXJuIGkoZSwgdCksIHIgPyBlLl9fcHJvdG9fXyA9IHQgOiBuKGUsIHQpLCBlOwogICAgICAgICAgfTsKICAgICAgICB9KHt9LCAhMSkgOiB2b2lkIDApLCBjaGVjazogaSB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIsICIuL19jdHgiOiAxNywgIi4vX2lzLW9iamVjdCI6IDMzLCAiLi9fb2JqZWN0LWdvcGQiOiA0NSB9XSwgNTQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi9fZ2xvYmFsIiksCiAgICAgICAgICBvID0gZSgiLi9fY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vX29iamVjdC1kcCIpLAogICAgICAgICAgYyA9IGUoIi4vX2Rlc2NyaXB0b3JzIiksCiAgICAgICAgICBzID0gZSgiLi9fd2tzIikoInNwZWNpZXMiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0gImZ1bmN0aW9uIiA9PSB0eXBlb2Ygb1tlXSA/IG9bZV0gOiBuW2VdO2MgJiYgdCAmJiAhdFtzXSAmJiBpLmYodCwgcywgeyBjb25maWd1cmFibGU6ICEwLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9IH0pOwogICAgICB9OwogICAgfSwgeyAiLi9fY29yZSI6IDE2LCAiLi9fZGVzY3JpcHRvcnMiOiAxOSwgIi4vX2dsb2JhbCI6IDI1LCAiLi9fb2JqZWN0LWRwIjogNDMsICIuL193a3MiOiA2OCB9XSwgNTU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX29iamVjdC1kcCIpLmYsCiAgICAgICAgICBvID0gZSgiLi9faGFzIiksCiAgICAgICAgICBpID0gZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICBlICYmICFvKGUgPSByID8gZSA6IGUucHJvdG90eXBlLCBpKSAmJiBuKGUsIGksIHsgY29uZmlndXJhYmxlOiAhMCwgdmFsdWU6IHQgfSk7CiAgICAgIH07CiAgICB9LCB7ICIuL19oYXMiOiAyNiwgIi4vX29iamVjdC1kcCI6IDQzLCAiLi9fd2tzIjogNjggfV0sIDU2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19zaGFyZWQiKSgia2V5cyIpLAogICAgICAgICAgbyA9IGUoIi4vX3VpZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBvKGUpKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX3NoYXJlZCI6IDU3LCAiLi9fdWlkIjogNjcgfV0sIDU3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19nbG9iYWwiKSwKICAgICAgICAgIG8gPSAiX19jb3JlLWpzX3NoYXJlZF9fIiwKICAgICAgICAgIGkgPSBuW29dIHx8IChuW29dID0ge30pO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGlbZV0gfHwgKGlbZV0gPSB7fSk7CiAgICAgIH07CiAgICB9LCB7ICIuL19nbG9iYWwiOiAyNSB9XSwgNTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2EtZnVuY3Rpb24iKSwKICAgICAgICAgIGkgPSBlKCIuL193a3MiKSgic3BlY2llcyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgdmFyIHIsCiAgICAgICAgICAgIGMgPSBuKGUpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDAgPT09IGMgfHwgdm9pZCAwID09IChyID0gbihjKVtpXSkgPyB0IDogbyhyKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2EtZnVuY3Rpb24iOiA5LCAiLi9fYW4tb2JqZWN0IjogMTIsICIuL193a3MiOiA2OCB9XSwgNTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX3RvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBlKCIuL19kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQsIHIpIHsKICAgICAgICAgIHZhciBpLAogICAgICAgICAgICAgIGMsCiAgICAgICAgICAgICAgcyA9IFN0cmluZyhvKHQpKSwKICAgICAgICAgICAgICB1ID0gbihyKSwKICAgICAgICAgICAgICBhID0gcy5sZW5ndGg7cmV0dXJuIDAgPiB1IHx8IHUgPj0gYSA/IGUgPyAiIiA6IHZvaWQgMCA6IChpID0gcy5jaGFyQ29kZUF0KHUpLCA1NTI5NiA+IGkgfHwgaSA+IDU2MzE5IHx8IHUgKyAxID09PSBhIHx8IChjID0gcy5jaGFyQ29kZUF0KHUgKyAxKSkgPCA1NjMyMCB8fCBjID4gNTczNDMgPyBlID8gcy5jaGFyQXQodSkgOiBpIDogZSA/IHMuc2xpY2UodSwgdSArIDIpIDogKGkgLSA1NTI5NiA8PCAxMCkgKyAoYyAtIDU2MzIwKSArIDY1NTM2KTsKICAgICAgICB9OwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4LCAiLi9fdG8taW50ZWdlciI6IDYyIH1dLCA2MDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBjID0gZSgiLi9fY3R4IiksCiAgICAgICAgICBzID0gZSgiLi9faW52b2tlIiksCiAgICAgICAgICB1ID0gZSgiLi9faHRtbCIpLAogICAgICAgICAgYSA9IGUoIi4vX2RvbS1jcmVhdGUiKSwKICAgICAgICAgIGYgPSBlKCIuL19nbG9iYWwiKSwKICAgICAgICAgIF8gPSBmLnByb2Nlc3MsCiAgICAgICAgICBsID0gZi5zZXRJbW1lZGlhdGUsCiAgICAgICAgICBkID0gZi5jbGVhckltbWVkaWF0ZSwKICAgICAgICAgIHAgPSBmLk1lc3NhZ2VDaGFubmVsLAogICAgICAgICAgdiA9IDAsCiAgICAgICAgICB5ID0ge30sCiAgICAgICAgICBoID0gIm9ucmVhZHlzdGF0ZWNoYW5nZSIsCiAgICAgICAgICBiID0gZnVuY3Rpb24gYigpIHsKICAgICAgICB2YXIgZSA9ICt0aGlzO2lmICh5Lmhhc093blByb3BlcnR5KGUpKSB7CiAgICAgICAgICB2YXIgdCA9IHlbZV07ZGVsZXRlIHlbZV0sIHQoKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBtID0gZnVuY3Rpb24gbShlKSB7CiAgICAgICAgYi5jYWxsKGUuZGF0YSk7CiAgICAgIH07bCAmJiBkIHx8IChsID0gZnVuY3Rpb24gbChlKSB7CiAgICAgICAgZm9yICh2YXIgdCA9IFtdLCByID0gMTsgYXJndW1lbnRzLmxlbmd0aCA+IHI7KSB7CiAgICAgICAgICB0LnB1c2goYXJndW1lbnRzW3IrK10pOwogICAgICAgIH1yZXR1cm4geVsrK3ZdID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcygiZnVuY3Rpb24iID09IHR5cGVvZiBlID8gZSA6IEZ1bmN0aW9uKGUpLCB0KTsKICAgICAgICB9LCBuKHYpLCB2OwogICAgICB9LCBkID0gZnVuY3Rpb24gZChlKSB7CiAgICAgICAgZGVsZXRlIHlbZV07CiAgICAgIH0sICJwcm9jZXNzIiA9PSBlKCIuL19jb2YiKShfKSA/IG4gPSBmdW5jdGlvbiBuKGUpIHsKICAgICAgICBfLm5leHRUaWNrKGMoYiwgZSwgMSkpOwogICAgICB9IDogcCA/IChvID0gbmV3IHAoKSwgaSA9IG8ucG9ydDIsIG8ucG9ydDEub25tZXNzYWdlID0gbSwgbiA9IGMoaS5wb3N0TWVzc2FnZSwgaSwgMSkpIDogZi5hZGRFdmVudExpc3RlbmVyICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHBvc3RNZXNzYWdlICYmICFmLmltcG9ydFNjcmlwdHMgPyAobiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIGYucG9zdE1lc3NhZ2UoZSArICIiLCAiKiIpOwogICAgICB9LCBmLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBtLCAhMSkpIDogbiA9IGggaW4gYSgic2NyaXB0IikgPyBmdW5jdGlvbiAoZSkgewogICAgICAgIHUuYXBwZW5kQ2hpbGQoYSgic2NyaXB0IikpW2hdID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdS5yZW1vdmVDaGlsZCh0aGlzKSwgYi5jYWxsKGUpOwogICAgICAgIH07CiAgICAgIH0gOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHNldFRpbWVvdXQoYyhiLCBlLCAxKSwgMCk7CiAgICAgIH0pLCB0LmV4cG9ydHMgPSB7IHNldDogbCwgY2xlYXI6IGQgfTsKICAgIH0sIHsgIi4vX2NvZiI6IDE1LCAiLi9fY3R4IjogMTcsICIuL19kb20tY3JlYXRlIjogMjAsICIuL19nbG9iYWwiOiAyNSwgIi4vX2h0bWwiOiAyOCwgIi4vX2ludm9rZSI6IDMwIH1dLCA2MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fdG8taW50ZWdlciIpLAogICAgICAgICAgbyA9IE1hdGgubWF4LAogICAgICAgICAgaSA9IE1hdGgubWluO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIGUgPSBuKGUpLCAwID4gZSA/IG8oZSArIHQsIDApIDogaShlLCB0KTsKICAgICAgfTsKICAgIH0sIHsgIi4vX3RvLWludGVnZXIiOiA2MiB9XSwgNjI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IE1hdGguY2VpbCwKICAgICAgICAgIG8gPSBNYXRoLmZsb29yO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGlzTmFOKGUgPSArZSkgPyAwIDogKGUgPiAwID8gbyA6IG4pKGUpOwogICAgICB9OwogICAgfSwge31dLCA2MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2RlZmluZWQiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuKG8oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4LCAiLi9faW9iamVjdCI6IDMxIH1dLCA2NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fdG8taW50ZWdlciIpLAogICAgICAgICAgbyA9IE1hdGgubWluO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUgPiAwID8gbyhuKGUpLCA5MDA3MTk5MjU0NzQwOTkxKSA6IDA7CiAgICAgIH07CiAgICB9LCB7ICIuL190by1pbnRlZ2VyIjogNjIgfV0sIDY1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gT2JqZWN0KG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4IH1dLCA2NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faXMtb2JqZWN0Iik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoIW4oZSkpIHJldHVybiBlO3ZhciByLCBvO2lmICh0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIChyID0gZS50b1N0cmluZykgJiYgIW4obyA9IHIuY2FsbChlKSkpIHJldHVybiBvO2lmICgiZnVuY3Rpb24iID09IHR5cGVvZiAociA9IGUudmFsdWVPZikgJiYgIW4obyA9IHIuY2FsbChlKSkpIHJldHVybiBvO2lmICghdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiAociA9IGUudG9TdHJpbmcpICYmICFuKG8gPSByLmNhbGwoZSkpKSByZXR1cm4gbzt0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwogICAgICB9OwogICAgfSwgeyAiLi9faXMtb2JqZWN0IjogMzMgfV0sIDY3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSAwLAogICAgICAgICAgbyA9IE1hdGgucmFuZG9tKCk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIlN5bWJvbCgiLmNvbmNhdCh2b2lkIDAgPT09IGUgPyAiIiA6IGUsICIpXyIsICgrK24gKyBvKS50b1N0cmluZygzNikpOwogICAgICB9OwogICAgfSwge31dLCA2ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fc2hhcmVkIikoIndrcyIpLAogICAgICAgICAgbyA9IGUoIi4vX3VpZCIpLAogICAgICAgICAgaSA9IGUoIi4vX2dsb2JhbCIpLlN5bWJvbCwKICAgICAgICAgIGMgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBpLAogICAgICAgICAgcyA9IHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBjICYmIGlbZV0gfHwgKGMgPyBpIDogbykoIlN5bWJvbC4iICsgZSkpOwogICAgICB9O3Muc3RvcmUgPSBuOwogICAgfSwgeyAiLi9fZ2xvYmFsIjogMjUsICIuL19zaGFyZWQiOiA1NywgIi4vX3VpZCI6IDY3IH1dLCA2OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fY2xhc3NvZiIpLAogICAgICAgICAgbyA9IGUoIi4vX3drcyIpKCJpdGVyYXRvciIpLAogICAgICAgICAgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpO3QuZXhwb3J0cyA9IGUoIi4vX2NvcmUiKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPSBlID8gZVtvXSB8fCBlWyJAQGl0ZXJhdG9yIl0gfHwgaVtuKGUpXSA6IHZvaWQgMDsKICAgICAgfTsKICAgIH0sIHsgIi4vX2NsYXNzb2YiOiAxNCwgIi4vX2NvcmUiOiAxNiwgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fd2tzIjogNjggfV0sIDcwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vX2FkZC10by11bnNjb3BhYmxlcyIpLAogICAgICAgICAgbyA9IGUoIi4vX2l0ZXItc3RlcCIpLAogICAgICAgICAgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpLAogICAgICAgICAgYyA9IGUoIi4vX3RvLWlvYmplY3QiKTt0LmV4cG9ydHMgPSBlKCIuL19pdGVyLWRlZmluZSIpKEFycmF5LCAiQXJyYXkiLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHRoaXMuX3QgPSBjKGUpLCB0aGlzLl9pID0gMCwgdGhpcy5fayA9IHQ7CiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZSA9IHRoaXMuX3QsCiAgICAgICAgICAgIHQgPSB0aGlzLl9rLAogICAgICAgICAgICByID0gdGhpcy5faSsrO3JldHVybiAhZSB8fCByID49IGUubGVuZ3RoID8gKHRoaXMuX3QgPSB2b2lkIDAsIG8oMSkpIDogImtleXMiID09IHQgPyBvKDAsIHIpIDogInZhbHVlcyIgPT0gdCA/IG8oMCwgZVtyXSkgOiBvKDAsIFtyLCBlW3JdXSk7CiAgICAgIH0sICJ2YWx1ZXMiKSwgaS5Bcmd1bWVudHMgPSBpLkFycmF5LCBuKCJrZXlzIiksIG4oInZhbHVlcyIpLCBuKCJlbnRyaWVzIik7CiAgICB9LCB7ICIuL19hZGQtdG8tdW5zY29wYWJsZXMiOiAxMCwgIi4vX2l0ZXItZGVmaW5lIjogMzYsICIuL19pdGVyLXN0ZXAiOiAzOCwgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fdG8taW9iamVjdCI6IDYzIH1dLCA3MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fZXhwb3J0Iik7bihuLlMgKyBuLkYgKiAhZSgiLi9fZGVzY3JpcHRvcnMiKSwgIk9iamVjdCIsIHsgZGVmaW5lUHJvcGVydHk6IGUoIi4vX29iamVjdC1kcCIpLmYgfSk7CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fZXhwb3J0IjogMjIsICIuL19vYmplY3QtZHAiOiA0MyB9XSwgNzI6IFtmdW5jdGlvbiAoZSwgdCwgcikge30sIHt9XSwgNzM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBjID0gZSgiLi9fbGlicmFyeSIpLAogICAgICAgICAgcyA9IGUoIi4vX2dsb2JhbCIpLAogICAgICAgICAgdSA9IGUoIi4vX2N0eCIpLAogICAgICAgICAgYSA9IGUoIi4vX2NsYXNzb2YiKSwKICAgICAgICAgIGYgPSBlKCIuL19leHBvcnQiKSwKICAgICAgICAgIF8gPSBlKCIuL19pcy1vYmplY3QiKSwKICAgICAgICAgIGwgPSAoZSgiLi9fYW4tb2JqZWN0IiksIGUoIi4vX2EtZnVuY3Rpb24iKSksCiAgICAgICAgICBkID0gZSgiLi9fYW4taW5zdGFuY2UiKSwKICAgICAgICAgIHAgPSBlKCIuL19mb3Itb2YiKSwKICAgICAgICAgIHYgPSAoZSgiLi9fc2V0LXByb3RvIikuc2V0LCBlKCIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIikpLAogICAgICAgICAgeSA9IGUoIi4vX3Rhc2siKS5zZXQsCiAgICAgICAgICBoID0gZSgiLi9fbWljcm90YXNrIikoKSwKICAgICAgICAgIGIgPSAiUHJvbWlzZSIsCiAgICAgICAgICBtID0gcy5UeXBlRXJyb3IsCiAgICAgICAgICBnID0gcy5wcm9jZXNzLAogICAgICAgICAgX2ogPSBzW2JdLAogICAgICAgICAgZyA9IHMucHJvY2VzcywKICAgICAgICAgIHggPSAicHJvY2VzcyIgPT0gYShnKSwKICAgICAgICAgIHcgPSBmdW5jdGlvbiB3KCkge30sCiAgICAgICAgICBrID0gISFmdW5jdGlvbiAoKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhciB0ID0gX2oucmVzb2x2ZSgxKSwKICAgICAgICAgICAgICByID0gKHQuY29uc3RydWN0b3IgPSB7fSlbZSgiLi9fd2tzIikoInNwZWNpZXMiKV0gPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBlKHcsIHcpOwogICAgICAgICAgfTtyZXR1cm4gKHggfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50KSAmJiB0LnRoZW4odykgaW5zdGFuY2VvZiByOwogICAgICAgIH0gY2F0Y2ggKG4pIHt9CiAgICAgIH0oKSwKICAgICAgICAgIE8gPSBmdW5jdGlvbiBPKGUsIHQpIHsKICAgICAgICByZXR1cm4gZSA9PT0gdCB8fCBlID09PSBfaiAmJiB0ID09PSBpOwogICAgICB9LAogICAgICAgICAgTSA9IGZ1bmN0aW9uIE0oZSkgewogICAgICAgIHZhciB0O3JldHVybiBfKGUpICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mICh0ID0gZS50aGVuKSA/IHQgOiAhMTsKICAgICAgfSwKICAgICAgICAgIFAgPSBmdW5jdGlvbiBQKGUpIHsKICAgICAgICByZXR1cm4gTyhfaiwgZSkgPyBuZXcgUyhlKSA6IG5ldyBvKGUpOwogICAgICB9LAogICAgICAgICAgUyA9IG8gPSBmdW5jdGlvbiBvKGUpIHsKICAgICAgICB2YXIgdCwgcjt0aGlzLnByb21pc2UgPSBuZXcgZShmdW5jdGlvbiAoZSwgbikgewogICAgICAgICAgaWYgKHZvaWQgMCAhPT0gdCB8fCB2b2lkIDAgIT09IHIpIHRocm93IG0oIkJhZCBQcm9taXNlIGNvbnN0cnVjdG9yIik7dCA9IGUsIHIgPSBuOwogICAgICAgIH0pLCB0aGlzLnJlc29sdmUgPSBsKHQpLCB0aGlzLnJlamVjdCA9IGwocik7CiAgICAgIH0sCiAgICAgICAgICBFID0gZnVuY3Rpb24gRShlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGUoKTsKICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICByZXR1cm4geyBlcnJvcjogdCB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIFQgPSBmdW5jdGlvbiBUKGUsIHQpIHsKICAgICAgICBpZiAoIWUuX24pIHsKICAgICAgICAgIGUuX24gPSAhMDt2YXIgciA9IGUuX2M7aChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGZvciAodmFyIG4gPSBlLl92LCBvID0gMSA9PSBlLl9zLCBpID0gMCwgYyA9IGZ1bmN0aW9uIGModCkgewogICAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgICBjID0gbyA/IHQub2sgOiB0LmZhaWwsCiAgICAgICAgICAgICAgICAgIHMgPSB0LnJlc29sdmUsCiAgICAgICAgICAgICAgICAgIHUgPSB0LnJlamVjdCwKICAgICAgICAgICAgICAgICAgYSA9IHQuZG9tYWluO3RyeSB7CiAgICAgICAgICAgICAgICBjID8gKG8gfHwgKDIgPT0gZS5faCAmJiBDKGUpLCBlLl9oID0gMSksIGMgPT09ICEwID8gciA9IG4gOiAoYSAmJiBhLmVudGVyKCksIHIgPSBjKG4pLCBhICYmIGEuZXhpdCgpKSwgciA9PT0gdC5wcm9taXNlID8gdShtKCJQcm9taXNlLWNoYWluIGN5Y2xlIikpIDogKGkgPSBNKHIpKSA/IGkuY2FsbChyLCBzLCB1KSA6IHMocikpIDogdShuKTsKICAgICAgICAgICAgICB9IGNhdGNoIChmKSB7CiAgICAgICAgICAgICAgICB1KGYpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsgci5sZW5ndGggPiBpOykgewogICAgICAgICAgICAgIGMocltpKytdKTsKICAgICAgICAgICAgfWUuX2MgPSBbXSwgZS5fbiA9ICExLCB0ICYmICFlLl9oICYmIEEoZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBBID0gZnVuY3Rpb24gQShlKSB7CiAgICAgICAgeS5jYWxsKHMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0LAogICAgICAgICAgICAgIHIsCiAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICBvID0gZS5fdjtpZiAoVShlKSAmJiAodCA9IEUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB4ID8gZy5lbWl0KCJ1bmhhbmRsZWRSZWplY3Rpb24iLCBvLCBlKSA6IChyID0gcy5vbnVuaGFuZGxlZHJlamVjdGlvbikgPyByKHsgcHJvbWlzZTogZSwgcmVhc29uOiBvIH0pIDogKG4gPSBzLmNvbnNvbGUpICYmIG4uZXJyb3IgJiYgbi5lcnJvcigiVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uIiwgbyk7CiAgICAgICAgICB9KSwgZS5faCA9IHggfHwgVShlKSA/IDIgOiAxKSwgZS5fYSA9IHZvaWQgMCwgdCkgdGhyb3cgdC5lcnJvcjsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgICAgIFUgPSBmdW5jdGlvbiBVKGUpIHsKICAgICAgICBpZiAoMSA9PSBlLl9oKSByZXR1cm4gITE7Zm9yICh2YXIgdCwgciA9IGUuX2EgfHwgZS5fYywgbiA9IDA7IHIubGVuZ3RoID4gbjspIHsKICAgICAgICAgIGlmICh0ID0gcltuKytdLCB0LmZhaWwgfHwgIVUodC5wcm9taXNlKSkgcmV0dXJuICExOwogICAgICAgIH1yZXR1cm4gITA7CiAgICAgIH0sCiAgICAgICAgICBDID0gZnVuY3Rpb24gQyhlKSB7CiAgICAgICAgeS5jYWxsKHMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0O3ggPyBnLmVtaXQoInJlamVjdGlvbkhhbmRsZWQiLCBlKSA6ICh0ID0gcy5vbnJlamVjdGlvbmhhbmRsZWQpICYmIHQoeyBwcm9taXNlOiBlLCByZWFzb246IGUuX3YgfSk7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgICAgICBSID0gZnVuY3Rpb24gUihlKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzO3QuX2QgfHwgKHQuX2QgPSAhMCwgdCA9IHQuX3cgfHwgdCwgdC5fdiA9IGUsIHQuX3MgPSAyLCB0Ll9hIHx8ICh0Ll9hID0gdC5fYy5zbGljZSgpKSwgVCh0LCAhMCkpOwogICAgICB9LAogICAgICAgICAgTCA9IGZ1bmN0aW9uIEwoZSkgewogICAgICAgIHZhciB0LAogICAgICAgICAgICByID0gdGhpcztpZiAoIXIuX2QpIHsKICAgICAgICAgIHIuX2QgPSAhMCwgciA9IHIuX3cgfHwgcjt0cnkgewogICAgICAgICAgICBpZiAociA9PT0gZSkgdGhyb3cgbSgiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGYiKTsodCA9IE0oZSkpID8gaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIG4gPSB7IF93OiByLCBfZDogITEgfTt0cnkgewogICAgICAgICAgICAgICAgdC5jYWxsKGUsIHUoTCwgbiwgMSksIHUoUiwgbiwgMSkpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKG8pIHsKICAgICAgICAgICAgICAgIFIuY2FsbChuLCBvKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pIDogKHIuX3YgPSBlLCByLl9zID0gMSwgVChyLCAhMSkpOwogICAgICAgICAgfSBjYXRjaCAobikgewogICAgICAgICAgICBSLmNhbGwoeyBfdzogciwgX2Q6ICExIH0sIG4pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTtrIHx8IChfaiA9IGZ1bmN0aW9uIGooZSkgewogICAgICAgIGQodGhpcywgX2osIGIsICJfaCIpLCBsKGUpLCBuLmNhbGwodGhpcyk7dHJ5IHsKICAgICAgICAgIGUodShMLCB0aGlzLCAxKSwgdShSLCB0aGlzLCAxKSk7CiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgUi5jYWxsKHRoaXMsIHQpOwogICAgICAgIH0KICAgICAgfSwgbiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHRoaXMuX2MgPSBbXSwgdGhpcy5fYSA9IHZvaWQgMCwgdGhpcy5fcyA9IDAsIHRoaXMuX2QgPSAhMSwgdGhpcy5fdiA9IHZvaWQgMCwgdGhpcy5faCA9IDAsIHRoaXMuX24gPSAhMTsKICAgICAgfSwgbi5wcm90b3R5cGUgPSBlKCIuL19yZWRlZmluZS1hbGwiKShfai5wcm90b3R5cGUsIHsgdGhlbjogZnVuY3Rpb24gdGhlbihlLCB0KSB7CiAgICAgICAgICB2YXIgciA9IFAodih0aGlzLCBfaikpO3JldHVybiByLm9rID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSA/IGUgOiAhMCwgci5mYWlsID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdCAmJiB0LCByLmRvbWFpbiA9IHggPyBnLmRvbWFpbiA6IHZvaWQgMCwgdGhpcy5fYy5wdXNoKHIpLCB0aGlzLl9hICYmIHRoaXMuX2EucHVzaChyKSwgdGhpcy5fcyAmJiBUKHRoaXMsICExKSwgci5wcm9taXNlOwogICAgICAgIH0sICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaChlKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgZSk7CiAgICAgICAgfSB9KSwgUyA9IGZ1bmN0aW9uIFMoKSB7CiAgICAgICAgdmFyIGUgPSBuZXcgbigpO3RoaXMucHJvbWlzZSA9IGUsIHRoaXMucmVzb2x2ZSA9IHUoTCwgZSwgMSksIHRoaXMucmVqZWN0ID0gdShSLCBlLCAxKTsKICAgICAgfSksIGYoZi5HICsgZi5XICsgZi5GICogIWssIHsgUHJvbWlzZTogX2ogfSksIGUoIi4vX3NldC10by1zdHJpbmctdGFnIikoX2osIGIpLCBlKCIuL19zZXQtc3BlY2llcyIpKGIpLCBpID0gZSgiLi9fY29yZSIpW2JdLCBmKGYuUyArIGYuRiAqICFrLCBiLCB7IHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KGUpIHsKICAgICAgICAgIHZhciB0ID0gUCh0aGlzKSwKICAgICAgICAgICAgICByID0gdC5yZWplY3Q7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCBmKGYuUyArIGYuRiAqIChjIHx8ICFrKSwgYiwgeyByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKGUpIHsKICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgX2ogJiYgTyhlLmNvbnN0cnVjdG9yLCB0aGlzKSkgcmV0dXJuIGU7dmFyIHQgPSBQKHRoaXMpLAogICAgICAgICAgICAgIHIgPSB0LnJlc29sdmU7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCBmKGYuUyArIGYuRiAqICEoayAmJiBlKCIuL19pdGVyLWRldGVjdCIpKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX2ouYWxsKGUpWyJjYXRjaCJdKHcpOwogICAgICB9KSksIGIsIHsgYWxsOiBmdW5jdGlvbiBhbGwoZSkgewogICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgIHIgPSBQKHQpLAogICAgICAgICAgICAgIG4gPSByLnJlc29sdmUsCiAgICAgICAgICAgICAgbyA9IHIucmVqZWN0LAogICAgICAgICAgICAgIGkgPSBFKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHIgPSBbXSwKICAgICAgICAgICAgICAgIGkgPSAwLAogICAgICAgICAgICAgICAgYyA9IDE7cChlLCAhMSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB2YXIgcyA9IGkrKywKICAgICAgICAgICAgICAgICAgdSA9ICExO3IucHVzaCh2b2lkIDApLCBjKyssIHQucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICB1IHx8ICh1ID0gITAsIHJbc10gPSBlLCAtLWMgfHwgbihyKSk7CiAgICAgICAgICAgICAgfSwgbyk7CiAgICAgICAgICAgIH0pLCAtLWMgfHwgbihyKTsKICAgICAgICAgIH0pO3JldHVybiBpICYmIG8oaS5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9LCByYWNlOiBmdW5jdGlvbiByYWNlKGUpIHsKICAgICAgICAgIHZhciB0ID0gdGhpcywKICAgICAgICAgICAgICByID0gUCh0KSwKICAgICAgICAgICAgICBuID0gci5yZWplY3QsCiAgICAgICAgICAgICAgbyA9IEUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBwKGUsICExLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHQucmVzb2x2ZShlKS50aGVuKHIucmVzb2x2ZSwgbik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7cmV0dXJuIG8gJiYgbihvLmVycm9yKSwgci5wcm9taXNlOwogICAgICAgIH0gfSk7CiAgICB9LCB7ICIuL19hLWZ1bmN0aW9uIjogOSwgIi4vX2FuLWluc3RhbmNlIjogMTEsICIuL19hbi1vYmplY3QiOiAxMiwgIi4vX2NsYXNzb2YiOiAxNCwgIi4vX2NvcmUiOiAxNiwgIi4vX2N0eCI6IDE3LCAiLi9fZXhwb3J0IjogMjIsICIuL19mb3Itb2YiOiAyNCwgIi4vX2dsb2JhbCI6IDI1LCAiLi9faXMtb2JqZWN0IjogMzMsICIuL19pdGVyLWRldGVjdCI6IDM3LCAiLi9fbGlicmFyeSI6IDQwLCAiLi9fbWljcm90YXNrIjogNDEsICIuL19yZWRlZmluZS1hbGwiOiA1MSwgIi4vX3NldC1wcm90byI6IDUzLCAiLi9fc2V0LXNwZWNpZXMiOiA1NCwgIi4vX3NldC10by1zdHJpbmctdGFnIjogNTUsICIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIjogNTgsICIuL190YXNrIjogNjAsICIuL193a3MiOiA2OCB9XSwgNzQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi9fc3RyaW5nLWF0IikoITApO2UoIi4vX2l0ZXItZGVmaW5lIikoU3RyaW5nLCAiU3RyaW5nIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB0aGlzLl90ID0gU3RyaW5nKGUpLCB0aGlzLl9pID0gMDsKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBlLAogICAgICAgICAgICB0ID0gdGhpcy5fdCwKICAgICAgICAgICAgciA9IHRoaXMuX2k7cmV0dXJuIHIgPj0gdC5sZW5ndGggPyB7IHZhbHVlOiB2b2lkIDAsIGRvbmU6ICEwIH0gOiAoZSA9IG4odCwgciksIHRoaXMuX2kgKz0gZS5sZW5ndGgsIHsgdmFsdWU6IGUsIGRvbmU6ICExIH0pOwogICAgICB9KTsKICAgIH0sIHsgIi4vX2l0ZXItZGVmaW5lIjogMzYsICIuL19zdHJpbmctYXQiOiA1OSB9XSwgNzU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuL2VzNi5hcnJheS5pdGVyYXRvciIpO2ZvciAodmFyIG4gPSBlKCIuL19nbG9iYWwiKSwgbyA9IGUoIi4vX2hpZGUiKSwgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpLCBjID0gZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIiksIHMgPSBbIk5vZGVMaXN0IiwgIkRPTVRva2VuTGlzdCIsICJNZWRpYUxpc3QiLCAiU3R5bGVTaGVldExpc3QiLCAiQ1NTUnVsZUxpc3QiXSwgdSA9IDA7IDUgPiB1OyB1KyspIHsKICAgICAgICB2YXIgYSA9IHNbdV0sCiAgICAgICAgICAgIGYgPSBuW2FdLAogICAgICAgICAgICBfID0gZiAmJiBmLnByb3RvdHlwZTtfICYmICFfW2NdICYmIG8oXywgYywgYSksIGlbYV0gPSBpLkFycmF5OwogICAgICB9CiAgICB9LCB7ICIuL19nbG9iYWwiOiAyNSwgIi4vX2hpZGUiOiAyNywgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fd2tzIjogNjgsICIuL2VzNi5hcnJheS5pdGVyYXRvciI6IDcwIH1dLCA3NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoIi4vaHlwZXJ0eS1kaXNjb3ZlcnkvSHlwZXJ0eURpc2NvdmVyeSIpLAogICAgICAgICAgaSA9IG4obyk7clsiZGVmYXVsdCJdID0gaVsiZGVmYXVsdCJdLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuL2h5cGVydHktZGlzY292ZXJ5L0h5cGVydHlEaXNjb3ZlcnkiOiA3NyB9XSwgNzc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBjID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBzID0gbihjKSwKICAgICAgICAgIHUgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGEgPSBuKHUpLAogICAgICAgICAgZiA9IGUoIi4uL3V0aWxzL3V0aWxzIiksCiAgICAgICAgICBfID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCwgcikgewogICAgICAgICAgKDAsIHNbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIG4gPSB0aGlzO24ubWVzc2FnZUJ1cyA9IHIsIG4uZG9tYWluID0gKDAsIGYuZGl2aWRlVVJMKSh0KS5kb21haW4sIG4uZGlzY292ZXJ5VVJMID0gdDsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogImRpc2NvdmVyRGF0YU9iamVjdFBlck5hbWUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiAiZGF0YU9iamVjdDovLyIgKyBlIH0gfTtyZXR1cm4gbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHIubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShvLCBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgdmFyIG4gPSByLmJvZHkudmFsdWUudXJsO24gPyBlKG4pIDogdCgiRGF0YU9iamVjdCBuYW1lIGRvZXMgbm90IGV4aXN0Iik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogImRpc2NvdmVySHlwZXJ0eVBlclVzZXIiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0gInVzZXI6Ly8iICsgZS5zdWJzdHJpbmcoZS5pbmRleE9mKCJAIikgKyAxLCBlLmxlbmd0aCkgKyAiLyIgKyBlLnN1YnN0cmluZygwLCBlLmluZGV4T2YoIkAiKSksCiAgICAgICAgICAgICAgICBjID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiBvIH0gfTtyZXR1cm4gY29uc29sZS5sb2coIk1lc3NhZ2U6ICIsIGMsIG4sIG8pLCBuZXcgaVsiZGVmYXVsdCJdKGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgci5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKGMsIGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygibWVzc2FnZSByZXBseSIsIHIpO3ZhciBvID0gdm9pZCAwLAogICAgICAgICAgICAgICAgICAgIGkgPSB2b2lkIDAsCiAgICAgICAgICAgICAgICAgICAgYyA9IHZvaWQgMCwKICAgICAgICAgICAgICAgICAgICBzID0gci5ib2R5LnZhbHVlO2ZvciAobyBpbiBzKSB7CiAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHNbb10ubGFzdE1vZGlmaWVkKSBpZiAodm9pZCAwID09PSBpKSBpID0gbmV3IERhdGUoc1tvXS5sYXN0TW9kaWZpZWQpLCBjID0gbztlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdSA9IG5ldyBEYXRlKHNbb10ubGFzdE1vZGlmaWVkKTtpLmdldFRpbWUoKSA8IHUuZ2V0VGltZSgpICYmIChpID0gdSwgYyA9IG8pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9Y29uc29sZS5sb2coIkxhc3QgSHlwZXJ0eTogIiwgYywgaSk7dmFyIGEgPSBjO2lmICh2b2lkIDAgPT09IGEpIHJldHVybiBuKCJVc2VyIEh5cGVydHkgbm90IGZvdW5kIik7dmFyIGYgPSB7IGlkOiBlLCBkZXNjcmlwdG9yOiBzW2FdLmRlc2NyaXB0b3IsIGh5cGVydHlVUkw6IGEgfTtjb25zb2xlLmxvZygiPT09PiBoeXBlcnR5RGlzY292ZXJ5IG1lc3NhZ2VCdW5kbGU6ICIsIGYpLCB0KGYpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkaXNjb3Zlckh5cGVydGllc1BlclVzZXIiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0gInVzZXI6Ly8iICsgZS5zdWJzdHJpbmcoZS5pbmRleE9mKCJAIikgKyAxLCBlLmxlbmd0aCkgKyAiLyIgKyBlLnN1YnN0cmluZygwLCBlLmluZGV4T2YoIkAiKSksCiAgICAgICAgICAgICAgICBjID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiBvIH0gfTtyZXR1cm4gY29uc29sZS5sb2coIk1lc3NhZ2UgZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyOiAiLCBjLCBuLCBvKSwgbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHIubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShjLCBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coImRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlciByZXBseSIsIHIpO3ZhciBuID0gci5ib2R5LnZhbHVlO3JldHVybiBuID8gdm9pZCBlKG4pIDogdCgiVXNlciBIeXBlcnR5IG5vdCBmb3VuZCIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gXywgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi4vdXRpbHMvdXRpbHMiOiA3OCwgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIjogMywgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDQsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiA1IH1dLCA3ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1mdW5jdGlvbiBvKGUpIHsKICAgICAgICB2YXIgdCA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpLAogICAgICAgICAgICByID0gIiQxLCQyLCQzIiwKICAgICAgICAgICAgbiA9IGUucmVwbGFjZSh0LCByKS5zcGxpdCgiLCIpO25bMF0gPT09IGUgJiYgKG5bMF0gPSAiaHR0cHMiLCBuWzFdID0gZSk7dmFyIG8gPSB7IHR5cGU6IG5bMF0sIGRvbWFpbjogblsxXSwgaWRlbnRpdHk6IG5bMl0gfTtyZXR1cm4gbzsKICAgICAgfWZ1bmN0aW9uIGkoZSkgewogICAgICAgIHJldHVybiBlID8gSlNPTi5wYXJzZSgoMCwgc1siZGVmYXVsdCJdKShlKSkgOiB2b2lkIDA7CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgYyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSIpLAogICAgICAgICAgcyA9IG4oYyk7ci5kaXZpZGVVUkwgPSBvLCByLmRlZXBDbG9uZSA9IGk7CiAgICB9LCB7ICJiYWJlbC1ydW50aW1lL2NvcmUtanMvanNvbi9zdHJpbmdpZnkiOiAxIH1dIH0sIHt9LCBbNzZdKSg3Nik7Cn0pOwoKfSkuY2FsbCh0aGlzLHR5cGVvZiBnbG9iYWwgIT09ICJ1bmRlZmluZWQiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDoge30pCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewooZnVuY3Rpb24gKGdsb2JhbCl7CiJ1c2Ugc3RyaWN0IjsKCnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsKCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKLy8gRGlzdHJpYnV0aW9uIGZpbGUgZm9yIFN5bmNoZXIuanMKLy8gdmVyc2lvbjogMC4yLjAKCiFmdW5jdGlvbiAoZSkgewogIGlmICgib2JqZWN0IiA9PSAodHlwZW9mIGV4cG9ydHMgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGV4cG9ydHMpKSAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgbW9kdWxlKSBtb2R1bGUuZXhwb3J0cyA9IGUoKTtlbHNlIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiBkZWZpbmUgJiYgZGVmaW5lLmFtZCkgZGVmaW5lKFtdLCBlKTtlbHNlIHsKICAgIHZhciB0O3QgPSAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIGdsb2JhbCA/IGdsb2JhbCA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBzZWxmID8gc2VsZiA6IHRoaXMsIHQuU3luY2hlciA9IGUoKTsKICB9Cn0oZnVuY3Rpb24gKCkgewogIHJldHVybiBmdW5jdGlvbiBlKHQsIHIsIG4pIHsKICAgIGZ1bmN0aW9uIG8ocywgYSkgewogICAgICBpZiAoIXJbc10pIHsKICAgICAgICBpZiAoIXRbc10pIHsKICAgICAgICAgIHZhciBjID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgcmVxdWlyZSAmJiByZXF1aXJlO2lmICghYSAmJiBjKSByZXR1cm4gYyhzLCAhMCk7aWYgKGkpIHJldHVybiBpKHMsICEwKTt2YXIgdSA9IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciICsgcyArICInIik7dGhyb3cgdS5jb2RlID0gIk1PRFVMRV9OT1RfRk9VTkQiLCB1OwogICAgICAgIH12YXIgbCA9IHJbc10gPSB7IGV4cG9ydHM6IHt9IH07dFtzXVswXS5jYWxsKGwuZXhwb3J0cywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciByID0gdFtzXVsxXVtlXTtyZXR1cm4gbyhyID8gciA6IGUpOwogICAgICAgIH0sIGwsIGwuZXhwb3J0cywgZSwgdCwgciwgbik7CiAgICAgIH1yZXR1cm4gcltzXS5leHBvcnRzOwogICAgfWZvciAodmFyIGkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiByZXF1aXJlICYmIHJlcXVpcmUsIHMgPSAwOyBzIDwgbi5sZW5ndGg7IHMrKykgewogICAgICBvKG5bc10pOwogICAgfXJldHVybiBvOwogIH0oeyAxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgT2JqZWN0Lm9ic2VydmUgJiYgIUFycmF5Lm9ic2VydmUgJiYgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgdmFyIHIgPSBlLmdldE5vdGlmaWVyLAogICAgICAgICAgICBuID0gInBlcmZvcm1DaGFuZ2UiLAogICAgICAgICAgICBvID0gIl9vcmlnaW5hbCIsCiAgICAgICAgICAgIGkgPSAic3BsaWNlIiwKICAgICAgICAgICAgcyA9IHsgcHVzaDogZnVuY3Rpb24gYyhlKSB7CiAgICAgICAgICAgIHZhciB0ID0gYXJndW1lbnRzLAogICAgICAgICAgICAgICAgcyA9IGNbb10uYXBwbHkodGhpcywgdCk7cmV0dXJuIHIodGhpcylbbl0oaSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiB7IGluZGV4OiBzIC0gdC5sZW5ndGgsIGFkZGVkQ291bnQ6IHQubGVuZ3RoLCByZW1vdmVkOiBbXSB9OwogICAgICAgICAgICB9KSwgczsKICAgICAgICAgIH0sIHVuc2hpZnQ6IGZ1bmN0aW9uIHUoZSkgewogICAgICAgICAgICB2YXIgdCA9IGFyZ3VtZW50cywKICAgICAgICAgICAgICAgIHMgPSB1W29dLmFwcGx5KHRoaXMsIHQpO3JldHVybiByKHRoaXMpW25dKGksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4geyBpbmRleDogMCwgYWRkZWRDb3VudDogdC5sZW5ndGgsIHJlbW92ZWQ6IFtdIH07CiAgICAgICAgICAgIH0pLCBzOwogICAgICAgICAgfSwgcG9wOiBmdW5jdGlvbiBsKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMubGVuZ3RoLAogICAgICAgICAgICAgICAgdCA9IGxbb10uY2FsbCh0aGlzKTtyZXR1cm4gdGhpcy5sZW5ndGggIT09IGUgJiYgcih0aGlzKVtuXShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHsgaW5kZXg6IHRoaXMubGVuZ3RoLCBhZGRlZENvdW50OiAwLCByZW1vdmVkOiBbdF0gfTsKICAgICAgICAgICAgfSwgdGhpcyksIHQ7CiAgICAgICAgICB9LCBzaGlmdDogZnVuY3Rpb24gZigpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmxlbmd0aCwKICAgICAgICAgICAgICAgIHQgPSBmW29dLmNhbGwodGhpcyk7cmV0dXJuIHRoaXMubGVuZ3RoICE9PSBlICYmIHIodGhpcylbbl0oaSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiB7IGluZGV4OiAwLCBhZGRlZENvdW50OiAwLCByZW1vdmVkOiBbdF0gfTsKICAgICAgICAgICAgfSwgdGhpcyksIHQ7CiAgICAgICAgICB9LCBzcGxpY2U6IGZ1bmN0aW9uIGQoZSwgdCkgewogICAgICAgICAgICB2YXIgcyA9IGFyZ3VtZW50cywKICAgICAgICAgICAgICAgIGEgPSBkW29dLmFwcGx5KHRoaXMsIHMpO3JldHVybiAoYS5sZW5ndGggfHwgcy5sZW5ndGggPiAyKSAmJiByKHRoaXMpW25dKGksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4geyBpbmRleDogZSwgYWRkZWRDb3VudDogcy5sZW5ndGggLSAyLCByZW1vdmVkOiBhIH07CiAgICAgICAgICAgIH0sIHRoaXMpLCBhOwogICAgICAgICAgfSB9O2ZvciAodmFyIGEgaW4gcykgewogICAgICAgICAgc1thXVtvXSA9IHQucHJvdG90eXBlW2FdLCB0LnByb3RvdHlwZVthXSA9IHNbYV07CiAgICAgICAgfXQub2JzZXJ2ZSA9IGZ1bmN0aW9uICh0LCByKSB7CiAgICAgICAgICByZXR1cm4gZS5vYnNlcnZlKHQsIHIsIFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCBpXSk7CiAgICAgICAgfSwgdC51bm9ic2VydmUgPSBlLnVub2JzZXJ2ZTsKICAgICAgfShPYmplY3QsIEFycmF5KTsKICAgIH0sIHt9XSwgMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vanNvbi9zdHJpbmdpZnkiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSI6IDE3IH1dLCAzOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvY3JlYXRlIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZSI6IDE4IH1dLCA0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDE5IH1dLCA1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI6IDIwIH1dLCA2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiIpLCBfX2VzTW9kdWxlOiAhMCB9OwogICAgfSwgeyAiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjogMjEgfV0sIDc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9rZXlzIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2tleXMiOiAyMiB9XSwgODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L3NldC1wcm90b3R5cGUtb2YiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiI6IDIzIH1dLCA5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vcHJvbWlzZSI6IDI0IH1dLCAxMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIjogMjUgfV0sIDExOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICByLl9fZXNNb2R1bGUgPSAhMCwgclsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgdCkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgICB9OwogICAgfSwge31dLCAxMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1yLl9fZXNNb2R1bGUgPSAhMDt2YXIgbyA9IGUoIi4uL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSIpLAogICAgICAgICAgaSA9IG4obyk7clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUoZSwgdCkgewogICAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgIHZhciBuID0gdFtyXTtuLmVudW1lcmFibGUgPSBuLmVudW1lcmFibGUgfHwgITEsIG4uY29uZmlndXJhYmxlID0gITAsICJ2YWx1ZSIgaW4gbiAmJiAobi53cml0YWJsZSA9ICEwKSwgKDAsIGlbImRlZmF1bHQiXSkoZSwgbi5rZXksIG4pOwogICAgICAgICAgfQogICAgICAgIH1yZXR1cm4gZnVuY3Rpb24gKHQsIHIsIG4pIHsKICAgICAgICAgIHJldHVybiByICYmIGUodC5wcm90b3R5cGUsIHIpLCBuICYmIGUodCwgbiksIHQ7CiAgICAgICAgfTsKICAgICAgfSgpOwogICAgfSwgeyAiLi4vY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5IjogNCB9XSwgMTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiKVsiZGVmYXVsdCJdO3JbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZm9yICh2YXIgbyA9ICEwOyBvOykgewogICAgICAgICAgdmFyIGkgPSBlLAogICAgICAgICAgICAgIHMgPSB0LAogICAgICAgICAgICAgIGEgPSByO28gPSAhMSwgbnVsbCA9PT0gaSAmJiAoaSA9IEZ1bmN0aW9uLnByb3RvdHlwZSk7dmFyIGMgPSBuKGksIHMpO2lmICh2b2lkIDAgIT09IGMpIHsKICAgICAgICAgICAgaWYgKCJ2YWx1ZSIgaW4gYykgcmV0dXJuIGMudmFsdWU7dmFyIHUgPSBjLmdldDtpZiAodm9pZCAwID09PSB1KSByZXR1cm47cmV0dXJuIHUuY2FsbChhKTsKICAgICAgICAgIH12YXIgbCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihpKTtpZiAobnVsbCA9PT0gbCkgcmV0dXJuO2UgPSBsLCB0ID0gcywgciA9IGEsIG8gPSAhMCwgYyA9IGwgPSB2b2lkIDA7CiAgICAgICAgfQogICAgICB9LCByLl9fZXNNb2R1bGUgPSAhMDsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjogNSB9XSwgMTQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9jcmVhdGUiKVsiZGVmYXVsdCJdLAogICAgICAgICAgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiIpWyJkZWZhdWx0Il07clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgdCAmJiBudWxsICE9PSB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHQgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKHQpKSk7ZS5wcm90b3R5cGUgPSBuKHQgJiYgdC5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IGUsIGVudW1lcmFibGU6ICExLCB3cml0YWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAgfSB9KSwgdCAmJiAobyA/IG8oZSwgdCkgOiBlLl9fcHJvdG9fXyA9IHQpOwogICAgICB9LCByLl9fZXNNb2R1bGUgPSAhMDsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvY3JlYXRlIjogMywgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiI6IDggfV0sIDE1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfXIuX19lc01vZHVsZSA9ICEwO3ZhciBvID0gZSgiLi4vaGVscGVycy90eXBlb2YiKSwKICAgICAgICAgIGkgPSBuKG8pO3JbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCFlKSB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiAhdCB8fCAib2JqZWN0IiAhPT0gKCJ1bmRlZmluZWQiID09IHR5cGVvZiB0ID8gInVuZGVmaW5lZCIgOiAoMCwgaVsiZGVmYXVsdCJdKSh0KSkgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgdCA/IGUgOiB0OwogICAgICB9OwogICAgfSwgeyAiLi4vaGVscGVycy90eXBlb2YiOiAxNiB9XSwgMTY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbCIpWyJkZWZhdWx0Il07clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLmNvbnN0cnVjdG9yID09PSBuID8gInN5bWJvbCIgOiB0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSk7CiAgICAgIH0sIHIuX19lc01vZHVsZSA9ICEwOwogICAgfSwgeyAiYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbCI6IDEwIH1dLCAxNzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kLmNvcmUiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAobi5KU09OICYmIG4uSlNPTi5zdHJpbmdpZnkgfHwgSlNPTi5zdHJpbmdpZnkpLmFwcGx5KEpTT04sIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQuY29yZSI6IDMxIH1dLCAxODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICByZXR1cm4gbi5jcmVhdGUoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQiOiA1NiB9XSwgMTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4uLy4uL21vZHVsZXMvJCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIG4uc2V0RGVzYyhlLCB0LCByKTsKICAgICAgfTsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJCI6IDU2IH1dLCAyMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kIik7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpLCB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBuLmdldERlc2MoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQiOiA1NiwgIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOiA4MSB9XSwgMjE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZiIpLCB0LmV4cG9ydHMgPSBlKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZiI6IDgyIH1dLCAyMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5rZXlzIiksIHQuZXhwb3J0cyA9IGUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuT2JqZWN0LmtleXM7CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQuY29yZSI6IDMxLCAiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmtleXMiOiA4MyB9XSwgMjM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZiIpLCB0LmV4cG9ydHMgPSBlKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5zZXRQcm90b3R5cGVPZjsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZiI6IDg0IH1dLCAyNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmciKSwgZSgiLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yIiksIGUoIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSIpLCBlKCIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIiksIHQuZXhwb3J0cyA9IGUoIi4uL21vZHVsZXMvJC5jb3JlIikuUHJvbWlzZTsKICAgIH0sIHsgIi4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIjogODUsICIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIjogODYsICIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOiA4NywgIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSI6IDg5IH1dLCAyNTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCIpLCBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIiksIHQuZXhwb3J0cyA9IGUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuU3ltYm9sOwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy8kLmNvcmUiOiAzMSwgIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmciOiA4NSwgIi4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCI6IDg4IH1dLCAyNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGUpIHRocm93IFR5cGVFcnJvcihlICsgIiBpcyBub3QgYSBmdW5jdGlvbiEiKTtyZXR1cm4gZTsKICAgICAgfTsKICAgIH0sIHt9XSwgMjc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7fTsKICAgIH0sIHt9XSwgMjg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5pcy1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmICghbihlKSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhbiBvYmplY3QhIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuaXMtb2JqZWN0IjogNDkgfV0sIDI5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIiksCiAgICAgICAgICBvID0gZSgiLi8kLndrcyIpKCJ0b1N0cmluZ1RhZyIpLAogICAgICAgICAgaSA9ICJBcmd1bWVudHMiID09IG4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBhcmd1bWVudHM7CiAgICAgIH0oKSk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgdCwgciwgcztyZXR1cm4gdm9pZCAwID09PSBlID8gIlVuZGVmaW5lZCIgOiBudWxsID09PSBlID8gIk51bGwiIDogInN0cmluZyIgPT0gdHlwZW9mIChyID0gKHQgPSBPYmplY3QoZSkpW29dKSA/IHIgOiBpID8gbih0KSA6ICJPYmplY3QiID09IChzID0gbih0KSkgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdC5jYWxsZWUgPyAiQXJndW1lbnRzIiA6IHM7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAsICIuLyQud2tzIjogNzggfV0sIDMwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS50b1N0cmluZzt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSkuc2xpY2UoOCwgLTEpOwogICAgICB9OwogICAgfSwge31dLCAzMTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0geyB2ZXJzaW9uOiAiMS4yLjYiIH07Im51bWJlciIgPT0gdHlwZW9mIF9fZSAmJiAoX19lID0gbik7CiAgICB9LCB7fV0sIDMyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuYS1mdW5jdGlvbiIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgaWYgKG4oZSksIHZvaWQgMCA9PT0gdCkgcmV0dXJuIGU7c3dpdGNoIChyKSB7Y2FzZSAxOgogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICByZXR1cm4gZS5jYWxsKHQsIHIpOwogICAgICAgICAgICB9O2Nhc2UgMjoKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChyLCBuKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGUuY2FsbCh0LCByLCBuKTsKICAgICAgICAgICAgfTtjYXNlIDM6CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAociwgbiwgbykgewogICAgICAgICAgICAgIHJldHVybiBlLmNhbGwodCwgciwgbiwgbyk7CiAgICAgICAgICAgIH07fXJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZS5hcHBseSh0LCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH07CiAgICB9LCB7ICIuLyQuYS1mdW5jdGlvbiI6IDI2IH1dLCAzMzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKHZvaWQgMCA9PSBlKSB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNhbGwgbWV0aG9kIG9uICAiICsgZSk7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDM0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gIWUoIi4vJC5mYWlscyIpKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gNyAhPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICJhIiwgeyBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIDc7CiAgICAgICAgICB9IH0pLmE7CiAgICAgIH0pOwogICAgfSwgeyAiLi8kLmZhaWxzIjogMzggfV0sIDM1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaXMtb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi8kLmdsb2JhbCIpLmRvY3VtZW50LAogICAgICAgICAgaSA9IG4obykgJiYgbihvLmNyZWF0ZUVsZW1lbnQpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGkgPyBvLmNyZWF0ZUVsZW1lbnQoZSkgOiB7fTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5nbG9iYWwiOiA0MSwgIi4vJC5pcy1vYmplY3QiOiA0OSB9XSwgMzY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQgPSBuLmdldEtleXMoZSksCiAgICAgICAgICAgIHIgPSBuLmdldFN5bWJvbHM7aWYgKHIpIGZvciAodmFyIG8sIGkgPSByKGUpLCBzID0gbi5pc0VudW0sIGEgPSAwOyBpLmxlbmd0aCA+IGE7KSB7CiAgICAgICAgICBzLmNhbGwoZSwgbyA9IGlbYSsrXSkgJiYgdC5wdXNoKG8pOwogICAgICAgIH1yZXR1cm4gdDsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2IH1dLCAzNzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmdsb2JhbCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5jb3JlIiksCiAgICAgICAgICBpID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgcyA9ICJwcm90b3R5cGUiLAogICAgICAgICAgYSA9IGZ1bmN0aW9uIGEoZSwgdCwgcikgewogICAgICAgIHZhciBjLAogICAgICAgICAgICB1LAogICAgICAgICAgICBsLAogICAgICAgICAgICBmID0gZSAmIGEuRiwKICAgICAgICAgICAgZCA9IGUgJiBhLkcsCiAgICAgICAgICAgIHAgPSBlICYgYS5TLAogICAgICAgICAgICBiID0gZSAmIGEuUCwKICAgICAgICAgICAgaCA9IGUgJiBhLkIsCiAgICAgICAgICAgIHYgPSBlICYgYS5XLAogICAgICAgICAgICB5ID0gZCA/IG8gOiBvW3RdIHx8IChvW3RdID0ge30pLAogICAgICAgICAgICBfID0gZCA/IG4gOiBwID8gblt0XSA6IChuW3RdIHx8IHt9KVtzXTtkICYmIChyID0gdCk7Zm9yIChjIGluIHIpIHsKICAgICAgICAgIHUgPSAhZiAmJiBfICYmIGMgaW4gXywgdSAmJiBjIGluIHkgfHwgKGwgPSB1ID8gX1tjXSA6IHJbY10sIHlbY10gPSBkICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIF9bY10gPyByW2NdIDogaCAmJiB1ID8gaShsLCBuKSA6IHYgJiYgX1tjXSA9PSBsID8gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSBmdW5jdGlvbiB0KF90KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBlID8gbmV3IGUoX3QpIDogZShfdCk7CiAgICAgICAgICAgIH07cmV0dXJuIHRbc10gPSBlW3NdLCB0OwogICAgICAgICAgfShsKSA6IGIgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgbCA/IGkoRnVuY3Rpb24uY2FsbCwgbCkgOiBsLCBiICYmICgoeVtzXSB8fCAoeVtzXSA9IHt9KSlbY10gPSBsKSk7CiAgICAgICAgfQogICAgICB9O2EuRiA9IDEsIGEuRyA9IDIsIGEuUyA9IDQsIGEuUCA9IDgsIGEuQiA9IDE2LCBhLlcgPSAzMiwgdC5leHBvcnRzID0gYTsKICAgIH0sIHsgIi4vJC5jb3JlIjogMzEsICIuLyQuY3R4IjogMzIsICIuLyQuZ2xvYmFsIjogNDEgfV0sIDM4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuICEhZSgpOwogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgIHJldHVybiAhMDsKICAgICAgICB9CiAgICAgIH07CiAgICB9LCB7fV0sIDM5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY3R4IiksCiAgICAgICAgICBvID0gZSgiLi8kLml0ZXItY2FsbCIpLAogICAgICAgICAgaSA9IGUoIi4vJC5pcy1hcnJheS1pdGVyIiksCiAgICAgICAgICBzID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgYSA9IGUoIi4vJC50by1sZW5ndGgiKSwKICAgICAgICAgIGMgPSBlKCIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCB1KSB7CiAgICAgICAgdmFyIGwsCiAgICAgICAgICAgIGYsCiAgICAgICAgICAgIGQsCiAgICAgICAgICAgIHAgPSBjKGUpLAogICAgICAgICAgICBiID0gbihyLCB1LCB0ID8gMiA6IDEpLAogICAgICAgICAgICBoID0gMDtpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgcCkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBpdGVyYWJsZSEiKTtpZiAoaShwKSkgZm9yIChsID0gYShlLmxlbmd0aCk7IGwgPiBoOyBoKyspIHsKICAgICAgICAgIHQgPyBiKHMoZiA9IGVbaF0pWzBdLCBmWzFdKSA6IGIoZVtoXSk7CiAgICAgICAgfSBlbHNlIGZvciAoZCA9IHAuY2FsbChlKTsgIShmID0gZC5uZXh0KCkpLmRvbmU7KSB7CiAgICAgICAgICBvKGQsIGIsIGYudmFsdWUsIHQpOwogICAgICAgIH0KICAgICAgfTsKICAgIH0sIHsgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5pcy1hcnJheS1pdGVyIjogNDcsICIuLyQuaXRlci1jYWxsIjogNTAsICIuLyQudG8tbGVuZ3RoIjogNzUsICIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCI6IDc5IH1dLCA0MDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWlvYmplY3QiKSwKICAgICAgICAgIG8gPSBlKCIuLyQiKS5nZXROYW1lcywKICAgICAgICAgIGkgPSB7fS50b1N0cmluZywKICAgICAgICAgIHMgPSAib2JqZWN0IiA9PSAodHlwZW9mIHdpbmRvdyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yod2luZG93KSkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW10sCiAgICAgICAgICBhID0gZnVuY3Rpb24gYShlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBvKGUpOwogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgIHJldHVybiBzLnNsaWNlKCk7CiAgICAgICAgfQogICAgICB9O3QuZXhwb3J0cy5nZXQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBzICYmICJbb2JqZWN0IFdpbmRvd10iID09IGkuY2FsbChlKSA/IGEoZSkgOiBvKG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQudG8taW9iamVjdCI6IDc0IH1dLCA0MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoID8gd2luZG93IDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIHNlbGYgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oInJldHVybiB0aGlzIikoKTsibnVtYmVyIiA9PSB0eXBlb2YgX19nICYmIChfX2cgPSBuKTsKICAgIH0sIHt9XSwgNDI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IHt9Lmhhc093blByb3BlcnR5O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIG4uY2FsbChlLCB0KTsKICAgICAgfTsKICAgIH0sIHt9XSwgNDM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIik7dC5leHBvcnRzID0gZSgiLi8kLmRlc2NyaXB0b3JzIikgPyBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBuLnNldERlc2MoZSwgdCwgbygxLCByKSk7CiAgICAgIH0gOiBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBlW3RdID0gciwgZTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmRlc2NyaXB0b3JzIjogMzQsICIuLyQucHJvcGVydHktZGVzYyI6IDYxIH1dLCA0NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vJC5nbG9iYWwiKS5kb2N1bWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CiAgICB9LCB7ICIuLyQuZ2xvYmFsIjogNDEgfV0sIDQ1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICB2YXIgbiA9IHZvaWQgMCA9PT0gcjtzd2l0Y2ggKHQubGVuZ3RoKSB7Y2FzZSAwOgogICAgICAgICAgICByZXR1cm4gbiA/IGUoKSA6IGUuY2FsbChyKTtjYXNlIDE6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdKSA6IGUuY2FsbChyLCB0WzBdKTtjYXNlIDI6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdKTtjYXNlIDM6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdLCB0WzJdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdLCB0WzJdKTtjYXNlIDQ6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdLCB0WzJdLCB0WzNdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdLCB0WzJdLCB0WzNdKTt9cmV0dXJuIGUuYXBwbHkociwgdCk7CiAgICAgIH07CiAgICB9LCB7fV0sIDQ2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIik7dC5leHBvcnRzID0gT2JqZWN0KCJ6IikucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiU3RyaW5nIiA9PSBuKGUpID8gZS5zcGxpdCgiIikgOiBPYmplY3QoZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAgfV0sIDQ3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaXRlcmF0b3JzIiksCiAgICAgICAgICBvID0gZSgiLi8kLndrcyIpKCJpdGVyYXRvciIpLAogICAgICAgICAgaSA9IEFycmF5LnByb3RvdHlwZTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUgJiYgKG4uQXJyYXkgPT09IGUgfHwgaVtvXSA9PT0gZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQud2tzIjogNzggfV0sIDQ4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIik7dC5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiQXJyYXkiID09IG4oZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAgfV0sIDQ5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIm9iamVjdCIgPT0gKHR5cGVvZiBlID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihlKSkgPyBudWxsICE9PSBlIDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgZTsKICAgICAgfTsKICAgIH0sIHt9XSwgNTA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5hbi1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgciwgbykgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gbyA/IHQobihyKVswXSwgclsxXSkgOiB0KHIpOwogICAgICAgIH0gY2F0Y2ggKGkpIHsKICAgICAgICAgIHZhciBzID0gZVsicmV0dXJuIl07dGhyb3cgdm9pZCAwICE9PSBzICYmIG4ocy5jYWxsKGUpKSwgaTsKICAgICAgICB9CiAgICAgIH07CiAgICB9LCB7ICIuLyQuYW4tb2JqZWN0IjogMjggfV0sIDUxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vJCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBpID0gZSgiLi8kLnNldC10by1zdHJpbmctdGFnIiksCiAgICAgICAgICBzID0ge307ZSgiLi8kLmhpZGUiKShzLCBlKCIuLyQud2tzIikoIml0ZXJhdG9yIiksIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSksIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZS5wcm90b3R5cGUgPSBuLmNyZWF0ZShzLCB7IG5leHQ6IG8oMSwgcikgfSksIGkoZSwgdCArICIgSXRlcmF0b3IiKTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmhpZGUiOiA0MywgIi4vJC5wcm9wZXJ0eS1kZXNjIjogNjEsICIuLyQuc2V0LXRvLXN0cmluZy10YWciOiA2NywgIi4vJC53a3MiOiA3OCB9XSwgNTI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmxpYnJhcnkiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZXhwb3J0IiksCiAgICAgICAgICBpID0gZSgiLi8kLnJlZGVmaW5lIiksCiAgICAgICAgICBzID0gZSgiLi8kLmhpZGUiKSwKICAgICAgICAgIGEgPSBlKCIuLyQuaGFzIiksCiAgICAgICAgICBjID0gZSgiLi8kLml0ZXJhdG9ycyIpLAogICAgICAgICAgdSA9IGUoIi4vJC5pdGVyLWNyZWF0ZSIpLAogICAgICAgICAgbCA9IGUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpLAogICAgICAgICAgZiA9IGUoIi4vJCIpLmdldFByb3RvLAogICAgICAgICAgZCA9IGUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIHAgPSAhKFtdLmtleXMgJiYgIm5leHQiIGluIFtdLmtleXMoKSksCiAgICAgICAgICBiID0gIkBAaXRlcmF0b3IiLAogICAgICAgICAgaCA9ICJrZXlzIiwKICAgICAgICAgIHYgPSAidmFsdWVzIiwKICAgICAgICAgIHkgPSBmdW5jdGlvbiB5KCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBfLCBnLCBtLCBqKSB7CiAgICAgICAgdShyLCB0LCBfKTt2YXIgJCwKICAgICAgICAgICAgTywKICAgICAgICAgICAgdyA9IGZ1bmN0aW9uIHcoZSkgewogICAgICAgICAgaWYgKCFwICYmIGUgaW4gRSkgcmV0dXJuIEVbZV07c3dpdGNoIChlKSB7Y2FzZSBoOgogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICAgICAgfTtjYXNlIHY6CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcih0aGlzLCBlKTsKICAgICAgICAgICAgICB9O31yZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgICAgIGsgPSB0ICsgIiBJdGVyYXRvciIsCiAgICAgICAgICAgIHggPSBnID09IHYsCiAgICAgICAgICAgIEMgPSAhMSwKICAgICAgICAgICAgRSA9IGUucHJvdG90eXBlLAogICAgICAgICAgICBTID0gRVtkXSB8fCBFW2JdIHx8IGcgJiYgRVtnXSwKICAgICAgICAgICAgVCA9IFMgfHwgdyhnKTtpZiAoUykgewogICAgICAgICAgdmFyIE0gPSBmKFQuY2FsbChuZXcgZSgpKSk7bChNLCBrLCAhMCksICFuICYmIGEoRSwgYikgJiYgcyhNLCBkLCB5KSwgeCAmJiBTLm5hbWUgIT09IHYgJiYgKEMgPSAhMCwgVCA9IGZ1bmN0aW9uIFQoKSB7CiAgICAgICAgICAgIHJldHVybiBTLmNhbGwodGhpcyk7CiAgICAgICAgICB9KTsKICAgICAgICB9aWYgKG4gJiYgIWogfHwgIXAgJiYgIUMgJiYgRVtkXSB8fCBzKEUsIGQsIFQpLCBjW3RdID0gVCwgY1trXSA9IHksIGcpIGlmICgkID0geyB2YWx1ZXM6IHggPyBUIDogdyh2KSwga2V5czogbSA/IFQgOiB3KGgpLCBlbnRyaWVzOiB4ID8gdygiZW50cmllcyIpIDogVCB9LCBqKSBmb3IgKE8gaW4gJCkgewogICAgICAgICAgTyBpbiBFIHx8IGkoRSwgTywgJFtPXSk7CiAgICAgICAgfSBlbHNlIG8oby5QICsgby5GICogKHAgfHwgQyksIHQsICQpO3JldHVybiAkOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuZXhwb3J0IjogMzcsICIuLyQuaGFzIjogNDIsICIuLyQuaGlkZSI6IDQzLCAiLi8kLml0ZXItY3JlYXRlIjogNTEsICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQubGlicmFyeSI6IDU4LCAiLi8kLnJlZGVmaW5lIjogNjMsICIuLyQuc2V0LXRvLXN0cmluZy10YWciOiA2NywgIi4vJC53a3MiOiA3OCB9XSwgNTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIG8gPSAhMTt0cnkgewogICAgICAgIHZhciBpID0gWzddW25dKCk7aVsicmV0dXJuIl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBvID0gITA7CiAgICAgICAgfSwgQXJyYXkuZnJvbShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aHJvdyAyOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChzKSB7fXQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCF0ICYmICFvKSByZXR1cm4gITE7dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgdmFyIGkgPSBbN10sCiAgICAgICAgICAgICAgcyA9IGlbbl0oKTtzLm5leHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHIgPSAhMDsKICAgICAgICAgIH0sIGlbbl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBzOwogICAgICAgICAgfSwgZShpKTsKICAgICAgICB9IGNhdGNoIChhKSB7fXJldHVybiByOwogICAgICB9OwogICAgfSwgeyAiLi8kLndrcyI6IDc4IH1dLCA1NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHQsIGRvbmU6ICEhZSB9OwogICAgICB9OwogICAgfSwge31dLCA1NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHt9OwogICAgfSwge31dLCA1NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gT2JqZWN0O3QuZXhwb3J0cyA9IHsgY3JlYXRlOiBuLmNyZWF0ZSwgZ2V0UHJvdG86IG4uZ2V0UHJvdG90eXBlT2YsIGlzRW51bToge30ucHJvcGVydHlJc0VudW1lcmFibGUsIGdldERlc2M6IG4uZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLCBzZXREZXNjOiBuLmRlZmluZVByb3BlcnR5LCBzZXREZXNjczogbi5kZWZpbmVQcm9wZXJ0aWVzLCBnZXRLZXlzOiBuLmtleXMsIGdldE5hbWVzOiBuLmdldE93blByb3BlcnR5TmFtZXMsIGdldFN5bWJvbHM6IG4uZ2V0T3duUHJvcGVydHlTeW1ib2xzLCBlYWNoOiBbXS5mb3JFYWNoIH07CiAgICB9LCB7fV0sIDU3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQudG8taW9iamVjdCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgZm9yICh2YXIgciwgaSA9IG8oZSksIHMgPSBuLmdldEtleXMoaSksIGEgPSBzLmxlbmd0aCwgYyA9IDA7IGEgPiBjOykgewogICAgICAgICAgaWYgKGlbciA9IHNbYysrXV0gPT09IHQpIHJldHVybiByOwogICAgICAgIH0KICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLnRvLWlvYmplY3QiOiA3NCB9XSwgNTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAhMDsKICAgIH0sIHt9XSwgNTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiwKICAgICAgICAgIG8sCiAgICAgICAgICBpLAogICAgICAgICAgcyA9IGUoIi4vJC5nbG9iYWwiKSwKICAgICAgICAgIGEgPSBlKCIuLyQudGFzayIpLnNldCwKICAgICAgICAgIGMgPSBzLk11dGF0aW9uT2JzZXJ2ZXIgfHwgcy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyLAogICAgICAgICAgdSA9IHMucHJvY2VzcywKICAgICAgICAgIGwgPSBzLlByb21pc2UsCiAgICAgICAgICBmID0gInByb2Nlc3MiID09IGUoIi4vJC5jb2YiKSh1KSwKICAgICAgICAgIGQgPSBmdW5jdGlvbiBkKCkgewogICAgICAgIHZhciBlLCB0LCByO2ZvciAoZiAmJiAoZSA9IHUuZG9tYWluKSAmJiAodS5kb21haW4gPSBudWxsLCBlLmV4aXQoKSk7IG47KSB7CiAgICAgICAgICB0ID0gbi5kb21haW4sIHIgPSBuLmZuLCB0ICYmIHQuZW50ZXIoKSwgcigpLCB0ICYmIHQuZXhpdCgpLCBuID0gbi5uZXh0OwogICAgICAgIH1vID0gdm9pZCAwLCBlICYmIGUuZW50ZXIoKTsKICAgICAgfTtpZiAoZikgaSA9IGZ1bmN0aW9uIGkoKSB7CiAgICAgICAgdS5uZXh0VGljayhkKTsKICAgICAgfTtlbHNlIGlmIChjKSB7CiAgICAgICAgdmFyIHAgPSAxLAogICAgICAgICAgICBiID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpO25ldyBjKGQpLm9ic2VydmUoYiwgeyBjaGFyYWN0ZXJEYXRhOiAhMCB9KSwgaSA9IGZ1bmN0aW9uIGkoKSB7CiAgICAgICAgICBiLmRhdGEgPSBwID0gLXA7CiAgICAgICAgfTsKICAgICAgfSBlbHNlIGkgPSBsICYmIGwucmVzb2x2ZSA/IGZ1bmN0aW9uICgpIHsKICAgICAgICBsLnJlc29sdmUoKS50aGVuKGQpOwogICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgIGEuY2FsbChzLCBkKTsKICAgICAgfTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0geyBmbjogZSwgbmV4dDogdm9pZCAwLCBkb21haW46IGYgJiYgdS5kb21haW4gfTtvICYmIChvLm5leHQgPSB0KSwgbiB8fCAobiA9IHQsIGkoKSksIG8gPSB0OwogICAgICB9OwogICAgfSwgeyAiLi8kLmNvZiI6IDMwLCAiLi8kLmdsb2JhbCI6IDQxLCAiLi8kLnRhc2siOiA3MiB9XSwgNjA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5leHBvcnQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vJC5mYWlscyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgdmFyIHIgPSAoby5PYmplY3QgfHwge30pW2VdIHx8IE9iamVjdFtlXSwKICAgICAgICAgICAgcyA9IHt9O3NbZV0gPSB0KHIpLCBuKG4uUyArIG4uRiAqIGkoZnVuY3Rpb24gKCkgewogICAgICAgICAgcigxKTsKICAgICAgICB9KSwgIk9iamVjdCIsIHMpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmNvcmUiOiAzMSwgIi4vJC5leHBvcnQiOiAzNywgIi4vJC5mYWlscyI6IDM4IH1dLCA2MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIHsgZW51bWVyYWJsZTogISgxICYgZSksIGNvbmZpZ3VyYWJsZTogISgyICYgZSksIHdyaXRhYmxlOiAhKDQgJiBlKSwgdmFsdWU6IHQgfTsKICAgICAgfTsKICAgIH0sIHt9XSwgNjI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5yZWRlZmluZSIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgZm9yICh2YXIgciBpbiB0KSB7CiAgICAgICAgICBuKGUsIHIsIHRbcl0pOwogICAgICAgIH1yZXR1cm4gZTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5yZWRlZmluZSI6IDYzIH1dLCA2MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vJC5oaWRlIik7CiAgICB9LCB7ICIuLyQuaGlkZSI6IDQzIH1dLCA2NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IE9iamVjdC5pcyB8fCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBlID09PSB0ID8gMCAhPT0gZSB8fCAxIC8gZSA9PT0gMSAvIHQgOiBlICE9IGUgJiYgdCAhPSB0OwogICAgICB9OwogICAgfSwge31dLCA2NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kIikuZ2V0RGVzYywKICAgICAgICAgIG8gPSBlKCIuLyQuaXMtb2JqZWN0IiksCiAgICAgICAgICBpID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgcyA9IGZ1bmN0aW9uIHMoZSwgdCkgewogICAgICAgIGlmIChpKGUpLCAhbyh0KSAmJiBudWxsICE9PSB0KSB0aHJvdyBUeXBlRXJyb3IodCArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7CiAgICAgIH07dC5leHBvcnRzID0geyBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoIl9fcHJvdG9fXyIgaW4ge30gPyBmdW5jdGlvbiAodCwgciwgbykgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbyA9IGUoIi4vJC5jdHgiKShGdW5jdGlvbi5jYWxsLCBuKE9iamVjdC5wcm90b3R5cGUsICJfX3Byb3RvX18iKS5zZXQsIDIpLCBvKHQsIFtdKSwgciA9ICEodCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgICAgIH0gY2F0Y2ggKGkpIHsKICAgICAgICAgICAgciA9ICEwOwogICAgICAgICAgfXJldHVybiBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICByZXR1cm4gcyhlLCB0KSwgciA/IGUuX19wcm90b19fID0gdCA6IG8oZSwgdCksIGU7CiAgICAgICAgICB9OwogICAgICAgIH0oe30sICExKSA6IHZvaWQgMCksIGNoZWNrOiBzIH07CiAgICB9LCB7ICIuLyQiOiA1NiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5pcy1vYmplY3QiOiA0OSB9XSwgNjY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmNvcmUiKSwKICAgICAgICAgIG8gPSBlKCIuLyQiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuZGVzY3JpcHRvcnMiKSwKICAgICAgICAgIHMgPSBlKCIuLyQud2tzIikoInNwZWNpZXMiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0gbltlXTtpICYmIHQgJiYgIXRbc10gJiYgby5zZXREZXNjKHQsIHMsIHsgY29uZmlndXJhYmxlOiAhMCwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgfSB9KTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmNvcmUiOiAzMSwgIi4vJC5kZXNjcmlwdG9ycyI6IDM0LCAiLi8kLndrcyI6IDc4IH1dLCA2NzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kIikuc2V0RGVzYywKICAgICAgICAgIG8gPSBlKCIuLyQuaGFzIiksCiAgICAgICAgICBpID0gZSgiLi8kLndrcyIpKCJ0b1N0cmluZ1RhZyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZSAmJiAhbyhlID0gciA/IGUgOiBlLnByb3RvdHlwZSwgaSkgJiYgbihlLCBpLCB7IGNvbmZpZ3VyYWJsZTogITAsIHZhbHVlOiB0IH0pOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuaGFzIjogNDIsICIuLyQud2tzIjogNzggfV0sIDY4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBvID0gIl9fY29yZS1qc19zaGFyZWRfXyIsCiAgICAgICAgICBpID0gbltvXSB8fCAobltvXSA9IHt9KTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBpW2VdIHx8IChpW2VdID0ge30pOwogICAgICB9OwogICAgfSwgeyAiLi8kLmdsb2JhbCI6IDQxIH1dLCA2OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5hLWZ1bmN0aW9uIiksCiAgICAgICAgICBpID0gZSgiLi8kLndrcyIpKCJzcGVjaWVzIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB2YXIgciwKICAgICAgICAgICAgcyA9IG4oZSkuY29uc3RydWN0b3I7cmV0dXJuIHZvaWQgMCA9PT0gcyB8fCB2b2lkIDAgPT0gKHIgPSBuKHMpW2ldKSA/IHQgOiBvKHIpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmEtZnVuY3Rpb24iOiAyNiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC53a3MiOiA3OCB9XSwgNzA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiB0KSkgdGhyb3cgVHlwZUVycm9yKHIgKyAiOiB1c2UgdGhlICduZXcnIG9wZXJhdG9yISIpO3JldHVybiBlOwogICAgICB9OwogICAgfSwge31dLCA3MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZGVmaW5lZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0LCByKSB7CiAgICAgICAgICB2YXIgaSwKICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgIGEgPSBTdHJpbmcobyh0KSksCiAgICAgICAgICAgICAgYyA9IG4ociksCiAgICAgICAgICAgICAgdSA9IGEubGVuZ3RoO3JldHVybiAwID4gYyB8fCBjID49IHUgPyBlID8gIiIgOiB2b2lkIDAgOiAoaSA9IGEuY2hhckNvZGVBdChjKSwgNTUyOTYgPiBpIHx8IGkgPiA1NjMxOSB8fCBjICsgMSA9PT0gdSB8fCAocyA9IGEuY2hhckNvZGVBdChjICsgMSkpIDwgNTYzMjAgfHwgcyA+IDU3MzQzID8gZSA/IGEuY2hhckF0KGMpIDogaSA6IGUgPyBhLnNsaWNlKGMsIGMgKyAyKSA6IChpIC0gNTUyOTYgPDwgMTApICsgKHMgLSA1NjMyMCkgKyA2NTUzNik7CiAgICAgICAgfTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5kZWZpbmVkIjogMzMsICIuLyQudG8taW50ZWdlciI6IDczIH1dLCA3MjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBzID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgYSA9IGUoIi4vJC5pbnZva2UiKSwKICAgICAgICAgIGMgPSBlKCIuLyQuaHRtbCIpLAogICAgICAgICAgdSA9IGUoIi4vJC5kb20tY3JlYXRlIiksCiAgICAgICAgICBsID0gZSgiLi8kLmdsb2JhbCIpLAogICAgICAgICAgZiA9IGwucHJvY2VzcywKICAgICAgICAgIGQgPSBsLnNldEltbWVkaWF0ZSwKICAgICAgICAgIHAgPSBsLmNsZWFySW1tZWRpYXRlLAogICAgICAgICAgYiA9IGwuTWVzc2FnZUNoYW5uZWwsCiAgICAgICAgICBoID0gMCwKICAgICAgICAgIHYgPSB7fSwKICAgICAgICAgIHkgPSAib25yZWFkeXN0YXRlY2hhbmdlIiwKICAgICAgICAgIF8gPSBmdW5jdGlvbiBfKCkgewogICAgICAgIHZhciBlID0gK3RoaXM7aWYgKHYuaGFzT3duUHJvcGVydHkoZSkpIHsKICAgICAgICAgIHZhciB0ID0gdltlXTtkZWxldGUgdltlXSwgdCgpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIGcgPSBmdW5jdGlvbiBnKGUpIHsKICAgICAgICBfLmNhbGwoZS5kYXRhKTsKICAgICAgfTtkICYmIHAgfHwgKGQgPSBmdW5jdGlvbiBkKGUpIHsKICAgICAgICBmb3IgKHZhciB0ID0gW10sIHIgPSAxOyBhcmd1bWVudHMubGVuZ3RoID4gcjspIHsKICAgICAgICAgIHQucHVzaChhcmd1bWVudHNbcisrXSk7CiAgICAgICAgfXJldHVybiB2WysraF0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBhKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgPyBlIDogRnVuY3Rpb24oZSksIHQpOwogICAgICAgIH0sIG4oaCksIGg7CiAgICAgIH0sIHAgPSBmdW5jdGlvbiBwKGUpIHsKICAgICAgICBkZWxldGUgdltlXTsKICAgICAgfSwgInByb2Nlc3MiID09IGUoIi4vJC5jb2YiKShmKSA/IG4gPSBmdW5jdGlvbiBuKGUpIHsKICAgICAgICBmLm5leHRUaWNrKHMoXywgZSwgMSkpOwogICAgICB9IDogYiA/IChvID0gbmV3IGIoKSwgaSA9IG8ucG9ydDIsIG8ucG9ydDEub25tZXNzYWdlID0gZywgbiA9IHMoaS5wb3N0TWVzc2FnZSwgaSwgMSkpIDogbC5hZGRFdmVudExpc3RlbmVyICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHBvc3RNZXNzYWdlICYmICFsLmltcG9ydFNjcmlwdHMgPyAobiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIGwucG9zdE1lc3NhZ2UoZSArICIiLCAiKiIpOwogICAgICB9LCBsLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBnLCAhMSkpIDogbiA9IHkgaW4gdSgic2NyaXB0IikgPyBmdW5jdGlvbiAoZSkgewogICAgICAgIGMuYXBwZW5kQ2hpbGQodSgic2NyaXB0IikpW3ldID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgYy5yZW1vdmVDaGlsZCh0aGlzKSwgXy5jYWxsKGUpOwogICAgICAgIH07CiAgICAgIH0gOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHNldFRpbWVvdXQocyhfLCBlLCAxKSwgMCk7CiAgICAgIH0pLCB0LmV4cG9ydHMgPSB7IHNldDogZCwgY2xlYXI6IHAgfTsKICAgIH0sIHsgIi4vJC5jb2YiOiAzMCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5kb20tY3JlYXRlIjogMzUsICIuLyQuZ2xvYmFsIjogNDEsICIuLyQuaHRtbCI6IDQ0LCAiLi8kLmludm9rZSI6IDQ1IH1dLCA3MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gTWF0aC5jZWlsLAogICAgICAgICAgbyA9IE1hdGguZmxvb3I7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gaXNOYU4oZSA9ICtlKSA/IDAgOiAoZSA+IDAgPyBvIDogbikoZSk7CiAgICAgIH07CiAgICB9LCB7fV0sIDc0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbihvKGUpKTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5kZWZpbmVkIjogMzMsICIuLyQuaW9iamVjdCI6IDQ2IH1dLCA3NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBNYXRoLm1pbjt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlID4gMCA/IG8obihlKSwgOTAwNzE5OTI1NDc0MDk5MSkgOiAwOwogICAgICB9OwogICAgfSwgeyAiLi8kLnRvLWludGVnZXIiOiA3MyB9XSwgNzY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gT2JqZWN0KG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmRlZmluZWQiOiAzMyB9XSwgNzc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IDAsCiAgICAgICAgICBvID0gTWF0aC5yYW5kb20oKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiU3ltYm9sKCIuY29uY2F0KHZvaWQgMCA9PT0gZSA/ICIiIDogZSwgIilfIiwgKCsrbiArIG8pLnRvU3RyaW5nKDM2KSk7CiAgICAgIH07CiAgICB9LCB7fV0sIDc4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuc2hhcmVkIikoIndrcyIpLAogICAgICAgICAgbyA9IGUoIi4vJC51aWQiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuZ2xvYmFsIikuU3ltYm9sO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBpICYmIGlbZV0gfHwgKGkgfHwgbykoIlN5bWJvbC4iICsgZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmdsb2JhbCI6IDQxLCAiLi8kLnNoYXJlZCI6IDY4LCAiLi8kLnVpZCI6IDc3IH1dLCA3OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmNsYXNzb2YiKSwKICAgICAgICAgIG8gPSBlKCIuLyQud2tzIikoIml0ZXJhdG9yIiksCiAgICAgICAgICBpID0gZSgiLi8kLml0ZXJhdG9ycyIpO3QuZXhwb3J0cyA9IGUoIi4vJC5jb3JlIikuZ2V0SXRlcmF0b3JNZXRob2QgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiB2b2lkIDAgIT0gZSA/IGVbb10gfHwgZVsiQEBpdGVyYXRvciJdIHx8IGlbbihlKV0gOiB2b2lkIDA7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY2xhc3NvZiI6IDI5LCAiLi8kLmNvcmUiOiAzMSwgIi4vJC5pdGVyYXRvcnMiOiA1NSwgIi4vJC53a3MiOiA3OCB9XSwgODA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmFkZC10by11bnNjb3BhYmxlcyIpLAogICAgICAgICAgbyA9IGUoIi4vJC5pdGVyLXN0ZXAiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuaXRlcmF0b3JzIiksCiAgICAgICAgICBzID0gZSgiLi8kLnRvLWlvYmplY3QiKTt0LmV4cG9ydHMgPSBlKCIuLyQuaXRlci1kZWZpbmUiKShBcnJheSwgIkFycmF5IiwgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB0aGlzLl90ID0gcyhlKSwgdGhpcy5faSA9IDAsIHRoaXMuX2sgPSB0OwogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUgPSB0aGlzLl90LAogICAgICAgICAgICB0ID0gdGhpcy5faywKICAgICAgICAgICAgciA9IHRoaXMuX2krKztyZXR1cm4gIWUgfHwgciA+PSBlLmxlbmd0aCA/ICh0aGlzLl90ID0gdm9pZCAwLCBvKDEpKSA6ICJrZXlzIiA9PSB0ID8gbygwLCByKSA6ICJ2YWx1ZXMiID09IHQgPyBvKDAsIGVbcl0pIDogbygwLCBbciwgZVtyXV0pOwogICAgICB9LCAidmFsdWVzIiksIGkuQXJndW1lbnRzID0gaS5BcnJheSwgbigia2V5cyIpLCBuKCJ2YWx1ZXMiKSwgbigiZW50cmllcyIpOwogICAgfSwgeyAiLi8kLmFkZC10by11bnNjb3BhYmxlcyI6IDI3LCAiLi8kLml0ZXItZGVmaW5lIjogNTIsICIuLyQuaXRlci1zdGVwIjogNTQsICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQudG8taW9iamVjdCI6IDc0IH1dLCA4MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWlvYmplY3QiKTtlKCIuLyQub2JqZWN0LXNhcCIpKCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBmdW5jdGlvbiAodCwgcikgewogICAgICAgICAgcmV0dXJuIGUobih0KSwgcik7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9LCB7ICIuLyQub2JqZWN0LXNhcCI6IDYwLCAiLi8kLnRvLWlvYmplY3QiOiA3NCB9XSwgODI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC50by1vYmplY3QiKTtlKCIuLyQub2JqZWN0LXNhcCIpKCJnZXRQcm90b3R5cGVPZiIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICByZXR1cm4gZShuKHQpKTsKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5vYmplY3Qtc2FwIjogNjAsICIuLyQudG8tb2JqZWN0IjogNzYgfV0sIDgzOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQudG8tb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgia2V5cyIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICByZXR1cm4gZShuKHQpKTsKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5vYmplY3Qtc2FwIjogNjAsICIuLyQudG8tb2JqZWN0IjogNzYgfV0sIDg0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuZXhwb3J0Iik7bihuLlMsICJPYmplY3QiLCB7IHNldFByb3RvdHlwZU9mOiBlKCIuLyQuc2V0LXByb3RvIikuc2V0IH0pOwogICAgfSwgeyAiLi8kLmV4cG9ydCI6IDM3LCAiLi8kLnNldC1wcm90byI6IDY1IH1dLCA4NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7fSwge31dLCA4NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4sCiAgICAgICAgICBvID0gZSgiLi8kIiksCiAgICAgICAgICBpID0gZSgiLi8kLmxpYnJhcnkiKSwKICAgICAgICAgIHMgPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBhID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgYyA9IGUoIi4vJC5jbGFzc29mIiksCiAgICAgICAgICB1ID0gZSgiLi8kLmV4cG9ydCIpLAogICAgICAgICAgbCA9IGUoIi4vJC5pcy1vYmplY3QiKSwKICAgICAgICAgIGYgPSBlKCIuLyQuYW4tb2JqZWN0IiksCiAgICAgICAgICBkID0gZSgiLi8kLmEtZnVuY3Rpb24iKSwKICAgICAgICAgIHAgPSBlKCIuLyQuc3RyaWN0LW5ldyIpLAogICAgICAgICAgYiA9IGUoIi4vJC5mb3Itb2YiKSwKICAgICAgICAgIGggPSBlKCIuLyQuc2V0LXByb3RvIikuc2V0LAogICAgICAgICAgdiA9IGUoIi4vJC5zYW1lLXZhbHVlIiksCiAgICAgICAgICB5ID0gZSgiLi8kLndrcyIpKCJzcGVjaWVzIiksCiAgICAgICAgICBfID0gZSgiLi8kLnNwZWNpZXMtY29uc3RydWN0b3IiKSwKICAgICAgICAgIGcgPSBlKCIuLyQubWljcm90YXNrIiksCiAgICAgICAgICBtID0gIlByb21pc2UiLAogICAgICAgICAgaiA9IHMucHJvY2VzcywKICAgICAgICAgICQgPSAicHJvY2VzcyIgPT0gYyhqKSwKICAgICAgICAgIF9PID0gc1ttXSwKICAgICAgICAgIHcgPSBmdW5jdGlvbiB3KGUpIHsKICAgICAgICB2YXIgdCA9IG5ldyBfTyhmdW5jdGlvbiAoKSB7fSk7cmV0dXJuIGUgJiYgKHQuY29uc3RydWN0b3IgPSBPYmplY3QpLCBfTy5yZXNvbHZlKHQpID09PSB0OwogICAgICB9LAogICAgICAgICAgayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiB0KGUpIHsKICAgICAgICAgIHZhciByID0gbmV3IF9PKGUpO3JldHVybiBoKHIsIHQucHJvdG90eXBlKSwgcjsKICAgICAgICB9dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgaWYgKHIgPSBfTyAmJiBfTy5yZXNvbHZlICYmIHcoKSwgaCh0LCBfTyksIHQucHJvdG90eXBlID0gby5jcmVhdGUoX08ucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiB0IH0gfSksIHQucmVzb2x2ZSg1KS50aGVuKGZ1bmN0aW9uICgpIHt9KSBpbnN0YW5jZW9mIHQgfHwgKHIgPSAhMSksIHIgJiYgZSgiLi8kLmRlc2NyaXB0b3JzIikpIHsKICAgICAgICAgICAgdmFyIG4gPSAhMTtfTy5yZXNvbHZlKG8uc2V0RGVzYyh7fSwgInRoZW4iLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICAgICAgbiA9ICEwOwogICAgICAgICAgICAgIH0gfSkpLCByID0gbjsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChpKSB7CiAgICAgICAgICByID0gITE7CiAgICAgICAgfXJldHVybiByOwogICAgICB9KCksCiAgICAgICAgICB4ID0gZnVuY3Rpb24geChlLCB0KSB7CiAgICAgICAgcmV0dXJuIGkgJiYgZSA9PT0gX08gJiYgdCA9PT0gbiA/ICEwIDogdihlLCB0KTsKICAgICAgfSwKICAgICAgICAgIEMgPSBmdW5jdGlvbiBDKGUpIHsKICAgICAgICB2YXIgdCA9IGYoZSlbeV07cmV0dXJuIHZvaWQgMCAhPSB0ID8gdCA6IGU7CiAgICAgIH0sCiAgICAgICAgICBFID0gZnVuY3Rpb24gRShlKSB7CiAgICAgICAgdmFyIHQ7cmV0dXJuIGwoZSkgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgKHQgPSBlLnRoZW4pID8gdCA6ICExOwogICAgICB9LAogICAgICAgICAgUyA9IGZ1bmN0aW9uIFMoZSkgewogICAgICAgIHZhciB0LCByO3RoaXMucHJvbWlzZSA9IG5ldyBlKGZ1bmN0aW9uIChlLCBuKSB7CiAgICAgICAgICBpZiAodm9pZCAwICE9PSB0IHx8IHZvaWQgMCAhPT0gcikgdGhyb3cgVHlwZUVycm9yKCJCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvciIpO3QgPSBlLCByID0gbjsKICAgICAgICB9KSwgdGhpcy5yZXNvbHZlID0gZCh0KSwgdGhpcy5yZWplY3QgPSBkKHIpOwogICAgICB9LAogICAgICAgICAgVCA9IGZ1bmN0aW9uIFQoZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBlKCk7CiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgcmV0dXJuIHsgZXJyb3I6IHQgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBNID0gZnVuY3Rpb24gTShlLCB0KSB7CiAgICAgICAgaWYgKCFlLm4pIHsKICAgICAgICAgIGUubiA9ICEwO3ZhciByID0gZS5jO2coZnVuY3Rpb24gKCkgewogICAgICAgICAgICBmb3IgKHZhciBuID0gZS52LCBvID0gMSA9PSBlLnMsIGkgPSAwLCBhID0gZnVuY3Rpb24gYSh0KSB7CiAgICAgICAgICAgICAgdmFyIHIsCiAgICAgICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgICAgIHMgPSBvID8gdC5vayA6IHQuZmFpbCwKICAgICAgICAgICAgICAgICAgYSA9IHQucmVzb2x2ZSwKICAgICAgICAgICAgICAgICAgYyA9IHQucmVqZWN0O3RyeSB7CiAgICAgICAgICAgICAgICBzID8gKG8gfHwgKGUuaCA9ICEwKSwgciA9IHMgPT09ICEwID8gbiA6IHMobiksIHIgPT09IHQucHJvbWlzZSA/IGMoVHlwZUVycm9yKCJQcm9taXNlLWNoYWluIGN5Y2xlIikpIDogKGkgPSBFKHIpKSA/IGkuY2FsbChyLCBhLCBjKSA6IGEocikpIDogYyhuKTsKICAgICAgICAgICAgICB9IGNhdGNoICh1KSB7CiAgICAgICAgICAgICAgICBjKHUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsgci5sZW5ndGggPiBpOykgewogICAgICAgICAgICAgIGEocltpKytdKTsKICAgICAgICAgICAgfXIubGVuZ3RoID0gMCwgZS5uID0gITEsIHQgJiYgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIHQsCiAgICAgICAgICAgICAgICAgIHIsCiAgICAgICAgICAgICAgICAgIG8gPSBlLnA7TihvKSAmJiAoJCA/IGouZW1pdCgidW5oYW5kbGVkUmVqZWN0aW9uIiwgbiwgbykgOiAodCA9IHMub251bmhhbmRsZWRyZWplY3Rpb24pID8gdCh7IHByb21pc2U6IG8sIHJlYXNvbjogbiB9KSA6IChyID0gcy5jb25zb2xlKSAmJiByLmVycm9yICYmIHIuZXJyb3IoIlVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbiIsIG4pKSwgZS5hID0gdm9pZCAwOwogICAgICAgICAgICB9LCAxKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIE4gPSBmdW5jdGlvbiBOKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IGUuX2QsCiAgICAgICAgICAgIG4gPSByLmEgfHwgci5jLAogICAgICAgICAgICBvID0gMDtpZiAoci5oKSByZXR1cm4gITE7Zm9yICg7IG4ubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGlmICh0ID0gbltvKytdLCB0LmZhaWwgfHwgIU4odC5wcm9taXNlKSkgcmV0dXJuICExOwogICAgICAgIH1yZXR1cm4gITA7CiAgICAgIH0sCiAgICAgICAgICBSID0gZnVuY3Rpb24gUihlKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzO3QuZCB8fCAodC5kID0gITAsIHQgPSB0LnIgfHwgdCwgdC52ID0gZSwgdC5zID0gMiwgdC5hID0gdC5jLnNsaWNlKCksIE0odCwgITApKTsKICAgICAgfSwKICAgICAgICAgIEQgPSBmdW5jdGlvbiBEKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IHRoaXM7aWYgKCFyLmQpIHsKICAgICAgICAgIHIuZCA9ICEwLCByID0gci5yIHx8IHI7dHJ5IHsKICAgICAgICAgICAgaWYgKHIucCA9PT0gZSkgdGhyb3cgVHlwZUVycm9yKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOyh0ID0gRShlKSkgPyBnKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHsgcjogciwgZDogITEgfTt0cnkgewogICAgICAgICAgICAgICAgdC5jYWxsKGUsIGEoRCwgbiwgMSksIGEoUiwgbiwgMSkpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKG8pIHsKICAgICAgICAgICAgICAgIFIuY2FsbChuLCBvKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pIDogKHIudiA9IGUsIHIucyA9IDEsIE0ociwgITEpKTsKICAgICAgICAgIH0gY2F0Y2ggKG4pIHsKICAgICAgICAgICAgUi5jYWxsKHsgcjogciwgZDogITEgfSwgbik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9O2sgfHwgKF9PID0gZnVuY3Rpb24gTyhlKSB7CiAgICAgICAgZChlKTt2YXIgdCA9IHRoaXMuX2QgPSB7IHA6IHAodGhpcywgX08sIG0pLCBjOiBbXSwgYTogdm9pZCAwLCBzOiAwLCBkOiAhMSwgdjogdm9pZCAwLCBoOiAhMSwgbjogITEgfTt0cnkgewogICAgICAgICAgZShhKEQsIHQsIDEpLCBhKFIsIHQsIDEpKTsKICAgICAgICB9IGNhdGNoIChyKSB7CiAgICAgICAgICBSLmNhbGwodCwgcik7CiAgICAgICAgfQogICAgICB9LCBlKCIuLyQucmVkZWZpbmUtYWxsIikoX08ucHJvdG90eXBlLCB7IHRoZW46IGZ1bmN0aW9uIHRoZW4oZSwgdCkgewogICAgICAgICAgdmFyIHIgPSBuZXcgUyhfKHRoaXMsIF9PKSksCiAgICAgICAgICAgICAgbiA9IHIucHJvbWlzZSwKICAgICAgICAgICAgICBvID0gdGhpcy5fZDtyZXR1cm4gci5vayA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgPyBlIDogITAsIHIuZmFpbCA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgJiYgdCwgby5jLnB1c2gociksIG8uYSAmJiBvLmEucHVzaChyKSwgby5zICYmIE0obywgITEpLCBuOwogICAgICAgIH0sICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaChlKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgZSk7CiAgICAgICAgfSB9KSksIHUodS5HICsgdS5XICsgdS5GICogIWssIHsgUHJvbWlzZTogX08gfSksIGUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpKF9PLCBtKSwgZSgiLi8kLnNldC1zcGVjaWVzIikobSksIG4gPSBlKCIuLyQuY29yZSIpW21dLCB1KHUuUyArIHUuRiAqICFrLCBtLCB7IHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KGUpIHsKICAgICAgICAgIHZhciB0ID0gbmV3IFModGhpcyksCiAgICAgICAgICAgICAgciA9IHQucmVqZWN0O3JldHVybiByKGUpLCB0LnByb21pc2U7CiAgICAgICAgfSB9KSwgdSh1LlMgKyB1LkYgKiAoIWsgfHwgdyghMCkpLCBtLCB7IHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoZSkgewogICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBfTyAmJiB4KGUuY29uc3RydWN0b3IsIHRoaXMpKSByZXR1cm4gZTt2YXIgdCA9IG5ldyBTKHRoaXMpLAogICAgICAgICAgICAgIHIgPSB0LnJlc29sdmU7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCB1KHUuUyArIHUuRiAqICEoayAmJiBlKCIuLyQuaXRlci1kZXRlY3QiKShmdW5jdGlvbiAoZSkgewogICAgICAgIF9PLmFsbChlKVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7fSk7CiAgICAgIH0pKSwgbSwgeyBhbGw6IGZ1bmN0aW9uIGFsbChlKSB7CiAgICAgICAgICB2YXIgdCA9IEModGhpcyksCiAgICAgICAgICAgICAgciA9IG5ldyBTKHQpLAogICAgICAgICAgICAgIG4gPSByLnJlc29sdmUsCiAgICAgICAgICAgICAgaSA9IHIucmVqZWN0LAogICAgICAgICAgICAgIHMgPSBbXSwKICAgICAgICAgICAgICBhID0gVChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGIoZSwgITEsIHMucHVzaCwgcyk7dmFyIHIgPSBzLmxlbmd0aCwKICAgICAgICAgICAgICAgIGEgPSBBcnJheShyKTtyID8gby5lYWNoLmNhbGwocywgZnVuY3Rpb24gKGUsIG8pIHsKICAgICAgICAgICAgICB2YXIgcyA9ICExO3QucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBzIHx8IChzID0gITAsIGFbb10gPSBlLCAtLXIgfHwgbihhKSk7CiAgICAgICAgICAgICAgfSwgaSk7CiAgICAgICAgICAgIH0pIDogbihhKTsKICAgICAgICAgIH0pO3JldHVybiBhICYmIGkoYS5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9LCByYWNlOiBmdW5jdGlvbiByYWNlKGUpIHsKICAgICAgICAgIHZhciB0ID0gQyh0aGlzKSwKICAgICAgICAgICAgICByID0gbmV3IFModCksCiAgICAgICAgICAgICAgbiA9IHIucmVqZWN0LAogICAgICAgICAgICAgIG8gPSBUKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgYihlLCAhMSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB0LnJlc29sdmUoZSkudGhlbihyLnJlc29sdmUsIG4pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pO3JldHVybiBvICYmIG4oby5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9IH0pOwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuYS1mdW5jdGlvbiI6IDI2LCAiLi8kLmFuLW9iamVjdCI6IDI4LCAiLi8kLmNsYXNzb2YiOiAyOSwgIi4vJC5jb3JlIjogMzEsICIuLyQuY3R4IjogMzIsICIuLyQuZGVzY3JpcHRvcnMiOiAzNCwgIi4vJC5leHBvcnQiOiAzNywgIi4vJC5mb3Itb2YiOiAzOSwgIi4vJC5nbG9iYWwiOiA0MSwgIi4vJC5pcy1vYmplY3QiOiA0OSwgIi4vJC5pdGVyLWRldGVjdCI6IDUzLCAiLi8kLmxpYnJhcnkiOiA1OCwgIi4vJC5taWNyb3Rhc2siOiA1OSwgIi4vJC5yZWRlZmluZS1hbGwiOiA2MiwgIi4vJC5zYW1lLXZhbHVlIjogNjQsICIuLyQuc2V0LXByb3RvIjogNjUsICIuLyQuc2V0LXNwZWNpZXMiOiA2NiwgIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6IDY3LCAiLi8kLnNwZWNpZXMtY29uc3RydWN0b3IiOiA2OSwgIi4vJC5zdHJpY3QtbmV3IjogNzAsICIuLyQud2tzIjogNzggfV0sIDg3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vJC5zdHJpbmctYXQiKSghMCk7ZSgiLi8kLml0ZXItZGVmaW5lIikoU3RyaW5nLCAiU3RyaW5nIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB0aGlzLl90ID0gU3RyaW5nKGUpLCB0aGlzLl9pID0gMDsKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBlLAogICAgICAgICAgICB0ID0gdGhpcy5fdCwKICAgICAgICAgICAgciA9IHRoaXMuX2k7cmV0dXJuIHIgPj0gdC5sZW5ndGggPyB7IHZhbHVlOiB2b2lkIDAsIGRvbmU6ICEwIH0gOiAoZSA9IG4odCwgciksIHRoaXMuX2kgKz0gZS5sZW5ndGgsIHsgdmFsdWU6IGUsIGRvbmU6ICExIH0pOwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5pdGVyLWRlZmluZSI6IDUyLCAiLi8kLnN0cmluZy1hdCI6IDcxIH1dLCA4ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4gPSBlKCIuLyQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBpID0gZSgiLi8kLmhhcyIpLAogICAgICAgICAgcyA9IGUoIi4vJC5kZXNjcmlwdG9ycyIpLAogICAgICAgICAgYSA9IGUoIi4vJC5leHBvcnQiKSwKICAgICAgICAgIGMgPSBlKCIuLyQucmVkZWZpbmUiKSwKICAgICAgICAgIHUgPSBlKCIuLyQuZmFpbHMiKSwKICAgICAgICAgIGwgPSBlKCIuLyQuc2hhcmVkIiksCiAgICAgICAgICBmID0gZSgiLi8kLnNldC10by1zdHJpbmctdGFnIiksCiAgICAgICAgICBkID0gZSgiLi8kLnVpZCIpLAogICAgICAgICAgcCA9IGUoIi4vJC53a3MiKSwKICAgICAgICAgIGIgPSBlKCIuLyQua2V5b2YiKSwKICAgICAgICAgIGggPSBlKCIuLyQuZ2V0LW5hbWVzIiksCiAgICAgICAgICB2ID0gZSgiLi8kLmVudW0ta2V5cyIpLAogICAgICAgICAgeSA9IGUoIi4vJC5pcy1hcnJheSIpLAogICAgICAgICAgXyA9IGUoIi4vJC5hbi1vYmplY3QiKSwKICAgICAgICAgIGcgPSBlKCIuLyQudG8taW9iamVjdCIpLAogICAgICAgICAgbSA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBqID0gbi5nZXREZXNjLAogICAgICAgICAgJCA9IG4uc2V0RGVzYywKICAgICAgICAgIE8gPSBuLmNyZWF0ZSwKICAgICAgICAgIHcgPSBoLmdldCwKICAgICAgICAgIGsgPSBvLlN5bWJvbCwKICAgICAgICAgIHggPSBvLkpTT04sCiAgICAgICAgICBDID0geCAmJiB4LnN0cmluZ2lmeSwKICAgICAgICAgIEUgPSAhMSwKICAgICAgICAgIFMgPSBwKCJfaGlkZGVuIiksCiAgICAgICAgICBUID0gbi5pc0VudW0sCiAgICAgICAgICBNID0gbCgic3ltYm9sLXJlZ2lzdHJ5IiksCiAgICAgICAgICBOID0gbCgic3ltYm9scyIpLAogICAgICAgICAgUiA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGssCiAgICAgICAgICBEID0gT2JqZWN0LnByb3RvdHlwZSwKICAgICAgICAgIFAgPSBzICYmIHUoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiA3ICE9IE8oJCh7fSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gJCh0aGlzLCAiYSIsIHsgdmFsdWU6IDcgfSkuYTsKICAgICAgICAgIH0gfSkpLmE7CiAgICAgIH0pID8gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICB2YXIgbiA9IGooRCwgdCk7biAmJiBkZWxldGUgRFt0XSwgJChlLCB0LCByKSwgbiAmJiBlICE9PSBEICYmICQoRCwgdCwgbik7CiAgICAgIH0gOiAkLAogICAgICAgICAgQSA9IGZ1bmN0aW9uIEEoZSkgewogICAgICAgIHZhciB0ID0gTltlXSA9IE8oay5wcm90b3R5cGUpO3JldHVybiB0Ll9rID0gZSwgcyAmJiBFICYmIFAoRCwgZSwgeyBjb25maWd1cmFibGU6ICEwLCBzZXQ6IGZ1bmN0aW9uIHNldCh0KSB7CiAgICAgICAgICAgIGkodGhpcywgUykgJiYgaSh0aGlzW1NdLCBlKSAmJiAodGhpc1tTXVtlXSA9ICExKSwgUCh0aGlzLCBlLCBtKDEsIHQpKTsKICAgICAgICAgIH0gfSksIHQ7CiAgICAgIH0sCiAgICAgICAgICBMID0gZnVuY3Rpb24gTChlKSB7CiAgICAgICAgcmV0dXJuICJzeW1ib2wiID09ICh0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSkpOwogICAgICB9LAogICAgICAgICAgSSA9IGZ1bmN0aW9uIEkoZSwgdCwgcikgewogICAgICAgIHJldHVybiByICYmIGkoTiwgdCkgPyAoci5lbnVtZXJhYmxlID8gKGkoZSwgUykgJiYgZVtTXVt0XSAmJiAoZVtTXVt0XSA9ICExKSwgciA9IE8ociwgeyBlbnVtZXJhYmxlOiBtKDAsICExKSB9KSkgOiAoaShlLCBTKSB8fCAkKGUsIFMsIG0oMSwge30pKSwgZVtTXVt0XSA9ICEwKSwgUChlLCB0LCByKSkgOiAkKGUsIHQsIHIpOwogICAgICB9LAogICAgICAgICAgRiA9IGZ1bmN0aW9uIEYoZSwgdCkgewogICAgICAgIF8oZSk7Zm9yICh2YXIgciwgbiA9IHYodCA9IGcodCkpLCBvID0gMCwgaSA9IG4ubGVuZ3RoOyBpID4gbzspIHsKICAgICAgICAgIEkoZSwgciA9IG5bbysrXSwgdFtyXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9LAogICAgICAgICAgViA9IGZ1bmN0aW9uIFYoZSwgdCkgewogICAgICAgIHJldHVybiB2b2lkIDAgPT09IHQgPyBPKGUpIDogRihPKGUpLCB0KTsKICAgICAgfSwKICAgICAgICAgIHogPSBmdW5jdGlvbiB6KGUpIHsKICAgICAgICB2YXIgdCA9IFQuY2FsbCh0aGlzLCBlKTtyZXR1cm4gdCB8fCAhaSh0aGlzLCBlKSB8fCAhaShOLCBlKSB8fCBpKHRoaXMsIFMpICYmIHRoaXNbU11bZV0gPyB0IDogITA7CiAgICAgIH0sCiAgICAgICAgICBVID0gZnVuY3Rpb24gVShlLCB0KSB7CiAgICAgICAgdmFyIHIgPSBqKGUgPSBnKGUpLCB0KTtyZXR1cm4gIXIgfHwgIWkoTiwgdCkgfHwgaShlLCBTKSAmJiBlW1NdW3RdIHx8IChyLmVudW1lcmFibGUgPSAhMCksIHI7CiAgICAgIH0sCiAgICAgICAgICBIID0gZnVuY3Rpb24gSChlKSB7CiAgICAgICAgZm9yICh2YXIgdCwgciA9IHcoZyhlKSksIG4gPSBbXSwgbyA9IDA7IHIubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGkoTiwgdCA9IHJbbysrXSkgfHwgdCA9PSBTIHx8IG4ucHVzaCh0KTsKICAgICAgICB9cmV0dXJuIG47CiAgICAgIH0sCiAgICAgICAgICBCID0gZnVuY3Rpb24gQihlKSB7CiAgICAgICAgZm9yICh2YXIgdCwgciA9IHcoZyhlKSksIG4gPSBbXSwgbyA9IDA7IHIubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGkoTiwgdCA9IHJbbysrXSkgJiYgbi5wdXNoKE5bdF0pOwogICAgICAgIH1yZXR1cm4gbjsKICAgICAgfSwKICAgICAgICAgIEogPSBmdW5jdGlvbiBKKGUpIHsKICAgICAgICBpZiAodm9pZCAwICE9PSBlICYmICFMKGUpKSB7CiAgICAgICAgICBmb3IgKHZhciB0LCByLCBuID0gW2VdLCBvID0gMSwgaSA9IGFyZ3VtZW50czsgaS5sZW5ndGggPiBvOykgewogICAgICAgICAgICBuLnB1c2goaVtvKytdKTsKICAgICAgICAgIH1yZXR1cm4gdCA9IG5bMV0sICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgJiYgKHIgPSB0KSwgIXIgJiYgeSh0KSB8fCAodCA9IGZ1bmN0aW9uIHQoZSwgX3QyKSB7CiAgICAgICAgICAgIHJldHVybiByICYmIChfdDIgPSByLmNhbGwodGhpcywgZSwgX3QyKSksIEwoX3QyKSA/IHZvaWQgMCA6IF90MjsKICAgICAgICAgIH0pLCBuWzFdID0gdCwgQy5hcHBseSh4LCBuKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBXID0gdShmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUgPSBrKCk7cmV0dXJuICJbbnVsbF0iICE9IEMoW2VdKSB8fCAie30iICE9IEMoeyBhOiBlIH0pIHx8ICJ7fSIgIT0gQyhPYmplY3QoZSkpOwogICAgICB9KTtSIHx8IChrID0gZnVuY3Rpb24gaygpIHsKICAgICAgICBpZiAoTCh0aGlzKSkgdGhyb3cgVHlwZUVycm9yKCJTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IiKTtyZXR1cm4gQShkKGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdm9pZCAwKSk7CiAgICAgIH0sIGMoay5wcm90b3R5cGUsICJ0b1N0cmluZyIsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcy5fazsKICAgICAgfSksIEwgPSBmdW5jdGlvbiBMKGUpIHsKICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIGs7CiAgICAgIH0sIG4uY3JlYXRlID0gViwgbi5pc0VudW0gPSB6LCBuLmdldERlc2MgPSBVLCBuLnNldERlc2MgPSBJLCBuLnNldERlc2NzID0gRiwgbi5nZXROYW1lcyA9IGguZ2V0ID0gSCwgbi5nZXRTeW1ib2xzID0gQiwgcyAmJiAhZSgiLi8kLmxpYnJhcnkiKSAmJiBjKEQsICJwcm9wZXJ0eUlzRW51bWVyYWJsZSIsIHosICEwKSk7dmFyIFkgPSB7ICJmb3IiOiBmdW5jdGlvbiBfZm9yKGUpIHsKICAgICAgICAgIHJldHVybiBpKE0sIGUgKz0gIiIpID8gTVtlXSA6IE1bZV0gPSBrKGUpOwogICAgICAgIH0sIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKGUpIHsKICAgICAgICAgIHJldHVybiBiKE0sIGUpOwogICAgICAgIH0sIHVzZVNldHRlcjogZnVuY3Rpb24gdXNlU2V0dGVyKCkgewogICAgICAgICAgRSA9ICEwOwogICAgICAgIH0sIHVzZVNpbXBsZTogZnVuY3Rpb24gdXNlU2ltcGxlKCkgewogICAgICAgICAgRSA9ICExOwogICAgICAgIH0gfTtuLmVhY2guY2FsbCgiaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMiLnNwbGl0KCIsIiksIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQgPSBwKGUpO1lbZV0gPSBSID8gdCA6IEEodCk7CiAgICAgIH0pLCBFID0gITAsIGEoYS5HICsgYS5XLCB7IFN5bWJvbDogayB9KSwgYShhLlMsICJTeW1ib2wiLCBZKSwgYShhLlMgKyBhLkYgKiAhUiwgIk9iamVjdCIsIHsgY3JlYXRlOiBWLCBkZWZpbmVQcm9wZXJ0eTogSSwgZGVmaW5lUHJvcGVydGllczogRiwgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiBVLCBnZXRPd25Qcm9wZXJ0eU5hbWVzOiBILCBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6IEIgfSksIHggJiYgYShhLlMgKyBhLkYgKiAoIVIgfHwgVyksICJKU09OIiwgeyBzdHJpbmdpZnk6IEogfSksIGYoaywgIlN5bWJvbCIpLCBmKE1hdGgsICJNYXRoIiwgITApLCBmKG8uSlNPTiwgIkpTT04iLCAhMCk7CiAgICB9LCB7ICIuLyQiOiA1NiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5kZXNjcmlwdG9ycyI6IDM0LCAiLi8kLmVudW0ta2V5cyI6IDM2LCAiLi8kLmV4cG9ydCI6IDM3LCAiLi8kLmZhaWxzIjogMzgsICIuLyQuZ2V0LW5hbWVzIjogNDAsICIuLyQuZ2xvYmFsIjogNDEsICIuLyQuaGFzIjogNDIsICIuLyQuaXMtYXJyYXkiOiA0OCwgIi4vJC5rZXlvZiI6IDU3LCAiLi8kLmxpYnJhcnkiOiA1OCwgIi4vJC5wcm9wZXJ0eS1kZXNjIjogNjEsICIuLyQucmVkZWZpbmUiOiA2MywgIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6IDY3LCAiLi8kLnNoYXJlZCI6IDY4LCAiLi8kLnRvLWlvYmplY3QiOiA3NCwgIi4vJC51aWQiOiA3NywgIi4vJC53a3MiOiA3OCB9XSwgODk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuL2VzNi5hcnJheS5pdGVyYXRvciIpO3ZhciBuID0gZSgiLi8kLml0ZXJhdG9ycyIpO24uTm9kZUxpc3QgPSBuLkhUTUxDb2xsZWN0aW9uID0gbi5BcnJheTsKICAgIH0sIHsgIi4vJC5pdGVyYXRvcnMiOiA1NSwgIi4vZXM2LmFycmF5Lml0ZXJhdG9yIjogODAgfV0sIDkwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCBmdW5jdGlvbiAoZSkgewogICAgICAgIGZ1bmN0aW9uIHQoZSkgewogICAgICAgICAgdGhpcy5nID0gW10sIHRoaXMuayA9IGU7CiAgICAgICAgfWZ1bmN0aW9uIHIoZSkgewogICAgICAgICAgIWZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICAgIHZhciBuID0gZS50YWtlUmVjb3JkcygpO24ubGVuZ3RoICYmIGUuayhuLCBlKSwgZS5mID0gc2V0VGltZW91dChyLCB0Ll9wZXJpb2QpOwogICAgICAgICAgfSgpOwogICAgICAgIH1mdW5jdGlvbiBuKHQpIHsKICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIG4gPSB7IHR5cGU6IG51bGwsIHRhcmdldDogbnVsbCwgYWRkZWROb2RlczogW10sIHJlbW92ZWROb2RlczogW10sIHByZXZpb3VzU2libGluZzogbnVsbCwgbmV4dFNpYmxpbmc6IG51bGwsIGF0dHJpYnV0ZU5hbWU6IG51bGwsIGF0dHJpYnV0ZU5hbWVzcGFjZTogbnVsbCwgb2xkVmFsdWU6IG51bGwgfTtmb3IgKHIgaW4gdCkgewogICAgICAgICAgICBuW3JdICE9PSBlICYmIHRbcl0gIT09IGUgJiYgKG5bcl0gPSB0W3JdKTsKICAgICAgICAgIH1yZXR1cm4gbjsKICAgICAgICB9ZnVuY3Rpb24gbyhlLCB0KSB7CiAgICAgICAgICB2YXIgciA9IGEoZSwgdCk7cmV0dXJuIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICAgIHZhciBvLAogICAgICAgICAgICAgICAgYyA9IG4ubGVuZ3RoO3QuYSAmJiByLmEgJiYgaShuLCBlLCByLmEsIHQuZCksICh0LmIgfHwgdC5lKSAmJiAobyA9IHMobiwgZSwgciwgdCkpLCAobyB8fCBuLmxlbmd0aCAhPT0gYykgJiYgKHIgPSBhKGUsIHQpKTsKICAgICAgICAgIH07CiAgICAgICAgfWZ1bmN0aW9uIGkodCwgciwgbywgaSkgewogICAgICAgICAgZm9yICh2YXIgcywgYSwgYyA9IHt9LCB1ID0gci5hdHRyaWJ1dGVzLCBsID0gdS5sZW5ndGg7IGwtLTspIHsKICAgICAgICAgICAgcyA9IHVbbF0sIGEgPSBzLm5hbWUsIGkgJiYgaVthXSA9PT0gZSB8fCAocy52YWx1ZSAhPT0gb1thXSAmJiB0LnB1c2gobih7IHR5cGU6ICJhdHRyaWJ1dGVzIiwgdGFyZ2V0OiByLCBhdHRyaWJ1dGVOYW1lOiBhLCBvbGRWYWx1ZTogb1thXSwgYXR0cmlidXRlTmFtZXNwYWNlOiBzLm5hbWVzcGFjZVVSSSB9KSksIGNbYV0gPSAhMCk7CiAgICAgICAgICB9Zm9yIChhIGluIG8pIHsKICAgICAgICAgICAgY1thXSB8fCB0LnB1c2gobih7IHRhcmdldDogciwgdHlwZTogImF0dHJpYnV0ZXMiLCBhdHRyaWJ1dGVOYW1lOiBhLCBvbGRWYWx1ZTogb1thXSB9KSk7CiAgICAgICAgICB9CiAgICAgICAgfWZ1bmN0aW9uIHModCwgciwgbywgcykgewogICAgICAgICAgZnVuY3Rpb24gYShlLCByLCBvLCBhLCBjKSB7CiAgICAgICAgICAgIHZhciBsID0gZS5sZW5ndGggLSAxO2MgPSAtIH4oKGwgLSBjKSAvIDIpO2ZvciAodmFyIGYsIGQsIHA7IHAgPSBlLnBvcCgpOykgewogICAgICAgICAgICAgIGYgPSBvW3AuaF0sIGQgPSBhW3AuaV0sIHMuYiAmJiBjICYmIE1hdGguYWJzKHAuaCAtIHAuaSkgPj0gbCAmJiAodC5wdXNoKG4oeyB0eXBlOiAiY2hpbGRMaXN0IiwgdGFyZ2V0OiByLCBhZGRlZE5vZGVzOiBbZl0sIHJlbW92ZWROb2RlczogW2ZdLCBuZXh0U2libGluZzogZi5uZXh0U2libGluZywgcHJldmlvdXNTaWJsaW5nOiBmLnByZXZpb3VzU2libGluZyB9KSksIGMtLSksIHMuYSAmJiBkLmEgJiYgaSh0LCBmLCBkLmEsIHMuZCksIHMuYyAmJiAzID09PSBmLm5vZGVUeXBlICYmIGYubm9kZVZhbHVlICE9PSBkLmMgJiYgdC5wdXNoKG4oeyB0eXBlOiAiY2hhcmFjdGVyRGF0YSIsIHRhcmdldDogZiB9KSksIHMuZSAmJiB1KGYsIGQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9ZnVuY3Rpb24gdShyLCBvKSB7CiAgICAgICAgICAgIGZvciAodmFyIGQsIHAsIGIsIGgsIHYsIHkgPSByLmNoaWxkTm9kZXMsIF8gPSBvLmIsIGcgPSB5Lmxlbmd0aCwgbSA9IF8gPyBfLmxlbmd0aCA6IDAsIGogPSAwLCAkID0gMCwgTyA9IDA7IGcgPiAkIHx8IG0gPiBPOykgewogICAgICAgICAgICAgIGggPSB5WyRdLCB2ID0gKGIgPSBfW09dKSAmJiBiLmosIGggPT09IHYgPyAocy5hICYmIGIuYSAmJiBpKHQsIGgsIGIuYSwgcy5kKSwgcy5jICYmIGIuYyAhPT0gZSAmJiBoLm5vZGVWYWx1ZSAhPT0gYi5jICYmIHQucHVzaChuKHsgdHlwZTogImNoYXJhY3RlckRhdGEiLCB0YXJnZXQ6IGggfSkpLCBwICYmIGEocCwgciwgeSwgXywgaiksIHMuZSAmJiAoaC5jaGlsZE5vZGVzLmxlbmd0aCB8fCBiLmIgJiYgYi5iLmxlbmd0aCkgJiYgdShoLCBiKSwgJCsrLCBPKyspIDogKGwgPSAhMCwgZCB8fCAoZCA9IHt9LCBwID0gW10pLCBoICYmIChkW2IgPSBjKGgpXSB8fCAoZFtiXSA9ICEwLCAtMSA9PT0gKGIgPSBmKF8sIGgsIE8sICJqIikpID8gcy5iICYmICh0LnB1c2gobih7IHR5cGU6ICJjaGlsZExpc3QiLCB0YXJnZXQ6IHIsIGFkZGVkTm9kZXM6IFtoXSwgbmV4dFNpYmxpbmc6IGgubmV4dFNpYmxpbmcsIHByZXZpb3VzU2libGluZzogaC5wcmV2aW91c1NpYmxpbmcgfSkpLCBqKyspIDogcC5wdXNoKHsgaDogJCwgaTogYiB9KSksICQrKyksIHYgJiYgdiAhPT0geVskXSAmJiAoZFtiID0gYyh2KV0gfHwgKGRbYl0gPSAhMCwgLTEgPT09IChiID0gZih5LCB2LCAkKSkgPyBzLmIgJiYgKHQucHVzaChuKHsgdHlwZTogImNoaWxkTGlzdCIsIHRhcmdldDogby5qLCByZW1vdmVkTm9kZXM6IFt2XSwgbmV4dFNpYmxpbmc6IF9bTyArIDFdLCBwcmV2aW91c1NpYmxpbmc6IF9bTyAtIDFdIH0pKSwgai0tKSA6IHAucHVzaCh7IGg6IGIsIGk6IE8gfSkpLCBPKyspKTsKICAgICAgICAgICAgfXAgJiYgYShwLCByLCB5LCBfLCBqKTsKICAgICAgICAgIH12YXIgbDtyZXR1cm4gdShyLCBvKSwgbDsKICAgICAgICB9ZnVuY3Rpb24gYShlLCB0KSB7CiAgICAgICAgICB2YXIgciA9ICEwO3JldHVybiBmdW5jdGlvbiBuKGUpIHsKICAgICAgICAgICAgdmFyIG8gPSB7IGo6IGUgfTtyZXR1cm4gIXQuYyB8fCAzICE9PSBlLm5vZGVUeXBlICYmIDggIT09IGUubm9kZVR5cGUgPyAodC5hICYmIHIgJiYgMSA9PT0gZS5ub2RlVHlwZSAmJiAoby5hID0gbChlLmF0dHJpYnV0ZXMsIGZ1bmN0aW9uIChlLCByKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQuZCAmJiAhdC5kW3IubmFtZV0gfHwgKGVbci5uYW1lXSA9IHIudmFsdWUpLCBlOwogICAgICAgICAgICB9KSksIHIgJiYgKHQuYiB8fCB0LmMgfHwgdC5hICYmIHQuZSkgJiYgKG8uYiA9IHUoZS5jaGlsZE5vZGVzLCBuKSksIHIgPSB0LmUpIDogby5jID0gZS5ub2RlVmFsdWUsIG87CiAgICAgICAgICB9KGUpOwogICAgICAgIH1mdW5jdGlvbiBjKGUpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBlLmlkIHx8IChlLm1vX2lkID0gZS5tb19pZCB8fCBkKyspOwogICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJldHVybiBlLm5vZGVWYWx1ZTsKICAgICAgICAgICAgfSBjYXRjaCAocikgewogICAgICAgICAgICAgIHJldHVybiBkKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9ZnVuY3Rpb24gdShlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0gW10sIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICAgICAgICByW25dID0gdChlW25dLCBuLCBlKTsKICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICB9ZnVuY3Rpb24gbChlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0ge30sIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICAgICAgICByID0gdChyLCBlW25dLCBuLCBlKTsKICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICB9ZnVuY3Rpb24gZihlLCB0LCByLCBuKSB7CiAgICAgICAgICBmb3IgKDsgciA8IGUubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgaWYgKChuID8gZVtyXVtuXSA6IGVbcl0pID09PSB0KSByZXR1cm4gcjsKICAgICAgICAgIH1yZXR1cm4gLTE7CiAgICAgICAgfXQuX3BlcmlvZCA9IDMwLCB0LnByb3RvdHlwZSA9IHsgb2JzZXJ2ZTogZnVuY3Rpb24gb2JzZXJ2ZShlLCB0KSB7CiAgICAgICAgICAgIGZvciAodmFyIG4gPSB7IGE6ICEhKHQuYXR0cmlidXRlcyB8fCB0LmF0dHJpYnV0ZUZpbHRlciB8fCB0LmF0dHJpYnV0ZU9sZFZhbHVlKSwgYjogISF0LmNoaWxkTGlzdCwgZTogISF0LnN1YnRyZWUsIGM6ICEoIXQuY2hhcmFjdGVyRGF0YSAmJiAhdC5jaGFyYWN0ZXJEYXRhT2xkVmFsdWUpIH0sIGkgPSB0aGlzLmcsIHMgPSAwOyBzIDwgaS5sZW5ndGg7IHMrKykgewogICAgICAgICAgICAgIGlbc10ubSA9PT0gZSAmJiBpLnNwbGljZShzLCAxKTsKICAgICAgICAgICAgfXQuYXR0cmlidXRlRmlsdGVyICYmIChuLmQgPSBsKHQuYXR0cmlidXRlRmlsdGVyLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHJldHVybiBlW3RdID0gITAsIGU7CiAgICAgICAgICAgIH0pKSwgaS5wdXNoKHsgbTogZSwgbDogbyhlLCBuKSB9KSwgdGhpcy5mIHx8IHIodGhpcyk7CiAgICAgICAgICB9LCB0YWtlUmVjb3JkczogZnVuY3Rpb24gdGFrZVJlY29yZHMoKSB7CiAgICAgICAgICAgIGZvciAodmFyIGUgPSBbXSwgdCA9IHRoaXMuZywgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgICAgdFtyXS5sKGUpOwogICAgICAgICAgICB9cmV0dXJuIGU7CiAgICAgICAgICB9LCBkaXNjb25uZWN0OiBmdW5jdGlvbiBkaXNjb25uZWN0KCkgewogICAgICAgICAgICB0aGlzLmcgPSBbXSwgY2xlYXJUaW1lb3V0KHRoaXMuZiksIHRoaXMuZiA9IG51bGw7CiAgICAgICAgICB9IH07dmFyIGQgPSAxO3JldHVybiB0OwogICAgICB9KHZvaWQgMCk7CiAgICB9LCB7fV0sIDkxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgT2JqZWN0Lm9ic2VydmUgfHwgZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgdmFyIG8sCiAgICAgICAgICAgIGksCiAgICAgICAgICAgIHMgPSBbImFkZCIsICJ1cGRhdGUiLCAiZGVsZXRlIiwgInJlY29uZmlndXJlIiwgInNldFByb3RvdHlwZSIsICJwcmV2ZW50RXh0ZW5zaW9ucyJdLAogICAgICAgICAgICBhID0gdC5pc0FycmF5IHx8IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgcmV0dXJuICJbb2JqZWN0IEFycmF5XSIgPT09IGUuY2FsbCh0KTsKICAgICAgICAgIH07CiAgICAgICAgfShlLnByb3RvdHlwZS50b1N0cmluZyksCiAgICAgICAgICAgIGMgPSB0LnByb3RvdHlwZS5pbmRleE9mID8gdC5pbmRleE9mIHx8IGZ1bmN0aW9uIChlLCByLCBuKSB7CiAgICAgICAgICByZXR1cm4gdC5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGUsIHIsIG4pOwogICAgICAgIH0gOiBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgICAgZm9yICh2YXIgbiA9IHIgfHwgMDsgbiA8IGUubGVuZ3RoOyBuKyspIHsKICAgICAgICAgICAgaWYgKGVbbl0gPT09IHQpIHJldHVybiBuOwogICAgICAgICAgfXJldHVybiAtMTsKICAgICAgICB9LAogICAgICAgICAgICB1ID0gci5NYXAgIT09IG4gJiYgTWFwLnByb3RvdHlwZS5mb3JFYWNoID8gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIG5ldyBNYXAoKTsKICAgICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGUgPSBbXSwKICAgICAgICAgICAgICB0ID0gW107cmV0dXJuIHsgc2l6ZTogMCwgaGFzOiBmdW5jdGlvbiBoYXModCkgewogICAgICAgICAgICAgIHJldHVybiBjKGUsIHQpID4gLTE7CiAgICAgICAgICAgIH0sIGdldDogZnVuY3Rpb24gZ2V0KHIpIHsKICAgICAgICAgICAgICByZXR1cm4gdFtjKGUsIHIpXTsKICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiBzZXQociwgbikgewogICAgICAgICAgICAgIHZhciBvID0gYyhlLCByKTstMSA9PT0gbyA/IChlLnB1c2gociksIHQucHVzaChuKSwgdGhpcy5zaXplKyspIDogdFtvXSA9IG47CiAgICAgICAgICAgIH0sICJkZWxldGUiOiBmdW5jdGlvbiBfZGVsZXRlKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IGMoZSwgcik7biA+IC0xICYmIChlLnNwbGljZShuLCAxKSwgdC5zcGxpY2UobiwgMSksIHRoaXMuc2l6ZS0tKTsKICAgICAgICAgICAgfSwgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChyKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7CiAgICAgICAgICAgICAgICByLmNhbGwoYXJndW1lbnRzWzFdLCB0W25dLCBlW25dLCB0aGlzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gfTsKICAgICAgICB9LAogICAgICAgICAgICBsID0gZS5nZXRPd25Qcm9wZXJ0eU5hbWVzID8gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHQgPSBlLmdldE93blByb3BlcnR5TmFtZXM7dHJ5IHsKICAgICAgICAgICAgYXJndW1lbnRzLmNhbGxlZTsKICAgICAgICAgIH0gY2F0Y2ggKHIpIHsKICAgICAgICAgICAgdmFyIG4gPSAodChjKS5qb2luKCIgIikgKyAiICIpLnJlcGxhY2UoL3Byb3RvdHlwZSB8bGVuZ3RoIHxuYW1lIC9nLCAiIikuc2xpY2UoMCwgLTEpLnNwbGl0KCIgIik7bi5sZW5ndGggJiYgKHQgPSBmdW5jdGlvbiB0KF90MykgewogICAgICAgICAgICAgIHZhciByID0gZS5nZXRPd25Qcm9wZXJ0eU5hbWVzKF90Myk7aWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIF90MykgZm9yICh2YXIgbywgaSA9IDA7IGkgPCBuLmxlbmd0aDspIHsKICAgICAgICAgICAgICAgIChvID0gYyhyLCBuW2krK10pKSA+IC0xICYmIHIuc3BsaWNlKG8sIDEpOwogICAgICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9cmV0dXJuIHQ7CiAgICAgICAgfSgpIDogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgbyA9IFtdO2lmICgiaGFzT3duUHJvcGVydHkiIGluIHQpIGZvciAociBpbiB0KSB7CiAgICAgICAgICAgIHQuaGFzT3duUHJvcGVydHkocikgJiYgby5wdXNoKHIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbiA9IGUuaGFzT3duUHJvcGVydHk7Zm9yIChyIGluIHQpIHsKICAgICAgICAgICAgICBuLmNhbGwodCwgcikgJiYgby5wdXNoKHIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9cmV0dXJuIGEodCkgJiYgby5wdXNoKCJsZW5ndGgiKSwgbzsKICAgICAgICB9LAogICAgICAgICAgICBmID0gZS5nZXRQcm90b3R5cGVPZiwKICAgICAgICAgICAgZCA9IGUuZGVmaW5lUHJvcGVydGllcyAmJiBlLmdldE93blByb3BlcnR5RGVzY3JpcHRvciwKICAgICAgICAgICAgcCA9IHIucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHIud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlID0gK25ldyBEYXRlKCksCiAgICAgICAgICAgICAgdCA9IGU7cmV0dXJuIGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByKCh0ID0gK25ldyBEYXRlKCkpIC0gZSk7CiAgICAgICAgICAgIH0sIDE3KTsKICAgICAgICAgIH07CiAgICAgICAgfSgpLAogICAgICAgICAgICBiID0gZnVuY3Rpb24gYihlLCB0LCByKSB7CiAgICAgICAgICB2YXIgbiA9IG8uZ2V0KGUpO24gPyAodihuLCBlKSwgbShlLCBuLCB0LCByKSkgOiAobiA9IGgoZSksIG0oZSwgbiwgdCwgciksIDEgPT09IG8uc2l6ZSAmJiBwKHkpKTsKICAgICAgICB9LAogICAgICAgICAgICBoID0gZnVuY3Rpb24gaCh0LCByKSB7CiAgICAgICAgICB2YXIgbiwKICAgICAgICAgICAgICBpID0gbCh0KSwKICAgICAgICAgICAgICBzID0gW10sCiAgICAgICAgICAgICAgYSA9IDAsCiAgICAgICAgICAgICAgciA9IHsgaGFuZGxlcnM6IHUoKSwgZnJvemVuOiBlLmlzRnJvemVuID8gZS5pc0Zyb3plbih0KSA6ICExLCBleHRlbnNpYmxlOiBlLmlzRXh0ZW5zaWJsZSA/IGUuaXNFeHRlbnNpYmxlKHQpIDogITAsIHByb3RvOiBmICYmIGYodCksIHByb3BlcnRpZXM6IGksIHZhbHVlczogcywgbm90aWZpZXI6IGcodCwgcikgfTtpZiAoZCkgZm9yIChuID0gci5kZXNjcmlwdG9ycyA9IFtdOyBhIDwgaS5sZW5ndGg7KSB7CiAgICAgICAgICAgIG5bYV0gPSBkKHQsIGlbYV0pLCBzW2FdID0gdFtpW2ErK11dOwogICAgICAgICAgfSBlbHNlIGZvciAoOyBhIDwgaS5sZW5ndGg7KSB7CiAgICAgICAgICAgIHNbYV0gPSB0W2lbYSsrXV07CiAgICAgICAgICB9cmV0dXJuIG8uc2V0KHQsIHIpLCByOwogICAgICAgIH0sCiAgICAgICAgICAgIHYgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgdCA9IGQgPyBmdW5jdGlvbiAoZSwgdCwgciwgbiwgbykgewogICAgICAgICAgICB2YXIgaSA9IHQucHJvcGVydGllc1tyXSwKICAgICAgICAgICAgICAgIHMgPSBlW2ldLAogICAgICAgICAgICAgICAgYSA9IHQudmFsdWVzW3JdLAogICAgICAgICAgICAgICAgYyA9IHQuZGVzY3JpcHRvcnNbcl07InZhbHVlIiBpbiBvICYmIChhID09PSBzID8gMCA9PT0gYSAmJiAxIC8gYSAhPT0gMSAvIHMgOiBhID09PSBhIHx8IHMgPT09IHMpICYmIChqKGUsIHQsIHsgbmFtZTogaSwgdHlwZTogInVwZGF0ZSIsIG9iamVjdDogZSwgb2xkVmFsdWU6IGEgfSwgbiksIHQudmFsdWVzW3JdID0gcyksICFjLmNvbmZpZ3VyYWJsZSB8fCBvLmNvbmZpZ3VyYWJsZSAmJiBvLndyaXRhYmxlID09PSBjLndyaXRhYmxlICYmIG8uZW51bWVyYWJsZSA9PT0gYy5lbnVtZXJhYmxlICYmIG8uZ2V0ID09PSBjLmdldCAmJiBvLnNldCA9PT0gYy5zZXQgfHwgKGooZSwgdCwgeyBuYW1lOiBpLCB0eXBlOiAicmVjb25maWd1cmUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBhIH0sIG4pLCB0LmRlc2NyaXB0b3JzW3JdID0gbyk7CiAgICAgICAgICB9IDogZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKICAgICAgICAgICAgdmFyIG8gPSB0LnByb3BlcnRpZXNbcl0sCiAgICAgICAgICAgICAgICBpID0gZVtvXSwKICAgICAgICAgICAgICAgIHMgPSB0LnZhbHVlc1tyXTsocyA9PT0gaSA/IDAgPT09IHMgJiYgMSAvIHMgIT09IDEgLyBpIDogcyA9PT0gcyB8fCBpID09PSBpKSAmJiAoaihlLCB0LCB7IG5hbWU6IG8sIHR5cGU6ICJ1cGRhdGUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBzIH0sIG4pLCB0LnZhbHVlc1tyXSA9IGkpOwogICAgICAgICAgfSwKICAgICAgICAgICAgICByID0gZCA/IGZ1bmN0aW9uIChlLCByLCBuLCBvLCBpKSB7CiAgICAgICAgICAgIGZvciAodmFyIHMsIGEgPSByLmxlbmd0aDsgbiAmJiBhLS07KSB7CiAgICAgICAgICAgICAgbnVsbCAhPT0gclthXSAmJiAocyA9IGQoZSwgclthXSksIG4tLSwgcyA/IHQoZSwgbywgYSwgaSwgcykgOiAoaihlLCBvLCB7IG5hbWU6IHJbYV0sIHR5cGU6ICJkZWxldGUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBvLnZhbHVlc1thXSB9LCBpKSwgby5wcm9wZXJ0aWVzLnNwbGljZShhLCAxKSwgby52YWx1ZXMuc3BsaWNlKGEsIDEpLCBvLmRlc2NyaXB0b3JzLnNwbGljZShhLCAxKSkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IDogZnVuY3Rpb24gKGUsIHQsIHIsIG4sIG8pIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IHQubGVuZ3RoOyByICYmIGktLTspIHsKICAgICAgICAgICAgICBudWxsICE9PSB0W2ldICYmIChqKGUsIG4sIHsgbmFtZTogdFtpXSwgdHlwZTogImRlbGV0ZSIsIG9iamVjdDogZSwgb2xkVmFsdWU6IG4udmFsdWVzW2ldIH0sIG8pLCBuLnByb3BlcnRpZXMuc3BsaWNlKGksIDEpLCBuLnZhbHVlcy5zcGxpY2UoaSwgMSksIHItLSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07cmV0dXJuIGZ1bmN0aW9uIChuLCBvLCBpKSB7CiAgICAgICAgICAgIGlmIChuLmhhbmRsZXJzLnNpemUgJiYgIW4uZnJvemVuKSB7CiAgICAgICAgICAgICAgdmFyIHMsCiAgICAgICAgICAgICAgICAgIGEsCiAgICAgICAgICAgICAgICAgIHUsCiAgICAgICAgICAgICAgICAgIHAsCiAgICAgICAgICAgICAgICAgIGIsCiAgICAgICAgICAgICAgICAgIGgsCiAgICAgICAgICAgICAgICAgIHYsCiAgICAgICAgICAgICAgICAgIHksCiAgICAgICAgICAgICAgICAgIF8gPSBuLnZhbHVlcywKICAgICAgICAgICAgICAgICAgZyA9IG4uZGVzY3JpcHRvcnMsCiAgICAgICAgICAgICAgICAgIG0gPSAwO2lmIChuLmV4dGVuc2libGUpIHsKICAgICAgICAgICAgICAgIGlmIChzID0gbi5wcm9wZXJ0aWVzLnNsaWNlKCksIGEgPSBzLmxlbmd0aCwgdSA9IGwobyksIGcpIHsKICAgICAgICAgICAgICAgICAgZm9yICg7IG0gPCB1Lmxlbmd0aDspIHsKICAgICAgICAgICAgICAgICAgICBiID0gdVttKytdLCBwID0gYyhzLCBiKSwgeSA9IGQobywgYiksIC0xID09PSBwID8gKGoobywgbiwgeyBuYW1lOiBiLCB0eXBlOiAiYWRkIiwgb2JqZWN0OiBvIH0sIGkpLCBuLnByb3BlcnRpZXMucHVzaChiKSwgXy5wdXNoKG9bYl0pLCBnLnB1c2goeSkpIDogKHNbcF0gPSBudWxsLCBhLS0sIHQobywgbiwgcCwgaSwgeSkpOwogICAgICAgICAgICAgICAgICB9cihvLCBzLCBhLCBuLCBpKSwgZS5pc0V4dGVuc2libGUobykgfHwgKG4uZXh0ZW5zaWJsZSA9ICExLCBqKG8sIG4sIHsgdHlwZTogInByZXZlbnRFeHRlbnNpb25zIiwgb2JqZWN0OiBvIH0sIGkpLCBuLmZyb3plbiA9IGUuaXNGcm96ZW4obykpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZm9yICg7IG0gPCB1Lmxlbmd0aDspIHsKICAgICAgICAgICAgICAgICAgICBiID0gdVttKytdLCBwID0gYyhzLCBiKSwgaCA9IG9bYl0sIC0xID09PSBwID8gKGoobywgbiwgeyBuYW1lOiBiLCB0eXBlOiAiYWRkIiwgb2JqZWN0OiBvIH0sIGkpLCBuLnByb3BlcnRpZXMucHVzaChiKSwgXy5wdXNoKGgpKSA6IChzW3BdID0gbnVsbCwgYS0tLCB0KG8sIG4sIHAsIGkpKTsKICAgICAgICAgICAgICAgICAgfXIobywgcywgYSwgbiwgaSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmICghbi5mcm96ZW4pIHsKICAgICAgICAgICAgICAgIGZvciAoOyBtIDwgcy5sZW5ndGg7IG0rKykgewogICAgICAgICAgICAgICAgICBiID0gc1ttXSwgdChvLCBuLCBtLCBpLCBkKG8sIGIpKTsKICAgICAgICAgICAgICAgIH1lLmlzRnJvemVuKG8pICYmIChuLmZyb3plbiA9ICEwKTsKICAgICAgICAgICAgICB9ZiAmJiAodiA9IGYobyksIHYgIT09IG4ucHJvdG8gJiYgKGoobywgbiwgeyB0eXBlOiAic2V0UHJvdG90eXBlIiwgbmFtZTogIl9fcHJvdG9fXyIsIG9iamVjdDogbywgb2xkVmFsdWU6IG4ucHJvdG8gfSksIG4ucHJvdG8gPSB2KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfSgpLAogICAgICAgICAgICB5ID0gZnVuY3Rpb24geSgpIHsKICAgICAgICAgIG8uc2l6ZSAmJiAoby5mb3JFYWNoKHYpLCBpLmZvckVhY2goXyksIHAoeSkpOwogICAgICAgIH0sCiAgICAgICAgICAgIF8gPSBmdW5jdGlvbiBfKGUsIHQpIHsKICAgICAgICAgIHZhciByID0gZS5jaGFuZ2VSZWNvcmRzO3IubGVuZ3RoICYmIChlLmNoYW5nZVJlY29yZHMgPSBbXSwgdChyKSk7CiAgICAgICAgfSwKICAgICAgICAgICAgZyA9IGZ1bmN0aW9uIGcoZSwgdCkgewogICAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyICYmICh0ID0gby5nZXQoZSkpLCB0ICYmIHQubm90aWZpZXIgfHwgeyBub3RpZnk6IGZ1bmN0aW9uIG5vdGlmeSh0KSB7CiAgICAgICAgICAgICAgdC50eXBlO3ZhciByID0gby5nZXQoZSk7aWYgKHIpIHsKICAgICAgICAgICAgICAgIHZhciBuLAogICAgICAgICAgICAgICAgICAgIGkgPSB7IG9iamVjdDogZSB9O2ZvciAobiBpbiB0KSB7CiAgICAgICAgICAgICAgICAgICJvYmplY3QiICE9PSBuICYmIChpW25dID0gdFtuXSk7CiAgICAgICAgICAgICAgICB9aihlLCByLCBpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHBlcmZvcm1DaGFuZ2U6IGZ1bmN0aW9uIHBlcmZvcm1DaGFuZ2UodCwgcikgewogICAgICAgICAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgdCkgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBub24tc3RyaW5nIGNoYW5nZVR5cGUiKTtpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgcikgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IHBlcmZvcm0gbm9uLWZ1bmN0aW9uIik7dmFyIGksCiAgICAgICAgICAgICAgICAgIHMsCiAgICAgICAgICAgICAgICAgIGEgPSBvLmdldChlKSwKICAgICAgICAgICAgICAgICAgYyA9IGFyZ3VtZW50c1syXSwKICAgICAgICAgICAgICAgICAgdSA9IGMgPT09IG4gPyByKCkgOiByLmNhbGwoYyk7aWYgKGEgJiYgdihhLCBlLCB0KSwgYSAmJiB1ICYmICJvYmplY3QiID09ICh0eXBlb2YgdSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YodSkpKSB7CiAgICAgICAgICAgICAgICBzID0geyBvYmplY3Q6IGUsIHR5cGU6IHQgfTtmb3IgKGkgaW4gdSkgewogICAgICAgICAgICAgICAgICAib2JqZWN0IiAhPT0gaSAmJiAidHlwZSIgIT09IGkgJiYgKHNbaV0gPSB1W2ldKTsKICAgICAgICAgICAgICAgIH1qKGUsIGEsIHMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSB9OwogICAgICAgIH0sCiAgICAgICAgICAgIG0gPSBmdW5jdGlvbiBtKGUsIHQsIHIsIG4pIHsKICAgICAgICAgIHZhciBvID0gaS5nZXQocik7byB8fCBpLnNldChyLCBvID0geyBvYnNlcnZlZDogdSgpLCBjaGFuZ2VSZWNvcmRzOiBbXSB9KSwgby5vYnNlcnZlZC5zZXQoZSwgeyBhY2NlcHRMaXN0OiBuLnNsaWNlKCksIGRhdGE6IHQgfSksIHQuaGFuZGxlcnMuc2V0KHIsIG8pOwogICAgICAgIH0sCiAgICAgICAgICAgIGogPSBmdW5jdGlvbiBqKGUsIHQsIHIsIG4pIHsKICAgICAgICAgIHQuaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgICB2YXIgbyA9IHQub2JzZXJ2ZWQuZ2V0KGUpLmFjY2VwdExpc3Q7KCJzdHJpbmciICE9IHR5cGVvZiBuIHx8IC0xID09PSBjKG8sIG4pKSAmJiBjKG8sIHIudHlwZSkgPiAtMSAmJiB0LmNoYW5nZVJlY29yZHMucHVzaChyKTsKICAgICAgICAgIH0pOwogICAgICAgIH07byA9IHUoKSwgaSA9IHUoKSwgZS5vYnNlcnZlID0gZnVuY3Rpb24gKHQsIHIsIG8pIHsKICAgICAgICAgIGlmICghdCB8fCAib2JqZWN0IiAhPSAodHlwZW9mIHQgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKHQpKSAmJiAiZnVuY3Rpb24iICE9IHR5cGVvZiB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3Qub2JzZXJ2ZSBjYW5ub3Qgb2JzZXJ2ZSBub24tb2JqZWN0Iik7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIHIpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBkZWxpdmVyIHRvIG5vbi1mdW5jdGlvbiIpO2lmIChlLmlzRnJvemVuICYmIGUuaXNGcm96ZW4ocikpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBkZWxpdmVyIHRvIGEgZnJvemVuIGZ1bmN0aW9uIG9iamVjdCIpO2lmIChvID09PSBuKSBvID0gcztlbHNlIGlmICghbyB8fCAib2JqZWN0IiAhPSAodHlwZW9mIG8gPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG8pKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhpcmQgYXJndW1lbnQgdG8gT2JqZWN0Lm9ic2VydmUgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzLiIpO3JldHVybiBiKHQsIHIsIG8pLCB0OwogICAgICAgIH0sIGUudW5vYnNlcnZlID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIGlmIChudWxsID09PSBlIHx8ICJvYmplY3QiICE9ICh0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSkpICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC51bm9ic2VydmUgY2Fubm90IHVub2JzZXJ2ZSBub24tb2JqZWN0Iik7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIHQpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC51bm9ic2VydmUgY2Fubm90IGRlbGl2ZXIgdG8gbm9uLWZ1bmN0aW9uIik7dmFyIHIsCiAgICAgICAgICAgICAgbiA9IGkuZ2V0KHQpO3JldHVybiBuICYmIChyID0gbi5vYnNlcnZlZC5nZXQoZSkpICYmIChuLm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgdihlLmRhdGEsIHQpOwogICAgICAgICAgfSksIHAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfKG4sIHQpOwogICAgICAgICAgfSksIDEgPT09IG4ub2JzZXJ2ZWQuc2l6ZSAmJiBuLm9ic2VydmVkLmhhcyhlKSA/IGlbImRlbGV0ZSJdKHQpIDogbi5vYnNlcnZlZFsiZGVsZXRlIl0oZSksIDEgPT09IHIuZGF0YS5oYW5kbGVycy5zaXplID8gb1siZGVsZXRlIl0oZSkgOiByLmRhdGEuaGFuZGxlcnNbImRlbGV0ZSJdKHQpKSwgZTsKICAgICAgICB9LCBlLmdldE5vdGlmaWVyID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIGlmIChudWxsID09PSB0IHx8ICJvYmplY3QiICE9ICh0eXBlb2YgdCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YodCkpICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIHQpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5nZXROb3RpZmllciBjYW5ub3QgZ2V0Tm90aWZpZXIgbm9uLW9iamVjdCIpO3JldHVybiBlLmlzRnJvemVuICYmIGUuaXNGcm96ZW4odCkgPyBudWxsIDogZyh0KTsKICAgICAgICB9LCBlLmRlbGl2ZXJDaGFuZ2VSZWNvcmRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3QuZGVsaXZlckNoYW5nZVJlY29yZHMgY2Fubm90IGRlbGl2ZXIgdG8gbm9uLWZ1bmN0aW9uIik7dmFyIHQgPSBpLmdldChlKTt0ICYmICh0Lm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgdihlLmRhdGEsIHQpOwogICAgICAgICAgfSksIF8odCwgZSkpOwogICAgICAgIH07CiAgICAgIH0oT2JqZWN0LCBBcnJheSwgdGhpcyk7CiAgICB9LCB7fV0sIDkyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pLCByLkRhdGFPYmplY3RPYnNlcnZlciA9IHIuRGF0YU9iamVjdFJlcG9ydGVyID0gci5TeW5jaGVyID0gdm9pZCAwLCBlKCJtdXRhdGlvbm9ic2VydmVyLXNoaW0iKSwgZSgib2JqZWN0Lm9ic2VydmUiKSwgZSgiYXJyYXkub2JzZXJ2ZSIpO3ZhciBvID0gZSgiLi9zeW5jaGVyL1N5bmNoZXIiKSwKICAgICAgICAgIGkgPSBuKG8pLAogICAgICAgICAgcyA9IGUoIi4vc3luY2hlci9EYXRhT2JqZWN0UmVwb3J0ZXIiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoIi4vc3luY2hlci9EYXRhT2JqZWN0T2JzZXJ2ZXIiKSwKICAgICAgICAgIHUgPSBuKGMpO3IuU3luY2hlciA9IGlbImRlZmF1bHQiXSwgci5EYXRhT2JqZWN0UmVwb3J0ZXIgPSBhWyJkZWZhdWx0Il0sIHIuRGF0YU9iamVjdE9ic2VydmVyID0gdVsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi9zeW5jaGVyL0RhdGFPYmplY3RPYnNlcnZlciI6IDk1LCAiLi9zeW5jaGVyL0RhdGFPYmplY3RSZXBvcnRlciI6IDk2LCAiLi9zeW5jaGVyL1N5bmNoZXIiOiA5OSwgImFycmF5Lm9ic2VydmUiOiAxLCAibXV0YXRpb25vYnNlcnZlci1zaGltIjogOTAsICJvYmplY3Qub2JzZXJ2ZSI6IDkxIH1dLCA5MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCIuL1N5bmNPYmplY3QiKSwKICAgICAgICAgIHAgPSBuKGQpLAogICAgICAgICAgYiA9IGUoIi4vRGF0YU9iamVjdENoaWxkIiksCiAgICAgICAgICBoID0gbihiKSwKICAgICAgICAgIHYgPSBlKCIuLi91dGlscy91dGlscy5qcyIpLAogICAgICAgICAgeSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiBlKHQsIHIsIG4sIG8sIGksIHMpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIGUpO3ZhciBhID0gdGhpczthLl9zeW5jaGVyID0gdCwgYS5fdXJsID0gciwgYS5fc2NoZW1hID0gbiwgYS5fc3RhdHVzID0gbywgYS5fc3luY09iaiA9IG5ldyBwWyJkZWZhdWx0Il0oaSksIGEuX2NoaWxkcmVucyA9IHMsIGEuX3ZlcnNpb24gPSAwLCBhLl9jaGlsZElkID0gMCwgYS5fY2hpbGRyZW5PYmplY3RzID0ge30sIGEuX2NoaWxkcmVuTGlzdGVuZXJzID0gW10sIGEuX293bmVyID0gdC5fb3duZXIsIGEuX2J1cyA9IHQuX2J1czsKICAgICAgICB9cmV0dXJuICgwLCBmWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzLAogICAgICAgICAgICAgICAgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gdC5fdXJsICsgIi9jaGlsZHJlbi8iO3QuX2NoaWxkcmVucyAmJiB0Ll9jaGlsZHJlbnMuZm9yRWFjaChmdW5jdGlvbiAobikgewogICAgICAgICAgICAgIHZhciBvID0gciArIG4sCiAgICAgICAgICAgICAgICAgIGkgPSB0Ll9idXMuYWRkTGlzdGVuZXIobywgZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICAgIGlmIChyLmZyb20gIT09IGUuX293bmVyKSBzd2l0Y2ggKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0LUNoaWxkcmVuLVJDVjogIiwgciksIHIudHlwZSkge2Nhc2UgImNyZWF0ZSI6CiAgICAgICAgICAgICAgICAgICAgdC5fb25DaGlsZENyZWF0ZShyKTticmVhaztjYXNlICJkZWxldGUiOgogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHIpO2JyZWFrO2RlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgdC5fY2hhbmdlQ2hpbGRyZW4ocik7fQogICAgICAgICAgICAgIH0pO3QuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2goaSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXM7ZS5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGUucmVtb3ZlKCk7CiAgICAgICAgICAgIH0pLCAoMCwgYVsiZGVmYXVsdCJdKShlLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlLl9jaGlsZHJlbk9iamVjdHNbdF0uX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAicGF1c2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHRocm93ICJOb3QgaW1wbGVtZW50ZWQiOwogICAgICAgICAgfSB9LCB7IGtleTogInJlc3VtZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdGhyb3cgIk5vdCBpbXBsZW1lbnRlZCI7CiAgICAgICAgICB9IH0sIHsga2V5OiAic3RvcCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdGhyb3cgIk5vdCBpbXBsZW1lbnRlZCI7CiAgICAgICAgICB9IH0sIHsga2V5OiAiYWRkQ2hpbGQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7ci5fY2hpbGRJZCsrO3ZhciBuID0gci5fb3duZXIgKyAiIyIgKyByLl9jaGlsZElkLAogICAgICAgICAgICAgICAgbyA9IHIuX3VybCArICIvY2hpbGRyZW4vIiArIGUsCiAgICAgICAgICAgICAgICBzID0geyB0eXBlOiAiY3JlYXRlIiwgZnJvbTogci5fb3duZXIsIHRvOiBvLCBib2R5OiB7IHJlc291cmNlOiBuLCB2YWx1ZTogdCB9IH07cmV0dXJuIG5ldyBpWyJkZWZhdWx0Il0oZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB2YXIgaSA9IHIuX2J1cy5wb3N0TWVzc2FnZShzKTtjb25zb2xlLmxvZygiY3JlYXRlLXJlcG9ydGVyLWNoaWxkKCAiICsgci5fb3duZXIgKyAiICk6ICIsIHMpO3ZhciBhID0gbmV3IGhbImRlZmF1bHQiXShyLCBuLCB0LCByLl9vd25lciwgaSk7YS5vbkNoYW5nZShmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgci5fb25DaGFuZ2UoZSwgeyBwYXRoOiBvLCBjaGlsZElkOiBuIH0pOwogICAgICAgICAgICAgIH0pLCByLl9jaGlsZHJlbk9iamVjdHNbbl0gPSBhLCBlKGEpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvbkFkZENoaWxkIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoaWxkQ3JlYXRlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IGUuYm9keS5yZXNvdXJjZTtjb25zb2xlLmxvZygiY3JlYXRlLW9ic2VydmVyLWNoaWxkKCAiICsgdC5fb3duZXIgKyAiICk6ICIsIGUpO3ZhciBuID0gbmV3IGhbImRlZmF1bHQiXSh0LCByLCBlLmJvZHkudmFsdWUpO3QuX2NoaWxkcmVuT2JqZWN0c1tyXSA9IG4sIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IDIwMCwgc291cmNlOiB0Ll9vd25lciB9IH0pOwogICAgICAgICAgICB9KTt2YXIgbyA9IHsgdHlwZTogZS50eXBlLCBmcm9tOiBlLmZyb20sIHVybDogZS50bywgdmFsdWU6IGUuYm9keS52YWx1ZSwgY2hpbGRJZDogciwgaWRlbnRpdHk6IGUuYm9keS5pZGVudGl0eSB9O3QuX29uQWRkQ2hpbGRyZW5IYW5kbGVyICYmIChjb25zb2xlLmxvZygiQURELUNISUxEUkVOLUVWRU5UOiAiLCBvKSwgdC5fb25BZGRDaGlsZHJlbkhhbmRsZXIobykpOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoYW5nZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gdGhpcztpZiAoci5fdmVyc2lvbisrLCAib24iID09PSByLl9zdGF0dXMpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHsgdHlwZTogInVwZGF0ZSIsIGZyb206IHIuX3VybCwgdG86IHIuX3VybCArICIvY2hhbmdlcyIsIGJvZHk6IHsgdmVyc2lvbjogci5fdmVyc2lvbiwgc291cmNlOiByLl9vd25lciwgYXR0cmlidXRlOiBlLmZpZWxkIH0gfTtlLm9UeXBlID09PSBkLk9iamVjdFR5cGUuT0JKRUNUID8gZS5jVHlwZSAhPT0gZC5DaGFuZ2VUeXBlLlJFTU9WRSAmJiAobi5ib2R5LnZhbHVlID0gZS5kYXRhKSA6IChuLmJvZHkuYXR0cmlidXRlVHlwZSA9IGUub1R5cGUsIG4uYm9keS52YWx1ZSA9IGUuZGF0YSwgZS5jVHlwZSAhPT0gZC5DaGFuZ2VUeXBlLlVQREFURSAmJiAobi5ib2R5Lm9wZXJhdGlvbiA9IGUuY1R5cGUpKSwgdCAmJiAobi50byA9IHQucGF0aCwgbi5ib2R5LnJlc291cmNlID0gdC5jaGlsZElkKSwgci5fYnVzLnBvc3RNZXNzYWdlKG4pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IH0sIHsga2V5OiAiX2NoYW5nZU9iamVjdCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gdGhpcztpZiAoci5fdmVyc2lvbiArIDEgPT09IHQuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgICAgICAgci5fdmVyc2lvbisrO3ZhciBuID0gdC5ib2R5LmF0dHJpYnV0ZSwKICAgICAgICAgICAgICAgICAgbyA9ICgwLCB2LmRlZXBDbG9uZSkodC5ib2R5LnZhbHVlKSwKICAgICAgICAgICAgICAgICAgaSA9IGUuZmluZEJlZm9yZShuKTtpZiAodC5ib2R5LmF0dHJpYnV0ZVR5cGUgPT09IGQuT2JqZWN0VHlwZS5BUlJBWSkgewogICAgICAgICAgICAgICAgaWYgKHQuYm9keS5vcGVyYXRpb24gPT09IGQuQ2hhbmdlVHlwZS5BREQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHMgPSBpLm9iaiwKICAgICAgICAgICAgICAgICAgICAgIGEgPSBpLmxhc3Q7QXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShzLCBbYSwgMF0uY29uY2F0KG8pKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5ib2R5Lm9wZXJhdGlvbiA9PT0gZC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICAgICAgICB2YXIgYyA9IGkub2JqLAogICAgICAgICAgICAgICAgICAgICAgdSA9IGkubGFzdDtjLnNwbGljZSh1LCBvKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpLm9ialtpLmxhc3RdID0gbzsKICAgICAgICAgICAgICB9IGVsc2UgdC5ib2R5LnZhbHVlID8gaS5vYmpbaS5sYXN0XSA9IG8gOiBkZWxldGUgaS5vYmpbaS5sYXN0XTsKICAgICAgICAgICAgfSBlbHNlIGNvbnNvbGUubG9nKCJVTlNZTkNIUk9OSVpFRCBWRVJTSU9OOiAoZGF0YSA9PiAiICsgci5fdmVyc2lvbiArICIsIG1zZyA9PiAiICsgdC5ib2R5LnZlcnNpb24gKyAiKSIpOwogICAgICAgICAgfSB9LCB7IGtleTogIl9jaGFuZ2VDaGlsZHJlbiIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcztjb25zb2xlLmxvZygiQ2hhbmdlIGNoaWxkcmVuOiAiLCB0Ll9vd25lciwgZSk7dmFyIHIgPSBlLmJvZHkucmVzb3VyY2UsCiAgICAgICAgICAgICAgICBuID0gdC5fY2hpbGRyZW5PYmplY3RzW3JdO24gPyB0Ll9jaGFuZ2VPYmplY3Qobi5fc3luY09iaiwgZSkgOiBjb25zb2xlLmxvZygiTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAiLCByKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJ1cmwiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzY2hlbWEiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtYTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzdGF0dXMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1czsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkYXRhIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICAgICAgICB9IH0sIHsga2V5OiAiY2hpbGRyZW5zIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpO3JbImRlZmF1bHQiXSA9IHksIHQuZXhwb3J0cyA9IHJbImRlZmF1bHQiXTsKICAgIH0sIHsgIi4uL3V0aWxzL3V0aWxzLmpzIjogMTAwLCAiLi9EYXRhT2JqZWN0Q2hpbGQiOiA5NCwgIi4vU3luY09iamVjdCI6IDk4LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjogNywgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIjogOSwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDExLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjogMTIgfV0sIDk0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBvID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoIi4vU3luY09iamVjdCIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCwgciwgbiwgbywgcykgewogICAgICAgICAgKDAsIGlbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIGEgPSB0aGlzO2EuX3BhcmVudCA9IHQsIGEuX2NoaWxkSWQgPSByLCBhLl9vd25lciA9IG8sIGEuX21zZ0lkID0gcywgYS5fc3luY09iaiA9IG5ldyB1WyJkZWZhdWx0Il0obiksIGEuX2J1cyA9IHQuX2J1cywgYS5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX293bmVyICYmIChlLl9saXN0ZW5lciA9IGUuX2J1cy5hZGRMaXN0ZW5lcihlLl9vd25lciwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAicmVzcG9uc2UiID09PSB0LnR5cGUgJiYgdC5pZCA9PT0gZS5fbXNnSWQgJiYgKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZToiLCB0KSwgZS5fb25SZXNwb25zZSh0KSk7CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfcmVsZWFzZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX2xpc3RlbmVyICYmIGUuX2xpc3RlbmVyLnJlbW92ZSgpOwogICAgICAgICAgfSB9LCB7IGtleTogImRlbGV0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2RlbGV0ZSBlLl9wYXJlbnQuX2NoaWxkcmVuW2UuX2NoaWxkSWRdLCBlLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICB9IH0sIHsga2V5OiAib25DaGFuZ2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlKHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvblJlc3BvbnNlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vblJlc3BvbnNlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHsgdHlwZTogZS50eXBlLCB1cmw6IGUuYm9keS5zb3VyY2UsIGNvZGU6IGUuYm9keS5jb2RlIH07dC5fb25SZXNwb25zZUhhbmRsZXIgJiYgdC5fb25SZXNwb25zZUhhbmRsZXIocik7CiAgICAgICAgICB9IH0sIHsga2V5OiAiY2hpbGRJZCIsIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkYXRhIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpO3JbImRlZmF1bHQiXSA9IGwsIHQuZXhwb3J0cyA9IHJbImRlZmF1bHQiXTsKICAgIH0sIHsgIi4vU3luY09iamVjdCI6IDk4LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiKSwKICAgICAgICAgIGkgPSBuKG8pLAogICAgICAgICAgcyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiIpLAogICAgICAgICAgYSA9IG4ocyksCiAgICAgICAgICBjID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICB1ID0gbihjKSwKICAgICAgICAgIGwgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGYgPSBuKGwpLAogICAgICAgICAgZCA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiksCiAgICAgICAgICBwID0gbihkKSwKICAgICAgICAgIGIgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IiksCiAgICAgICAgICBoID0gbihiKSwKICAgICAgICAgIHYgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiKSwKICAgICAgICAgIHkgPSBuKHYpLAogICAgICAgICAgXyA9IGUoIi4vRGF0YU9iamVjdCIpLAogICAgICAgICAgZyA9IG4oXyksCiAgICAgICAgICBtID0gZSgiLi9EYXRhT2JqZWN0Q2hpbGQiKSwKICAgICAgICAgIGogPSBuKG0pLAogICAgICAgICAgJCA9IHsgQU5ZOiAiYW55IiwgU1RBUlQ6ICJzdGFydCIsIEVYQUNUOiAiZXhhY3QiIH0sCiAgICAgICAgICBPID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBmdW5jdGlvbiB0KGUsIHIsIG4sIG8sIHMsIGMsIGwpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIHQpO3ZhciBmID0gKDAsIHBbImRlZmF1bHQiXSkodGhpcywgKDAsIGFbImRlZmF1bHQiXSkodCkuY2FsbCh0aGlzLCBlLCByLCBuLCBvLCBzLmRhdGEsIGMpKSwKICAgICAgICAgICAgICBkID0gZjtyZXR1cm4gZC5fdmVyc2lvbiA9IGwsIGQuX2ZpbHRlcnMgPSB7fSwgZC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGQuX29uRmlsdGVyKGUpOwogICAgICAgICAgfSksICgwLCBpWyJkZWZhdWx0Il0pKHMuY2hpbGRyZW5zKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHZhciB0ID0gcy5jaGlsZHJlbnNbZV07ZC5fY2hpbGRyZW5PYmplY3RzW2VdID0gbmV3IGpbImRlZmF1bHQiXShkLCBlLCB0KTsKICAgICAgICAgIH0pLCBkLl9hbGxvY2F0ZUxpc3RlbmVycygpLCBmOwogICAgICAgIH1yZXR1cm4gKDAsIHlbImRlZmF1bHQiXSkodCwgZSksICgwLCBmWyJkZWZhdWx0Il0pKHQsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgKDAsIGhbImRlZmF1bHQiXSkoKDAsIGFbImRlZmF1bHQiXSkodC5wcm90b3R5cGUpLCAiX2FsbG9jYXRlTGlzdGVuZXJzIiwgdGhpcykuY2FsbCh0aGlzKTt2YXIgZSA9IHRoaXM7ZS5fY2hhbmdlTGlzdGVuZXIgPSBlLl9idXMuYWRkTGlzdGVuZXIoZS5fdXJsICsgIi9jaGFuZ2VzIiwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAidXBkYXRlIiA9PT0gdC50eXBlICYmIChjb25zb2xlLmxvZygiRGF0YU9iamVjdE9ic2VydmVyLSIgKyBlLl91cmwgKyAiLVJDVjogIiwgdCksIGUuX2NoYW5nZU9iamVjdChlLl9zeW5jT2JqLCB0KSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICAoMCwgaFsiZGVmYXVsdCJdKSgoMCwgYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksICJfcmVsZWFzZUxpc3RlbmVycyIsIHRoaXMpLmNhbGwodGhpcyk7dmFyIGUgPSB0aGlzO2UuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgICAgICAgfSB9LCB7IGtleTogImRlbGV0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX3JlbGVhc2VMaXN0ZW5lcnMoKSwgZGVsZXRlIGUuX3N5bmNoZXIuX29ic2VydmVyc1tlLl91cmxdOwogICAgICAgICAgfSB9LCB7IGtleTogInVuc3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMsCiAgICAgICAgICAgICAgICB0ID0geyB0eXBlOiAidW5zdWJzY3JpYmUiLCBmcm9tOiBlLl9vd25lciwgdG86IGUuX3N5bmNoZXIuX3N1YlVSTCwgYm9keTogeyByZXNvdXJjZTogZS5fdXJsIH0gfTtlLl9idXMucG9zdE1lc3NhZ2UodCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAiLCB0KSwgMjAwID09PSB0LmJvZHkuY29kZSAmJiAoZS5fcmVsZWFzZUxpc3RlbmVycygpLCBkZWxldGUgZS5fc3luY2hlci5fb2JzZXJ2ZXJzW2UuX3VybF0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvbkNoYW5nZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gZSwKICAgICAgICAgICAgICAgIG4gPSB7IHR5cGU6ICQuRVhBQ1QsIGNhbGxiYWNrOiB0IH0sCiAgICAgICAgICAgICAgICBvID0gZS5pbmRleE9mKCIqIik7byA9PT0gZS5sZW5ndGggLSAxICYmICgwID09PSBvID8gbi50eXBlID0gJC5BTlkgOiAobi50eXBlID0gJC5TVEFSVCwgciA9IGUuc3Vic3RyKDAsIGUubGVuZ3RoIC0gMSkpKSwgdGhpcy5fZmlsdGVyc1tyXSA9IG47CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uRmlsdGVyIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzOygwLCBpWyJkZWZhdWx0Il0pKHQuX2ZpbHRlcnMpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHQuX2ZpbHRlcnNbcl07bi50eXBlID09PSAkLkFOWSA/IG4uY2FsbGJhY2soZSkgOiBuLnR5cGUgPT09ICQuU1RBUlQgPyAwID09PSBlLmZpZWxkLmluZGV4T2YocikgJiYgbi5jYWxsYmFjayhlKSA6IG4udHlwZSA9PT0gJC5FWEFDVCAmJiBlLmZpZWxkID09PSByICYmIG4uY2FsbGJhY2soZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9XSksIHQ7CiAgICAgIH0oZ1siZGVmYXVsdCJdKTtyWyJkZWZhdWx0Il0gPSBPLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuL0RhdGFPYmplY3QiOiA5MywgIi4vRGF0YU9iamVjdENoaWxkIjogOTQsICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiOiA2LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjogNywgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDExLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjogMTIsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IjogMTMsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiOiAxNCwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjogMTUgfV0sIDk2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBvID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIpLAogICAgICAgICAgcCA9IG4oZCksCiAgICAgICAgICBiID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2dldCIpLAogICAgICAgICAgaCA9IG4oYiksCiAgICAgICAgICB2ID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIiksCiAgICAgICAgICB5ID0gbih2KSwKICAgICAgICAgIF8gPSBlKCIuL0RhdGFPYmplY3QiKSwKICAgICAgICAgIGcgPSBuKF8pLAogICAgICAgICAgbSA9IGUoIi4uL3V0aWxzL3V0aWxzLmpzIiksCiAgICAgICAgICBqID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBmdW5jdGlvbiB0KGUsIHIsIG4sIG8sIGksIHMpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIHQpO3ZhciBjID0gKDAsIHBbImRlZmF1bHQiXSkodGhpcywgKDAsIGFbImRlZmF1bHQiXSkodCkuY2FsbCh0aGlzLCBlLCByLCBuLCBvLCBpLCBzKSksCiAgICAgICAgICAgICAgbCA9IGM7cmV0dXJuIGwuX3N1YnNjcmlwdGlvbnMgPSB7fSwgbC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItIiArIHIgKyAiLVNFTkQ6ICIsIGUpLCBsLl9vbkNoYW5nZShlKTsKICAgICAgICAgIH0pLCBsLl9hbGxvY2F0ZUxpc3RlbmVycygpLCBjOwogICAgICAgIH1yZXR1cm4gKDAsIHlbImRlZmF1bHQiXSkodCwgZSksICgwLCBmWyJkZWZhdWx0Il0pKHQsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgKDAsIGhbImRlZmF1bHQiXSkoKDAsIGFbImRlZmF1bHQiXSkodC5wcm90b3R5cGUpLCAiX2FsbG9jYXRlTGlzdGVuZXJzIiwgdGhpcykuY2FsbCh0aGlzKTt2YXIgZSA9IHRoaXM7ZS5fcmVzcG9uc2VMaXN0ZW5lciA9IGUuX2J1cy5hZGRMaXN0ZW5lcihlLl91cmwsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgInJlc3BvbnNlIiA9PT0gdC50eXBlICYmIGUuX29uUmVzcG9uc2UodCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICAoMCwgaFsiZGVmYXVsdCJdKSgoMCwgYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksICJfcmVsZWFzZUxpc3RlbmVycyIsIHRoaXMpLmNhbGwodGhpcyk7dmFyIGUgPSB0aGlzO2UuX3Jlc3BvbnNlTGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiaW52aXRlT2JzZXJ2ZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHsgdHlwZTogImNyZWF0ZSIsIGZyb206IHQuX3N5bmNoZXIuX293bmVyLCB0bzogdC5fc3luY2hlci5fc3ViVVJMLCBib2R5OiB7IHJlc291cmNlOiB0Ll91cmwsIHNjaGVtYTogdC5fc2NoZW1hLCB2YWx1ZTogdC5fc3luY09iai5kYXRhLCBhdXRob3Jpc2U6IGUgfSB9O3QuX2J1cy5wb3N0TWVzc2FnZShyKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkZWxldGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpcywKICAgICAgICAgICAgICAgIHQgPSB7IHR5cGU6ICJkZWxldGUiLCBmcm9tOiBlLl9vd25lciwgdG86IGUuX3N5bmNoZXIuX3N1YlVSTCwgYm9keTogeyByZXNvdXJjZTogZS5fdXJsIH0gfTtlLl9idXMucG9zdE1lc3NhZ2UodCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YU9iamVjdFJlcG9ydGVyLURFTEVURTogIiwgdCksIDIwMCA9PT0gdC5ib2R5LmNvZGUgJiYgKGUuX3JlbGVhc2VMaXN0ZW5lcnMoKSwgZGVsZXRlIGUuX3N5bmNoZXIuX3JlcG9ydGVyc1tlLl91cmxdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAib25TdWJzY3JpcHRpb24iLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIm9uUmVzcG9uc2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGU7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uRm9yd2FyZCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcztzd2l0Y2ggKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItUkNWOiAiLCBlKSwgZS5ib2R5LnR5cGUpIHtjYXNlICJzdWJzY3JpYmUiOgogICAgICAgICAgICAgICAgdC5fb25TdWJzY3JpYmUoZSk7YnJlYWs7Y2FzZSAidW5zdWJzY3JpYmUiOgogICAgICAgICAgICAgICAgdC5fb25VblN1YnNjcmliZShlKTt9CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uU3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IGUuYm9keS5mcm9tLAogICAgICAgICAgICAgICAgbiA9IHsgdHlwZTogZS5ib2R5LnR5cGUsIHVybDogciwgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHsgdXJsOiByLCBzdGF0dXM6ICJvbiIgfTt0Ll9zdWJzY3JpcHRpb25zW3JdID0gbjt2YXIgbyA9IHt9O3JldHVybiAoMCwgaVsiZGVmYXVsdCJdKSh0Ll9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgdmFyIHIgPSB0Ll9jaGlsZHJlbk9iamVjdHNbZV0uZGF0YTtvW2VdID0gKDAsIG0uZGVlcENsb25lKShyKTsKICAgICAgICAgICAgICAgIH0pLCB0Ll9idXMucG9zdE1lc3NhZ2UoeyBpZDogZS5pZCwgdHlwZTogInJlc3BvbnNlIiwgZnJvbTogZS50bywgdG86IGUuZnJvbSwgYm9keTogeyBjb2RlOiAyMDAsIHNjaGVtYTogdC5fc2NoZW1hLCB2ZXJzaW9uOiB0Ll92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgbS5kZWVwQ2xvbmUpKHQuZGF0YSksIGNoaWxkcmVuczogbyB9IH0gfSksIG47CiAgICAgICAgICAgICAgfSwgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocikgewogICAgICAgICAgICAgICAgdC5fYnVzLnBvc3RNZXNzYWdlKHsgaWQ6IGUuaWQsIHR5cGU6ICJyZXNwb25zZSIsIGZyb206IGUudG8sIHRvOiBlLmZyb20sIGJvZHk6IHsgY29kZTogNDAzLCBkZXNjOiByIH0gfSk7CiAgICAgICAgICAgICAgfSB9O3QuX29uU3Vic2NyaXB0aW9uSGFuZGxlciAmJiAoY29uc29sZS5sb2coIlNVQlNDUklQVElPTi1FVkVOVDogIiwgbiksIHQuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihuKSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uVW5TdWJzY3JpYmUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5ib2R5LmZyb20sCiAgICAgICAgICAgICAgICBuID0gdC5fc3Vic2NyaXB0aW9uc1tyXTtkZWxldGUgdC5fc3Vic2NyaXB0aW9uc1tyXTt2YXIgbyA9IHsgdHlwZTogZS5ib2R5LnR5cGUsIHVybDogciwgb2JqZWN0OiBuIH07dC5fb25TdWJzY3JpcHRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAiLCBvKSwgdC5fb25TdWJzY3JpcHRpb25IYW5kbGVyKG8pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZXNwb25zZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcywKICAgICAgICAgICAgICAgIHIgPSB7IHR5cGU6IGUudHlwZSwgdXJsOiBlLmZyb20sIGNvZGU6IGUuYm9keS5jb2RlIH07dC5fb25SZXNwb25zZUhhbmRsZXIgJiYgKGNvbnNvbGUubG9nKCJSRVNQT05TRS1FVkVOVDogIiwgciksIHQuX29uUmVzcG9uc2VIYW5kbGVyKHIpKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzdWJzY3JpcHRpb25zIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgICAgICAgfSB9XSksIHQ7CiAgICAgIH0oZ1siZGVmYXVsdCJdKTtyWyJkZWZhdWx0Il0gPSBqLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuLi91dGlscy91dGlscy5qcyI6IDEwMCwgIi4vRGF0YU9iamVjdCI6IDkzLCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjogNiwgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cyI6IDcsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOiAxMSwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI6IDEyLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2dldCI6IDEzLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIjogMTQsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI6IDE1IH1dLCA5NzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZSh0LCByLCBuLCBvKSB7CiAgICAgICAgICAoMCwgaVsiZGVmYXVsdCJdKSh0aGlzLCBlKTt2YXIgcyA9IHRoaXM7cy5fb3duZXIgPSB0LCBzLl91cmwgPSByLCBzLl9idXMgPSBuLCBzLl9jaGlsZHJlbiA9IG8sIHMuX2NoYW5nZXMgPSBbXSwgcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX2xpc3RlbmVyID0gZS5fYnVzLmFkZExpc3RlbmVyKGUuX3VybCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YVByb3Zpc2lvbmFsLSIgKyBlLl91cmwgKyAiLVJDVjogIiwgdCksIGUuX2NoYW5nZXMucHVzaCh0KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX3JlbGVhc2VMaXN0ZW5lcnMiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpcztlLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJhcHBseSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpczt0Ll9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlLl9jaGFuZ2VPYmplY3QoZS5fc3luY09iaiwgdCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogImNoaWxkcmVuIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gYywgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSksIHIuT2JqZWN0VHlwZSA9IHIuQ2hhbmdlVHlwZSA9IHZvaWQgMDt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cyIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIHUgPSBuKGMpLAogICAgICAgICAgbCA9IGUoIi4uL3V0aWxzL3V0aWxzLmpzIiksCiAgICAgICAgICBmID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCkgewogICAgICAgICAgKDAsIGFbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIHIgPSB0aGlzO3IuX29ic2VydmVycyA9IFtdLCByLl9maWx0ZXJzID0ge30sIHQgPyByLl9kYXRhID0gKDAsIGwuZGVlcENsb25lKSh0KSA6IHIuX2RhdGEgPSB7fSwgci5faW50ZXJuYWxPYnNlcnZlKG5ldyBkKCksIHIuX2RhdGEpOwogICAgICAgIH1yZXR1cm4gKDAsIHVbImRlZmF1bHQiXSkoZSwgW3sga2V5OiAib2JzZXJ2ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHRoaXMuX29ic2VydmVycy5wdXNoKGUpOwogICAgICAgICAgfSB9LCB7IGtleTogImZpbmQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IGUuc3BsaXQoIi4iKTtyZXR1cm4gdGhpcy5fZmluZFdpdGhTcGxpdCh0KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJmaW5kQmVmb3JlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB7fSwKICAgICAgICAgICAgICAgIHIgPSBlLnNwbGl0KCIuIik7cmV0dXJuIHQubGFzdCA9IHIucG9wKCksIHQub2JqID0gdGhpcy5fZmluZFdpdGhTcGxpdChyKSwgdDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfZmluZFdpdGhTcGxpdCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcy5fZGF0YTtyZXR1cm4gZS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgdCA9IHRbZV07CiAgICAgICAgICAgIH0pLCB0OwogICAgICAgICAgfSB9LCB7IGtleTogIl9maXJlRXZlbnQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vYnNlcnZlcnMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHQoZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9pc09ic2VydmFibGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICByZXR1cm4gZS5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0IHx8IGUuY29uc3RydWN0b3IgPT09IEFycmF5OwogICAgICAgICAgfSB9LCB7IGtleTogIl9pbnRlcm5hbE9ic2VydmUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7aWYgKHIuX2lzT2JzZXJ2YWJsZSh0KSkgewogICAgICAgICAgICAgIHZhciBuID0gZnVuY3Rpb24gbih0KSB7CiAgICAgICAgICAgICAgICByLl9vbkNoYW5nZXMoZSwgdCk7CiAgICAgICAgICAgICAgfTtpZiAodC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgICAgICAgICBPYmplY3Qub2JzZXJ2ZSh0LCBuKTtmb3IgKHZhciBvIGluIHQpIHsKICAgICAgICAgICAgICAgICAgci5faXNPYnNlcnZhYmxlKHRbb10pICYmIHIuX2ludGVybmFsT2JzZXJ2ZShlWyJuZXciXShvKSwgdFtvXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgICAgICAgICAgQXJyYXkub2JzZXJ2ZSh0LCBuKTtmb3IgKHZhciBpIGluIHQpIHsKICAgICAgICAgICAgICAgICAgaWYgKHIuX2lzT2JzZXJ2YWJsZSh0W2ldKSkgewogICAgICAgICAgICAgICAgICAgIHZhciBzID0gZVsibmV3Il0obmV3IHAodFtpXSwgaSkpO3IuX2ludGVybmFsT2JzZXJ2ZShzLCB0W2ldKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoYW5nZXMiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7Zm9yICh2YXIgbiBpbiB0KSB7CiAgICAgICAgICAgICAgdmFyIG8gPSB0W25dLm9iamVjdCwKICAgICAgICAgICAgICAgICAgaSA9IHZvaWQgMDtpZiAoby5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0ICYmIChpID0gaC5PQkpFQ1QpLCBvLmNvbnN0cnVjdG9yID09PSBBcnJheSAmJiAoaSA9IGguQVJSQVkpLCAic3BsaWNlIiA9PT0gdFtuXS50eXBlKSAhZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIHMgPSB0W25dLmluZGV4LAogICAgICAgICAgICAgICAgICAgIGEgPSBlWyJuZXciXSgiIiArIHMpLAogICAgICAgICAgICAgICAgICAgIGMgPSBhLnRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICAgICAgdSA9IHRbbl0ucmVtb3ZlZC5sZW5ndGg7aWYgKDAgIT09IHUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGYgPSB0W25dLnJlbW92ZWQ7Zi5mb3JFYWNoKGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgICAgICAgci5faXNPYnNlcnZhYmxlKHQpICYmIGUucmVtb3ZlSW5kZXgocyArIG4pOwogICAgICAgICAgICAgICAgICB9KSwgci5fZmlyZUV2ZW50KHsgY1R5cGU6IGIuUkVNT1ZFLCBvVHlwZTogaSwgZmllbGQ6IGMsIGRhdGE6IHUgfSk7CiAgICAgICAgICAgICAgICB9dmFyIGQgPSB0W25dLmFkZGVkQ291bnQ7aWYgKDAgIT09IGQpIHsKICAgICAgICAgICAgICAgICAgdmFyIGggPSBvLnNsaWNlKHMsIHMgKyBkKTtoLmZvckVhY2goZnVuY3Rpb24gKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoci5faXNPYnNlcnZhYmxlKHQpKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IGVbIm5ldyJdKG5ldyBwKHQsIHMgKyBuKSk7ci5faW50ZXJuYWxPYnNlcnZlKG8sIHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSksIHIuX2ZpcmVFdmVudCh7IGNUeXBlOiBiLkFERCwgb1R5cGU6IGksIGZpZWxkOiBjLCBkYXRhOiAoMCwgbC5kZWVwQ2xvbmUpKGgpIH0pOwogICAgICAgICAgICAgICAgfXMgIT09IG8ubGVuZ3RoIC0gMSAmJiBlLnJlSW5kZXhGcm9tKG8pOwogICAgICAgICAgICAgIH0oKTtlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBzID0gZVsibmV3Il0odFtuXS5uYW1lKSwKICAgICAgICAgICAgICAgICAgICBhID0gcy50b1N0cmluZygpO2lmICgtMSAhPT0gYS5pbmRleE9mKCJTeW1ib2wiKSkgY29udGludWU7dmFyIGMgPSBvW3Rbbl0ubmFtZV07InVwZGF0ZSIgPT09IHRbbl0udHlwZSAmJiB0aGlzLl9maXJlRXZlbnQoeyBjVHlwZTogYi5VUERBVEUsIG9UeXBlOiBpLCBmaWVsZDogYSwgZGF0YTogKDAsIGwuZGVlcENsb25lKShjKSB9KSwgImFkZCIgPT09IHRbbl0udHlwZSAmJiAodGhpcy5faW50ZXJuYWxPYnNlcnZlKHMsIGMpLCB0aGlzLl9maXJlRXZlbnQoeyBjVHlwZTogYi5BREQsIG9UeXBlOiBpLCBmaWVsZDogYSwgZGF0YTogKDAsIGwuZGVlcENsb25lKShjKSB9KSksICJkZWxldGUiID09PSB0W25dLnR5cGUgJiYgdGhpcy5fZmlyZUV2ZW50KHsgY1R5cGU6IGIuUkVNT1ZFLCBvVHlwZTogaSwgZmllbGQ6IGEgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IH0sIHsga2V5OiAiZGF0YSIsIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCksCiAgICAgICAgICBkID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUoKSB7CiAgICAgICAgICAoMCwgYVsiZGVmYXVsdCJdKSh0aGlzLCBlKSwgdGhpcy5fcGF0aCA9IFtdLCB0aGlzLl9vYnNlcnZhYmxlcyA9IHt9OwogICAgICAgIH1yZXR1cm4gKDAsIHVbImRlZmF1bHQiXSkoZSwgW3sga2V5OiAicmVtb3ZlSW5kZXgiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICBkZWxldGUgdGhpcy5fb2JzZXJ2YWJsZXNbZV07CiAgICAgICAgICB9IH0sIHsga2V5OiAicmVJbmRleEZyb20iLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXM7KDAsIGlbImRlZmF1bHQiXSkodGhpcy5fb2JzZXJ2YWJsZXMpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHQuX29ic2VydmFibGVzW3JdLAogICAgICAgICAgICAgICAgICBvID0gZS5pbmRleE9mKG4ub2JqKTtuLmlkeCAhPSBvICYmIChuLmlkeCA9IG8sIGRlbGV0ZSB0Ll9vYnNlcnZhYmxlc1tyXSwgdC5fb2JzZXJ2YWJsZXNbb10gPSBuKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAibmV3IiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgZS5jb25zdHJ1Y3RvciA9PSBwICYmICh0aGlzLl9vYnNlcnZhYmxlc1tlLmlkeF0gPSBlKTt2YXIgdCA9IHRoaXMuY2xvbmUoKTtyZXR1cm4gdC5fcGF0aC5wdXNoKGUpLCB0OwogICAgICAgICAgfSB9LCB7IGtleTogImNsb25lIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgdCA9IG5ldyBlKCk7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHQuX3BhdGgucHVzaChlKTsKICAgICAgICAgICAgfSksIHQ7CiAgICAgICAgICB9IH0sIHsga2V5OiAidG9TdHJpbmciLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gIiI7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbiAodCwgcikgewogICAgICAgICAgICAgIDAgPT09IHIgPyBlID0gdC50b1N0cmluZygpIDogZSArPSAiLiIgKyB0LnRvU3RyaW5nKCk7CiAgICAgICAgICAgIH0pLCBlOwogICAgICAgICAgfSB9XSksIGU7CiAgICAgIH0oKSwKICAgICAgICAgIHAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZSh0LCByKSB7CiAgICAgICAgICAoMCwgYVsiZGVmYXVsdCJdKSh0aGlzLCBlKSwgdGhpcy5vYmogPSB0LCB0aGlzLmlkeCA9IHI7CiAgICAgICAgfXJldHVybiAoMCwgdVsiZGVmYXVsdCJdKShlLCBbeyBrZXk6ICJ0b1N0cmluZyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuaWR4LnRvU3RyaW5nKCk7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpLAogICAgICAgICAgYiA9IHIuQ2hhbmdlVHlwZSA9IHsgVVBEQVRFOiAidXBkYXRlIiwgQUREOiAiYWRkIiwgUkVNT1ZFOiAicmVtb3ZlIiB9LAogICAgICAgICAgaCA9IHIuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAib2JqZWN0IiwgQVJSQVk6ICJhcnJheSIgfTtyWyJkZWZhdWx0Il0gPSBmOwogICAgfSwgeyAiLi4vdXRpbHMvdXRpbHMuanMiOiAxMDAsICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiOiA3LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIHUgPSBuKGMpLAogICAgICAgICAgbCA9IGUoIi4vRGF0YU9iamVjdFJlcG9ydGVyIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCIuL0RhdGFPYmplY3RPYnNlcnZlciIpLAogICAgICAgICAgcCA9IG4oZCksCiAgICAgICAgICBiID0gZSgiLi9EYXRhUHJvdmlzaW9uYWwiKSwKICAgICAgICAgIGggPSBuKGIpLAogICAgICAgICAgdiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiBlKHQsIHIsIG4pIHsKICAgICAgICAgICgwLCBhWyJkZWZhdWx0Il0pKHRoaXMsIGUpO3ZhciBvID0gdGhpcztvLl9vd25lciA9IHQsIG8uX2J1cyA9IHIsIG8uX3N1YlVSTCA9IG4ucnVudGltZVVSTCArICIvc20iLCBvLl9yZXBvcnRlcnMgPSB7fSwgby5fb2JzZXJ2ZXJzID0ge30sIG8uX3Byb3Zpc2lvbmFscyA9IHt9LCByLmFkZExpc3RlbmVyKHQsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmIChlLmZyb20gIT09IHQpIHN3aXRjaCAoY29uc29sZS5sb2coIlN5bmNoZXItUkNWOiAiLCBlKSwgZS50eXBlKSB7Y2FzZSAiZm9yd2FyZCI6CiAgICAgICAgICAgICAgICBvLl9vbkZvcndhcmQoZSk7YnJlYWs7Y2FzZSAiY3JlYXRlIjoKICAgICAgICAgICAgICAgIG8uX29uUmVtb3RlQ3JlYXRlKGUpO2JyZWFrO2Nhc2UgImRlbGV0ZSI6CiAgICAgICAgICAgICAgICBvLl9vblJlbW90ZURlbGV0ZShlKTt9CiAgICAgICAgICB9KTsKICAgICAgICB9cmV0dXJuICgwLCB1WyJkZWZhdWx0Il0pKGUsIFt7IGtleTogImNyZWF0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0LCByKSB7CiAgICAgICAgICAgIHZhciBuID0gdGhpcztyLnJlcG9ydGVyID0gbi5fb3duZXIsIHIuc2NoZW1hID0gZTt2YXIgbyA9IHsgdHlwZTogImNyZWF0ZSIsIGZyb206IG4uX293bmVyLCB0bzogbi5fc3ViVVJMLCBib2R5OiB7IHNjaGVtYTogZSwgdmFsdWU6IHIsIGF1dGhvcmlzZTogdCB9IH07cmV0dXJuIG5ldyBpWyJkZWZhdWx0Il0oZnVuY3Rpb24gKHQsIGkpIHsKICAgICAgICAgICAgICBuLl9idXMucG9zdE1lc3NhZ2UobywgZnVuY3Rpb24gKG8pIHsKICAgICAgICAgICAgICAgIGlmIChjb25zb2xlLmxvZygiY3JlYXRlLXJlc3BvbnNlOiAiLCBvKSwgMjAwID09PSBvLmJvZHkuY29kZSkgewogICAgICAgICAgICAgICAgICB2YXIgcyA9IG8uYm9keS5yZXNvdXJjZSwKICAgICAgICAgICAgICAgICAgICAgIGEgPSBuZXcgZlsiZGVmYXVsdCJdKG4sIHMsIGUsICJvbiIsIHIsIG8uYm9keS5jaGlsZHJlblJlc291cmNlcyk7bi5fcmVwb3J0ZXJzW3NdID0gYSwgdChhKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpKG8uYm9keS5kZXNjKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAic3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUsIHQpIHsKICAgICAgICAgICAgdmFyIHIgPSB0aGlzLAogICAgICAgICAgICAgICAgbiA9IHsgdHlwZTogInN1YnNjcmliZSIsIGZyb206IHIuX293bmVyLCB0bzogci5fc3ViVVJMLCBib2R5OiB7IHNjaGVtYTogZSwgcmVzb3VyY2U6IHQgfSB9O3JldHVybiBuZXcgaVsiZGVmYXVsdCJdKGZ1bmN0aW9uIChvLCBpKSB7CiAgICAgICAgICAgICAgci5fYnVzLnBvc3RNZXNzYWdlKG4sIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygic3Vic2NyaWJlLXJlc3BvbnNlOiAiLCBuKTt2YXIgcyA9IHIuX3Byb3Zpc2lvbmFsc1t0XTtpZiAoZGVsZXRlIHIuX3Byb3Zpc2lvbmFsc1t0XSwgcyAmJiBzLl9yZWxlYXNlTGlzdGVuZXJzKCksIG4uYm9keS5jb2RlIDwgMjAwKSBzID0gbmV3IGhbImRlZmF1bHQiXShyLl9vd25lciwgdCwgci5fYnVzLCBuLmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMpLCByLl9wcm92aXNpb25hbHNbdF0gPSBzO2Vsc2UgaWYgKDIwMCA9PT0gbi5ib2R5LmNvZGUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGEgPSBuZXcgcFsiZGVmYXVsdCJdKHIsIHQsIGUsICJvbiIsIG4uYm9keS52YWx1ZSwgcy5jaGlsZHJlbiwgbi5ib2R5LnZlcnNpb24pO3IuX29ic2VydmVyc1t0XSA9IGEsIG8oYSksIHMuYXBwbHkoYSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaShuLmJvZHkuZGVzYyk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIm9uTm90aWZpY2F0aW9uIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gZTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25Gb3J3YXJkIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHQuX3JlcG9ydGVyc1tlLmJvZHkudG9dO3IuX29uRm9yd2FyZChlKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZW1vdGVDcmVhdGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5mcm9tLnNsaWNlKDAsIC0xMyksCiAgICAgICAgICAgICAgICBuID0geyB0eXBlOiBlLnR5cGUsIGZyb206IGUuYm9keS5zb3VyY2UsIHVybDogciwgc2NoZW1hOiBlLmJvZHkuc2NoZW1hLCB2YWx1ZTogZS5ib2R5LnZhbHVlLCBpZGVudGl0eTogZS5ib2R5LmlkZW50aXR5LCBhY2s6IGZ1bmN0aW9uIGFjayhyKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IDIwMDtyICYmIChuID0gciksIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IG4gfSB9KTsKICAgICAgICAgICAgICB9IH07dC5fb25Ob3RpZmljYXRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLCBuKSwgdC5fb25Ob3RpZmljYXRpb25IYW5kbGVyKG4pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZW1vdGVEZWxldGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5ib2R5LnJlc291cmNlLAogICAgICAgICAgICAgICAgbiA9IHQuX29ic2VydmVyc1tyXTtpZiAobikgewogICAgICAgICAgICAgIHZhciBvID0geyB0eXBlOiBlLnR5cGUsIHVybDogciwgaWRlbnRpdHk6IGUuYm9keS5pZGVudGl0eSwgYWNrOiBmdW5jdGlvbiBhY2socikgewogICAgICAgICAgICAgICAgICB2YXIgbyA9IDIwMDtyICYmIChvID0gciksIDIwMCA9PT0gbyAmJiBuWyJkZWxldGUiXSgpLCB0Ll9idXMucG9zdE1lc3NhZ2UoeyBpZDogZS5pZCwgdHlwZTogInJlc3BvbnNlIiwgZnJvbTogZS50bywgdG86IGUuZnJvbSwgYm9keTogeyBjb2RlOiBvLCBzb3VyY2U6IHQuX293bmVyIH0gfSk7CiAgICAgICAgICAgICAgICB9IH07dC5fb25Ob3RpZmljYXRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLCBvKSwgdC5fb25Ob3RpZmljYXRpb25IYW5kbGVyKG8pKTsKICAgICAgICAgICAgfSBlbHNlIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiB0Ll9vd25lciB9IH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIm93bmVyIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJyZXBvcnRlcnMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlcG9ydGVyczsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvYnNlcnZlcnMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29ic2VydmVyczsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gdiwgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi9EYXRhT2JqZWN0T2JzZXJ2ZXIiOiA5NSwgIi4vRGF0YU9iamVjdFJlcG9ydGVyIjogOTYsICIuL0RhdGFQcm92aXNpb25hbCI6IDk3LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UiOiA5LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgMTAwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfWZ1bmN0aW9uIG8oZSkgewogICAgICAgIHZhciB0ID0gLyhbYS16QS1aLV0qKTpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fSkoWy1hLXpBLVowLTlAOiUuX1wrfiM9XC9dKikvZ2ksCiAgICAgICAgICAgIHIgPSAiJDEsJDIsJDMiLAogICAgICAgICAgICBuID0gZS5yZXBsYWNlKHQsIHIpLnNwbGl0KCIsIik7blswXSA9PT0gZSAmJiAoblswXSA9ICJodHRwcyIsIG5bMV0gPSBlKTt2YXIgbyA9IHsgdHlwZTogblswXSwgZG9tYWluOiBuWzFdLCBpZGVudGl0eTogblsyXSB9O3JldHVybiBvOwogICAgICB9ZnVuY3Rpb24gaShlKSB7CiAgICAgICAgcmV0dXJuIGUgPyBKU09OLnBhcnNlKCgwLCBhWyJkZWZhdWx0Il0pKGUpKSA6IHZvaWQgMDsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBzID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL2pzb24vc3RyaW5naWZ5IiksCiAgICAgICAgICBhID0gbihzKTtyLmRpdmlkZVVSTCA9IG8sIHIuZGVlcENsb25lID0gaTsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSI6IDIgfV0gfSwge30sIFs5Ml0pKDkyKTsKfSk7Cgp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKfSx7fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gYWN0aXZhdGU7Cgp2YXIgX0h5cGVydHlEaXNjb3ZlcnkgPSByZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9kaXN0L0h5cGVydHlEaXNjb3ZlcnknKTsKCnZhciBfSHlwZXJ0eURpc2NvdmVyeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9IeXBlcnR5RGlzY292ZXJ5KTsKCnZhciBfU3luY2hlciA9IHJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlcicpOwoKdmFyIF9FdmVudEVtaXR0ZXIyID0gcmVxdWlyZSgnLi91dGlscy9FdmVudEVtaXR0ZXInKTsKCnZhciBfRXZlbnRFbWl0dGVyMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0V2ZW50RW1pdHRlcjIpOwoKdmFyIF91dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMvdXRpbHMnKTsKCnZhciBfY29tbXVuaWNhdGlvbiA9IHJlcXVpcmUoJy4vaHlwZXJ0eS1jaGF0L2NvbW11bmljYXRpb24nKTsKCnZhciBfcGFydGljaXBhbnQgPSByZXF1aXJlKCcuL2h5cGVydHktY2hhdC9wYXJ0aWNpcGFudCcpOwoKdmFyIF9wYXJ0aWNpcGFudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wYXJ0aWNpcGFudCk7Cgp2YXIgX0NoYXQgPSByZXF1aXJlKCcuL2h5cGVydHktY2hhdC9DaGF0Jyk7Cgp2YXIgX0NoYXQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQ2hhdCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpID8gY2FsbCA6IHNlbGY7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqLwoKLy8gU2VydmljZSBGcmFtZXdvcmsKCgovLyBVdGlscwoKCi8vIEludGVybmFscwoKCi8qKgoqIEh5cGVydHkgQ2hhdDsKKiBAYXV0aG9yIFZpdG9yIFNpbHZhIFt2aXRvci10LXNpbHZhQHRlbGVjb20ucHRdCiogQHZlcnNpb24gMC4xLjAKKi8KCnZhciBIeXBlcnR5Q2hhdCA9IGZ1bmN0aW9uIChfRXZlbnRFbWl0dGVyKSB7CiAgX2luaGVyaXRzKEh5cGVydHlDaGF0LCBfRXZlbnRFbWl0dGVyKTsKCiAgZnVuY3Rpb24gSHlwZXJ0eUNoYXQoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSHlwZXJ0eUNoYXQpOwoKICAgIGlmICghaHlwZXJ0eVVSTCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgaHlwZXJ0eVVSTCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghYnVzKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBNaW5pQnVzIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKICAgIHZhciBfdGhpczIgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoSHlwZXJ0eUNoYXQpLmNhbGwodGhpcywgaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwogICAgdmFyIHN5bmNoZXIgPSBuZXcgX1N5bmNoZXIuU3luY2hlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pOwoKICAgIHZhciBkb21haW4gPSAoMCwgX3V0aWxzLmRpdmlkZVVSTCkoaHlwZXJ0eVVSTCkuZG9tYWluOwogICAgdmFyIGh5cGVydHlEaXNjb3ZlcnkgPSBuZXcgX0h5cGVydHlEaXNjb3ZlcnkyLmRlZmF1bHQoaHlwZXJ0eVVSTCwgYnVzKTsKCiAgICBfdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovLycgKyBkb21haW4gKyAnLy53ZWxsLWtub3duL2RhdGFzY2hlbWFzL0NvbW11bmljYXRpb24nOwoKICAgIF90aGlzLl9oeXBlcnR5VVJMID0gaHlwZXJ0eVVSTDsKICAgIF90aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIF90aGlzLl9kb21haW4gPSBkb21haW47CiAgICBfdGhpcy5faHlwZXJ0eURpc2NvdmVyeSA9IGh5cGVydHlEaXNjb3Zlcnk7CgogICAgc3luY2hlci5vbk5vdGlmaWNhdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgY29uc29sZS5sb2coJ05vdGlmaWNhdGlvbjogJywgZXZlbnQpOwogICAgICBfdGhpcy5fYXV0b1N1YnNjcmliZShldmVudC51cmwpOwogICAgfSk7CgogICAgcmV0dXJuIF90aGlzMjsKICB9CgogIC8qKgogICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBjcmVhdGUgYSBuZXcgR3JvdXAgQ2hhdCBwcm92aWRpbmcgdGhlIGlkZW50aWZpZXIgb2YgdGhlIEdyb3VwIHRvIGJlIG5vdGlmaWVkLgogICAqIEBwYXJhbSAge1N0cmluZ30gbmFtZSAgICAgICAgICAgICBjaGF0IG5hbWUKICAgKiBAcGFyYW0gIHtVUkwuVXNlclVSTH0gVXNlclVSTExpc3QgTGlzdCBvZiBVc2VyIGFsbG93ZWQKICAgKiBAcmV0dXJuIHtQcm9taXNlfQogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKEh5cGVydHlDaGF0LCBbewogICAga2V5OiAnY3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUobmFtZSwgcGFydGljaXBhbnRzKSB7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgc3luY2hlciA9IF90aGlzLl9zeW5jaGVyOwogICAgICB2YXIgaHlwZXJ0eURpc2NvdmVyeSA9IF90aGlzLl9oeXBlcnR5RGlzY292ZXJ5OwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gQ3JlYXRlIG93bmVyIHBhcnRpY2lwYW50CiAgICAgICAgLy8gVE9ETzogY3JlYXRlIGFsbCBpbmZvcm1hdGlvbiB0byBjb21tdW5pY2F0aW9uOwogICAgICAgIF9jb21tdW5pY2F0aW9uLmNvbW11bmljYXRpb25PYmplY3Qub3duZXIgPSBfdGhpcy5faHlwZXJ0eVVSTDsKICAgICAgICBfY29tbXVuaWNhdGlvbi5jb21tdW5pY2F0aW9uT2JqZWN0Lm5hbWUgPSBuYW1lOwogICAgICAgIF9jb21tdW5pY2F0aW9uLmNvbW11bmljYXRpb25PYmplY3QuaWQgPSBuYW1lOwogICAgICAgIF9jb21tdW5pY2F0aW9uLmNvbW11bmljYXRpb25PYmplY3Quc3RhdHVzID0gX2NvbW11bmljYXRpb24uQ29tbXVuaWNhdGlvblN0YXR1cy5PUEVOOwogICAgICAgIF9jb21tdW5pY2F0aW9uLmNvbW11bmljYXRpb25PYmplY3Quc3RhcnRpbmdUaW1lID0gbmV3IERhdGUoKS50b0pTT04oKTsKICAgICAgICBfY29tbXVuaWNhdGlvbi5jb21tdW5pY2F0aW9uT2JqZWN0Lmxhc3RNb2RpZmllZCA9IF9jb21tdW5pY2F0aW9uLmNvbW11bmljYXRpb25PYmplY3Quc3RhcnRpbmdUaW1lOwoKICAgICAgICAvLyBTZXQgdGhlIG90aGVyIHN1YnNjcmlwdGlvbiBsaWtlIGEgcGFydGljaXBhbnQKICAgICAgICBfcGFydGljaXBhbnQyLmRlZmF1bHQuaHlwZXJ0eVJlc291cmNlID0gX3RoaXMuX2h5cGVydHlVUkw7CiAgICAgICAgX2NvbW11bmljYXRpb24uY29tbXVuaWNhdGlvbk9iamVjdC5wYXJ0aWNpcGFudHMucHVzaChfcGFydGljaXBhbnQyLmRlZmF1bHQpOwoKICAgICAgICBjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIE1hcHBpbmcgUGFydGljcGFudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gXG4nKTsKICAgICAgICBfdGhpcy5fbWFwcGluZ1VzZXIocGFydGljaXBhbnRzKS50aGVuKGZ1bmN0aW9uIChoeXBlcnRpZXMpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5fY3JlYXRlU3luY2hlcihoeXBlcnRpZXMsIF9jb21tdW5pY2F0aW9uLmNvbW11bmljYXRpb25PYmplY3QpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChoeXBlcnRpZXMpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5fY3JlYXRlU3luY2hlcihoeXBlcnRpZXMsIF9jb21tdW5pY2F0aW9uLmNvbW11bmljYXRpb25PYmplY3QpOwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGFPYmplY3RSZXBvcnRlcikgewogICAgICAgICAgY29uc29sZS5pbmZvKCczLiBSZXR1cm4gQ3JlYXRlIERhdGEgT2JqZWN0IFJlcG9ydGVyJywgZGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICAgICAgICB2YXIgY2hhdCA9IG5ldyBfQ2hhdDIuZGVmYXVsdChzeW5jaGVyLCBoeXBlcnR5RGlzY292ZXJ5LCBfdGhpcy5fZG9tYWluKTsKICAgICAgICAgIGNoYXQuZGF0YU9iamVjdFJlcG9ydGVyID0gZGF0YU9iamVjdFJlcG9ydGVyOwogICAgICAgICAgcmVzb2x2ZShjaGF0KTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICByZWplY3QocmVhc29uKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnam9pbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gam9pbihyZXNvdXJjZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgc3luY2hlciA9IF90aGlzLl9zeW5jaGVyOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gU3luY2hlciBzdWJzY3JpYmUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBcbicpOwogICAgICAgIGNvbnNvbGUuaW5mbyhyZXNvdXJjZSk7CgogICAgICAgIHN5bmNoZXIuc3Vic2NyaWJlKF90aGlzLl9vYmplY3REZXNjVVJMLCByZXNvdXJjZSkudGhlbihmdW5jdGlvbiAoZGF0YU9iamVjdE9ic2VydmVyKSB7CiAgICAgICAgICBjb25zb2xlLmluZm8oJ0RhdGEgT2JqZWN0IE9ic2VydmVyOiAnLCBkYXRhT2JqZWN0T2JzZXJ2ZXIpOwogICAgICAgICAgdmFyIGNoYXQgPSBuZXcgX0NoYXQyLmRlZmF1bHQoc3luY2hlciwgX3RoaXMuX2h5cGVydHlEaXNjb3ZlcnksIF90aGlzLl9kb21haW4pOwogICAgICAgICAgY2hhdC5kYXRhT2JqZWN0T2JzZXJ2ZXIgPSBkYXRhT2JqZWN0T2JzZXJ2ZXI7CgogICAgICAgICAgcmVzb2x2ZShjaGF0KTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICByZWplY3QocmVhc29uKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2F1dG9TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hdXRvU3Vic2NyaWJlKHJlc291cmNlKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5qb2luKHJlc291cmNlKS50aGVuKGZ1bmN0aW9uIChjaGF0R3JvdXApIHsKICAgICAgICBfdGhpcy50cmlnZ2VyKCdjaGF0OnN1YnNjcmliZScsIGNoYXRHcm91cCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGVTeW5jaGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlU3luY2hlcihoeXBlcnRpZXMsIGNvbW11bmljYXRpb24pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIHN5bmNoZXIgPSBfdGhpcy5fc3luY2hlcjsKCiAgICAgIGNvbnNvbGUuaW5mbygnSGF2ZSAnICsgaHlwZXJ0aWVzLmxlbmd0aCArICcgcGFydGljaXBhbnRzOycpOwogICAgICBjb25zb2xlLmluZm8oJ1dJdGggY29tbXVuaWNhdGlvbk9iamVjdDogJywgY29tbXVuaWNhdGlvbik7CgogICAgICBjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBTeW5jaGVyIENyZWF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFxuJyk7CiAgICAgIHJldHVybiBzeW5jaGVyLmNyZWF0ZShfdGhpcy5fb2JqZWN0RGVzY1VSTCwgaHlwZXJ0aWVzLCBjb21tdW5pY2F0aW9uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfbWFwcGluZ1VzZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYXBwaW5nVXNlcih1c2VyTGlzdCkgewoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIHZhciBoeXBlcnRpZXMgPSBbXTsKICAgICAgICB2YXIgY291bnQgPSAwOwoKICAgICAgICBpZiAodXNlckxpc3QubGVuZ3RoID09PSAwKSByZWplY3QoaHlwZXJ0aWVzKTsKCiAgICAgICAgdmFyIHJlc3VsdFVzZXJzID0gZnVuY3Rpb24gcmVzdWx0VXNlcnMoKSB7CiAgICAgICAgICBpZiAoY291bnQgPT09IHVzZXJMaXN0Lmxlbmd0aCkgewogICAgICAgICAgICBjb25zb2xlLmluZm8oJ0hhdmUgJyArIGh5cGVydGllcy5sZW5ndGggKyAndXNlcnMgZm91bmQ7Jyk7CiAgICAgICAgICAgIHJlc29sdmUoaHlwZXJ0aWVzKTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB2YXIgYWN0aXZlVXNlcnMgPSBmdW5jdGlvbiBhY3RpdmVVc2Vycyh1c2VyKSB7CiAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgaHlwZXJ0aWVzLnB1c2godXNlci5oeXBlcnR5VVJMKTsKICAgICAgICAgIHJlc3VsdFVzZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIGluYWN0aXZlVXNlcnMgPSBmdW5jdGlvbiBpbmFjdGl2ZVVzZXJzKCkgewogICAgICAgICAgY291bnQrKzsKICAgICAgICAgIHJlc3VsdFVzZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgdXNlckxpc3QuZm9yRWFjaChmdW5jdGlvbiAodXNlcikgewogICAgICAgICAgY29uc29sZS5sb2codXNlcik7CiAgICAgICAgICBpZiAodXNlci5lbWFpbC5sZW5ndGgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9oeXBlcnR5RGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0eVBlclVzZXIodXNlci5lbWFpbCwgdXNlci5kb21haW4pLnRoZW4oYWN0aXZlVXNlcnMpLmNhdGNoKGluYWN0aXZlVXNlcnMpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBIeXBlcnR5Q2hhdDsKfShfRXZlbnRFbWl0dGVyMy5kZWZhdWx0KTsKCmZ1bmN0aW9uIGFjdGl2YXRlKGh5cGVydHlVUkwsIGJ1cywgY29uZmlndXJhdGlvbikgewoKICByZXR1cm4gewogICAgbmFtZTogJ0h5cGVydHlDaGF0JywKICAgIGluc3RhbmNlOiBuZXcgSHlwZXJ0eUNoYXQoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uKQogIH07Cn0KCn0seyIuL2h5cGVydHktY2hhdC9DaGF0Ijo1LCIuL2h5cGVydHktY2hhdC9jb21tdW5pY2F0aW9uIjo2LCIuL2h5cGVydHktY2hhdC9wYXJ0aWNpcGFudCI6NywiLi91dGlscy9FdmVudEVtaXR0ZXIiOjgsIi4vdXRpbHMvdXRpbHMiOjksInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvSHlwZXJ0eURpc2NvdmVyeSI6Miwic2VydmljZS1mcmFtZXdvcmsvZGlzdC9TeW5jaGVyIjozfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKdmFyIF9FdmVudEVtaXR0ZXIyID0gcmVxdWlyZSgnLi4vdXRpbHMvRXZlbnRFbWl0dGVyJyk7Cgp2YXIgX0V2ZW50RW1pdHRlcjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9FdmVudEVtaXR0ZXIyKTsKCnZhciBfcGFydGljaXBhbnQgPSByZXF1aXJlKCcuL3BhcnRpY2lwYW50Jyk7Cgp2YXIgX3BhcnRpY2lwYW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BhcnRpY2lwYW50KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikgPyBjYWxsIDogc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgQ2hhdEdyb3VwID0gZnVuY3Rpb24gKF9FdmVudEVtaXR0ZXIpIHsKICBfaW5oZXJpdHMoQ2hhdEdyb3VwLCBfRXZlbnRFbWl0dGVyKTsKCiAgZnVuY3Rpb24gQ2hhdEdyb3VwKHN5bmNoZXIsIGh5cGVydHlEaXNjb3ZlcnksIGRvbWFpbikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENoYXRHcm91cCk7CgogICAgaWYgKCFzeW5jaGVyKSB0aHJvdyBFcnJvcignU3luY2hlciBpcyBhIG5lY2Vzc2FyeSBkZXBlbmRlY3knKTsKICAgIGlmICghaHlwZXJ0eURpc2NvdmVyeSkgdGhyb3cgRXJyb3IoJ0h5cGVydHkgZGlzY292ZXIgaXMgYSBuZWNlc3NhcnkgZGVwZW5kZWN5Jyk7CgogICAgdmFyIF90aGlzMiA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIE9iamVjdC5nZXRQcm90b3R5cGVPZihDaGF0R3JvdXApLmNhbGwodGhpcywgc3luY2hlciwgaHlwZXJ0eURpc2NvdmVyeSkpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKICAgIF90aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIF90aGlzLl9oeXBlcnR5RGlzY292ZXJ5ID0gaHlwZXJ0eURpc2NvdmVyeTsKCiAgICBfdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovLycgKyBkb21haW4gKyAnLy53ZWxsLWtub3duL2RhdGFzY2hlbWFzL0NvbW11bmljYXRpb24nOwogICAgcmV0dXJuIF90aGlzMjsKICB9CgogIF9jcmVhdGVDbGFzcyhDaGF0R3JvdXAsIFt7CiAgICBrZXk6ICdwcm9jZXNzUGFydGlwYW50cycsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc1BhcnRpcGFudHMocGFydGljaXBhbnRzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBwYXJ0aWNpcGFudHMuZm9yRWFjaChmdW5jdGlvbiAocGFydGljaXBhbnQpIHsKICAgICAgICBpZiAoX3RoaXMuX2RhdGFPYmplY3RPYnNlcnZlci5fb3duZXIgIT09IHBhcnRpY2lwYW50Lmh5cGVydHlSZXNvdXJjZSkgewogICAgICAgICAgX3RoaXMucHJvY2Vzc1BhcnRpY2lwYW50KHBhcnRpY2lwYW50KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ3Byb2Nlc3NQYXJ0aWNpcGFudCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc1BhcnRpY2lwYW50KHBhcnRpY2lwYW50KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGNvbnNvbGUubG9nKCdFYWNoIFBhcnRpY2lwYW50IHdpbGwgYmUgdHJpZ2dlcjogJywgcGFydGljaXBhbnQpOwogICAgICBfdGhpcy50cmlnZ2VyKCdwYXJ0aWNpcGFudDphZGRlZCcsIHBhcnRpY2lwYW50KTsKICAgIH0KCiAgICAvKioKICAgICAqIFByb2Nlc3MgY2hpbGQgbWVzc2FnZXMKICAgICAqIEBwYXJhbSAge1t0eXBlXX0gY2hpbGQgW2Rlc2NyaXB0aW9uXQogICAgICogQHJldHVybiB7W3R5cGVdfSAgICAgICAgICBbZGVzY3JpcHRpb25dCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnX3Byb2Nlc3NDaGlsZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3Byb2Nlc3NDaGlsZChjaGlsZCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY29uc29sZS5pbmZvKCdQcm9jZXNzIE1lc3NhZ2U6JywgY2hpbGQpOwoKICAgICAgX3RoaXMudHJpZ2dlcignbmV3Om1lc3NhZ2U6cmVjaXZlZCcsIGNoaWxkKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBzZW5kIGEgY2hhdCBtZXNzYWdlLgogICAgICogQHBhcmFtICB7TWVzc2FnZX0gbWVzc2FnZSB0ZXh0IHRvIGJlIHNlbmQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzZW5kJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kKG1lc3NhZ2UpIHsKCiAgICAgIGNvbnNvbGUuaW5mbygnU2VuZCBNZXNzYWdlOicsIG1lc3NhZ2UsIHRoaXMpOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGRhdGFPYmplY3QgPSBfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIgPyBfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIgOiBfdGhpcy5kYXRhT2JqZWN0T2JzZXJ2ZXI7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBkYXRhT2JqZWN0LmFkZENoaWxkKCdjaGF0bWVzc2FnZXMnLCB7IGNoYXRNZXNzYWdlOiBtZXNzYWdlIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGFPYmplY3RDaGlsZCkgewogICAgICAgICAgY29uc29sZS5pbmZvKCdEYXRhIE9iamVjdCBDaGlsZDogJywgZGF0YU9iamVjdENoaWxkKTsKICAgICAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgICAgIGNoaWxkSWQ6IGRhdGFPYmplY3RDaGlsZC5fY2hpbGRJZCwKICAgICAgICAgICAgZnJvbTogZGF0YU9iamVjdENoaWxkLl9vd25lciwKICAgICAgICAgICAgdmFsdWU6IGRhdGFPYmplY3RDaGlsZC5kYXRhCiAgICAgICAgICB9OwoKICAgICAgICAgIF90aGlzLl9wcm9jZXNzQ2hpbGQobXNnKTsKICAgICAgICAgIHJlc29sdmUoZGF0YU9iamVjdENoaWxkKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdSZWFzb246JywgcmVhc29uKTsKICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBjbG9zZSBhbiBleGlzdGluZyBHcm91cCBDaGF0IGluc3RhbmNlLgogICAgICoKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdjbG9zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvc2UoKSB7fQogIH0sIHsKICAgIGtleTogJ2pvaW4nLAogICAgdmFsdWU6IGZ1bmN0aW9uIGpvaW4ocmVzb3VyY2UpIHsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBfdGhpcy5hZGRQYXJ0aWNpcGFudChyZXNvdXJjZSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICByZXNvbHZlKCdqb2luZWQ6ICcsIHJlc3VsdCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgcmVqZWN0KHJlYXNvbik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8vIFRPRE86IGltcHJvdmUgdGhpcyB3aXRoIGFuIGludml0ZTsKICAgIC8qKgogICAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGFkZCAvIGludml0ZSBuZXcgcGFydGljaXBhbnQgb24gYW4gZXhpc3RpbmcgR3JvdXAgQ2hhdCBpbnN0YW5jZS4KICAgICAqIEByZXR1cm4ge1Byb21pc2V9IFByb21pc2Ugd2l0aCB0aGUgc3RhdHVzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkUGFydGljaXBhbnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFBhcnRpY2lwYW50KGVtYWlsKSB7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgc3luY2hlciA9IF90aGlzLl9zeW5jaGVyOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHt9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byByZW1vdmUgYSBwYXJ0aWNpcGFudCBmcm9tIGFuIGV4aXN0aW5nIEdyb3VwIENoYXQgaW5zdGFuY2UuCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSBQcm9taXNlIHdpdGggdGhlIHN0YXR1cwogICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlbW92ZVBhcnRpY2lwYW50JywKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVQYXJ0aWNpcGFudCgpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJlc29sdmUoJ3BhcnRpY2lwYW50IHJlbW92ZWQnKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICByZWplY3QoJ3JlbW92ZSBwYXJ0aWNpcGFudCBmYWlsJyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBvcGVuIGEgR3JvdXAgQ2hhdCBpbnN0YW5jZSB0aGF0IHdhcyBwcmV2aW91c2x5IGNsb3NlZC4KICAgICAqIEByZXR1cm4ge1t0eXBlXX0gW2Rlc2NyaXB0aW9uXQogICAgICovCgogIH0sIHsKICAgIGtleTogJ29wZW4nLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oKSB7fQogIH0sIHsKICAgIGtleTogJ2RhdGFPYmplY3RSZXBvcnRlcicsCiAgICBzZXQ6IGZ1bmN0aW9uIHNldChkYXRhT2JqZWN0UmVwb3J0ZXIpIHsKCiAgICAgIGlmICghZGF0YU9iamVjdFJlcG9ydGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBkYXRhIG9iamVjdCByZXBvcnRlciBpcyBuZWNlc3NhcnkgcGFyYW1ldGVyJyk7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY29uc29sZS5pbmZvKCdTZXQgZGF0YSBvYmplY3QgcmVwb3J0ZXI6ICcsIGRhdGFPYmplY3RSZXBvcnRlcik7CgogICAgICBkYXRhT2JqZWN0UmVwb3J0ZXIub25TdWJzY3JpcHRpb24oZnVuY3Rpb24gKGV2ZW50KSB7CgogICAgICAgIGV2ZW50LmFjY2VwdCgpOwoKICAgICAgICAvLyBTZXQgdGhlIG90aGVyIHN1YnNjcmlwdGlvbiBsaWtlIGEgcGFydGljaXBhbnQKICAgICAgICBfcGFydGljaXBhbnQyLmRlZmF1bHQuaHlwZXJ0eVJlc291cmNlID0gZXZlbnQudXJsOwoKICAgICAgICBjb25zb2xlLmluZm8oJ09uIFN1YnNjcmlwdGlvbiBhZGQgUGFydGljaXBhbnQ6ICcsIF9wYXJ0aWNpcGFudDIuZGVmYXVsdCwgZXZlbnQpOwoKICAgICAgICBkYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YS5wYXJ0aWNpcGFudHMucHVzaChfcGFydGljaXBhbnQyLmRlZmF1bHQpOwoKICAgICAgICBfdGhpcy5wcm9jZXNzUGFydGljaXBhbnQoX3BhcnRpY2lwYW50Mi5kZWZhdWx0KTsKICAgICAgfSk7CgogICAgICBkYXRhT2JqZWN0UmVwb3J0ZXIub25BZGRDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1JlcG9ydGVyIC0gQWRkIENoaWxkOiAnLCBjaGlsZCk7CiAgICAgICAgZGF0YU9iamVjdFJlcG9ydGVyLmRhdGEubGFzdE1vZGlmaWVkID0gbmV3IERhdGUoKS50b0pTT04oKTsKICAgICAgICBfdGhpcy5fcHJvY2Vzc0NoaWxkKGNoaWxkKTsKICAgICAgfSk7CgogICAgICBfdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyID0gZGF0YU9iamVjdFJlcG9ydGVyOwogICAgfSwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICByZXR1cm4gX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdkYXRhT2JqZWN0T2JzZXJ2ZXInLAogICAgc2V0OiBmdW5jdGlvbiBzZXQoZGF0YU9iamVjdE9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyID0gZGF0YU9iamVjdE9ic2VydmVyOwoKICAgICAgZGF0YU9iamVjdE9ic2VydmVyLm9uQ2hhbmdlKCdwYXJ0aWNpcGFudHMuKicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGNvbnNvbGUuaW5mbygnQ2hhbmdlIEV2ZW50OiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMucHJvY2Vzc1BhcnRpcGFudHMoZXZlbnQuZGF0YSk7CiAgICAgIH0pOwoKICAgICAgZGF0YU9iamVjdE9ic2VydmVyLm9uQWRkQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdPYnNlcnZlciAtIEFkZCBDaGlsZDogJywgY2hpbGQpOwogICAgICAgIF90aGlzLl9wcm9jZXNzQ2hpbGQoY2hpbGQpOwogICAgICB9KTsKICAgIH0sCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgcmV0dXJuIF90aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXI7CiAgICB9CiAgfSwgewogICAga2V5OiAnZGF0YU9iamVjdCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgcmV0dXJuIF90aGlzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPyBfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIgOiBfdGhpcy5kYXRhT2JqZWN0T2JzZXJ2ZXI7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQ2hhdEdyb3VwOwp9KF9FdmVudEVtaXR0ZXIzLmRlZmF1bHQpOwoKZXhwb3J0cy5kZWZhdWx0ID0gQ2hhdEdyb3VwOwoKfSx7Ii4uL3V0aWxzL0V2ZW50RW1pdHRlciI6OCwiLi9wYXJ0aWNpcGFudCI6N31dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Ci8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKdmFyIENvbW11bmljYXRpb25TdGF0dXMgPSBleHBvcnRzLkNvbW11bmljYXRpb25TdGF0dXMgPSB7CiAgT1BFTjogJ29wZW4nLAogIFBFTkRJTkc6ICdwZW5kaW5nJywKICBDTE9TRUQ6ICdjbG9zZWQnLAogIFBBVVNFRDogJ3BhdXNlZCcsCiAgRkFJTEVEOiAnZmFpbGVkJwp9OwoKdmFyIGNvbW11bmljYXRpb25PYmplY3QgPSBleHBvcnRzLmNvbW11bmljYXRpb25PYmplY3QgPSB7CiAgaWQ6ICcnLAogIG5hbWU6ICcnLAogIG93bmVyOiAnJywKICBzdGFydGluZ1RpbWU6ICcnLAogIGxhc3RNb2RpZmllZDogJycsCiAgZHVyYXRpb246ICcnLAogIHN0YXR1czogJycsCiAgcW9zOiAnJywKICBwYXJ0aWNpcGFudHM6IFtdCn07Cgp9LHt9XSw3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBwYXJ0aWNpcGFudCA9IHsKICBzdGF0dXM6ICcnLAogIGh5cGVydHlSZXNvdXJjZTogJycsCiAgaWRlbnRpdHk6ICcnCn07CgpleHBvcnRzLmRlZmF1bHQgPSBwYXJ0aWNpcGFudDsKCn0se31dLDg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovKioKICogRXZlbnRFbWl0dGVyCiAqIEFsbCBjbGFzc2VzIHdoaWNoIGV4dGVuZHMgdGhpcywgY2FuIGhhdmUgYWRkRXZlbnRMaXN0ZW5lciBhbmQgdHJpZ2dlciBldmVudHM7CiAqLwoKdmFyIEV2ZW50RW1pdHRlciA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRFbWl0dGVyKTsKICB9CgogIF9jcmVhdGVDbGFzcyhFdmVudEVtaXR0ZXIsIFt7CiAgICBrZXk6ICJhZGRFdmVudExpc3RlbmVyIiwKCgogICAgLyoqCiAgICAgKiBhZGRFdmVudExpc3RlbmVyIGxpc3RlbiBmb3IgYW4gZXZlbnRUeXBlCiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9ICAgICAgICAgZXZlbnRUeXBlIC0gbGlzdGVuaW5nIGZvciB0aGlzIHR5cGUgb2YgZXZlbnQKICAgICAqIEBwYXJhbSAge0Z1bmN0aW9ufSAgICAgICBjYiAgICAgICAgLSBjYWxsYmFjayBmdW5jdGlvbiB3aWxsIGJlIGV4ZWN1dGVkIHdoZW4gdGhlIGV2ZW50IGl0IGlzIGludm9rZWQKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBjYikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBfdGhpc1tldmVudFR5cGVdID0gY2I7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgdGhlIGV2ZW50VHlwZQogICAgICogQHBhcmFtICB7c3RyaW5nfSBldmVudFR5cGUgLSBldmVudCB3aWxsIGJlIGludm9rZWQKICAgICAqIEBwYXJhbSAge29iamVjdH0gcGFyYW1zIC0gcGFyYW1ldGVycyB3aWxsIGJlIHBhc3NlZCB0byB0aGUgYWRkRXZlbnRMaXN0ZW5lcgogICAgICovCgogIH0sIHsKICAgIGtleTogInRyaWdnZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRyaWdnZXIoZXZlbnRUeXBlLCBwYXJhbXMpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGlmIChfdGhpc1tldmVudFR5cGVdKSB7CiAgICAgICAgX3RoaXNbZXZlbnRUeXBlXShwYXJhbXMpOwogICAgICB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRXZlbnRFbWl0dGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBFdmVudEVtaXR0ZXI7Cgp9LHt9XSw5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChwcm9jZXNzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kZWVwQ2xvbmUgPSBkZWVwQ2xvbmU7CmV4cG9ydHMuZ2V0Q29uZmlnID0gZ2V0Q29uZmlnOwpleHBvcnRzLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYTsKZXhwb3J0cy5zZXJpYWxpemUgPSBzZXJpYWxpemU7CmV4cG9ydHMuZ2V0VGVtcGxhdGUgPSBnZXRUZW1wbGF0ZTsKLyoqCiAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKiovCgovLyBqc2hpbnQgYnJvd3Nlcjp0cnVlLCBqcXVlcnk6IHRydWUKLy8ganNoaW50IHZhcnN0bXQ6IHRydWUKLyogZ2xvYmFsIEhhbmRsZWJhcnMgKi8KCi8qKgogKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsCiAqIEBtb2R1bGUgdXRpbHMKICovCgovKioKICogQHR5cGVkZWYgZGl2aWRlVVJMCiAqIEB0eXBlIE9iamVjdAogKiBAcHJvcGVydHkge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG9mIFVSTAogKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTAogKi8KCi8qKgogKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICogQHBhcmFtICB7VVJMLlVSTH0gdXJsIC0gdXJsIGFkZHJlc3MKICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTAogKi8KZnVuY3Rpb24gZGl2aWRlVVJMKHVybCkgewoKICAvLyBsZXQgcmUgPSAvKFthLXpBLVotXSopPzpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKSooXC9bXC9cZFx3XC4tXSopKig/OltcP10pKiguKykqL2dpOwogIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogIHZhciBzdWJzdCA9ICckMSwkMiwkMyc7CiAgdmFyIHBhcnRzID0gdXJsLnJlcGxhY2UocmUsIHN1YnN0KS5zcGxpdCgnLCcpOwoKICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgaWYgKHBhcnRzWzBdID09PSB1cmwpIHsKICAgIHBhcnRzWzBdID0gJ2h0dHBzJzsKICAgIHBhcnRzWzFdID0gdXJsOwogIH0KCiAgdmFyIHJlc3VsdCA9IHsKICAgIHR5cGU6IHBhcnRzWzBdLAogICAgZG9tYWluOiBwYXJ0c1sxXSwKICAgIGlkZW50aXR5OiBwYXJ0c1syXQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQogKiBAcGFyYW0gIHtPYmplY3R9ICBvYmogLSBvYmplY3QgdG8gYmUgY2xvbmVkCiAqIEByZXR1cm4ge09iamVjdH0KICovCmZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHsKICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uCiAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7Cn0KCi8qKgogKiBHZXQgdGhlIGNvbmZpZ3VyYXRpb24gZnJvbSBhbiBqc29uIGZpbGU7CiAqIEBwYXJhbSAge0pTT05PYmplY3R9IGpzb25GaWxlCiAqIEByZXR1cm4ge29iamVjdH0KICovCmZ1bmN0aW9uIGdldENvbmZpZyhKU09OT2JqZWN0KSB7CiAgY29uc29sZS5sb2cocHJvY2Vzcy5lbnYuZW52aXJvbm1lbnQpOwogIHJldHVybiBKU09OT2JqZWN0W3Byb2Nlc3MuZW52LmVudmlyb25tZW50XTsKfQoKLyoqCiAqIEdldCBXZWJSVEMgQVBJIHJlc291cmNlcwogKiBAcGFyYW0gIHtPYmplY3R9ICAgICBvcHRpb25zIE9iamVjdCBjb250YWluaW5nIHRoZSBpbmZvcm1hdGlvbiB0aGF0IHJlc291cmNlcyB3aWxsIGJlIHVzZWQgKGNhbWVyYSwgbWljLCByZXNvbHV0aW9uLCBldGMpOwogKiBAcmV0dXJuIHtQcm9taXNlfQogKi8KZnVuY3Rpb24gZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKSB7CgogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24gKG1lZGlhU3RyZWFtKSB7CiAgICAgIHJlc29sdmUobWVkaWFTdHJlYW0pOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICByZWplY3QocmVhc29uKTsKICAgIH0pOwogIH0pOwp9CgpmdW5jdGlvbiBzZXJpYWxpemUoKSB7CgogICQuZm4uc2VyaWFsaXplT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIG8gPSB7fTsKICAgIHZhciBhID0gdGhpcy5zZXJpYWxpemVBcnJheSgpOwogICAgJC5lYWNoKGEsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKG9bdGhpcy5uYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKCFvW3RoaXMubmFtZV0ucHVzaCkgewogICAgICAgICAgb1t0aGlzLm5hbWVdID0gW29bdGhpcy5uYW1lXV07CiAgICAgICAgfQoKICAgICAgICBvW3RoaXMubmFtZV0ucHVzaCh0aGlzLnZhbHVlIHx8ICcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvW3RoaXMubmFtZV0gPSB0aGlzLnZhbHVlIHx8ICcnOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gbzsKICB9OwoKICAkLmZuLnNlcmlhbGl6ZU9iamVjdEFycmF5ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIG8gPSB7fTsKICAgIHZhciBhID0gdGhpcy5zZXJpYWxpemVBcnJheSgpOwogICAgJC5lYWNoKGEsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKG9bdGhpcy5uYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKCFvW3RoaXMubmFtZV0ucHVzaCkgewogICAgICAgICAgb1t0aGlzLm5hbWVdID0gW29bdGhpcy5uYW1lXV07CiAgICAgICAgfQoKICAgICAgICBvW3RoaXMubmFtZV0ucHVzaCh0aGlzLnZhbHVlIHx8ICcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIW9bdGhpcy5uYW1lXSkgb1t0aGlzLm5hbWVdID0gW107CiAgICAgICAgb1t0aGlzLm5hbWVdLnB1c2godGhpcy52YWx1ZSB8fCAnJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBvOwogIH07Cn0KCmZ1bmN0aW9uIGdldFRlbXBsYXRlKHBhdGgsIHNjcmlwdCkgewoKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgIGlmIChIYW5kbGViYXJzLnRlbXBsYXRlcyA9PT0gdW5kZWZpbmVkIHx8IEhhbmRsZWJhcnMudGVtcGxhdGVzW25hbWVdID09PSB1bmRlZmluZWQpIHsKICAgICAgSGFuZGxlYmFycy50ZW1wbGF0ZXMgPSB7fTsKICAgIH0gZWxzZSB7CiAgICAgIHJlc29sdmUoSGFuZGxlYmFycy50ZW1wbGF0ZXNbbmFtZV0pOwogICAgfQoKICAgIHZhciB0ZW1wbGF0ZUZpbGUgPSAkLmFqYXgoewogICAgICB1cmw6IHBhdGggKyAnLmhicycsCiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSkgewogICAgICAgIEhhbmRsZWJhcnMudGVtcGxhdGVzW25hbWVdID0gSGFuZGxlYmFycy5jb21waWxlKGRhdGEpOwogICAgICB9LAoKICAgICAgZmFpbDogZnVuY3Rpb24gZmFpbChyZWFzb24pIHsKICAgICAgICByZXR1cm4gcmVhc29uOwogICAgICB9CiAgICB9KTsKCiAgICB2YXIgc2NyaXB0RmlsZSA9ICQuZ2V0U2NyaXB0KHNjcmlwdCk7CgogICAgdmFyIHJlcXVlc3RzID0gW107CiAgICBpZiAocGF0aCkgcmVxdWVzdHMucHVzaCh0ZW1wbGF0ZUZpbGUpOwogICAgaWYgKHNjcmlwdCkgcmVxdWVzdHMucHVzaChzY3JpcHRGaWxlKTsKCiAgICBQcm9taXNlLmFsbChyZXF1ZXN0cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgIHJlc29sdmUoSGFuZGxlYmFycy50ZW1wbGF0ZXNbbmFtZV0pOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICByZWplY3QocmVhc29uKTsKICAgIH0pOwogIH0pOwp9Cgp9KS5jYWxsKHRoaXMscmVxdWlyZSgnX3Byb2Nlc3MnKSkKfSx7Il9wcm9jZXNzIjoxfV19LHt9LFs0XSkoNCkKfSk7",
      "sourceCodeClassname": "HypertyChat",
      "encoding": "base64",
      "signature": ""
    },
    "cguid": 1,
    "type": "Hyperties",
    "version": "0.1",
    "description": "Description of HypertyChat",
    "objectName": "HypertyChat",
    "configuration": {},
    "sourcePackageURL": "/sourcePackage",
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "dataObjects": [],
    "accessControlPolicy": "somePolicy"
  },
  "GroupChat": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChnbG9iYWwpewovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8vIERpc3RyaWJ1dGlvbiBmaWxlIGZvciBIeXBlcnR5RGlzY292ZXJ5LmpzIAovLyB2ZXJzaW9uOiAwLjIuMAoKIWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiPT10eXBlb2YgZXhwb3J0cyYmInVuZGVmaW5lZCIhPXR5cGVvZiBtb2R1bGUpbW9kdWxlLmV4cG9ydHM9ZSgpO2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sZSk7ZWxzZXt2YXIgdDt0PSJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzoidW5kZWZpbmVkIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmP3NlbGY6dGhpcyx0Lkh5cGVydHlEaXNjb3Zlcnk9ZSgpfX0oZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24gZSh0LHIsbil7ZnVuY3Rpb24gbyhjLHMpe2lmKCFyW2NdKXtpZighdFtjXSl7dmFyIHU9ImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIXMmJnUpcmV0dXJuIHUoYywhMCk7aWYoaSlyZXR1cm4gaShjLCEwKTt2YXIgYT1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitjKyInIik7dGhyb3cgYS5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixhfXZhciBmPXJbY109e2V4cG9ydHM6e319O3RbY11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIHI9dFtjXVsxXVtlXTtyZXR1cm4gbyhyP3I6ZSl9LGYsZi5leHBvcnRzLGUsdCxyLG4pfXJldHVybiByW2NdLmV4cG9ydHN9Zm9yKHZhciBpPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGM9MDtjPG4ubGVuZ3RoO2MrKylvKG5bY10pO3JldHVybiBvfSh7MTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSI6Nn1dLDI6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5Ijo3fV0sMzpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlIiksX19lc01vZHVsZTohMH19LHsiY29yZS1qcy9saWJyYXJ5L2ZuL3Byb21pc2UiOjh9XSw0OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3IuX19lc01vZHVsZT0hMCxyWyJkZWZhdWx0Il09ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX19LHt9XSw1OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19ci5fX2VzTW9kdWxlPSEwO3ZhciBvPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksaT1uKG8pO3JbImRlZmF1bHQiXT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIHI9MDtyPHQubGVuZ3RoO3IrKyl7dmFyIG49dFtyXTtuLmVudW1lcmFibGU9bi5lbnVtZXJhYmxlfHwhMSxuLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gbiYmKG4ud3JpdGFibGU9ITApLCgwLGlbImRlZmF1bHQiXSkoZSxuLmtleSxuKX19cmV0dXJuIGZ1bmN0aW9uKHQscixuKXtyZXR1cm4gciYmZSh0LnByb3RvdHlwZSxyKSxuJiZlKHQsbiksdH19KCl9LHsiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkiOjJ9XSw2OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vLi4vbW9kdWxlcy9fY29yZSIpLG89bi5KU09OfHwobi5KU09OPXtzdHJpbmdpZnk6SlNPTi5zdHJpbmdpZnl9KTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG8uc3RyaW5naWZ5LmFwcGx5KG8sYXJndW1lbnRzKX19LHsiLi4vLi4vbW9kdWxlcy9fY29yZSI6MTZ9XSw3OltmdW5jdGlvbihlLHQscil7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSIpO3ZhciBuPWUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKS5PYmplY3Q7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gbi5kZWZpbmVQcm9wZXJ0eShlLHQscil9fSx7Ii4uLy4uL21vZHVsZXMvX2NvcmUiOjE2LCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZGVmaW5lLXByb3BlcnR5Ijo3MX1dLDg6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIiksZSgiLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yIiksZSgiLi4vbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlIiksZSgiLi4vbW9kdWxlcy9lczYucHJvbWlzZSIpLHQuZXhwb3J0cz1lKCIuLi9tb2R1bGVzL19jb3JlIikuUHJvbWlzZX0seyIuLi9tb2R1bGVzL19jb3JlIjoxNiwiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyI6NzIsIi4uL21vZHVsZXMvZXM2LnByb21pc2UiOjczLCIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOjc0LCIuLi9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUiOjc1fV0sOTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZigiZnVuY3Rpb24iIT10eXBlb2YgZSl0aHJvdyBUeXBlRXJyb3IoZSsiIGlzIG5vdCBhIGZ1bmN0aW9uISIpO3JldHVybiBlfX0se31dLDEwOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKCl7fX0se31dLDExOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLG4pe2lmKCEoZSBpbnN0YW5jZW9mIHQpfHx2b2lkIDAhPT1uJiZuIGluIGUpdGhyb3cgVHlwZUVycm9yKHIrIjogaW5jb3JyZWN0IGludm9jYXRpb24hIik7cmV0dXJuIGV9fSx7fV0sMTI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19pcy1vYmplY3QiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7aWYoIW4oZSkpdGhyb3cgVHlwZUVycm9yKGUrIiBpcyBub3QgYW4gb2JqZWN0ISIpO3JldHVybiBlfX0seyIuL19pcy1vYmplY3QiOjMzfV0sMTM6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1pb2JqZWN0Iiksbz1lKCIuL190by1sZW5ndGgiKSxpPWUoIi4vX3RvLWluZGV4Iik7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0LHIsYyl7dmFyIHMsdT1uKHQpLGE9byh1Lmxlbmd0aCksZj1pKGMsYSk7aWYoZSYmciE9cil7Zm9yKDthPmY7KWlmKHM9dVtmKytdLHMhPXMpcmV0dXJuITB9ZWxzZSBmb3IoO2E+ZjtmKyspaWYoKGV8fGYgaW4gdSkmJnVbZl09PT1yKXJldHVybiBlfHxmfHwwO3JldHVybiFlJiYtMX19fSx7Ii4vX3RvLWluZGV4Ijo2MSwiLi9fdG8taW9iamVjdCI6NjMsIi4vX3RvLWxlbmd0aCI6NjR9XSwxNDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2NvZiIpLG89ZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIiksaT0iQXJndW1lbnRzIj09bihmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHN9KCkpLGM9ZnVuY3Rpb24oZSx0KXt0cnl7cmV0dXJuIGVbdF19Y2F0Y2gocil7fX07dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0LHIscztyZXR1cm4gdm9pZCAwPT09ZT8iVW5kZWZpbmVkIjpudWxsPT09ZT8iTnVsbCI6InN0cmluZyI9PXR5cGVvZihyPWModD1PYmplY3QoZSksbykpP3I6aT9uKHQpOiJPYmplY3QiPT0ocz1uKHQpKSYmImZ1bmN0aW9uIj09dHlwZW9mIHQuY2FsbGVlPyJBcmd1bWVudHMiOnN9fSx7Ii4vX2NvZiI6MTUsIi4vX3drcyI6Njh9XSwxNTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXt9LnRvU3RyaW5nO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbi5jYWxsKGUpLnNsaWNlKDgsLTEpfX0se31dLDE2OltmdW5jdGlvbihlLHQscil7dmFyIG49dC5leHBvcnRzPXt2ZXJzaW9uOiIyLjQuMCJ9OyJudW1iZXIiPT10eXBlb2YgX19lJiYoX19lPW4pfSx7fV0sMTc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19hLWZ1bmN0aW9uIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtpZihuKGUpLHZvaWQgMD09PXQpcmV0dXJuIGU7c3dpdGNoKHIpe2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24ocil7cmV0dXJuIGUuY2FsbCh0LHIpfTtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKHIsbil7cmV0dXJuIGUuY2FsbCh0LHIsbil9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24ocixuLG8pe3JldHVybiBlLmNhbGwodCxyLG4sbyl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHQsYXJndW1lbnRzKX19fSx7Ii4vX2EtZnVuY3Rpb24iOjl9XSwxODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZih2b2lkIDA9PWUpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIitlKTtyZXR1cm4gZX19LHt9XSwxOTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz0hZSgiLi9fZmFpbHMiKShmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sImEiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gN319KS5hfSl9LHsiLi9fZmFpbHMiOjIzfV0sMjA6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19pcy1vYmplY3QiKSxvPWUoIi4vX2dsb2JhbCIpLmRvY3VtZW50LGk9bihvKSYmbihvLmNyZWF0ZUVsZW1lbnQpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaT9vLmNyZWF0ZUVsZW1lbnQoZSk6e319fSx7Ii4vX2dsb2JhbCI6MjUsIi4vX2lzLW9iamVjdCI6MzN9XSwyMTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz0iY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mIi5zcGxpdCgiLCIpfSx7fV0sMjI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX2NvcmUiKSxpPWUoIi4vX2N0eCIpLGM9ZSgiLi9faGlkZSIpLHM9InByb3RvdHlwZSIsdT1mdW5jdGlvbihlLHQscil7dmFyIGEsZixfLGw9ZSZ1LkYsZD1lJnUuRyxwPWUmdS5TLHY9ZSZ1LlAseT1lJnUuQixoPWUmdS5XLGI9ZD9vOm9bdF18fChvW3RdPXt9KSxtPWJbc10sZz1kP246cD9uW3RdOihuW3RdfHx7fSlbc107ZCYmKHI9dCk7Zm9yKGEgaW4gcilmPSFsJiZnJiZ2b2lkIDAhPT1nW2FdLGYmJmEgaW4gYnx8KF89Zj9nW2FdOnJbYV0sYlthXT1kJiYiZnVuY3Rpb24iIT10eXBlb2YgZ1thXT9yW2FdOnkmJmY/aShfLG4pOmgmJmdbYV09PV8/ZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCxyLG4pe2lmKHRoaXMgaW5zdGFuY2VvZiBlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBuZXcgZTtjYXNlIDE6cmV0dXJuIG5ldyBlKHQpO2Nhc2UgMjpyZXR1cm4gbmV3IGUodCxyKX1yZXR1cm4gbmV3IGUodCxyLG4pfXJldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07cmV0dXJuIHRbc109ZVtzXSx0fShfKTp2JiYiZnVuY3Rpb24iPT10eXBlb2YgXz9pKEZ1bmN0aW9uLmNhbGwsXyk6Xyx2JiYoKGIudmlydHVhbHx8KGIudmlydHVhbD17fSkpW2FdPV8sZSZ1LlImJm0mJiFtW2FdJiZjKG0sYSxfKSkpfTt1LkY9MSx1Lkc9Mix1LlM9NCx1LlA9OCx1LkI9MTYsdS5XPTMyLHUuVT02NCx1LlI9MTI4LHQuZXhwb3J0cz11fSx7Ii4vX2NvcmUiOjE2LCIuL19jdHgiOjE3LCIuL19nbG9iYWwiOjI1LCIuL19oaWRlIjoyN31dLDIzOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3RyeXtyZXR1cm4hIWUoKX1jYXRjaCh0KXtyZXR1cm4hMH19fSx7fV0sMjQ6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19jdHgiKSxvPWUoIi4vX2l0ZXItY2FsbCIpLGk9ZSgiLi9faXMtYXJyYXktaXRlciIpLGM9ZSgiLi9fYW4tb2JqZWN0Iikscz1lKCIuL190by1sZW5ndGgiKSx1PWUoIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIiksYT17fSxmPXt9LHI9dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLF8sbCl7dmFyIGQscCx2LHksaD1sP2Z1bmN0aW9uKCl7cmV0dXJuIGV9OnUoZSksYj1uKHIsXyx0PzI6MSksbT0wO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBoKXRocm93IFR5cGVFcnJvcihlKyIgaXMgbm90IGl0ZXJhYmxlISIpO2lmKGkoaCkpe2ZvcihkPXMoZS5sZW5ndGgpO2Q+bTttKyspaWYoeT10P2IoYyhwPWVbbV0pWzBdLHBbMV0pOmIoZVttXSkseT09PWF8fHk9PT1mKXJldHVybiB5fWVsc2UgZm9yKHY9aC5jYWxsKGUpOyEocD12Lm5leHQoKSkuZG9uZTspaWYoeT1vKHYsYixwLnZhbHVlLHQpLHk9PT1hfHx5PT09ZilyZXR1cm4geX07ci5CUkVBSz1hLHIuUkVUVVJOPWZ9LHsiLi9fYW4tb2JqZWN0IjoxMiwiLi9fY3R4IjoxNywiLi9faXMtYXJyYXktaXRlciI6MzIsIi4vX2l0ZXItY2FsbCI6MzQsIi4vX3RvLWxlbmd0aCI6NjQsIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIjo2OX1dLDI1OltmdW5jdGlvbihlLHQscil7dmFyIG49dC5leHBvcnRzPSJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cuTWF0aD09TWF0aD93aW5kb3c6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmJiZzZWxmLk1hdGg9PU1hdGg/c2VsZjpGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpOyJudW1iZXIiPT10eXBlb2YgX19nJiYoX19nPW4pfSx7fV0sMjY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj17fS5oYXNPd25Qcm9wZXJ0eTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jYWxsKGUsdCl9fSx7fV0sMjc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19vYmplY3QtZHAiKSxvPWUoIi4vX3Byb3BlcnR5LWRlc2MiKTt0LmV4cG9ydHM9ZSgiLi9fZGVzY3JpcHRvcnMiKT9mdW5jdGlvbihlLHQscil7cmV0dXJuIG4uZihlLHQsbygxLHIpKX06ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlW3RdPXIsZX19LHsiLi9fZGVzY3JpcHRvcnMiOjE5LCIuL19vYmplY3QtZHAiOjQzLCIuL19wcm9wZXJ0eS1kZXNjIjo1MH1dLDI4OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWUoIi4vX2dsb2JhbCIpLmRvY3VtZW50JiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnR9LHsiLi9fZ2xvYmFsIjoyNX1dLDI5OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPSFlKCIuL19kZXNjcmlwdG9ycyIpJiYhZSgiLi9fZmFpbHMiKShmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSgiLi9fZG9tLWNyZWF0ZSIpKCJkaXYiKSwiYSIse2dldDpmdW5jdGlvbigpe3JldHVybiA3fX0pLmF9KX0seyIuL19kZXNjcmlwdG9ycyI6MTksIi4vX2RvbS1jcmVhdGUiOjIwLCIuL19mYWlscyI6MjN9XSwzMDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7dmFyIG49dm9pZCAwPT09cjtzd2l0Y2godC5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gbj9lKCk6ZS5jYWxsKHIpO2Nhc2UgMTpyZXR1cm4gbj9lKHRbMF0pOmUuY2FsbChyLHRbMF0pO2Nhc2UgMjpyZXR1cm4gbj9lKHRbMF0sdFsxXSk6ZS5jYWxsKHIsdFswXSx0WzFdKTtjYXNlIDM6cmV0dXJuIG4/ZSh0WzBdLHRbMV0sdFsyXSk6ZS5jYWxsKHIsdFswXSx0WzFdLHRbMl0pO2Nhc2UgNDpyZXR1cm4gbj9lKHRbMF0sdFsxXSx0WzJdLHRbM10pOmUuY2FsbChyLHRbMF0sdFsxXSx0WzJdLHRbM10pfXJldHVybiBlLmFwcGx5KHIsdCl9fSx7fV0sMzE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19jb2YiKTt0LmV4cG9ydHM9T2JqZWN0KCJ6IikucHJvcGVydHlJc0VudW1lcmFibGUoMCk/T2JqZWN0OmZ1bmN0aW9uKGUpe3JldHVybiJTdHJpbmciPT1uKGUpP2Uuc3BsaXQoIiIpOk9iamVjdChlKX19LHsiLi9fY29mIjoxNX1dLDMyOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faXRlcmF0b3JzIiksbz1lKCIuL193a3MiKSgiaXRlcmF0b3IiKSxpPUFycmF5LnByb3RvdHlwZTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMCE9PWUmJihuLkFycmF5PT09ZXx8aVtvXT09PWUpfX0seyIuL19pdGVyYXRvcnMiOjM5LCIuL193a3MiOjY4fV0sMzM6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIm9iamVjdCI9PXR5cGVvZiBlP251bGwhPT1lOiJmdW5jdGlvbiI9PXR5cGVvZiBlfX0se31dLDM0OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fYW4tb2JqZWN0Iik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLG8pe3RyeXtyZXR1cm4gbz90KG4ocilbMF0sclsxXSk6dChyKX1jYXRjaChpKXt2YXIgYz1lWyJyZXR1cm4iXTt0aHJvdyB2b2lkIDAhPT1jJiZuKGMuY2FsbChlKSksaX19fSx7Ii4vX2FuLW9iamVjdCI6MTJ9XSwzNTpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCIuL19vYmplY3QtY3JlYXRlIiksbz1lKCIuL19wcm9wZXJ0eS1kZXNjIiksaT1lKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpLGM9e307ZSgiLi9faGlkZSIpKGMsZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLHQuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7ZS5wcm90b3R5cGU9bihjLHtuZXh0Om8oMSxyKX0pLGkoZSx0KyIgSXRlcmF0b3IiKX19LHsiLi9faGlkZSI6MjcsIi4vX29iamVjdC1jcmVhdGUiOjQyLCIuL19wcm9wZXJ0eS1kZXNjIjo1MCwiLi9fc2V0LXRvLXN0cmluZy10YWciOjU1LCIuL193a3MiOjY4fV0sMzY6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi9fbGlicmFyeSIpLG89ZSgiLi9fZXhwb3J0IiksaT1lKCIuL19yZWRlZmluZSIpLGM9ZSgiLi9faGlkZSIpLHM9ZSgiLi9faGFzIiksdT1lKCIuL19pdGVyYXRvcnMiKSxhPWUoIi4vX2l0ZXItY3JlYXRlIiksZj1lKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpLF89ZSgiLi9fb2JqZWN0LWdwbyIpLGw9ZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksZD0hKFtdLmtleXMmJiJuZXh0ImluW10ua2V5cygpKSxwPSJAQGl0ZXJhdG9yIix2PSJrZXlzIix5PSJ2YWx1ZXMiLGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLGIsbSxnLGope2Eocix0LGIpO3ZhciB4LHcsayxPPWZ1bmN0aW9uKGUpe2lmKCFkJiZlIGluIEUpcmV0dXJuIEVbZV07c3dpdGNoKGUpe2Nhc2UgdjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyxlKX07Y2FzZSB5OnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgcih0aGlzLGUpfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyxlKX19LE09dCsiIEl0ZXJhdG9yIixQPW09PXksUz0hMSxFPWUucHJvdG90eXBlLFQ9RVtsXXx8RVtwXXx8bSYmRVttXSxBPVR8fE8obSksVT1tP1A/TygiZW50cmllcyIpOkE6dm9pZCAwLEM9IkFycmF5Ij09dD9FLmVudHJpZXN8fFQ6VDtpZihDJiYoaz1fKEMuY2FsbChuZXcgZSkpLGshPT1PYmplY3QucHJvdG90eXBlJiYoZihrLE0sITApLG58fHMoayxsKXx8YyhrLGwsaCkpKSxQJiZUJiZULm5hbWUhPT15JiYoUz0hMCxBPWZ1bmN0aW9uKCl7cmV0dXJuIFQuY2FsbCh0aGlzKX0pLG4mJiFqfHwhZCYmIVMmJkVbbF18fGMoRSxsLEEpLHVbdF09QSx1W01dPWgsbSlpZih4PXt2YWx1ZXM6UD9BOk8oeSksa2V5czpnP0E6Tyh2KSxlbnRyaWVzOlV9LGopZm9yKHcgaW4geCl3IGluIEV8fGkoRSx3LHhbd10pO2Vsc2UgbyhvLlArby5GKihkfHxTKSx0LHgpO3JldHVybiB4fX0seyIuL19leHBvcnQiOjIyLCIuL19oYXMiOjI2LCIuL19oaWRlIjoyNywiLi9faXRlci1jcmVhdGUiOjM1LCIuL19pdGVyYXRvcnMiOjM5LCIuL19saWJyYXJ5Ijo0MCwiLi9fb2JqZWN0LWdwbyI6NDYsIi4vX3JlZGVmaW5lIjo1MiwiLi9fc2V0LXRvLXN0cmluZy10YWciOjU1LCIuL193a3MiOjY4fV0sMzc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL193a3MiKSgiaXRlcmF0b3IiKSxvPSExO3RyeXt2YXIgaT1bN11bbl0oKTtpWyJyZXR1cm4iXT1mdW5jdGlvbigpe289ITB9LEFycmF5LmZyb20oaSxmdW5jdGlvbigpe3Rocm93IDJ9KX1jYXRjaChjKXt9dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7aWYoIXQmJiFvKXJldHVybiExO3ZhciByPSExO3RyeXt2YXIgaT1bN10sYz1pW25dKCk7Yy5uZXh0PWZ1bmN0aW9uKCl7cmV0dXJue2RvbmU6cj0hMH19LGlbbl09ZnVuY3Rpb24oKXtyZXR1cm4gY30sZShpKX1jYXRjaChzKXt9cmV0dXJuIHJ9fSx7Ii4vX3drcyI6Njh9XSwzODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybnt2YWx1ZTp0LGRvbmU6ISFlfX19LHt9XSwzOTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17fX0se31dLDQwOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPSEwfSx7fV0sNDE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX3Rhc2siKS5zZXQsaT1uLk11dGF0aW9uT2JzZXJ2ZXJ8fG4uV2ViS2l0TXV0YXRpb25PYnNlcnZlcixjPW4ucHJvY2VzcyxzPW4uUHJvbWlzZSx1PSJwcm9jZXNzIj09ZSgiLi9fY29mIikoYyk7dC5leHBvcnRzPWZ1bmN0aW9uKCl7dmFyIGUsdCxyLGE9ZnVuY3Rpb24oKXt2YXIgbixvO2Zvcih1JiYobj1jLmRvbWFpbikmJm4uZXhpdCgpO2U7KXtvPWUuZm4sZT1lLm5leHQ7dHJ5e28oKX1jYXRjaChpKXt0aHJvdyBlP3IoKTp0PXZvaWQgMCxpfX10PXZvaWQgMCxuJiZuLmVudGVyKCl9O2lmKHUpcj1mdW5jdGlvbigpe2MubmV4dFRpY2soYSl9O2Vsc2UgaWYoaSl7dmFyIGY9ITAsXz1kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiIik7bmV3IGkoYSkub2JzZXJ2ZShfLHtjaGFyYWN0ZXJEYXRhOiEwfSkscj1mdW5jdGlvbigpe18uZGF0YT1mPSFmfX1lbHNlIGlmKHMmJnMucmVzb2x2ZSl7dmFyIGw9cy5yZXNvbHZlKCk7cj1mdW5jdGlvbigpe2wudGhlbihhKX19ZWxzZSByPWZ1bmN0aW9uKCl7by5jYWxsKG4sYSl9O3JldHVybiBmdW5jdGlvbihuKXt2YXIgbz17Zm46bixuZXh0OnZvaWQgMH07dCYmKHQubmV4dD1vKSxlfHwoZT1vLHIoKSksdD1vfX19LHsiLi9fY29mIjoxNSwiLi9fZ2xvYmFsIjoyNSwiLi9fdGFzayI6NjB9XSw0MjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2FuLW9iamVjdCIpLG89ZSgiLi9fb2JqZWN0LWRwcyIpLGk9ZSgiLi9fZW51bS1idWcta2V5cyIpLGM9ZSgiLi9fc2hhcmVkLWtleSIpKCJJRV9QUk9UTyIpLHM9ZnVuY3Rpb24oKXt9LHU9InByb3RvdHlwZSIsYT1mdW5jdGlvbigpe3ZhciB0LHI9ZSgiLi9fZG9tLWNyZWF0ZSIpKCJpZnJhbWUiKSxuPWkubGVuZ3RoLG89Ij4iO2ZvcihyLnN0eWxlLmRpc3BsYXk9Im5vbmUiLGUoIi4vX2h0bWwiKS5hcHBlbmRDaGlsZChyKSxyLnNyYz0iamF2YXNjcmlwdDoiLHQ9ci5jb250ZW50V2luZG93LmRvY3VtZW50LHQub3BlbigpLHQud3JpdGUoIjxzY3JpcHQ+ZG9jdW1lbnQuRj1PYmplY3Q8L3NjcmlwdCIrbyksdC5jbG9zZSgpLGE9dC5GO24tLTspZGVsZXRlIGFbdV1baVtuXV07cmV0dXJuIGEoKX07dC5leHBvcnRzPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKGUsdCl7dmFyIHI7cmV0dXJuIG51bGwhPT1lPyhzW3VdPW4oZSkscj1uZXcgcyxzW3VdPW51bGwscltjXT1lKTpyPWEoKSx2b2lkIDA9PT10P3I6byhyLHQpfX0seyIuL19hbi1vYmplY3QiOjEyLCIuL19kb20tY3JlYXRlIjoyMCwiLi9fZW51bS1idWcta2V5cyI6MjEsIi4vX2h0bWwiOjI4LCIuL19vYmplY3QtZHBzIjo0NCwiLi9fc2hhcmVkLWtleSI6NTZ9XSw0MzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2FuLW9iamVjdCIpLG89ZSgiLi9faWU4LWRvbS1kZWZpbmUiKSxpPWUoIi4vX3RvLXByaW1pdGl2ZSIpLGM9T2JqZWN0LmRlZmluZVByb3BlcnR5O3IuZj1lKCIuL19kZXNjcmlwdG9ycyIpP09iamVjdC5kZWZpbmVQcm9wZXJ0eTpmdW5jdGlvbihlLHQscil7aWYobihlKSx0PWkodCwhMCksbihyKSxvKXRyeXtyZXR1cm4gYyhlLHQscil9Y2F0Y2gocyl7fWlmKCJnZXQiaW4gcnx8InNldCJpbiByKXRocm93IFR5cGVFcnJvcigiQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhIik7cmV0dXJuInZhbHVlImluIHImJihlW3RdPXIudmFsdWUpLGV9fSx7Ii4vX2FuLW9iamVjdCI6MTIsIi4vX2Rlc2NyaXB0b3JzIjoxOSwiLi9faWU4LWRvbS1kZWZpbmUiOjI5LCIuL190by1wcmltaXRpdmUiOjY2fV0sNDQ6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19vYmplY3QtZHAiKSxvPWUoIi4vX2FuLW9iamVjdCIpLGk9ZSgiLi9fb2JqZWN0LWtleXMiKTt0LmV4cG9ydHM9ZSgiLi9fZGVzY3JpcHRvcnMiKT9PYmplY3QuZGVmaW5lUHJvcGVydGllczpmdW5jdGlvbihlLHQpe28oZSk7Zm9yKHZhciByLGM9aSh0KSxzPWMubGVuZ3RoLHU9MDtzPnU7KW4uZihlLHI9Y1t1KytdLHRbcl0pO3JldHVybiBlfX0seyIuL19hbi1vYmplY3QiOjEyLCIuL19kZXNjcmlwdG9ycyI6MTksIi4vX29iamVjdC1kcCI6NDMsIi4vX29iamVjdC1rZXlzIjo0OH1dLDQ1OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LXBpZSIpLG89ZSgiLi9fcHJvcGVydHktZGVzYyIpLGk9ZSgiLi9fdG8taW9iamVjdCIpLGM9ZSgiLi9fdG8tcHJpbWl0aXZlIikscz1lKCIuL19oYXMiKSx1PWUoIi4vX2llOC1kb20tZGVmaW5lIiksYT1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO3IuZj1lKCIuL19kZXNjcmlwdG9ycyIpP2E6ZnVuY3Rpb24oZSx0KXtpZihlPWkoZSksdD1jKHQsITApLHUpdHJ5e3JldHVybiBhKGUsdCl9Y2F0Y2gocil7fXJldHVybiBzKGUsdCk/byghbi5mLmNhbGwoZSx0KSxlW3RdKTp2b2lkIDB9fSx7Ii4vX2Rlc2NyaXB0b3JzIjoxOSwiLi9faGFzIjoyNiwiLi9faWU4LWRvbS1kZWZpbmUiOjI5LCIuL19vYmplY3QtcGllIjo0OSwiLi9fcHJvcGVydHktZGVzYyI6NTAsIi4vX3RvLWlvYmplY3QiOjYzLCIuL190by1wcmltaXRpdmUiOjY2fV0sNDY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19oYXMiKSxvPWUoIi4vX3RvLW9iamVjdCIpLGk9ZSgiLi9fc2hhcmVkLWtleSIpKCJJRV9QUk9UTyIpLGM9T2JqZWN0LnByb3RvdHlwZTt0LmV4cG9ydHM9T2JqZWN0LmdldFByb3RvdHlwZU9mfHxmdW5jdGlvbihlKXtyZXR1cm4gZT1vKGUpLG4oZSxpKT9lW2ldOiJmdW5jdGlvbiI9PXR5cGVvZiBlLmNvbnN0cnVjdG9yJiZlIGluc3RhbmNlb2YgZS5jb25zdHJ1Y3Rvcj9lLmNvbnN0cnVjdG9yLnByb3RvdHlwZTplIGluc3RhbmNlb2YgT2JqZWN0P2M6bnVsbH19LHsiLi9faGFzIjoyNiwiLi9fc2hhcmVkLWtleSI6NTYsIi4vX3RvLW9iamVjdCI6NjV9XSw0NzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2hhcyIpLG89ZSgiLi9fdG8taW9iamVjdCIpLGk9ZSgiLi9fYXJyYXktaW5jbHVkZXMiKSghMSksYz1lKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIHIscz1vKGUpLHU9MCxhPVtdO2ZvcihyIGluIHMpciE9YyYmbihzLHIpJiZhLnB1c2gocik7Zm9yKDt0Lmxlbmd0aD51OyluKHMscj10W3UrK10pJiYofmkoYSxyKXx8YS5wdXNoKHIpKTtyZXR1cm4gYX19LHsiLi9fYXJyYXktaW5jbHVkZXMiOjEzLCIuL19oYXMiOjI2LCIuL19zaGFyZWQta2V5Ijo1NiwiLi9fdG8taW9iamVjdCI6NjN9XSw0ODpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX29iamVjdC1rZXlzLWludGVybmFsIiksbz1lKCIuL19lbnVtLWJ1Zy1rZXlzIik7dC5leHBvcnRzPU9iamVjdC5rZXlzfHxmdW5jdGlvbihlKXtyZXR1cm4gbihlLG8pfX0seyIuL19lbnVtLWJ1Zy1rZXlzIjoyMSwiLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwiOjQ3fV0sNDk6W2Z1bmN0aW9uKGUsdCxyKXtyLmY9e30ucHJvcGVydHlJc0VudW1lcmFibGV9LHt9XSw1MDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybntlbnVtZXJhYmxlOiEoMSZlKSxjb25maWd1cmFibGU6ISgyJmUpLHdyaXRhYmxlOiEoNCZlKSx2YWx1ZTp0fX19LHt9XSw1MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2hpZGUiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0LHIpe2Zvcih2YXIgbyBpbiB0KXImJmVbb10/ZVtvXT10W29dOm4oZSxvLHRbb10pO3JldHVybiBlfX0seyIuL19oaWRlIjoyN31dLDUyOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWUoIi4vX2hpZGUiKX0seyIuL19oaWRlIjoyN31dLDUzOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faXMtb2JqZWN0Iiksbz1lKCIuL19hbi1vYmplY3QiKSxpPWZ1bmN0aW9uKGUsdCl7aWYobyhlKSwhbih0KSYmbnVsbCE9PXQpdGhyb3cgVHlwZUVycm9yKHQrIjogY2FuJ3Qgc2V0IGFzIHByb3RvdHlwZSEiKX07dC5leHBvcnRzPXtzZXQ6T2JqZWN0LnNldFByb3RvdHlwZU9mfHwoIl9fcHJvdG9fXyJpbnt9P2Z1bmN0aW9uKHQscixuKXt0cnl7bj1lKCIuL19jdHgiKShGdW5jdGlvbi5jYWxsLGUoIi4vX29iamVjdC1nb3BkIikuZihPYmplY3QucHJvdG90eXBlLCJfX3Byb3RvX18iKS5zZXQsMiksbih0LFtdKSxyPSEodCBpbnN0YW5jZW9mIEFycmF5KX1jYXRjaChvKXtyPSEwfXJldHVybiBmdW5jdGlvbihlLHQpe3JldHVybiBpKGUsdCkscj9lLl9fcHJvdG9fXz10Om4oZSx0KSxlfX0oe30sITEpOnZvaWQgMCksY2hlY2s6aX19LHsiLi9fYW4tb2JqZWN0IjoxMiwiLi9fY3R4IjoxNywiLi9faXMtb2JqZWN0IjozMywiLi9fb2JqZWN0LWdvcGQiOjQ1fV0sNTQ6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi9fZ2xvYmFsIiksbz1lKCIuL19jb3JlIiksaT1lKCIuL19vYmplY3QtZHAiKSxjPWUoIi4vX2Rlc2NyaXB0b3JzIikscz1lKCIuL193a3MiKSgic3BlY2llcyIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXt2YXIgdD0iZnVuY3Rpb24iPT10eXBlb2Ygb1tlXT9vW2VdOm5bZV07YyYmdCYmIXRbc10mJmkuZih0LHMse2NvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc319KX19LHsiLi9fY29yZSI6MTYsIi4vX2Rlc2NyaXB0b3JzIjoxOSwiLi9fZ2xvYmFsIjoyNSwiLi9fb2JqZWN0LWRwIjo0MywiLi9fd2tzIjo2OH1dLDU1OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LWRwIikuZixvPWUoIi4vX2hhcyIpLGk9ZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtlJiYhbyhlPXI/ZTplLnByb3RvdHlwZSxpKSYmbihlLGkse2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTp0fSl9fSx7Ii4vX2hhcyI6MjYsIi4vX29iamVjdC1kcCI6NDMsIi4vX3drcyI6Njh9XSw1NjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX3NoYXJlZCIpKCJrZXlzIiksbz1lKCIuL191aWQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG5bZV18fChuW2VdPW8oZSkpfX0seyIuL19zaGFyZWQiOjU3LCIuL191aWQiOjY3fV0sNTc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPSJfX2NvcmUtanNfc2hhcmVkX18iLGk9bltvXXx8KG5bb109e30pO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaVtlXXx8KGlbZV09e30pfX0seyIuL19nbG9iYWwiOjI1fV0sNTg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19hbi1vYmplY3QiKSxvPWUoIi4vX2EtZnVuY3Rpb24iKSxpPWUoIi4vX3drcyIpKCJzcGVjaWVzIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIHIsYz1uKGUpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDA9PT1jfHx2b2lkIDA9PShyPW4oYylbaV0pP3Q6byhyKX19LHsiLi9fYS1mdW5jdGlvbiI6OSwiLi9fYW4tb2JqZWN0IjoxMiwiLi9fd2tzIjo2OH1dLDU5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fdG8taW50ZWdlciIpLG89ZSgiLi9fZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCxyKXt2YXIgaSxjLHM9U3RyaW5nKG8odCkpLHU9bihyKSxhPXMubGVuZ3RoO3JldHVybiAwPnV8fHU+PWE/ZT8iIjp2b2lkIDA6KGk9cy5jaGFyQ29kZUF0KHUpLDU1Mjk2Pml8fGk+NTYzMTl8fHUrMT09PWF8fChjPXMuY2hhckNvZGVBdCh1KzEpKTw1NjMyMHx8Yz41NzM0Mz9lP3MuY2hhckF0KHUpOmk6ZT9zLnNsaWNlKHUsdSsyKTooaS01NTI5Njw8MTApKyhjLTU2MzIwKSs2NTUzNil9fX0seyIuL19kZWZpbmVkIjoxOCwiLi9fdG8taW50ZWdlciI6NjJ9XSw2MDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG8saSxjPWUoIi4vX2N0eCIpLHM9ZSgiLi9faW52b2tlIiksdT1lKCIuL19odG1sIiksYT1lKCIuL19kb20tY3JlYXRlIiksZj1lKCIuL19nbG9iYWwiKSxfPWYucHJvY2VzcyxsPWYuc2V0SW1tZWRpYXRlLGQ9Zi5jbGVhckltbWVkaWF0ZSxwPWYuTWVzc2FnZUNoYW5uZWwsdj0wLHk9e30saD0ib25yZWFkeXN0YXRlY2hhbmdlIixiPWZ1bmN0aW9uKCl7dmFyIGU9K3RoaXM7aWYoeS5oYXNPd25Qcm9wZXJ0eShlKSl7dmFyIHQ9eVtlXTtkZWxldGUgeVtlXSx0KCl9fSxtPWZ1bmN0aW9uKGUpe2IuY2FsbChlLmRhdGEpfTtsJiZkfHwobD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9W10scj0xO2FyZ3VtZW50cy5sZW5ndGg+cjspdC5wdXNoKGFyZ3VtZW50c1tyKytdKTtyZXR1cm4geVsrK3ZdPWZ1bmN0aW9uKCl7cygiZnVuY3Rpb24iPT10eXBlb2YgZT9lOkZ1bmN0aW9uKGUpLHQpfSxuKHYpLHZ9LGQ9ZnVuY3Rpb24oZSl7ZGVsZXRlIHlbZV19LCJwcm9jZXNzIj09ZSgiLi9fY29mIikoXyk/bj1mdW5jdGlvbihlKXtfLm5leHRUaWNrKGMoYixlLDEpKX06cD8obz1uZXcgcCxpPW8ucG9ydDIsby5wb3J0MS5vbm1lc3NhZ2U9bSxuPWMoaS5wb3N0TWVzc2FnZSxpLDEpKTpmLmFkZEV2ZW50TGlzdGVuZXImJiJmdW5jdGlvbiI9PXR5cGVvZiBwb3N0TWVzc2FnZSYmIWYuaW1wb3J0U2NyaXB0cz8obj1mdW5jdGlvbihlKXtmLnBvc3RNZXNzYWdlKGUrIiIsIioiKX0sZi5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixtLCExKSk6bj1oIGluIGEoInNjcmlwdCIpP2Z1bmN0aW9uKGUpe3UuYXBwZW5kQ2hpbGQoYSgic2NyaXB0IikpW2hdPWZ1bmN0aW9uKCl7dS5yZW1vdmVDaGlsZCh0aGlzKSxiLmNhbGwoZSl9fTpmdW5jdGlvbihlKXtzZXRUaW1lb3V0KGMoYixlLDEpLDApfSksdC5leHBvcnRzPXtzZXQ6bCxjbGVhcjpkfX0seyIuL19jb2YiOjE1LCIuL19jdHgiOjE3LCIuL19kb20tY3JlYXRlIjoyMCwiLi9fZ2xvYmFsIjoyNSwiLi9faHRtbCI6MjgsIi4vX2ludm9rZSI6MzB9XSw2MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX3RvLWludGVnZXIiKSxvPU1hdGgubWF4LGk9TWF0aC5taW47dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9bihlKSwwPmU/byhlK3QsMCk6aShlLHQpfX0seyIuL190by1pbnRlZ2VyIjo2Mn1dLDYyOltmdW5jdGlvbihlLHQscil7dmFyIG49TWF0aC5jZWlsLG89TWF0aC5mbG9vcjt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGlzTmFOKGU9K2UpPzA6KGU+MD9vOm4pKGUpfX0se31dLDYzOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faW9iamVjdCIpLG89ZSgiLi9fZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbihvKGUpKX19LHsiLi9fZGVmaW5lZCI6MTgsIi4vX2lvYmplY3QiOjMxfV0sNjQ6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1pbnRlZ2VyIiksbz1NYXRoLm1pbjt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGU+MD9vKG4oZSksOTAwNzE5OTI1NDc0MDk5MSk6MH19LHsiLi9fdG8taW50ZWdlciI6NjJ9XSw2NTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2RlZmluZWQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdChuKGUpKX19LHsiLi9fZGVmaW5lZCI6MTh9XSw2NjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2lzLW9iamVjdCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKCFuKGUpKXJldHVybiBlO3ZhciByLG87aWYodCYmImZ1bmN0aW9uIj09dHlwZW9mKHI9ZS50b1N0cmluZykmJiFuKG89ci5jYWxsKGUpKSlyZXR1cm4gbztpZigiZnVuY3Rpb24iPT10eXBlb2Yocj1lLnZhbHVlT2YpJiYhbihvPXIuY2FsbChlKSkpcmV0dXJuIG87aWYoIXQmJiJmdW5jdGlvbiI9PXR5cGVvZihyPWUudG9TdHJpbmcpJiYhbihvPXIuY2FsbChlKSkpcmV0dXJuIG87dGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKX19LHsiLi9faXMtb2JqZWN0IjozM31dLDY3OltmdW5jdGlvbihlLHQscil7dmFyIG49MCxvPU1hdGgucmFuZG9tKCk7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiJTeW1ib2woIi5jb25jYXQodm9pZCAwPT09ZT8iIjplLCIpXyIsKCsrbitvKS50b1N0cmluZygzNikpfX0se31dLDY4OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fc2hhcmVkIikoIndrcyIpLG89ZSgiLi9fdWlkIiksaT1lKCIuL19nbG9iYWwiKS5TeW1ib2wsYz0iZnVuY3Rpb24iPT10eXBlb2YgaSxzPXQuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbltlXXx8KG5bZV09YyYmaVtlXXx8KGM/aTpvKSgiU3ltYm9sLiIrZSkpfTtzLnN0b3JlPW59LHsiLi9fZ2xvYmFsIjoyNSwiLi9fc2hhcmVkIjo1NywiLi9fdWlkIjo2N31dLDY5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fY2xhc3NvZiIpLG89ZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksaT1lKCIuL19pdGVyYXRvcnMiKTt0LmV4cG9ydHM9ZSgiLi9fY29yZSIpLmdldEl0ZXJhdG9yTWV0aG9kPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDAhPWU/ZVtvXXx8ZVsiQEBpdGVyYXRvciJdfHxpW24oZSldOnZvaWQgMH19LHsiLi9fY2xhc3NvZiI6MTQsIi4vX2NvcmUiOjE2LCIuL19pdGVyYXRvcnMiOjM5LCIuL193a3MiOjY4fV0sNzA6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi9fYWRkLXRvLXVuc2NvcGFibGVzIiksbz1lKCIuL19pdGVyLXN0ZXAiKSxpPWUoIi4vX2l0ZXJhdG9ycyIpLGM9ZSgiLi9fdG8taW9iamVjdCIpO3QuZXhwb3J0cz1lKCIuL19pdGVyLWRlZmluZSIpKEFycmF5LCJBcnJheSIsZnVuY3Rpb24oZSx0KXt0aGlzLl90PWMoZSksdGhpcy5faT0wLHRoaXMuX2s9dH0sZnVuY3Rpb24oKXt2YXIgZT10aGlzLl90LHQ9dGhpcy5fayxyPXRoaXMuX2krKztyZXR1cm4hZXx8cj49ZS5sZW5ndGg/KHRoaXMuX3Q9dm9pZCAwLG8oMSkpOiJrZXlzIj09dD9vKDAscik6InZhbHVlcyI9PXQ/bygwLGVbcl0pOm8oMCxbcixlW3JdXSl9LCJ2YWx1ZXMiKSxpLkFyZ3VtZW50cz1pLkFycmF5LG4oImtleXMiKSxuKCJ2YWx1ZXMiKSxuKCJlbnRyaWVzIil9LHsiLi9fYWRkLXRvLXVuc2NvcGFibGVzIjoxMCwiLi9faXRlci1kZWZpbmUiOjM2LCIuL19pdGVyLXN0ZXAiOjM4LCIuL19pdGVyYXRvcnMiOjM5LCIuL190by1pb2JqZWN0Ijo2M31dLDcxOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fZXhwb3J0Iik7bihuLlMrbi5GKiFlKCIuL19kZXNjcmlwdG9ycyIpLCJPYmplY3QiLHtkZWZpbmVQcm9wZXJ0eTplKCIuL19vYmplY3QtZHAiKS5mfSl9LHsiLi9fZGVzY3JpcHRvcnMiOjE5LCIuL19leHBvcnQiOjIyLCIuL19vYmplY3QtZHAiOjQzfV0sNzI6W2Z1bmN0aW9uKGUsdCxyKXt9LHt9XSw3MzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbixvLGksYz1lKCIuL19saWJyYXJ5Iikscz1lKCIuL19nbG9iYWwiKSx1PWUoIi4vX2N0eCIpLGE9ZSgiLi9fY2xhc3NvZiIpLGY9ZSgiLi9fZXhwb3J0IiksXz1lKCIuL19pcy1vYmplY3QiKSxsPShlKCIuL19hbi1vYmplY3QiKSxlKCIuL19hLWZ1bmN0aW9uIikpLGQ9ZSgiLi9fYW4taW5zdGFuY2UiKSxwPWUoIi4vX2Zvci1vZiIpLHY9KGUoIi4vX3NldC1wcm90byIpLnNldCxlKCIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIikpLHk9ZSgiLi9fdGFzayIpLnNldCxoPWUoIi4vX21pY3JvdGFzayIpKCksYj0iUHJvbWlzZSIsbT1zLlR5cGVFcnJvcixnPXMucHJvY2VzcyxqPXNbYl0sZz1zLnByb2Nlc3MseD0icHJvY2VzcyI9PWEoZyksdz1mdW5jdGlvbigpe30saz0hIWZ1bmN0aW9uKCl7dHJ5e3ZhciB0PWoucmVzb2x2ZSgxKSxyPSh0LmNvbnN0cnVjdG9yPXt9KVtlKCIuL193a3MiKSgic3BlY2llcyIpXT1mdW5jdGlvbihlKXtlKHcsdyl9O3JldHVybih4fHwiZnVuY3Rpb24iPT10eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50KSYmdC50aGVuKHcpaW5zdGFuY2VvZiByfWNhdGNoKG4pe319KCksTz1mdW5jdGlvbihlLHQpe3JldHVybiBlPT09dHx8ZT09PWomJnQ9PT1pfSxNPWZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiBfKGUpJiYiZnVuY3Rpb24iPT10eXBlb2YodD1lLnRoZW4pP3Q6ITF9LFA9ZnVuY3Rpb24oZSl7cmV0dXJuIE8oaixlKT9uZXcgUyhlKTpuZXcgbyhlKX0sUz1vPWZ1bmN0aW9uKGUpe3ZhciB0LHI7dGhpcy5wcm9taXNlPW5ldyBlKGZ1bmN0aW9uKGUsbil7aWYodm9pZCAwIT09dHx8dm9pZCAwIT09cil0aHJvdyBtKCJCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvciIpO3Q9ZSxyPW59KSx0aGlzLnJlc29sdmU9bCh0KSx0aGlzLnJlamVjdD1sKHIpfSxFPWZ1bmN0aW9uKGUpe3RyeXtlKCl9Y2F0Y2godCl7cmV0dXJue2Vycm9yOnR9fX0sVD1mdW5jdGlvbihlLHQpe2lmKCFlLl9uKXtlLl9uPSEwO3ZhciByPWUuX2M7aChmdW5jdGlvbigpe2Zvcih2YXIgbj1lLl92LG89MT09ZS5fcyxpPTAsYz1mdW5jdGlvbih0KXt2YXIgcixpLGM9bz90Lm9rOnQuZmFpbCxzPXQucmVzb2x2ZSx1PXQucmVqZWN0LGE9dC5kb21haW47dHJ5e2M/KG98fCgyPT1lLl9oJiZDKGUpLGUuX2g9MSksYz09PSEwP3I9bjooYSYmYS5lbnRlcigpLHI9YyhuKSxhJiZhLmV4aXQoKSkscj09PXQucHJvbWlzZT91KG0oIlByb21pc2UtY2hhaW4gY3ljbGUiKSk6KGk9TShyKSk/aS5jYWxsKHIscyx1KTpzKHIpKTp1KG4pfWNhdGNoKGYpe3UoZil9fTtyLmxlbmd0aD5pOyljKHJbaSsrXSk7ZS5fYz1bXSxlLl9uPSExLHQmJiFlLl9oJiZBKGUpfSl9fSxBPWZ1bmN0aW9uKGUpe3kuY2FsbChzLGZ1bmN0aW9uKCl7dmFyIHQscixuLG89ZS5fdjtpZihVKGUpJiYodD1FKGZ1bmN0aW9uKCl7eD9nLmVtaXQoInVuaGFuZGxlZFJlamVjdGlvbiIsbyxlKToocj1zLm9udW5oYW5kbGVkcmVqZWN0aW9uKT9yKHtwcm9taXNlOmUscmVhc29uOm99KToobj1zLmNvbnNvbGUpJiZuLmVycm9yJiZuLmVycm9yKCJVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24iLG8pfSksZS5faD14fHxVKGUpPzI6MSksZS5fYT12b2lkIDAsdCl0aHJvdyB0LmVycm9yfSl9LFU9ZnVuY3Rpb24oZSl7aWYoMT09ZS5faClyZXR1cm4hMTtmb3IodmFyIHQscj1lLl9hfHxlLl9jLG49MDtyLmxlbmd0aD5uOylpZih0PXJbbisrXSx0LmZhaWx8fCFVKHQucHJvbWlzZSkpcmV0dXJuITE7cmV0dXJuITB9LEM9ZnVuY3Rpb24oZSl7eS5jYWxsKHMsZnVuY3Rpb24oKXt2YXIgdDt4P2cuZW1pdCgicmVqZWN0aW9uSGFuZGxlZCIsZSk6KHQ9cy5vbnJlamVjdGlvbmhhbmRsZWQpJiZ0KHtwcm9taXNlOmUscmVhc29uOmUuX3Z9KX0pfSxSPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7dC5fZHx8KHQuX2Q9ITAsdD10Ll93fHx0LHQuX3Y9ZSx0Ll9zPTIsdC5fYXx8KHQuX2E9dC5fYy5zbGljZSgpKSxUKHQsITApKX0sTD1mdW5jdGlvbihlKXt2YXIgdCxyPXRoaXM7aWYoIXIuX2Qpe3IuX2Q9ITAscj1yLl93fHxyO3RyeXtpZihyPT09ZSl0aHJvdyBtKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOyh0PU0oZSkpP2goZnVuY3Rpb24oKXt2YXIgbj17X3c6cixfZDohMX07dHJ5e3QuY2FsbChlLHUoTCxuLDEpLHUoUixuLDEpKX1jYXRjaChvKXtSLmNhbGwobixvKX19KTooci5fdj1lLHIuX3M9MSxUKHIsITEpKX1jYXRjaChuKXtSLmNhbGwoe193OnIsX2Q6ITF9LG4pfX19O2t8fChqPWZ1bmN0aW9uKGUpe2QodGhpcyxqLGIsIl9oIiksbChlKSxuLmNhbGwodGhpcyk7dHJ5e2UodShMLHRoaXMsMSksdShSLHRoaXMsMSkpfWNhdGNoKHQpe1IuY2FsbCh0aGlzLHQpfX0sbj1mdW5jdGlvbihlKXt0aGlzLl9jPVtdLHRoaXMuX2E9dm9pZCAwLHRoaXMuX3M9MCx0aGlzLl9kPSExLHRoaXMuX3Y9dm9pZCAwLHRoaXMuX2g9MCx0aGlzLl9uPSExfSxuLnByb3RvdHlwZT1lKCIuL19yZWRlZmluZS1hbGwiKShqLnByb3RvdHlwZSx7dGhlbjpmdW5jdGlvbihlLHQpe3ZhciByPVAodih0aGlzLGopKTtyZXR1cm4gci5vaz0iZnVuY3Rpb24iPT10eXBlb2YgZT9lOiEwLHIuZmFpbD0iZnVuY3Rpb24iPT10eXBlb2YgdCYmdCxyLmRvbWFpbj14P2cuZG9tYWluOnZvaWQgMCx0aGlzLl9jLnB1c2gociksdGhpcy5fYSYmdGhpcy5fYS5wdXNoKHIpLHRoaXMuX3MmJlQodGhpcywhMSksci5wcm9taXNlfSwiY2F0Y2giOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnRoZW4odm9pZCAwLGUpfX0pLFM9ZnVuY3Rpb24oKXt2YXIgZT1uZXcgbjt0aGlzLnByb21pc2U9ZSx0aGlzLnJlc29sdmU9dShMLGUsMSksdGhpcy5yZWplY3Q9dShSLGUsMSl9KSxmKGYuRytmLlcrZi5GKiFrLHtQcm9taXNlOmp9KSxlKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpKGosYiksZSgiLi9fc2V0LXNwZWNpZXMiKShiKSxpPWUoIi4vX2NvcmUiKVtiXSxmKGYuUytmLkYqIWssYix7cmVqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0PVAodGhpcykscj10LnJlamVjdDtyZXR1cm4gcihlKSx0LnByb21pc2V9fSksZihmLlMrZi5GKihjfHwhayksYix7cmVzb2x2ZTpmdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgaiYmTyhlLmNvbnN0cnVjdG9yLHRoaXMpKXJldHVybiBlO3ZhciB0PVAodGhpcykscj10LnJlc29sdmU7cmV0dXJuIHIoZSksdC5wcm9taXNlfX0pLGYoZi5TK2YuRiohKGsmJmUoIi4vX2l0ZXItZGV0ZWN0IikoZnVuY3Rpb24oZSl7ai5hbGwoZSlbImNhdGNoIl0odyl9KSksYix7YWxsOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1QKHQpLG49ci5yZXNvbHZlLG89ci5yZWplY3QsaT1FKGZ1bmN0aW9uKCl7dmFyIHI9W10saT0wLGM9MTtwKGUsITEsZnVuY3Rpb24oZSl7dmFyIHM9aSsrLHU9ITE7ci5wdXNoKHZvaWQgMCksYysrLHQucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uKGUpe3V8fCh1PSEwLHJbc109ZSwtLWN8fG4ocikpfSxvKX0pLC0tY3x8bihyKX0pO3JldHVybiBpJiZvKGkuZXJyb3IpLHIucHJvbWlzZX0scmFjZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLHI9UCh0KSxuPXIucmVqZWN0LG89RShmdW5jdGlvbigpe3AoZSwhMSxmdW5jdGlvbihlKXt0LnJlc29sdmUoZSkudGhlbihyLnJlc29sdmUsbil9KX0pO3JldHVybiBvJiZuKG8uZXJyb3IpLHIucHJvbWlzZX19KX0seyIuL19hLWZ1bmN0aW9uIjo5LCIuL19hbi1pbnN0YW5jZSI6MTEsIi4vX2FuLW9iamVjdCI6MTIsIi4vX2NsYXNzb2YiOjE0LCIuL19jb3JlIjoxNiwiLi9fY3R4IjoxNywiLi9fZXhwb3J0IjoyMiwiLi9fZm9yLW9mIjoyNCwiLi9fZ2xvYmFsIjoyNSwiLi9faXMtb2JqZWN0IjozMywiLi9faXRlci1kZXRlY3QiOjM3LCIuL19saWJyYXJ5Ijo0MCwiLi9fbWljcm90YXNrIjo0MSwiLi9fcmVkZWZpbmUtYWxsIjo1MSwiLi9fc2V0LXByb3RvIjo1MywiLi9fc2V0LXNwZWNpZXMiOjU0LCIuL19zZXQtdG8tc3RyaW5nLXRhZyI6NTUsIi4vX3NwZWNpZXMtY29uc3RydWN0b3IiOjU4LCIuL190YXNrIjo2MCwiLi9fd2tzIjo2OH1dLDc0OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3ZhciBuPWUoIi4vX3N0cmluZy1hdCIpKCEwKTtlKCIuL19pdGVyLWRlZmluZSIpKFN0cmluZywiU3RyaW5nIixmdW5jdGlvbihlKXt0aGlzLl90PVN0cmluZyhlKSx0aGlzLl9pPTB9LGZ1bmN0aW9uKCl7dmFyIGUsdD10aGlzLl90LHI9dGhpcy5faTtyZXR1cm4gcj49dC5sZW5ndGg/e3ZhbHVlOnZvaWQgMCxkb25lOiEwfTooZT1uKHQsciksdGhpcy5faSs9ZS5sZW5ndGgse3ZhbHVlOmUsZG9uZTohMX0pfSl9LHsiLi9faXRlci1kZWZpbmUiOjM2LCIuL19zdHJpbmctYXQiOjU5fV0sNzU6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuL2VzNi5hcnJheS5pdGVyYXRvciIpO2Zvcih2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX2hpZGUiKSxpPWUoIi4vX2l0ZXJhdG9ycyIpLGM9ZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIikscz1bIk5vZGVMaXN0IiwiRE9NVG9rZW5MaXN0IiwiTWVkaWFMaXN0IiwiU3R5bGVTaGVldExpc3QiLCJDU1NSdWxlTGlzdCJdLHU9MDs1PnU7dSsrKXt2YXIgYT1zW3VdLGY9blthXSxfPWYmJmYucHJvdG90eXBlO18mJiFfW2NdJiZvKF8sYyxhKSxpW2FdPWkuQXJyYXl9fSx7Ii4vX2dsb2JhbCI6MjUsIi4vX2hpZGUiOjI3LCIuL19pdGVyYXRvcnMiOjM5LCIuL193a3MiOjY4LCIuL2VzNi5hcnJheS5pdGVyYXRvciI6NzB9XSw3NjpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCIuL2h5cGVydHktZGlzY292ZXJ5L0h5cGVydHlEaXNjb3ZlcnkiKSxpPW4obyk7clsiZGVmYXVsdCJdPWlbImRlZmF1bHQiXSx0LmV4cG9ydHM9clsiZGVmYXVsdCJdfSx7Ii4vaHlwZXJ0eS1kaXNjb3ZlcnkvSHlwZXJ0eURpc2NvdmVyeSI6Nzd9XSw3NzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLGk9bihvKSxjPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLHM9bihjKSx1PWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLGE9bih1KSxmPWUoIi4uL3V0aWxzL3V0aWxzIiksXz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxyKXsoMCxzWyJkZWZhdWx0Il0pKHRoaXMsZSk7dmFyIG49dGhpcztuLm1lc3NhZ2VCdXM9cixuLmRvbWFpbj0oMCxmLmRpdmlkZVVSTCkodCkuZG9tYWluLG4uZGlzY292ZXJ5VVJMPXR9cmV0dXJuKDAsYVsiZGVmYXVsdCJdKShlLFt7a2V5OiJkaXNjb3ZlckRhdGFPYmplY3RQZXJOYW1lIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMsbj12b2lkIDA7bj10P3Q6ci5kb21haW47dmFyIG89e3R5cGU6InJlYWQiLGZyb206ci5kaXNjb3ZlcnlVUkwsdG86ImRvbWFpbjovL3JlZ2lzdHJ5LiIrbisiLyIsYm9keTp7cmVzb3VyY2U6ImRhdGFPYmplY3Q6Ly8iK2V9fTtyZXR1cm4gbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbihlLHQpe3IubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShvLGZ1bmN0aW9uKHIpe3ZhciBuPXIuYm9keS52YWx1ZS51cmw7bj9lKG4pOnQoIkRhdGFPYmplY3QgbmFtZSBkb2VzIG5vdCBleGlzdCIpfSl9KX19LHtrZXk6ImRpc2NvdmVySHlwZXJ0eVBlclVzZXIiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcyxuPXZvaWQgMDtuPXQ/dDpyLmRvbWFpbjt2YXIgbz0idXNlcjovLyIrZS5zdWJzdHJpbmcoZS5pbmRleE9mKCJAIikrMSxlLmxlbmd0aCkrIi8iK2Uuc3Vic3RyaW5nKDAsZS5pbmRleE9mKCJAIikpLGM9e3R5cGU6InJlYWQiLGZyb206ci5kaXNjb3ZlcnlVUkwsdG86ImRvbWFpbjovL3JlZ2lzdHJ5LiIrbisiLyIsYm9keTp7cmVzb3VyY2U6b319O3JldHVybiBjb25zb2xlLmxvZygiTWVzc2FnZTogIixjLG4sbyksbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbih0LG4pe3IubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShjLGZ1bmN0aW9uKHIpe2NvbnNvbGUubG9nKCJtZXNzYWdlIHJlcGx5IixyKTt2YXIgbz12b2lkIDAsaT12b2lkIDAsYz12b2lkIDAscz1yLmJvZHkudmFsdWU7Zm9yKG8gaW4gcylpZih2b2lkIDAhPT1zW29dLmxhc3RNb2RpZmllZClpZih2b2lkIDA9PT1pKWk9bmV3IERhdGUoc1tvXS5sYXN0TW9kaWZpZWQpLGM9bztlbHNle3ZhciB1PW5ldyBEYXRlKHNbb10ubGFzdE1vZGlmaWVkKTtpLmdldFRpbWUoKTx1LmdldFRpbWUoKSYmKGk9dSxjPW8pfWNvbnNvbGUubG9nKCJMYXN0IEh5cGVydHk6ICIsYyxpKTt2YXIgYT1jO2lmKHZvaWQgMD09PWEpcmV0dXJuIG4oIlVzZXIgSHlwZXJ0eSBub3QgZm91bmQiKTt2YXIgZj17aWQ6ZSxkZXNjcmlwdG9yOnNbYV0uZGVzY3JpcHRvcixoeXBlcnR5VVJMOmF9O2NvbnNvbGUubG9nKCI9PT0+IGh5cGVydHlEaXNjb3ZlcnkgbWVzc2FnZUJ1bmRsZTogIixmKSx0KGYpfSl9KX19LHtrZXk6ImRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlciIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcj10aGlzLG49dm9pZCAwO249dD90OnIuZG9tYWluO3ZhciBvPSJ1c2VyOi8vIitlLnN1YnN0cmluZyhlLmluZGV4T2YoIkAiKSsxLGUubGVuZ3RoKSsiLyIrZS5zdWJzdHJpbmcoMCxlLmluZGV4T2YoIkAiKSksYz17dHlwZToicmVhZCIsZnJvbTpyLmRpc2NvdmVyeVVSTCx0bzoiZG9tYWluOi8vcmVnaXN0cnkuIituKyIvIixib2R5OntyZXNvdXJjZTpvfX07cmV0dXJuIGNvbnNvbGUubG9nKCJNZXNzYWdlIGRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlcjogIixjLG4sbyksbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbihlLHQpe3IubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShjLGZ1bmN0aW9uKHIpe2NvbnNvbGUubG9nKCJkaXNjb3Zlckh5cGVydGllc1BlclVzZXIgcmVwbHkiLHIpO3ZhciBuPXIuYm9keS52YWx1ZTtyZXR1cm4gbj92b2lkIGUobik6dCgiVXNlciBIeXBlcnR5IG5vdCBmb3VuZCIpfSl9KX19XSksZX0oKTtyWyJkZWZhdWx0Il09Xyx0LmV4cG9ydHM9clsiZGVmYXVsdCJdfSx7Ii4uL3V0aWxzL3V0aWxzIjo3OCwiYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UiOjMsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6NCwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjo1fV0sNzg6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1mdW5jdGlvbiBvKGUpe3ZhciB0PS8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpLHI9IiQxLCQyLCQzIixuPWUucmVwbGFjZSh0LHIpLnNwbGl0KCIsIik7blswXT09PWUmJihuWzBdPSJodHRwcyIsblsxXT1lKTt2YXIgbz17dHlwZTpuWzBdLGRvbWFpbjpuWzFdLGlkZW50aXR5Om5bMl19O3JldHVybiBvfWZ1bmN0aW9uIGkoZSl7cmV0dXJuIGU/SlNPTi5wYXJzZSgoMCxzWyJkZWZhdWx0Il0pKGUpKTp2b2lkIDB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO3ZhciBjPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSIpLHM9bihjKTtyLmRpdmlkZVVSTD1vLHIuZGVlcENsb25lPWl9LHsiYmFiZWwtcnVudGltZS9jb3JlLWpzL2pzb24vc3RyaW5naWZ5IjoxfV19LHt9LFs3Nl0pKDc2KX0pOwp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CihmdW5jdGlvbiAoZ2xvYmFsKXsKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovLyBEaXN0cmlidXRpb24gZmlsZSBmb3IgU3luY2hlci5qcyAKLy8gdmVyc2lvbjogMC4yLjAKCiFmdW5jdGlvbihlKXtpZigib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlKW1vZHVsZS5leHBvcnRzPWUoKTtlbHNlIGlmKCJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQpZGVmaW5lKFtdLGUpO2Vsc2V7dmFyIHQ7dD0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6InVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOiJ1bmRlZmluZWQiIT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMsdC5TeW5jaGVyPWUoKX19KGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uIGUodCxyLG4pe2Z1bmN0aW9uIG8ocyxhKXtpZighcltzXSl7aWYoIXRbc10pe3ZhciBjPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFhJiZjKXJldHVybiBjKHMsITApO2lmKGkpcmV0dXJuIGkocywhMCk7dmFyIHU9bmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIrcysiJyIpO3Rocm93IHUuY29kZT0iTU9EVUxFX05PVF9GT1VORCIsdX12YXIgbD1yW3NdPXtleHBvcnRzOnt9fTt0W3NdWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciByPXRbc11bMV1bZV07cmV0dXJuIG8ocj9yOmUpfSxsLGwuZXhwb3J0cyxlLHQscixuKX1yZXR1cm4gcltzXS5leHBvcnRzfWZvcih2YXIgaT0iZnVuY3Rpb24iPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxzPTA7czxuLmxlbmd0aDtzKyspbyhuW3NdKTtyZXR1cm4gb30oezE6W2Z1bmN0aW9uKGUsdCxyKXtPYmplY3Qub2JzZXJ2ZSYmIUFycmF5Lm9ic2VydmUmJmZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO3ZhciByPWUuZ2V0Tm90aWZpZXIsbj0icGVyZm9ybUNoYW5nZSIsbz0iX29yaWdpbmFsIixpPSJzcGxpY2UiLHM9e3B1c2g6ZnVuY3Rpb24gYyhlKXt2YXIgdD1hcmd1bWVudHMscz1jW29dLmFwcGx5KHRoaXMsdCk7cmV0dXJuIHIodGhpcylbbl0oaSxmdW5jdGlvbigpe3JldHVybntpbmRleDpzLXQubGVuZ3RoLGFkZGVkQ291bnQ6dC5sZW5ndGgscmVtb3ZlZDpbXX19KSxzfSx1bnNoaWZ0OmZ1bmN0aW9uIHUoZSl7dmFyIHQ9YXJndW1lbnRzLHM9dVtvXS5hcHBseSh0aGlzLHQpO3JldHVybiByKHRoaXMpW25dKGksZnVuY3Rpb24oKXtyZXR1cm57aW5kZXg6MCxhZGRlZENvdW50OnQubGVuZ3RoLHJlbW92ZWQ6W119fSksc30scG9wOmZ1bmN0aW9uIGwoKXt2YXIgZT10aGlzLmxlbmd0aCx0PWxbb10uY2FsbCh0aGlzKTtyZXR1cm4gdGhpcy5sZW5ndGghPT1lJiZyKHRoaXMpW25dKGksZnVuY3Rpb24oKXtyZXR1cm57aW5kZXg6dGhpcy5sZW5ndGgsYWRkZWRDb3VudDowLHJlbW92ZWQ6W3RdfX0sdGhpcyksdH0sc2hpZnQ6ZnVuY3Rpb24gZigpe3ZhciBlPXRoaXMubGVuZ3RoLHQ9ZltvXS5jYWxsKHRoaXMpO3JldHVybiB0aGlzLmxlbmd0aCE9PWUmJnIodGhpcylbbl0oaSxmdW5jdGlvbigpe3JldHVybntpbmRleDowLGFkZGVkQ291bnQ6MCxyZW1vdmVkOlt0XX19LHRoaXMpLHR9LHNwbGljZTpmdW5jdGlvbiBkKGUsdCl7dmFyIHM9YXJndW1lbnRzLGE9ZFtvXS5hcHBseSh0aGlzLHMpO3JldHVybihhLmxlbmd0aHx8cy5sZW5ndGg+MikmJnIodGhpcylbbl0oaSxmdW5jdGlvbigpe3JldHVybntpbmRleDplLGFkZGVkQ291bnQ6cy5sZW5ndGgtMixyZW1vdmVkOmF9fSx0aGlzKSxhfX07Zm9yKHZhciBhIGluIHMpc1thXVtvXT10LnByb3RvdHlwZVthXSx0LnByb3RvdHlwZVthXT1zW2FdO3Qub2JzZXJ2ZT1mdW5jdGlvbih0LHIpe3JldHVybiBlLm9ic2VydmUodCxyLFsiYWRkIiwidXBkYXRlIiwiZGVsZXRlIixpXSl9LHQudW5vYnNlcnZlPWUudW5vYnNlcnZlfShPYmplY3QsQXJyYXkpfSx7fV0sMjpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSI6MTd9XSwzOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9jcmVhdGUiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZSI6MTh9XSw0OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHkiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6MTl9XSw1OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI6MjB9XSw2OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIiksX19lc01vZHVsZTohMH19LHsiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjoyMX1dLDc6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2tleXMiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2tleXMiOjIyfV0sODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiI6MjN9XSw5OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL3Byb21pc2UiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vcHJvbWlzZSI6MjR9XSwxMDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIjoyNX1dLDExOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3IuX19lc01vZHVsZT0hMCxyWyJkZWZhdWx0Il09ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX19LHt9XSwxMjpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fXIuX19lc01vZHVsZT0hMDt2YXIgbz1lKCIuLi9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkiKSxpPW4obyk7clsiZGVmYXVsdCJdPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2Zvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKXt2YXIgbj10W3JdO24uZW51bWVyYWJsZT1uLmVudW1lcmFibGV8fCExLG4uY29uZmlndXJhYmxlPSEwLCJ2YWx1ZSJpbiBuJiYobi53cml0YWJsZT0hMCksKDAsaVsiZGVmYXVsdCJdKShlLG4ua2V5LG4pfX1yZXR1cm4gZnVuY3Rpb24odCxyLG4pe3JldHVybiByJiZlKHQucHJvdG90eXBlLHIpLG4mJmUodCxuKSx0fX0oKX0seyIuLi9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkiOjR9XSwxMzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpWyJkZWZhdWx0Il07clsiZGVmYXVsdCJdPWZ1bmN0aW9uKGUsdCxyKXtmb3IodmFyIG89ITA7bzspe3ZhciBpPWUscz10LGE9cjtvPSExLG51bGw9PT1pJiYoaT1GdW5jdGlvbi5wcm90b3R5cGUpO3ZhciBjPW4oaSxzKTtpZih2b2lkIDAhPT1jKXtpZigidmFsdWUiaW4gYylyZXR1cm4gYy52YWx1ZTt2YXIgdT1jLmdldDtpZih2b2lkIDA9PT11KXJldHVybjtyZXR1cm4gdS5jYWxsKGEpfXZhciBsPU9iamVjdC5nZXRQcm90b3R5cGVPZihpKTtpZihudWxsPT09bClyZXR1cm47ZT1sLHQ9cyxyPWEsbz0hMCxjPWw9dm9pZCAwfX0sci5fX2VzTW9kdWxlPSEwfSx7ImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjo1fV0sMTQ6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9jcmVhdGUiKVsiZGVmYXVsdCJdLG89ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mIilbImRlZmF1bHQiXTtyWyJkZWZhdWx0Il09ZnVuY3Rpb24oZSx0KXtpZigiZnVuY3Rpb24iIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiK3R5cGVvZiB0KTtlLnByb3RvdHlwZT1uKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSxlbnVtZXJhYmxlOiExLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19KSx0JiYobz9vKGUsdCk6ZS5fX3Byb3RvX189dCl9LHIuX19lc01vZHVsZT0hMH0seyJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2NyZWF0ZSI6MywiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mIjo4fV0sMTU6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1yLl9fZXNNb2R1bGU9ITA7dmFyIG89ZSgiLi4vaGVscGVycy90eXBlb2YiKSxpPW4obyk7clsiZGVmYXVsdCJdPWZ1bmN0aW9uKGUsdCl7aWYoIWUpdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTtyZXR1cm4hdHx8Im9iamVjdCIhPT0oInVuZGVmaW5lZCI9PXR5cGVvZiB0PyJ1bmRlZmluZWQiOigwLGlbImRlZmF1bHQiXSkodCkpJiYiZnVuY3Rpb24iIT10eXBlb2YgdD9lOnR9fSx7Ii4uL2hlbHBlcnMvdHlwZW9mIjoxNn1dLDE2OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3ZhciBuPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9zeW1ib2wiKVsiZGVmYXVsdCJdO3JbImRlZmF1bHQiXT1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5jb25zdHJ1Y3Rvcj09PW4/InN5bWJvbCI6dHlwZW9mIGV9LHIuX19lc01vZHVsZT0hMH0seyJiYWJlbC1ydW50aW1lL2NvcmUtanMvc3ltYm9sIjoxMH1dLDE3OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vLi4vbW9kdWxlcy8kLmNvcmUiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuKG4uSlNPTiYmbi5KU09OLnN0cmluZ2lmeXx8SlNPTi5zdHJpbmdpZnkpLmFwcGx5KEpTT04sYXJndW1lbnRzKX19LHsiLi4vLi4vbW9kdWxlcy8kLmNvcmUiOjMxfV0sMTg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLi8uLi9tb2R1bGVzLyQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jcmVhdGUoZSx0KX19LHsiLi4vLi4vbW9kdWxlcy8kIjo1Nn1dLDE5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vLi4vbW9kdWxlcy8kIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gbi5zZXREZXNjKGUsdCxyKX19LHsiLi4vLi4vbW9kdWxlcy8kIjo1Nn1dLDIwOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vLi4vbW9kdWxlcy8kIik7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpLHQuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybiBuLmdldERlc2MoZSx0KX19LHsiLi4vLi4vbW9kdWxlcy8kIjo1NiwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI6ODF9XSwyMTpbZnVuY3Rpb24oZSx0LHIpe2UoIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtcHJvdG90eXBlLW9mIiksdC5leHBvcnRzPWUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuT2JqZWN0LmdldFByb3RvdHlwZU9mfSx7Ii4uLy4uL21vZHVsZXMvJC5jb3JlIjozMSwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1wcm90b3R5cGUtb2YiOjgyfV0sMjI6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Qua2V5cyIpLHQuZXhwb3J0cz1lKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5rZXlzfSx7Ii4uLy4uL21vZHVsZXMvJC5jb3JlIjozMSwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmtleXMiOjgzfV0sMjM6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZiIpLHQuZXhwb3J0cz1lKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5zZXRQcm90b3R5cGVPZn0seyIuLi8uLi9tb2R1bGVzLyQuY29yZSI6MzEsIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mIjo4NH1dLDI0OltmdW5jdGlvbihlLHQscil7ZSgiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyIpLGUoIi4uL21vZHVsZXMvZXM2LnN0cmluZy5pdGVyYXRvciIpLGUoIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSIpLGUoIi4uL21vZHVsZXMvZXM2LnByb21pc2UiKSx0LmV4cG9ydHM9ZSgiLi4vbW9kdWxlcy8kLmNvcmUiKS5Qcm9taXNlfSx7Ii4uL21vZHVsZXMvJC5jb3JlIjozMSwiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyI6ODUsIi4uL21vZHVsZXMvZXM2LnByb21pc2UiOjg2LCIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOjg3LCIuLi9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUiOjg5fV0sMjU6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuLi8uLi9tb2R1bGVzL2VzNi5zeW1ib2wiKSxlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIiksdC5leHBvcnRzPWUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuU3ltYm9sfSx7Ii4uLy4uL21vZHVsZXMvJC5jb3JlIjozMSwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyI6ODUsIi4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCI6ODh9XSwyNjpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZigiZnVuY3Rpb24iIT10eXBlb2YgZSl0aHJvdyBUeXBlRXJyb3IoZSsiIGlzIG5vdCBhIGZ1bmN0aW9uISIpO3JldHVybiBlfX0se31dLDI3OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKCl7fX0se31dLDI4OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLmlzLW9iamVjdCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZighbihlKSl0aHJvdyBUeXBlRXJyb3IoZSsiIGlzIG5vdCBhbiBvYmplY3QhIik7cmV0dXJuIGV9fSx7Ii4vJC5pcy1vYmplY3QiOjQ5fV0sMjk6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuY29mIiksbz1lKCIuLyQud2tzIikoInRvU3RyaW5nVGFnIiksaT0iQXJndW1lbnRzIj09bihmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHN9KCkpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXt2YXIgdCxyLHM7cmV0dXJuIHZvaWQgMD09PWU/IlVuZGVmaW5lZCI6bnVsbD09PWU/Ik51bGwiOiJzdHJpbmciPT10eXBlb2Yocj0odD1PYmplY3QoZSkpW29dKT9yOmk/bih0KToiT2JqZWN0Ij09KHM9bih0KSkmJiJmdW5jdGlvbiI9PXR5cGVvZiB0LmNhbGxlZT8iQXJndW1lbnRzIjpzfX0seyIuLyQuY29mIjozMCwiLi8kLndrcyI6Nzh9XSwzMDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXt9LnRvU3RyaW5nO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbi5jYWxsKGUpLnNsaWNlKDgsLTEpfX0se31dLDMxOltmdW5jdGlvbihlLHQscil7dmFyIG49dC5leHBvcnRzPXt2ZXJzaW9uOiIxLjIuNiJ9OyJudW1iZXIiPT10eXBlb2YgX19lJiYoX19lPW4pfSx7fV0sMzI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuYS1mdW5jdGlvbiIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7aWYobihlKSx2b2lkIDA9PT10KXJldHVybiBlO3N3aXRjaChyKXtjYXNlIDE6cmV0dXJuIGZ1bmN0aW9uKHIpe3JldHVybiBlLmNhbGwodCxyKX07Y2FzZSAyOnJldHVybiBmdW5jdGlvbihyLG4pe3JldHVybiBlLmNhbGwodCxyLG4pfTtjYXNlIDM6cmV0dXJuIGZ1bmN0aW9uKHIsbixvKXtyZXR1cm4gZS5jYWxsKHQscixuLG8pfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0LGFyZ3VtZW50cyl9fX0seyIuLyQuYS1mdW5jdGlvbiI6MjZ9XSwzMzpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZih2b2lkIDA9PWUpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIitlKTtyZXR1cm4gZX19LHt9XSwzNDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz0hZSgiLi8kLmZhaWxzIikoZnVuY3Rpb24oKXtyZXR1cm4gNyE9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCJhIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSkuYX0pfSx7Ii4vJC5mYWlscyI6Mzh9XSwzNTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5pcy1vYmplY3QiKSxvPWUoIi4vJC5nbG9iYWwiKS5kb2N1bWVudCxpPW4obykmJm4oby5jcmVhdGVFbGVtZW50KTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGk/by5jcmVhdGVFbGVtZW50KGUpOnt9fX0seyIuLyQuZ2xvYmFsIjo0MSwiLi8kLmlzLW9iamVjdCI6NDl9XSwzNjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXt2YXIgdD1uLmdldEtleXMoZSkscj1uLmdldFN5bWJvbHM7aWYocilmb3IodmFyIG8saT1yKGUpLHM9bi5pc0VudW0sYT0wO2kubGVuZ3RoPmE7KXMuY2FsbChlLG89aVthKytdKSYmdC5wdXNoKG8pO3JldHVybiB0fX0seyIuLyQiOjU2fV0sMzc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuZ2xvYmFsIiksbz1lKCIuLyQuY29yZSIpLGk9ZSgiLi8kLmN0eCIpLHM9InByb3RvdHlwZSIsYT1mdW5jdGlvbihlLHQscil7dmFyIGMsdSxsLGY9ZSZhLkYsZD1lJmEuRyxwPWUmYS5TLGI9ZSZhLlAsaD1lJmEuQix2PWUmYS5XLHk9ZD9vOm9bdF18fChvW3RdPXt9KSxfPWQ/bjpwP25bdF06KG5bdF18fHt9KVtzXTtkJiYocj10KTtmb3IoYyBpbiByKXU9IWYmJl8mJmMgaW4gXyx1JiZjIGluIHl8fChsPXU/X1tjXTpyW2NdLHlbY109ZCYmImZ1bmN0aW9uIiE9dHlwZW9mIF9bY10/cltjXTpoJiZ1P2kobCxuKTp2JiZfW2NdPT1sP2Z1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzIGluc3RhbmNlb2YgZT9uZXcgZSh0KTplKHQpfTtyZXR1cm4gdFtzXT1lW3NdLHR9KGwpOmImJiJmdW5jdGlvbiI9PXR5cGVvZiBsP2koRnVuY3Rpb24uY2FsbCxsKTpsLGImJigoeVtzXXx8KHlbc109e30pKVtjXT1sKSl9O2EuRj0xLGEuRz0yLGEuUz00LGEuUD04LGEuQj0xNixhLlc9MzIsdC5leHBvcnRzPWF9LHsiLi8kLmNvcmUiOjMxLCIuLyQuY3R4IjozMiwiLi8kLmdsb2JhbCI6NDF9XSwzODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXt0cnl7cmV0dXJuISFlKCl9Y2F0Y2godCl7cmV0dXJuITB9fX0se31dLDM5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLmN0eCIpLG89ZSgiLi8kLml0ZXItY2FsbCIpLGk9ZSgiLi8kLmlzLWFycmF5LWl0ZXIiKSxzPWUoIi4vJC5hbi1vYmplY3QiKSxhPWUoIi4vJC50by1sZW5ndGgiKSxjPWUoIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLHUpe3ZhciBsLGYsZCxwPWMoZSksYj1uKHIsdSx0PzI6MSksaD0wO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBwKXRocm93IFR5cGVFcnJvcihlKyIgaXMgbm90IGl0ZXJhYmxlISIpO2lmKGkocCkpZm9yKGw9YShlLmxlbmd0aCk7bD5oO2grKyl0P2IocyhmPWVbaF0pWzBdLGZbMV0pOmIoZVtoXSk7ZWxzZSBmb3IoZD1wLmNhbGwoZSk7IShmPWQubmV4dCgpKS5kb25lOylvKGQsYixmLnZhbHVlLHQpfX0seyIuLyQuYW4tb2JqZWN0IjoyOCwiLi8kLmN0eCI6MzIsIi4vJC5pcy1hcnJheS1pdGVyIjo0NywiLi8kLml0ZXItY2FsbCI6NTAsIi4vJC50by1sZW5ndGgiOjc1LCIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCI6Nzl9XSw0MDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC50by1pb2JqZWN0Iiksbz1lKCIuLyQiKS5nZXROYW1lcyxpPXt9LnRvU3RyaW5nLHM9Im9iamVjdCI9PXR5cGVvZiB3aW5kb3cmJk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzP09iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdyk6W10sYT1mdW5jdGlvbihlKXt0cnl7cmV0dXJuIG8oZSl9Y2F0Y2godCl7cmV0dXJuIHMuc2xpY2UoKX19O3QuZXhwb3J0cy5nZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHMmJiJbb2JqZWN0IFdpbmRvd10iPT1pLmNhbGwoZSk/YShlKTpvKG4oZSkpfX0seyIuLyQiOjU2LCIuLyQudG8taW9iamVjdCI6NzR9XSw0MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXQuZXhwb3J0cz0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93Lk1hdGg9PU1hdGg/d2luZG93OiJ1bmRlZmluZWQiIT10eXBlb2Ygc2VsZiYmc2VsZi5NYXRoPT1NYXRoP3NlbGY6RnVuY3Rpb24oInJldHVybiB0aGlzIikoKTsibnVtYmVyIj09dHlwZW9mIF9fZyYmKF9fZz1uKX0se31dLDQyOltmdW5jdGlvbihlLHQscil7dmFyIG49e30uaGFzT3duUHJvcGVydHk7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG4uY2FsbChlLHQpfX0se31dLDQzOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kIiksbz1lKCIuLyQucHJvcGVydHktZGVzYyIpO3QuZXhwb3J0cz1lKCIuLyQuZGVzY3JpcHRvcnMiKT9mdW5jdGlvbihlLHQscil7cmV0dXJuIG4uc2V0RGVzYyhlLHQsbygxLHIpKX06ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlW3RdPXIsZX19LHsiLi8kIjo1NiwiLi8kLmRlc2NyaXB0b3JzIjozNCwiLi8kLnByb3BlcnR5LWRlc2MiOjYxfV0sNDQ6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZSgiLi8kLmdsb2JhbCIpLmRvY3VtZW50JiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnR9LHsiLi8kLmdsb2JhbCI6NDF9XSw0NTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7dmFyIG49dm9pZCAwPT09cjtzd2l0Y2godC5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gbj9lKCk6ZS5jYWxsKHIpO2Nhc2UgMTpyZXR1cm4gbj9lKHRbMF0pOmUuY2FsbChyLHRbMF0pO2Nhc2UgMjpyZXR1cm4gbj9lKHRbMF0sdFsxXSk6ZS5jYWxsKHIsdFswXSx0WzFdKTtjYXNlIDM6cmV0dXJuIG4/ZSh0WzBdLHRbMV0sdFsyXSk6ZS5jYWxsKHIsdFswXSx0WzFdLHRbMl0pO2Nhc2UgNDpyZXR1cm4gbj9lKHRbMF0sdFsxXSx0WzJdLHRbM10pOmUuY2FsbChyLHRbMF0sdFsxXSx0WzJdLHRbM10pfXJldHVybiBlLmFwcGx5KHIsdCl9fSx7fV0sNDY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuY29mIik7dC5leHBvcnRzPU9iamVjdCgieiIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApP09iamVjdDpmdW5jdGlvbihlKXtyZXR1cm4iU3RyaW5nIj09bihlKT9lLnNwbGl0KCIiKTpPYmplY3QoZSl9fSx7Ii4vJC5jb2YiOjMwfV0sNDc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuaXRlcmF0b3JzIiksbz1lKCIuLyQud2tzIikoIml0ZXJhdG9yIiksaT1BcnJheS5wcm90b3R5cGU7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDAhPT1lJiYobi5BcnJheT09PWV8fGlbb109PT1lKX19LHsiLi8kLml0ZXJhdG9ycyI6NTUsIi4vJC53a3MiOjc4fV0sNDg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuY29mIik7dC5leHBvcnRzPUFycmF5LmlzQXJyYXl8fGZ1bmN0aW9uKGUpe3JldHVybiJBcnJheSI9PW4oZSl9fSx7Ii4vJC5jb2YiOjMwfV0sNDk6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIm9iamVjdCI9PXR5cGVvZiBlP251bGwhPT1lOiJmdW5jdGlvbiI9PXR5cGVvZiBlfX0se31dLDUwOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLmFuLW9iamVjdCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscixvKXt0cnl7cmV0dXJuIG8/dChuKHIpWzBdLHJbMV0pOnQocil9Y2F0Y2goaSl7dmFyIHM9ZVsicmV0dXJuIl07dGhyb3cgdm9pZCAwIT09cyYmbihzLmNhbGwoZSkpLGl9fX0seyIuLyQuYW4tb2JqZWN0IjoyOH1dLDUxOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3ZhciBuPWUoIi4vJCIpLG89ZSgiLi8kLnByb3BlcnR5LWRlc2MiKSxpPWUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpLHM9e307ZSgiLi8kLmhpZGUiKShzLGUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSksdC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtlLnByb3RvdHlwZT1uLmNyZWF0ZShzLHtuZXh0Om8oMSxyKX0pLGkoZSx0KyIgSXRlcmF0b3IiKX19LHsiLi8kIjo1NiwiLi8kLmhpZGUiOjQzLCIuLyQucHJvcGVydHktZGVzYyI6NjEsIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6NjcsIi4vJC53a3MiOjc4fV0sNTI6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi8kLmxpYnJhcnkiKSxvPWUoIi4vJC5leHBvcnQiKSxpPWUoIi4vJC5yZWRlZmluZSIpLHM9ZSgiLi8kLmhpZGUiKSxhPWUoIi4vJC5oYXMiKSxjPWUoIi4vJC5pdGVyYXRvcnMiKSx1PWUoIi4vJC5pdGVyLWNyZWF0ZSIpLGw9ZSgiLi8kLnNldC10by1zdHJpbmctdGFnIiksZj1lKCIuLyQiKS5nZXRQcm90byxkPWUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSxwPSEoW10ua2V5cyYmIm5leHQiaW5bXS5rZXlzKCkpLGI9IkBAaXRlcmF0b3IiLGg9ImtleXMiLHY9InZhbHVlcyIseT1mdW5jdGlvbigpe3JldHVybiB0aGlzfTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0LHIsXyxnLG0sail7dShyLHQsXyk7dmFyICQsTyx3PWZ1bmN0aW9uKGUpe2lmKCFwJiZlIGluIEUpcmV0dXJuIEVbZV07c3dpdGNoKGUpe2Nhc2UgaDpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyxlKX07Y2FzZSB2OnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgcih0aGlzLGUpfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyxlKX19LGs9dCsiIEl0ZXJhdG9yIix4PWc9PXYsQz0hMSxFPWUucHJvdG90eXBlLFM9RVtkXXx8RVtiXXx8ZyYmRVtnXSxUPVN8fHcoZyk7aWYoUyl7dmFyIE09ZihULmNhbGwobmV3IGUpKTtsKE0saywhMCksIW4mJmEoRSxiKSYmcyhNLGQseSkseCYmUy5uYW1lIT09diYmKEM9ITAsVD1mdW5jdGlvbigpe3JldHVybiBTLmNhbGwodGhpcyl9KX1pZihuJiYhanx8IXAmJiFDJiZFW2RdfHxzKEUsZCxUKSxjW3RdPVQsY1trXT15LGcpaWYoJD17dmFsdWVzOng/VDp3KHYpLGtleXM6bT9UOncoaCksZW50cmllczp4P3coImVudHJpZXMiKTpUfSxqKWZvcihPIGluICQpTyBpbiBFfHxpKEUsTywkW09dKTtlbHNlIG8oby5QK28uRioocHx8QyksdCwkKTtyZXR1cm4gJH19LHsiLi8kIjo1NiwiLi8kLmV4cG9ydCI6MzcsIi4vJC5oYXMiOjQyLCIuLyQuaGlkZSI6NDMsIi4vJC5pdGVyLWNyZWF0ZSI6NTEsIi4vJC5pdGVyYXRvcnMiOjU1LCIuLyQubGlicmFyeSI6NTgsIi4vJC5yZWRlZmluZSI6NjMsIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6NjcsIi4vJC53a3MiOjc4fV0sNTM6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQud2tzIikoIml0ZXJhdG9yIiksbz0hMTt0cnl7dmFyIGk9WzddW25dKCk7aVsicmV0dXJuIl09ZnVuY3Rpb24oKXtvPSEwfSxBcnJheS5mcm9tKGksZnVuY3Rpb24oKXt0aHJvdyAyfSl9Y2F0Y2gocyl7fXQuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKCF0JiYhbylyZXR1cm4hMTt2YXIgcj0hMTt0cnl7dmFyIGk9WzddLHM9aVtuXSgpO3MubmV4dD1mdW5jdGlvbigpe3I9ITB9LGlbbl09ZnVuY3Rpb24oKXtyZXR1cm4gc30sZShpKX1jYXRjaChhKXt9cmV0dXJuIHJ9fSx7Ii4vJC53a3MiOjc4fV0sNTQ6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm57dmFsdWU6dCxkb25lOiEhZX19fSx7fV0sNTU6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9e319LHt9XSw1NjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPU9iamVjdDt0LmV4cG9ydHM9e2NyZWF0ZTpuLmNyZWF0ZSxnZXRQcm90bzpuLmdldFByb3RvdHlwZU9mLGlzRW51bTp7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxnZXREZXNjOm4uZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLHNldERlc2M6bi5kZWZpbmVQcm9wZXJ0eSxzZXREZXNjczpuLmRlZmluZVByb3BlcnRpZXMsZ2V0S2V5czpuLmtleXMsZ2V0TmFtZXM6bi5nZXRPd25Qcm9wZXJ0eU5hbWVzLGdldFN5bWJvbHM6bi5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMsZWFjaDpbXS5mb3JFYWNofX0se31dLDU3OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kIiksbz1lKCIuLyQudG8taW9iamVjdCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2Zvcih2YXIgcixpPW8oZSkscz1uLmdldEtleXMoaSksYT1zLmxlbmd0aCxjPTA7YT5jOylpZihpW3I9c1tjKytdXT09PXQpcmV0dXJuIHJ9fSx7Ii4vJCI6NTYsIi4vJC50by1pb2JqZWN0Ijo3NH1dLDU4OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPSEwfSx7fV0sNTk6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbixvLGkscz1lKCIuLyQuZ2xvYmFsIiksYT1lKCIuLyQudGFzayIpLnNldCxjPXMuTXV0YXRpb25PYnNlcnZlcnx8cy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyLHU9cy5wcm9jZXNzLGw9cy5Qcm9taXNlLGY9InByb2Nlc3MiPT1lKCIuLyQuY29mIikodSksZD1mdW5jdGlvbigpe3ZhciBlLHQscjtmb3IoZiYmKGU9dS5kb21haW4pJiYodS5kb21haW49bnVsbCxlLmV4aXQoKSk7bjspdD1uLmRvbWFpbixyPW4uZm4sdCYmdC5lbnRlcigpLHIoKSx0JiZ0LmV4aXQoKSxuPW4ubmV4dDtvPXZvaWQgMCxlJiZlLmVudGVyKCl9O2lmKGYpaT1mdW5jdGlvbigpe3UubmV4dFRpY2soZCl9O2Vsc2UgaWYoYyl7dmFyIHA9MSxiPWRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCIiKTtuZXcgYyhkKS5vYnNlcnZlKGIse2NoYXJhY3RlckRhdGE6ITB9KSxpPWZ1bmN0aW9uKCl7Yi5kYXRhPXA9LXB9fWVsc2UgaT1sJiZsLnJlc29sdmU/ZnVuY3Rpb24oKXtsLnJlc29sdmUoKS50aGVuKGQpfTpmdW5jdGlvbigpe2EuY2FsbChzLGQpfTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7dmFyIHQ9e2ZuOmUsbmV4dDp2b2lkIDAsZG9tYWluOmYmJnUuZG9tYWlufTtvJiYoby5uZXh0PXQpLG58fChuPXQsaSgpKSxvPXR9fSx7Ii4vJC5jb2YiOjMwLCIuLyQuZ2xvYmFsIjo0MSwiLi8kLnRhc2siOjcyfV0sNjA6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuZXhwb3J0Iiksbz1lKCIuLyQuY29yZSIpLGk9ZSgiLi8kLmZhaWxzIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIHI9KG8uT2JqZWN0fHx7fSlbZV18fE9iamVjdFtlXSxzPXt9O3NbZV09dChyKSxuKG4uUytuLkYqaShmdW5jdGlvbigpe3IoMSl9KSwiT2JqZWN0IixzKX19LHsiLi8kLmNvcmUiOjMxLCIuLyQuZXhwb3J0IjozNywiLi8kLmZhaWxzIjozOH1dLDYxOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJue2VudW1lcmFibGU6ISgxJmUpLGNvbmZpZ3VyYWJsZTohKDImZSksd3JpdGFibGU6ISg0JmUpLHZhbHVlOnR9fX0se31dLDYyOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLnJlZGVmaW5lIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByIGluIHQpbihlLHIsdFtyXSk7cmV0dXJuIGV9fSx7Ii4vJC5yZWRlZmluZSI6NjN9XSw2MzpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1lKCIuLyQuaGlkZSIpfSx7Ii4vJC5oaWRlIjo0M31dLDY0OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPU9iamVjdC5pc3x8ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT09PXQ/MCE9PWV8fDEvZT09PTEvdDplIT1lJiZ0IT10fX0se31dLDY1OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kIikuZ2V0RGVzYyxvPWUoIi4vJC5pcy1vYmplY3QiKSxpPWUoIi4vJC5hbi1vYmplY3QiKSxzPWZ1bmN0aW9uKGUsdCl7aWYoaShlKSwhbyh0KSYmbnVsbCE9PXQpdGhyb3cgVHlwZUVycm9yKHQrIjogY2FuJ3Qgc2V0IGFzIHByb3RvdHlwZSEiKX07dC5leHBvcnRzPXtzZXQ6T2JqZWN0LnNldFByb3RvdHlwZU9mfHwoIl9fcHJvdG9fXyJpbnt9P2Z1bmN0aW9uKHQscixvKXt0cnl7bz1lKCIuLyQuY3R4IikoRnVuY3Rpb24uY2FsbCxuKE9iamVjdC5wcm90b3R5cGUsIl9fcHJvdG9fXyIpLnNldCwyKSxvKHQsW10pLHI9ISh0IGluc3RhbmNlb2YgQXJyYXkpfWNhdGNoKGkpe3I9ITB9cmV0dXJuIGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHMoZSx0KSxyP2UuX19wcm90b19fPXQ6byhlLHQpLGV9fSh7fSwhMSk6dm9pZCAwKSxjaGVjazpzfX0seyIuLyQiOjU2LCIuLyQuYW4tb2JqZWN0IjoyOCwiLi8kLmN0eCI6MzIsIi4vJC5pcy1vYmplY3QiOjQ5fV0sNjY6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi8kLmNvcmUiKSxvPWUoIi4vJCIpLGk9ZSgiLi8kLmRlc2NyaXB0b3JzIikscz1lKCIuLyQud2tzIikoInNwZWNpZXMiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7dmFyIHQ9bltlXTtpJiZ0JiYhdFtzXSYmby5zZXREZXNjKHQscyx7Y29uZmlndXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzfX0pfX0seyIuLyQiOjU2LCIuLyQuY29yZSI6MzEsIi4vJC5kZXNjcmlwdG9ycyI6MzQsIi4vJC53a3MiOjc4fV0sNjc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQiKS5zZXREZXNjLG89ZSgiLi8kLmhhcyIpLGk9ZSgiLi8kLndrcyIpKCJ0b1N0cmluZ1RhZyIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7ZSYmIW8oZT1yP2U6ZS5wcm90b3R5cGUsaSkmJm4oZSxpLHtjb25maWd1cmFibGU6ITAsdmFsdWU6dH0pfX0seyIuLyQiOjU2LCIuLyQuaGFzIjo0MiwiLi8kLndrcyI6Nzh9XSw2ODpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5nbG9iYWwiKSxvPSJfX2NvcmUtanNfc2hhcmVkX18iLGk9bltvXXx8KG5bb109e30pO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaVtlXXx8KGlbZV09e30pfX0seyIuLyQuZ2xvYmFsIjo0MX1dLDY5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLmFuLW9iamVjdCIpLG89ZSgiLi8kLmEtZnVuY3Rpb24iKSxpPWUoIi4vJC53a3MiKSgic3BlY2llcyIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3ZhciByLHM9bihlKS5jb25zdHJ1Y3RvcjtyZXR1cm4gdm9pZCAwPT09c3x8dm9pZCAwPT0ocj1uKHMpW2ldKT90Om8ocil9fSx7Ii4vJC5hLWZ1bmN0aW9uIjoyNiwiLi8kLmFuLW9iamVjdCI6MjgsIi4vJC53a3MiOjc4fV0sNzA6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0LHIpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IFR5cGVFcnJvcihyKyI6IHVzZSB0aGUgJ25ldycgb3BlcmF0b3IhIik7cmV0dXJuIGV9fSx7fV0sNzE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQudG8taW50ZWdlciIpLG89ZSgiLi8kLmRlZmluZWQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQscil7dmFyIGkscyxhPVN0cmluZyhvKHQpKSxjPW4ociksdT1hLmxlbmd0aDtyZXR1cm4gMD5jfHxjPj11P2U/IiI6dm9pZCAwOihpPWEuY2hhckNvZGVBdChjKSw1NTI5Nj5pfHxpPjU2MzE5fHxjKzE9PT11fHwocz1hLmNoYXJDb2RlQXQoYysxKSk8NTYzMjB8fHM+NTczNDM/ZT9hLmNoYXJBdChjKTppOmU/YS5zbGljZShjLGMrMik6KGktNTUyOTY8PDEwKSsocy01NjMyMCkrNjU1MzYpfX19LHsiLi8kLmRlZmluZWQiOjMzLCIuLyQudG8taW50ZWdlciI6NzN9XSw3MjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG8saSxzPWUoIi4vJC5jdHgiKSxhPWUoIi4vJC5pbnZva2UiKSxjPWUoIi4vJC5odG1sIiksdT1lKCIuLyQuZG9tLWNyZWF0ZSIpLGw9ZSgiLi8kLmdsb2JhbCIpLGY9bC5wcm9jZXNzLGQ9bC5zZXRJbW1lZGlhdGUscD1sLmNsZWFySW1tZWRpYXRlLGI9bC5NZXNzYWdlQ2hhbm5lbCxoPTAsdj17fSx5PSJvbnJlYWR5c3RhdGVjaGFuZ2UiLF89ZnVuY3Rpb24oKXt2YXIgZT0rdGhpcztpZih2Lmhhc093blByb3BlcnR5KGUpKXt2YXIgdD12W2VdO2RlbGV0ZSB2W2VdLHQoKX19LGc9ZnVuY3Rpb24oZSl7Xy5jYWxsKGUuZGF0YSl9O2QmJnB8fChkPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxyPTE7YXJndW1lbnRzLmxlbmd0aD5yOyl0LnB1c2goYXJndW1lbnRzW3IrK10pO3JldHVybiB2WysraF09ZnVuY3Rpb24oKXthKCJmdW5jdGlvbiI9PXR5cGVvZiBlP2U6RnVuY3Rpb24oZSksdCl9LG4oaCksaH0scD1mdW5jdGlvbihlKXtkZWxldGUgdltlXX0sInByb2Nlc3MiPT1lKCIuLyQuY29mIikoZik/bj1mdW5jdGlvbihlKXtmLm5leHRUaWNrKHMoXyxlLDEpKX06Yj8obz1uZXcgYixpPW8ucG9ydDIsby5wb3J0MS5vbm1lc3NhZ2U9ZyxuPXMoaS5wb3N0TWVzc2FnZSxpLDEpKTpsLmFkZEV2ZW50TGlzdGVuZXImJiJmdW5jdGlvbiI9PXR5cGVvZiBwb3N0TWVzc2FnZSYmIWwuaW1wb3J0U2NyaXB0cz8obj1mdW5jdGlvbihlKXtsLnBvc3RNZXNzYWdlKGUrIiIsIioiKX0sbC5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixnLCExKSk6bj15IGluIHUoInNjcmlwdCIpP2Z1bmN0aW9uKGUpe2MuYXBwZW5kQ2hpbGQodSgic2NyaXB0IikpW3ldPWZ1bmN0aW9uKCl7Yy5yZW1vdmVDaGlsZCh0aGlzKSxfLmNhbGwoZSl9fTpmdW5jdGlvbihlKXtzZXRUaW1lb3V0KHMoXyxlLDEpLDApfSksdC5leHBvcnRzPXtzZXQ6ZCxjbGVhcjpwfX0seyIuLyQuY29mIjozMCwiLi8kLmN0eCI6MzIsIi4vJC5kb20tY3JlYXRlIjozNSwiLi8kLmdsb2JhbCI6NDEsIi4vJC5odG1sIjo0NCwiLi8kLmludm9rZSI6NDV9XSw3MzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPU1hdGguY2VpbCxvPU1hdGguZmxvb3I7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBpc05hTihlPStlKT8wOihlPjA/bzpuKShlKX19LHt9XSw3NDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5pb2JqZWN0Iiksbz1lKCIuLyQuZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbihvKGUpKX19LHsiLi8kLmRlZmluZWQiOjMzLCIuLyQuaW9iamVjdCI6NDZ9XSw3NTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC50by1pbnRlZ2VyIiksbz1NYXRoLm1pbjt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGU+MD9vKG4oZSksOTAwNzE5OTI1NDc0MDk5MSk6MH19LHsiLi8kLnRvLWludGVnZXIiOjczfV0sNzY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KG4oZSkpfX0seyIuLyQuZGVmaW5lZCI6MzN9XSw3NzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPTAsbz1NYXRoLnJhbmRvbSgpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4iU3ltYm9sKCIuY29uY2F0KHZvaWQgMD09PWU/IiI6ZSwiKV8iLCgrK24rbykudG9TdHJpbmcoMzYpKX19LHt9XSw3ODpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5zaGFyZWQiKSgid2tzIiksbz1lKCIuLyQudWlkIiksaT1lKCIuLyQuZ2xvYmFsIikuU3ltYm9sO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbltlXXx8KG5bZV09aSYmaVtlXXx8KGl8fG8pKCJTeW1ib2wuIitlKSl9fSx7Ii4vJC5nbG9iYWwiOjQxLCIuLyQuc2hhcmVkIjo2OCwiLi8kLnVpZCI6Nzd9XSw3OTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5jbGFzc29mIiksbz1lKCIuLyQud2tzIikoIml0ZXJhdG9yIiksaT1lKCIuLyQuaXRlcmF0b3JzIik7dC5leHBvcnRzPWUoIi4vJC5jb3JlIikuZ2V0SXRlcmF0b3JNZXRob2Q9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMCE9ZT9lW29dfHxlWyJAQGl0ZXJhdG9yIl18fGlbbihlKV06dm9pZCAwfX0seyIuLyQuY2xhc3NvZiI6MjksIi4vJC5jb3JlIjozMSwiLi8kLml0ZXJhdG9ycyI6NTUsIi4vJC53a3MiOjc4fV0sODA6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi8kLmFkZC10by11bnNjb3BhYmxlcyIpLG89ZSgiLi8kLml0ZXItc3RlcCIpLGk9ZSgiLi8kLml0ZXJhdG9ycyIpLHM9ZSgiLi8kLnRvLWlvYmplY3QiKTt0LmV4cG9ydHM9ZSgiLi8kLml0ZXItZGVmaW5lIikoQXJyYXksIkFycmF5IixmdW5jdGlvbihlLHQpe3RoaXMuX3Q9cyhlKSx0aGlzLl9pPTAsdGhpcy5faz10fSxmdW5jdGlvbigpe3ZhciBlPXRoaXMuX3QsdD10aGlzLl9rLHI9dGhpcy5faSsrO3JldHVybiFlfHxyPj1lLmxlbmd0aD8odGhpcy5fdD12b2lkIDAsbygxKSk6ImtleXMiPT10P28oMCxyKToidmFsdWVzIj09dD9vKDAsZVtyXSk6bygwLFtyLGVbcl1dKX0sInZhbHVlcyIpLGkuQXJndW1lbnRzPWkuQXJyYXksbigia2V5cyIpLG4oInZhbHVlcyIpLG4oImVudHJpZXMiKX0seyIuLyQuYWRkLXRvLXVuc2NvcGFibGVzIjoyNywiLi8kLml0ZXItZGVmaW5lIjo1MiwiLi8kLml0ZXItc3RlcCI6NTQsIi4vJC5pdGVyYXRvcnMiOjU1LCIuLyQudG8taW9iamVjdCI6NzR9XSw4MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC50by1pb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIixmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCxyKXtyZXR1cm4gZShuKHQpLHIpfX0pfSx7Ii4vJC5vYmplY3Qtc2FwIjo2MCwiLi8kLnRvLWlvYmplY3QiOjc0fV0sODI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQudG8tb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgiZ2V0UHJvdG90eXBlT2YiLGZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZShuKHQpKX19KX0seyIuLyQub2JqZWN0LXNhcCI6NjAsIi4vJC50by1vYmplY3QiOjc2fV0sODM6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQudG8tb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgia2V5cyIsZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBlKG4odCkpfX0pfSx7Ii4vJC5vYmplY3Qtc2FwIjo2MCwiLi8kLnRvLW9iamVjdCI6NzZ9XSw4NDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5leHBvcnQiKTtuKG4uUywiT2JqZWN0Iix7c2V0UHJvdG90eXBlT2Y6ZSgiLi8kLnNldC1wcm90byIpLnNldH0pfSx7Ii4vJC5leHBvcnQiOjM3LCIuLyQuc2V0LXByb3RvIjo2NX1dLDg1OltmdW5jdGlvbihlLHQscil7fSx7fV0sODY6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG4sbz1lKCIuLyQiKSxpPWUoIi4vJC5saWJyYXJ5Iikscz1lKCIuLyQuZ2xvYmFsIiksYT1lKCIuLyQuY3R4IiksYz1lKCIuLyQuY2xhc3NvZiIpLHU9ZSgiLi8kLmV4cG9ydCIpLGw9ZSgiLi8kLmlzLW9iamVjdCIpLGY9ZSgiLi8kLmFuLW9iamVjdCIpLGQ9ZSgiLi8kLmEtZnVuY3Rpb24iKSxwPWUoIi4vJC5zdHJpY3QtbmV3IiksYj1lKCIuLyQuZm9yLW9mIiksaD1lKCIuLyQuc2V0LXByb3RvIikuc2V0LHY9ZSgiLi8kLnNhbWUtdmFsdWUiKSx5PWUoIi4vJC53a3MiKSgic3BlY2llcyIpLF89ZSgiLi8kLnNwZWNpZXMtY29uc3RydWN0b3IiKSxnPWUoIi4vJC5taWNyb3Rhc2siKSxtPSJQcm9taXNlIixqPXMucHJvY2VzcywkPSJwcm9jZXNzIj09YyhqKSxPPXNbbV0sdz1mdW5jdGlvbihlKXt2YXIgdD1uZXcgTyhmdW5jdGlvbigpe30pO3JldHVybiBlJiYodC5jb25zdHJ1Y3Rvcj1PYmplY3QpLE8ucmVzb2x2ZSh0KT09PXR9LGs9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe3ZhciByPW5ldyBPKGUpO3JldHVybiBoKHIsdC5wcm90b3R5cGUpLHJ9dmFyIHI9ITE7dHJ5e2lmKHI9TyYmTy5yZXNvbHZlJiZ3KCksaCh0LE8pLHQucHJvdG90eXBlPW8uY3JlYXRlKE8ucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6dH19KSx0LnJlc29sdmUoNSkudGhlbihmdW5jdGlvbigpe30paW5zdGFuY2VvZiB0fHwocj0hMSksciYmZSgiLi8kLmRlc2NyaXB0b3JzIikpe3ZhciBuPSExO08ucmVzb2x2ZShvLnNldERlc2Moe30sInRoZW4iLHtnZXQ6ZnVuY3Rpb24oKXtuPSEwfX0pKSxyPW59fWNhdGNoKGkpe3I9ITF9cmV0dXJuIHJ9KCkseD1mdW5jdGlvbihlLHQpe3JldHVybiBpJiZlPT09TyYmdD09PW4/ITA6dihlLHQpfSxDPWZ1bmN0aW9uKGUpe3ZhciB0PWYoZSlbeV07cmV0dXJuIHZvaWQgMCE9dD90OmV9LEU9ZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIGwoZSkmJiJmdW5jdGlvbiI9PXR5cGVvZih0PWUudGhlbik/dDohMX0sUz1mdW5jdGlvbihlKXt2YXIgdCxyO3RoaXMucHJvbWlzZT1uZXcgZShmdW5jdGlvbihlLG4pe2lmKHZvaWQgMCE9PXR8fHZvaWQgMCE9PXIpdGhyb3cgVHlwZUVycm9yKCJCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvciIpO3Q9ZSxyPW59KSx0aGlzLnJlc29sdmU9ZCh0KSx0aGlzLnJlamVjdD1kKHIpfSxUPWZ1bmN0aW9uKGUpe3RyeXtlKCl9Y2F0Y2godCl7cmV0dXJue2Vycm9yOnR9fX0sTT1mdW5jdGlvbihlLHQpe2lmKCFlLm4pe2Uubj0hMDt2YXIgcj1lLmM7ZyhmdW5jdGlvbigpe2Zvcih2YXIgbj1lLnYsbz0xPT1lLnMsaT0wLGE9ZnVuY3Rpb24odCl7dmFyIHIsaSxzPW8/dC5vazp0LmZhaWwsYT10LnJlc29sdmUsYz10LnJlamVjdDt0cnl7cz8ob3x8KGUuaD0hMCkscj1zPT09ITA/bjpzKG4pLHI9PT10LnByb21pc2U/YyhUeXBlRXJyb3IoIlByb21pc2UtY2hhaW4gY3ljbGUiKSk6KGk9RShyKSk/aS5jYWxsKHIsYSxjKTphKHIpKTpjKG4pfWNhdGNoKHUpe2ModSl9fTtyLmxlbmd0aD5pOylhKHJbaSsrXSk7ci5sZW5ndGg9MCxlLm49ITEsdCYmc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciB0LHIsbz1lLnA7TihvKSYmKCQ/ai5lbWl0KCJ1bmhhbmRsZWRSZWplY3Rpb24iLG4sbyk6KHQ9cy5vbnVuaGFuZGxlZHJlamVjdGlvbik/dCh7cHJvbWlzZTpvLHJlYXNvbjpufSk6KHI9cy5jb25zb2xlKSYmci5lcnJvciYmci5lcnJvcigiVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uIixuKSksZS5hPXZvaWQgMH0sMSl9KX19LE49ZnVuY3Rpb24oZSl7dmFyIHQscj1lLl9kLG49ci5hfHxyLmMsbz0wO2lmKHIuaClyZXR1cm4hMTtmb3IoO24ubGVuZ3RoPm87KWlmKHQ9bltvKytdLHQuZmFpbHx8IU4odC5wcm9taXNlKSlyZXR1cm4hMTtyZXR1cm4hMH0sUj1mdW5jdGlvbihlKXt2YXIgdD10aGlzO3QuZHx8KHQuZD0hMCx0PXQucnx8dCx0LnY9ZSx0LnM9Mix0LmE9dC5jLnNsaWNlKCksTSh0LCEwKSl9LEQ9ZnVuY3Rpb24oZSl7dmFyIHQscj10aGlzO2lmKCFyLmQpe3IuZD0hMCxyPXIucnx8cjt0cnl7aWYoci5wPT09ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7KHQ9RShlKSk/ZyhmdW5jdGlvbigpe3ZhciBuPXtyOnIsZDohMX07dHJ5e3QuY2FsbChlLGEoRCxuLDEpLGEoUixuLDEpKX1jYXRjaChvKXtSLmNhbGwobixvKX19KTooci52PWUsci5zPTEsTShyLCExKSl9Y2F0Y2gobil7Ui5jYWxsKHtyOnIsZDohMX0sbil9fX07a3x8KE89ZnVuY3Rpb24oZSl7ZChlKTt2YXIgdD10aGlzLl9kPXtwOnAodGhpcyxPLG0pLGM6W10sYTp2b2lkIDAsczowLGQ6ITEsdjp2b2lkIDAsaDohMSxuOiExfTt0cnl7ZShhKEQsdCwxKSxhKFIsdCwxKSl9Y2F0Y2gocil7Ui5jYWxsKHQscil9fSxlKCIuLyQucmVkZWZpbmUtYWxsIikoTy5wcm90b3R5cGUse3RoZW46ZnVuY3Rpb24oZSx0KXt2YXIgcj1uZXcgUyhfKHRoaXMsTykpLG49ci5wcm9taXNlLG89dGhpcy5fZDtyZXR1cm4gci5vaz0iZnVuY3Rpb24iPT10eXBlb2YgZT9lOiEwLHIuZmFpbD0iZnVuY3Rpb24iPT10eXBlb2YgdCYmdCxvLmMucHVzaChyKSxvLmEmJm8uYS5wdXNoKHIpLG8ucyYmTShvLCExKSxufSwiY2F0Y2giOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnRoZW4odm9pZCAwLGUpfX0pKSx1KHUuRyt1LlcrdS5GKiFrLHtQcm9taXNlOk99KSxlKCIuLyQuc2V0LXRvLXN0cmluZy10YWciKShPLG0pLGUoIi4vJC5zZXQtc3BlY2llcyIpKG0pLG49ZSgiLi8kLmNvcmUiKVttXSx1KHUuUyt1LkYqIWssbSx7cmVqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBTKHRoaXMpLHI9dC5yZWplY3Q7cmV0dXJuIHIoZSksdC5wcm9taXNlfX0pLHUodS5TK3UuRiooIWt8fHcoITApKSxtLHtyZXNvbHZlOmZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBPJiZ4KGUuY29uc3RydWN0b3IsdGhpcykpcmV0dXJuIGU7dmFyIHQ9bmV3IFModGhpcykscj10LnJlc29sdmU7cmV0dXJuIHIoZSksdC5wcm9taXNlfX0pLHUodS5TK3UuRiohKGsmJmUoIi4vJC5pdGVyLWRldGVjdCIpKGZ1bmN0aW9uKGUpe08uYWxsKGUpWyJjYXRjaCJdKGZ1bmN0aW9uKCl7fSl9KSksbSx7YWxsOmZ1bmN0aW9uKGUpe3ZhciB0PUModGhpcykscj1uZXcgUyh0KSxuPXIucmVzb2x2ZSxpPXIucmVqZWN0LHM9W10sYT1UKGZ1bmN0aW9uKCl7YihlLCExLHMucHVzaCxzKTt2YXIgcj1zLmxlbmd0aCxhPUFycmF5KHIpO3I/by5lYWNoLmNhbGwocyxmdW5jdGlvbihlLG8pe3ZhciBzPSExO3QucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uKGUpe3N8fChzPSEwLGFbb109ZSwtLXJ8fG4oYSkpfSxpKX0pOm4oYSl9KTtyZXR1cm4gYSYmaShhLmVycm9yKSxyLnByb21pc2V9LHJhY2U6ZnVuY3Rpb24oZSl7dmFyIHQ9Qyh0aGlzKSxyPW5ldyBTKHQpLG49ci5yZWplY3Qsbz1UKGZ1bmN0aW9uKCl7YihlLCExLGZ1bmN0aW9uKGUpe3QucmVzb2x2ZShlKS50aGVuKHIucmVzb2x2ZSxuKX0pfSk7cmV0dXJuIG8mJm4oby5lcnJvciksci5wcm9taXNlfX0pfSx7Ii4vJCI6NTYsIi4vJC5hLWZ1bmN0aW9uIjoyNiwiLi8kLmFuLW9iamVjdCI6MjgsIi4vJC5jbGFzc29mIjoyOSwiLi8kLmNvcmUiOjMxLCIuLyQuY3R4IjozMiwiLi8kLmRlc2NyaXB0b3JzIjozNCwiLi8kLmV4cG9ydCI6MzcsIi4vJC5mb3Itb2YiOjM5LCIuLyQuZ2xvYmFsIjo0MSwiLi8kLmlzLW9iamVjdCI6NDksIi4vJC5pdGVyLWRldGVjdCI6NTMsIi4vJC5saWJyYXJ5Ijo1OCwiLi8kLm1pY3JvdGFzayI6NTksIi4vJC5yZWRlZmluZS1hbGwiOjYyLCIuLyQuc2FtZS12YWx1ZSI6NjQsIi4vJC5zZXQtcHJvdG8iOjY1LCIuLyQuc2V0LXNwZWNpZXMiOjY2LCIuLyQuc2V0LXRvLXN0cmluZy10YWciOjY3LCIuLyQuc3BlY2llcy1jb25zdHJ1Y3RvciI6NjksIi4vJC5zdHJpY3QtbmV3Ijo3MCwiLi8kLndrcyI6Nzh9XSw4NzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCIuLyQuc3RyaW5nLWF0IikoITApO2UoIi4vJC5pdGVyLWRlZmluZSIpKFN0cmluZywiU3RyaW5nIixmdW5jdGlvbihlKXt0aGlzLl90PVN0cmluZyhlKSx0aGlzLl9pPTB9LGZ1bmN0aW9uKCl7dmFyIGUsdD10aGlzLl90LHI9dGhpcy5faTtyZXR1cm4gcj49dC5sZW5ndGg/e3ZhbHVlOnZvaWQgMCxkb25lOiEwfTooZT1uKHQsciksdGhpcy5faSs9ZS5sZW5ndGgse3ZhbHVlOmUsZG9uZTohMX0pfSl9LHsiLi8kLml0ZXItZGVmaW5lIjo1MiwiLi8kLnN0cmluZy1hdCI6NzF9XSw4ODpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCIuLyQiKSxvPWUoIi4vJC5nbG9iYWwiKSxpPWUoIi4vJC5oYXMiKSxzPWUoIi4vJC5kZXNjcmlwdG9ycyIpLGE9ZSgiLi8kLmV4cG9ydCIpLGM9ZSgiLi8kLnJlZGVmaW5lIiksdT1lKCIuLyQuZmFpbHMiKSxsPWUoIi4vJC5zaGFyZWQiKSxmPWUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpLGQ9ZSgiLi8kLnVpZCIpLHA9ZSgiLi8kLndrcyIpLGI9ZSgiLi8kLmtleW9mIiksaD1lKCIuLyQuZ2V0LW5hbWVzIiksdj1lKCIuLyQuZW51bS1rZXlzIikseT1lKCIuLyQuaXMtYXJyYXkiKSxfPWUoIi4vJC5hbi1vYmplY3QiKSxnPWUoIi4vJC50by1pb2JqZWN0IiksbT1lKCIuLyQucHJvcGVydHktZGVzYyIpLGo9bi5nZXREZXNjLCQ9bi5zZXREZXNjLE89bi5jcmVhdGUsdz1oLmdldCxrPW8uU3ltYm9sLHg9by5KU09OLEM9eCYmeC5zdHJpbmdpZnksRT0hMSxTPXAoIl9oaWRkZW4iKSxUPW4uaXNFbnVtLE09bCgic3ltYm9sLXJlZ2lzdHJ5IiksTj1sKCJzeW1ib2xzIiksUj0iZnVuY3Rpb24iPT10eXBlb2YgayxEPU9iamVjdC5wcm90b3R5cGUsUD1zJiZ1KGZ1bmN0aW9uKCl7cmV0dXJuIDchPU8oJCh7fSwiYSIse2dldDpmdW5jdGlvbigpe3JldHVybiAkKHRoaXMsImEiLHt2YWx1ZTo3fSkuYX19KSkuYX0pP2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1qKEQsdCk7biYmZGVsZXRlIERbdF0sJChlLHQsciksbiYmZSE9PUQmJiQoRCx0LG4pfTokLEE9ZnVuY3Rpb24oZSl7dmFyIHQ9TltlXT1PKGsucHJvdG90eXBlKTtyZXR1cm4gdC5faz1lLHMmJkUmJlAoRCxlLHtjb25maWd1cmFibGU6ITAsc2V0OmZ1bmN0aW9uKHQpe2kodGhpcyxTKSYmaSh0aGlzW1NdLGUpJiYodGhpc1tTXVtlXT0hMSksUCh0aGlzLGUsbSgxLHQpKX19KSx0fSxMPWZ1bmN0aW9uKGUpe3JldHVybiJzeW1ib2wiPT10eXBlb2YgZX0sST1mdW5jdGlvbihlLHQscil7cmV0dXJuIHImJmkoTix0KT8oci5lbnVtZXJhYmxlPyhpKGUsUykmJmVbU11bdF0mJihlW1NdW3RdPSExKSxyPU8ocix7ZW51bWVyYWJsZTptKDAsITEpfSkpOihpKGUsUyl8fCQoZSxTLG0oMSx7fSkpLGVbU11bdF09ITApLFAoZSx0LHIpKTokKGUsdCxyKX0sRj1mdW5jdGlvbihlLHQpe18oZSk7Zm9yKHZhciByLG49dih0PWcodCkpLG89MCxpPW4ubGVuZ3RoO2k+bzspSShlLHI9bltvKytdLHRbcl0pO3JldHVybiBlfSxWPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQ/TyhlKTpGKE8oZSksdCl9LHo9ZnVuY3Rpb24oZSl7dmFyIHQ9VC5jYWxsKHRoaXMsZSk7cmV0dXJuIHR8fCFpKHRoaXMsZSl8fCFpKE4sZSl8fGkodGhpcyxTKSYmdGhpc1tTXVtlXT90OiEwfSxVPWZ1bmN0aW9uKGUsdCl7dmFyIHI9aihlPWcoZSksdCk7cmV0dXJuIXJ8fCFpKE4sdCl8fGkoZSxTKSYmZVtTXVt0XXx8KHIuZW51bWVyYWJsZT0hMCkscn0sSD1mdW5jdGlvbihlKXtmb3IodmFyIHQscj13KGcoZSkpLG49W10sbz0wO3IubGVuZ3RoPm87KWkoTix0PXJbbysrXSl8fHQ9PVN8fG4ucHVzaCh0KTtyZXR1cm4gbn0sQj1mdW5jdGlvbihlKXtmb3IodmFyIHQscj13KGcoZSkpLG49W10sbz0wO3IubGVuZ3RoPm87KWkoTix0PXJbbysrXSkmJm4ucHVzaChOW3RdKTtyZXR1cm4gbn0sSj1mdW5jdGlvbihlKXtpZih2b2lkIDAhPT1lJiYhTChlKSl7Zm9yKHZhciB0LHIsbj1bZV0sbz0xLGk9YXJndW1lbnRzO2kubGVuZ3RoPm87KW4ucHVzaChpW28rK10pO3JldHVybiB0PW5bMV0sImZ1bmN0aW9uIj09dHlwZW9mIHQmJihyPXQpLCFyJiZ5KHQpfHwodD1mdW5jdGlvbihlLHQpe3JldHVybiByJiYodD1yLmNhbGwodGhpcyxlLHQpKSxMKHQpP3ZvaWQgMDp0fSksblsxXT10LEMuYXBwbHkoeCxuKX19LFc9dShmdW5jdGlvbigpe3ZhciBlPWsoKTtyZXR1cm4iW251bGxdIiE9QyhbZV0pfHwie30iIT1DKHthOmV9KXx8Int9IiE9QyhPYmplY3QoZSkpfSk7Unx8KGs9ZnVuY3Rpb24oKXtpZihMKHRoaXMpKXRocm93IFR5cGVFcnJvcigiU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIik7cmV0dXJuIEEoZChhcmd1bWVudHMubGVuZ3RoPjA/YXJndW1lbnRzWzBdOnZvaWQgMCkpfSxjKGsucHJvdG90eXBlLCJ0b1N0cmluZyIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fa30pLEw9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBrfSxuLmNyZWF0ZT1WLG4uaXNFbnVtPXosbi5nZXREZXNjPVUsbi5zZXREZXNjPUksbi5zZXREZXNjcz1GLG4uZ2V0TmFtZXM9aC5nZXQ9SCxuLmdldFN5bWJvbHM9QixzJiYhZSgiLi8kLmxpYnJhcnkiKSYmYyhELCJwcm9wZXJ0eUlzRW51bWVyYWJsZSIseiwhMCkpO3ZhciBZPXsiZm9yIjpmdW5jdGlvbihlKXtyZXR1cm4gaShNLGUrPSIiKT9NW2VdOk1bZV09ayhlKX0sa2V5Rm9yOmZ1bmN0aW9uKGUpe3JldHVybiBiKE0sZSl9LHVzZVNldHRlcjpmdW5jdGlvbigpe0U9ITB9LHVzZVNpbXBsZTpmdW5jdGlvbigpe0U9ITF9fTtuLmVhY2guY2FsbCgiaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMiLnNwbGl0KCIsIiksZnVuY3Rpb24oZSl7dmFyIHQ9cChlKTtZW2VdPVI/dDpBKHQpfSksRT0hMCxhKGEuRythLlcse1N5bWJvbDprfSksYShhLlMsIlN5bWJvbCIsWSksYShhLlMrYS5GKiFSLCJPYmplY3QiLHtjcmVhdGU6VixkZWZpbmVQcm9wZXJ0eTpJLGRlZmluZVByb3BlcnRpZXM6RixnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6VSxnZXRPd25Qcm9wZXJ0eU5hbWVzOkgsZ2V0T3duUHJvcGVydHlTeW1ib2xzOkJ9KSx4JiZhKGEuUythLkYqKCFSfHxXKSwiSlNPTiIse3N0cmluZ2lmeTpKfSksZihrLCJTeW1ib2wiKSxmKE1hdGgsIk1hdGgiLCEwKSxmKG8uSlNPTiwiSlNPTiIsITApfSx7Ii4vJCI6NTYsIi4vJC5hbi1vYmplY3QiOjI4LCIuLyQuZGVzY3JpcHRvcnMiOjM0LCIuLyQuZW51bS1rZXlzIjozNiwiLi8kLmV4cG9ydCI6MzcsIi4vJC5mYWlscyI6MzgsIi4vJC5nZXQtbmFtZXMiOjQwLCIuLyQuZ2xvYmFsIjo0MSwiLi8kLmhhcyI6NDIsIi4vJC5pcy1hcnJheSI6NDgsIi4vJC5rZXlvZiI6NTcsIi4vJC5saWJyYXJ5Ijo1OCwiLi8kLnByb3BlcnR5LWRlc2MiOjYxLCIuLyQucmVkZWZpbmUiOjYzLCIuLyQuc2V0LXRvLXN0cmluZy10YWciOjY3LCIuLyQuc2hhcmVkIjo2OCwiLi8kLnRvLWlvYmplY3QiOjc0LCIuLyQudWlkIjo3NywiLi8kLndrcyI6Nzh9XSw4OTpbZnVuY3Rpb24oZSx0LHIpe2UoIi4vZXM2LmFycmF5Lml0ZXJhdG9yIik7dmFyIG49ZSgiLi8kLml0ZXJhdG9ycyIpO24uTm9kZUxpc3Q9bi5IVE1MQ29sbGVjdGlvbj1uLkFycmF5fSx7Ii4vJC5pdGVyYXRvcnMiOjU1LCIuL2VzNi5hcnJheS5pdGVyYXRvciI6ODB9XSw5MDpbZnVuY3Rpb24oZSx0LHIpe3dpbmRvdy5NdXRhdGlvbk9ic2VydmVyPXdpbmRvdy5NdXRhdGlvbk9ic2VydmVyfHx3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlcnx8ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlKXt0aGlzLmc9W10sdGhpcy5rPWV9ZnVuY3Rpb24gcihlKXshZnVuY3Rpb24gcigpe3ZhciBuPWUudGFrZVJlY29yZHMoKTtuLmxlbmd0aCYmZS5rKG4sZSksZS5mPXNldFRpbWVvdXQocix0Ll9wZXJpb2QpfSgpfWZ1bmN0aW9uIG4odCl7dmFyIHIsbj17dHlwZTpudWxsLHRhcmdldDpudWxsLGFkZGVkTm9kZXM6W10scmVtb3ZlZE5vZGVzOltdLHByZXZpb3VzU2libGluZzpudWxsLG5leHRTaWJsaW5nOm51bGwsYXR0cmlidXRlTmFtZTpudWxsLGF0dHJpYnV0ZU5hbWVzcGFjZTpudWxsLG9sZFZhbHVlOm51bGx9O2ZvcihyIGluIHQpbltyXSE9PWUmJnRbcl0hPT1lJiYobltyXT10W3JdKTtyZXR1cm4gbn1mdW5jdGlvbiBvKGUsdCl7dmFyIHI9YShlLHQpO3JldHVybiBmdW5jdGlvbihuKXt2YXIgbyxjPW4ubGVuZ3RoO3QuYSYmci5hJiZpKG4sZSxyLmEsdC5kKSwodC5ifHx0LmUpJiYobz1zKG4sZSxyLHQpKSwob3x8bi5sZW5ndGghPT1jKSYmKHI9YShlLHQpKX19ZnVuY3Rpb24gaSh0LHIsbyxpKXtmb3IodmFyIHMsYSxjPXt9LHU9ci5hdHRyaWJ1dGVzLGw9dS5sZW5ndGg7bC0tOylzPXVbbF0sYT1zLm5hbWUsaSYmaVthXT09PWV8fChzLnZhbHVlIT09b1thXSYmdC5wdXNoKG4oe3R5cGU6ImF0dHJpYnV0ZXMiLHRhcmdldDpyLGF0dHJpYnV0ZU5hbWU6YSxvbGRWYWx1ZTpvW2FdLGF0dHJpYnV0ZU5hbWVzcGFjZTpzLm5hbWVzcGFjZVVSSX0pKSxjW2FdPSEwKTtmb3IoYSBpbiBvKWNbYV18fHQucHVzaChuKHt0YXJnZXQ6cix0eXBlOiJhdHRyaWJ1dGVzIixhdHRyaWJ1dGVOYW1lOmEsb2xkVmFsdWU6b1thXX0pKX1mdW5jdGlvbiBzKHQscixvLHMpe2Z1bmN0aW9uIGEoZSxyLG8sYSxjKXt2YXIgbD1lLmxlbmd0aC0xO2M9LX4oKGwtYykvMik7Zm9yKHZhciBmLGQscDtwPWUucG9wKCk7KWY9b1twLmhdLGQ9YVtwLmldLHMuYiYmYyYmTWF0aC5hYnMocC5oLXAuaSk+PWwmJih0LnB1c2gobih7dHlwZToiY2hpbGRMaXN0Iix0YXJnZXQ6cixhZGRlZE5vZGVzOltmXSxyZW1vdmVkTm9kZXM6W2ZdLG5leHRTaWJsaW5nOmYubmV4dFNpYmxpbmcscHJldmlvdXNTaWJsaW5nOmYucHJldmlvdXNTaWJsaW5nfSkpLGMtLSkscy5hJiZkLmEmJmkodCxmLGQuYSxzLmQpLHMuYyYmMz09PWYubm9kZVR5cGUmJmYubm9kZVZhbHVlIT09ZC5jJiZ0LnB1c2gobih7dHlwZToiY2hhcmFjdGVyRGF0YSIsdGFyZ2V0OmZ9KSkscy5lJiZ1KGYsZCl9ZnVuY3Rpb24gdShyLG8pe2Zvcih2YXIgZCxwLGIsaCx2LHk9ci5jaGlsZE5vZGVzLF89by5iLGc9eS5sZW5ndGgsbT1fP18ubGVuZ3RoOjAsaj0wLCQ9MCxPPTA7Zz4kfHxtPk87KWg9eVskXSx2PShiPV9bT10pJiZiLmosaD09PXY/KHMuYSYmYi5hJiZpKHQsaCxiLmEscy5kKSxzLmMmJmIuYyE9PWUmJmgubm9kZVZhbHVlIT09Yi5jJiZ0LnB1c2gobih7dHlwZToiY2hhcmFjdGVyRGF0YSIsdGFyZ2V0Omh9KSkscCYmYShwLHIseSxfLGopLHMuZSYmKGguY2hpbGROb2Rlcy5sZW5ndGh8fGIuYiYmYi5iLmxlbmd0aCkmJnUoaCxiKSwkKyssTysrKToobD0hMCxkfHwoZD17fSxwPVtdKSxoJiYoZFtiPWMoaCldfHwoZFtiXT0hMCwtMT09PShiPWYoXyxoLE8sImoiKSk/cy5iJiYodC5wdXNoKG4oe3R5cGU6ImNoaWxkTGlzdCIsdGFyZ2V0OnIsYWRkZWROb2RlczpbaF0sbmV4dFNpYmxpbmc6aC5uZXh0U2libGluZyxwcmV2aW91c1NpYmxpbmc6aC5wcmV2aW91c1NpYmxpbmd9KSksaisrKTpwLnB1c2goe2g6JCxpOmJ9KSksJCsrKSx2JiZ2IT09eVskXSYmKGRbYj1jKHYpXXx8KGRbYl09ITAsLTE9PT0oYj1mKHksdiwkKSk/cy5iJiYodC5wdXNoKG4oe3R5cGU6ImNoaWxkTGlzdCIsdGFyZ2V0Om8uaixyZW1vdmVkTm9kZXM6W3ZdLG5leHRTaWJsaW5nOl9bTysxXSxwcmV2aW91c1NpYmxpbmc6X1tPLTFdfSkpLGotLSk6cC5wdXNoKHtoOmIsaTpPfSkpLE8rKykpO3AmJmEocCxyLHksXyxqKX12YXIgbDtyZXR1cm4gdShyLG8pLGx9ZnVuY3Rpb24gYShlLHQpe3ZhciByPSEwO3JldHVybiBmdW5jdGlvbiBuKGUpe3ZhciBvPXtqOmV9O3JldHVybiF0LmN8fDMhPT1lLm5vZGVUeXBlJiY4IT09ZS5ub2RlVHlwZT8odC5hJiZyJiYxPT09ZS5ub2RlVHlwZSYmKG8uYT1sKGUuYXR0cmlidXRlcyxmdW5jdGlvbihlLHIpe3JldHVybiB0LmQmJiF0LmRbci5uYW1lXXx8KGVbci5uYW1lXT1yLnZhbHVlKSxlfSkpLHImJih0LmJ8fHQuY3x8dC5hJiZ0LmUpJiYoby5iPXUoZS5jaGlsZE5vZGVzLG4pKSxyPXQuZSk6by5jPWUubm9kZVZhbHVlLG99KGUpfWZ1bmN0aW9uIGMoZSl7dHJ5e3JldHVybiBlLmlkfHwoZS5tb19pZD1lLm1vX2lkfHxkKyspfWNhdGNoKHQpe3RyeXtyZXR1cm4gZS5ub2RlVmFsdWV9Y2F0Y2gocil7cmV0dXJuIGQrK319fWZ1bmN0aW9uIHUoZSx0KXtmb3IodmFyIHI9W10sbj0wO248ZS5sZW5ndGg7bisrKXJbbl09dChlW25dLG4sZSk7cmV0dXJuIHJ9ZnVuY3Rpb24gbChlLHQpe2Zvcih2YXIgcj17fSxuPTA7bjxlLmxlbmd0aDtuKyspcj10KHIsZVtuXSxuLGUpO3JldHVybiByfWZ1bmN0aW9uIGYoZSx0LHIsbil7Zm9yKDtyPGUubGVuZ3RoO3IrKylpZigobj9lW3JdW25dOmVbcl0pPT09dClyZXR1cm4gcjtyZXR1cm4tMX10Ll9wZXJpb2Q9MzAsdC5wcm90b3R5cGU9e29ic2VydmU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49e2E6ISEodC5hdHRyaWJ1dGVzfHx0LmF0dHJpYnV0ZUZpbHRlcnx8dC5hdHRyaWJ1dGVPbGRWYWx1ZSksYjohIXQuY2hpbGRMaXN0LGU6ISF0LnN1YnRyZWUsYzohKCF0LmNoYXJhY3RlckRhdGEmJiF0LmNoYXJhY3RlckRhdGFPbGRWYWx1ZSl9LGk9dGhpcy5nLHM9MDtzPGkubGVuZ3RoO3MrKylpW3NdLm09PT1lJiZpLnNwbGljZShzLDEpO3QuYXR0cmlidXRlRmlsdGVyJiYobi5kPWwodC5hdHRyaWJ1dGVGaWx0ZXIsZnVuY3Rpb24oZSx0KXsKcmV0dXJuIGVbdF09ITAsZX0pKSxpLnB1c2goe206ZSxsOm8oZSxuKX0pLHRoaXMuZnx8cih0aGlzKX0sdGFrZVJlY29yZHM6ZnVuY3Rpb24oKXtmb3IodmFyIGU9W10sdD10aGlzLmcscj0wO3I8dC5sZW5ndGg7cisrKXRbcl0ubChlKTtyZXR1cm4gZX0sZGlzY29ubmVjdDpmdW5jdGlvbigpe3RoaXMuZz1bXSxjbGVhclRpbWVvdXQodGhpcy5mKSx0aGlzLmY9bnVsbH19O3ZhciBkPTE7cmV0dXJuIHR9KHZvaWQgMCl9LHt9XSw5MTpbZnVuY3Rpb24oZSx0LHIpe09iamVjdC5vYnNlcnZlfHxmdW5jdGlvbihlLHQscixuKXsidXNlIHN0cmljdCI7dmFyIG8saSxzPVsiYWRkIiwidXBkYXRlIiwiZGVsZXRlIiwicmVjb25maWd1cmUiLCJzZXRQcm90b3R5cGUiLCJwcmV2ZW50RXh0ZW5zaW9ucyJdLGE9dC5pc0FycmF5fHxmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PWUuY2FsbCh0KX19KGUucHJvdG90eXBlLnRvU3RyaW5nKSxjPXQucHJvdG90eXBlLmluZGV4T2Y/dC5pbmRleE9mfHxmdW5jdGlvbihlLHIsbil7cmV0dXJuIHQucHJvdG90eXBlLmluZGV4T2YuY2FsbChlLHIsbil9OmZ1bmN0aW9uKGUsdCxyKXtmb3IodmFyIG49cnx8MDtuPGUubGVuZ3RoO24rKylpZihlW25dPT09dClyZXR1cm4gbjtyZXR1cm4tMX0sdT1yLk1hcCE9PW4mJk1hcC5wcm90b3R5cGUuZm9yRWFjaD9mdW5jdGlvbigpe3JldHVybiBuZXcgTWFwfTpmdW5jdGlvbigpe3ZhciBlPVtdLHQ9W107cmV0dXJue3NpemU6MCxoYXM6ZnVuY3Rpb24odCl7cmV0dXJuIGMoZSx0KT4tMX0sZ2V0OmZ1bmN0aW9uKHIpe3JldHVybiB0W2MoZSxyKV19LHNldDpmdW5jdGlvbihyLG4pe3ZhciBvPWMoZSxyKTstMT09PW8/KGUucHVzaChyKSx0LnB1c2gobiksdGhpcy5zaXplKyspOnRbb109bn0sImRlbGV0ZSI6ZnVuY3Rpb24ocil7dmFyIG49YyhlLHIpO24+LTEmJihlLnNwbGljZShuLDEpLHQuc3BsaWNlKG4sMSksdGhpcy5zaXplLS0pfSxmb3JFYWNoOmZ1bmN0aW9uKHIpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXIuY2FsbChhcmd1bWVudHNbMV0sdFtuXSxlW25dLHRoaXMpfX19LGw9ZS5nZXRPd25Qcm9wZXJ0eU5hbWVzP2Z1bmN0aW9uKCl7dmFyIHQ9ZS5nZXRPd25Qcm9wZXJ0eU5hbWVzO3RyeXthcmd1bWVudHMuY2FsbGVlfWNhdGNoKHIpe3ZhciBuPSh0KGMpLmpvaW4oIiAiKSsiICIpLnJlcGxhY2UoL3Byb3RvdHlwZSB8bGVuZ3RoIHxuYW1lIC9nLCIiKS5zbGljZSgwLC0xKS5zcGxpdCgiICIpO24ubGVuZ3RoJiYodD1mdW5jdGlvbih0KXt2YXIgcj1lLmdldE93blByb3BlcnR5TmFtZXModCk7aWYoImZ1bmN0aW9uIj09dHlwZW9mIHQpZm9yKHZhciBvLGk9MDtpPG4ubGVuZ3RoOykobz1jKHIsbltpKytdKSk+LTEmJnIuc3BsaWNlKG8sMSk7cmV0dXJuIHJ9KX1yZXR1cm4gdH0oKTpmdW5jdGlvbih0KXt2YXIgcixuLG89W107aWYoImhhc093blByb3BlcnR5ImluIHQpZm9yKHIgaW4gdCl0Lmhhc093blByb3BlcnR5KHIpJiZvLnB1c2gocik7ZWxzZXtuPWUuaGFzT3duUHJvcGVydHk7Zm9yKHIgaW4gdCluLmNhbGwodCxyKSYmby5wdXNoKHIpfXJldHVybiBhKHQpJiZvLnB1c2goImxlbmd0aCIpLG99LGY9ZS5nZXRQcm90b3R5cGVPZixkPWUuZGVmaW5lUHJvcGVydGllcyYmZS5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IscD1yLnJlcXVlc3RBbmltYXRpb25GcmFtZXx8ci53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKCl7dmFyIGU9K25ldyBEYXRlLHQ9ZTtyZXR1cm4gZnVuY3Rpb24ocil7cmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtyKCh0PStuZXcgRGF0ZSktZSl9LDE3KX19KCksYj1mdW5jdGlvbihlLHQscil7dmFyIG49by5nZXQoZSk7bj8odihuLGUpLG0oZSxuLHQscikpOihuPWgoZSksbShlLG4sdCxyKSwxPT09by5zaXplJiZwKHkpKX0saD1mdW5jdGlvbih0LHIpe3ZhciBuLGk9bCh0KSxzPVtdLGE9MCxyPXtoYW5kbGVyczp1KCksZnJvemVuOmUuaXNGcm96ZW4/ZS5pc0Zyb3plbih0KTohMSxleHRlbnNpYmxlOmUuaXNFeHRlbnNpYmxlP2UuaXNFeHRlbnNpYmxlKHQpOiEwLHByb3RvOmYmJmYodCkscHJvcGVydGllczppLHZhbHVlczpzLG5vdGlmaWVyOmcodCxyKX07aWYoZClmb3Iobj1yLmRlc2NyaXB0b3JzPVtdO2E8aS5sZW5ndGg7KW5bYV09ZCh0LGlbYV0pLHNbYV09dFtpW2ErK11dO2Vsc2UgZm9yKDthPGkubGVuZ3RoOylzW2FdPXRbaVthKytdXTtyZXR1cm4gby5zZXQodCxyKSxyfSx2PWZ1bmN0aW9uKCl7dmFyIHQ9ZD9mdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPXQucHJvcGVydGllc1tyXSxzPWVbaV0sYT10LnZhbHVlc1tyXSxjPXQuZGVzY3JpcHRvcnNbcl07InZhbHVlImluIG8mJihhPT09cz8wPT09YSYmMS9hIT09MS9zOmE9PT1hfHxzPT09cykmJihqKGUsdCx7bmFtZTppLHR5cGU6InVwZGF0ZSIsb2JqZWN0OmUsb2xkVmFsdWU6YX0sbiksdC52YWx1ZXNbcl09cyksIWMuY29uZmlndXJhYmxlfHxvLmNvbmZpZ3VyYWJsZSYmby53cml0YWJsZT09PWMud3JpdGFibGUmJm8uZW51bWVyYWJsZT09PWMuZW51bWVyYWJsZSYmby5nZXQ9PT1jLmdldCYmby5zZXQ9PT1jLnNldHx8KGooZSx0LHtuYW1lOmksdHlwZToicmVjb25maWd1cmUiLG9iamVjdDplLG9sZFZhbHVlOmF9LG4pLHQuZGVzY3JpcHRvcnNbcl09byl9OmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPXQucHJvcGVydGllc1tyXSxpPWVbb10scz10LnZhbHVlc1tyXTsocz09PWk/MD09PXMmJjEvcyE9PTEvaTpzPT09c3x8aT09PWkpJiYoaihlLHQse25hbWU6byx0eXBlOiJ1cGRhdGUiLG9iamVjdDplLG9sZFZhbHVlOnN9LG4pLHQudmFsdWVzW3JdPWkpfSxyPWQ/ZnVuY3Rpb24oZSxyLG4sbyxpKXtmb3IodmFyIHMsYT1yLmxlbmd0aDtuJiZhLS07KW51bGwhPT1yW2FdJiYocz1kKGUsclthXSksbi0tLHM/dChlLG8sYSxpLHMpOihqKGUsbyx7bmFtZTpyW2FdLHR5cGU6ImRlbGV0ZSIsb2JqZWN0OmUsb2xkVmFsdWU6by52YWx1ZXNbYV19LGkpLG8ucHJvcGVydGllcy5zcGxpY2UoYSwxKSxvLnZhbHVlcy5zcGxpY2UoYSwxKSxvLmRlc2NyaXB0b3JzLnNwbGljZShhLDEpKSl9OmZ1bmN0aW9uKGUsdCxyLG4sbyl7Zm9yKHZhciBpPXQubGVuZ3RoO3ImJmktLTspbnVsbCE9PXRbaV0mJihqKGUsbix7bmFtZTp0W2ldLHR5cGU6ImRlbGV0ZSIsb2JqZWN0OmUsb2xkVmFsdWU6bi52YWx1ZXNbaV19LG8pLG4ucHJvcGVydGllcy5zcGxpY2UoaSwxKSxuLnZhbHVlcy5zcGxpY2UoaSwxKSxyLS0pfTtyZXR1cm4gZnVuY3Rpb24obixvLGkpe2lmKG4uaGFuZGxlcnMuc2l6ZSYmIW4uZnJvemVuKXt2YXIgcyxhLHUscCxiLGgsdix5LF89bi52YWx1ZXMsZz1uLmRlc2NyaXB0b3JzLG09MDtpZihuLmV4dGVuc2libGUpaWYocz1uLnByb3BlcnRpZXMuc2xpY2UoKSxhPXMubGVuZ3RoLHU9bChvKSxnKXtmb3IoO208dS5sZW5ndGg7KWI9dVttKytdLHA9YyhzLGIpLHk9ZChvLGIpLC0xPT09cD8oaihvLG4se25hbWU6Yix0eXBlOiJhZGQiLG9iamVjdDpvfSxpKSxuLnByb3BlcnRpZXMucHVzaChiKSxfLnB1c2gob1tiXSksZy5wdXNoKHkpKTooc1twXT1udWxsLGEtLSx0KG8sbixwLGkseSkpO3IobyxzLGEsbixpKSxlLmlzRXh0ZW5zaWJsZShvKXx8KG4uZXh0ZW5zaWJsZT0hMSxqKG8sbix7dHlwZToicHJldmVudEV4dGVuc2lvbnMiLG9iamVjdDpvfSxpKSxuLmZyb3plbj1lLmlzRnJvemVuKG8pKX1lbHNle2Zvcig7bTx1Lmxlbmd0aDspYj11W20rK10scD1jKHMsYiksaD1vW2JdLC0xPT09cD8oaihvLG4se25hbWU6Yix0eXBlOiJhZGQiLG9iamVjdDpvfSxpKSxuLnByb3BlcnRpZXMucHVzaChiKSxfLnB1c2goaCkpOihzW3BdPW51bGwsYS0tLHQobyxuLHAsaSkpO3IobyxzLGEsbixpKX1lbHNlIGlmKCFuLmZyb3plbil7Zm9yKDttPHMubGVuZ3RoO20rKyliPXNbbV0sdChvLG4sbSxpLGQobyxiKSk7ZS5pc0Zyb3plbihvKSYmKG4uZnJvemVuPSEwKX1mJiYodj1mKG8pLHYhPT1uLnByb3RvJiYoaihvLG4se3R5cGU6InNldFByb3RvdHlwZSIsbmFtZToiX19wcm90b19fIixvYmplY3Q6byxvbGRWYWx1ZTpuLnByb3RvfSksbi5wcm90bz12KSl9fX0oKSx5PWZ1bmN0aW9uKCl7by5zaXplJiYoby5mb3JFYWNoKHYpLGkuZm9yRWFjaChfKSxwKHkpKX0sXz1mdW5jdGlvbihlLHQpe3ZhciByPWUuY2hhbmdlUmVjb3JkcztyLmxlbmd0aCYmKGUuY2hhbmdlUmVjb3Jkcz1bXSx0KHIpKX0sZz1mdW5jdGlvbihlLHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPDImJih0PW8uZ2V0KGUpKSx0JiZ0Lm5vdGlmaWVyfHx7bm90aWZ5OmZ1bmN0aW9uKHQpe3QudHlwZTt2YXIgcj1vLmdldChlKTtpZihyKXt2YXIgbixpPXtvYmplY3Q6ZX07Zm9yKG4gaW4gdCkib2JqZWN0IiE9PW4mJihpW25dPXRbbl0pO2ooZSxyLGkpfX0scGVyZm9ybUNoYW5nZTpmdW5jdGlvbih0LHIpe2lmKCJzdHJpbmciIT10eXBlb2YgdCl0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIG5vbi1zdHJpbmcgY2hhbmdlVHlwZSIpO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiByKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBwZXJmb3JtIG5vbi1mdW5jdGlvbiIpO3ZhciBpLHMsYT1vLmdldChlKSxjPWFyZ3VtZW50c1syXSx1PWM9PT1uP3IoKTpyLmNhbGwoYyk7aWYoYSYmdihhLGUsdCksYSYmdSYmIm9iamVjdCI9PXR5cGVvZiB1KXtzPXtvYmplY3Q6ZSx0eXBlOnR9O2ZvcihpIGluIHUpIm9iamVjdCIhPT1pJiYidHlwZSIhPT1pJiYoc1tpXT11W2ldKTtqKGUsYSxzKX19fX0sbT1mdW5jdGlvbihlLHQscixuKXt2YXIgbz1pLmdldChyKTtvfHxpLnNldChyLG89e29ic2VydmVkOnUoKSxjaGFuZ2VSZWNvcmRzOltdfSksby5vYnNlcnZlZC5zZXQoZSx7YWNjZXB0TGlzdDpuLnNsaWNlKCksZGF0YTp0fSksdC5oYW5kbGVycy5zZXQocixvKX0saj1mdW5jdGlvbihlLHQscixuKXt0LmhhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIG89dC5vYnNlcnZlZC5nZXQoZSkuYWNjZXB0TGlzdDsoInN0cmluZyIhPXR5cGVvZiBufHwtMT09PWMobyxuKSkmJmMobyxyLnR5cGUpPi0xJiZ0LmNoYW5nZVJlY29yZHMucHVzaChyKX0pfTtvPXUoKSxpPXUoKSxlLm9ic2VydmU9ZnVuY3Rpb24odCxyLG8pe2lmKCF0fHwib2JqZWN0IiE9dHlwZW9mIHQmJiJmdW5jdGlvbiIhPXR5cGVvZiB0KXRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBvYnNlcnZlIG5vbi1vYmplY3QiKTtpZigiZnVuY3Rpb24iIT10eXBlb2Ygcil0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3Qub2JzZXJ2ZSBjYW5ub3QgZGVsaXZlciB0byBub24tZnVuY3Rpb24iKTtpZihlLmlzRnJvemVuJiZlLmlzRnJvemVuKHIpKXRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBkZWxpdmVyIHRvIGEgZnJvemVuIGZ1bmN0aW9uIG9iamVjdCIpO2lmKG89PT1uKW89cztlbHNlIGlmKCFvfHwib2JqZWN0IiE9dHlwZW9mIG8pdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhpcmQgYXJndW1lbnQgdG8gT2JqZWN0Lm9ic2VydmUgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzLiIpO3JldHVybiBiKHQscixvKSx0fSxlLnVub2JzZXJ2ZT1mdW5jdGlvbihlLHQpe2lmKG51bGw9PT1lfHwib2JqZWN0IiE9dHlwZW9mIGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlKXRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC51bm9ic2VydmUgY2Fubm90IHVub2JzZXJ2ZSBub24tb2JqZWN0Iik7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcigiT2JqZWN0LnVub2JzZXJ2ZSBjYW5ub3QgZGVsaXZlciB0byBub24tZnVuY3Rpb24iKTt2YXIgcixuPWkuZ2V0KHQpO3JldHVybiBuJiYocj1uLm9ic2VydmVkLmdldChlKSkmJihuLm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24oZSx0KXt2KGUuZGF0YSx0KX0pLHAoZnVuY3Rpb24oKXtfKG4sdCl9KSwxPT09bi5vYnNlcnZlZC5zaXplJiZuLm9ic2VydmVkLmhhcyhlKT9pWyJkZWxldGUiXSh0KTpuLm9ic2VydmVkWyJkZWxldGUiXShlKSwxPT09ci5kYXRhLmhhbmRsZXJzLnNpemU/b1siZGVsZXRlIl0oZSk6ci5kYXRhLmhhbmRsZXJzWyJkZWxldGUiXSh0KSksZX0sZS5nZXROb3RpZmllcj1mdW5jdGlvbih0KXtpZihudWxsPT09dHx8Im9iamVjdCIhPXR5cGVvZiB0JiYiZnVuY3Rpb24iIT10eXBlb2YgdCl0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3QuZ2V0Tm90aWZpZXIgY2Fubm90IGdldE5vdGlmaWVyIG5vbi1vYmplY3QiKTtyZXR1cm4gZS5pc0Zyb3plbiYmZS5pc0Zyb3plbih0KT9udWxsOmcodCl9LGUuZGVsaXZlckNoYW5nZVJlY29yZHM9ZnVuY3Rpb24oZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFR5cGVFcnJvcigiT2JqZWN0LmRlbGl2ZXJDaGFuZ2VSZWNvcmRzIGNhbm5vdCBkZWxpdmVyIHRvIG5vbi1mdW5jdGlvbiIpO3ZhciB0PWkuZ2V0KGUpO3QmJih0Lm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24oZSx0KXt2KGUuZGF0YSx0KX0pLF8odCxlKSl9fShPYmplY3QsQXJyYXksdGhpcyl9LHt9XSw5MjpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSxyLkRhdGFPYmplY3RPYnNlcnZlcj1yLkRhdGFPYmplY3RSZXBvcnRlcj1yLlN5bmNoZXI9dm9pZCAwLGUoIm11dGF0aW9ub2JzZXJ2ZXItc2hpbSIpLGUoIm9iamVjdC5vYnNlcnZlIiksZSgiYXJyYXkub2JzZXJ2ZSIpO3ZhciBvPWUoIi4vc3luY2hlci9TeW5jaGVyIiksaT1uKG8pLHM9ZSgiLi9zeW5jaGVyL0RhdGFPYmplY3RSZXBvcnRlciIpLGE9bihzKSxjPWUoIi4vc3luY2hlci9EYXRhT2JqZWN0T2JzZXJ2ZXIiKSx1PW4oYyk7ci5TeW5jaGVyPWlbImRlZmF1bHQiXSxyLkRhdGFPYmplY3RSZXBvcnRlcj1hWyJkZWZhdWx0Il0sci5EYXRhT2JqZWN0T2JzZXJ2ZXI9dVsiZGVmYXVsdCJdfSx7Ii4vc3luY2hlci9EYXRhT2JqZWN0T2JzZXJ2ZXIiOjk1LCIuL3N5bmNoZXIvRGF0YU9iamVjdFJlcG9ydGVyIjo5NiwiLi9zeW5jaGVyL1N5bmNoZXIiOjk5LCJhcnJheS5vYnNlcnZlIjoxLCJtdXRhdGlvbm9ic2VydmVyLXNoaW0iOjkwLCJvYmplY3Qub2JzZXJ2ZSI6OTF9XSw5MzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLGk9bihvKSxzPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cyIpLGE9bihzKSxjPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLHU9bihjKSxsPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLGY9bihsKSxkPWUoIi4vU3luY09iamVjdCIpLHA9bihkKSxiPWUoIi4vRGF0YU9iamVjdENoaWxkIiksaD1uKGIpLHY9ZSgiLi4vdXRpbHMvdXRpbHMuanMiKSx5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LHIsbixvLGkscyl7KDAsdVsiZGVmYXVsdCJdKSh0aGlzLGUpO3ZhciBhPXRoaXM7YS5fc3luY2hlcj10LGEuX3VybD1yLGEuX3NjaGVtYT1uLGEuX3N0YXR1cz1vLGEuX3N5bmNPYmo9bmV3IHBbImRlZmF1bHQiXShpKSxhLl9jaGlsZHJlbnM9cyxhLl92ZXJzaW9uPTAsYS5fY2hpbGRJZD0wLGEuX2NoaWxkcmVuT2JqZWN0cz17fSxhLl9jaGlsZHJlbkxpc3RlbmVycz1bXSxhLl9vd25lcj10Ll9vd25lcixhLl9idXM9dC5fYnVzfXJldHVybigwLGZbImRlZmF1bHQiXSkoZSxbe2tleToiX2FsbG9jYXRlTGlzdGVuZXJzIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLHI9dC5fdXJsKyIvY2hpbGRyZW4vIjt0Ll9jaGlsZHJlbnMmJnQuX2NoaWxkcmVucy5mb3JFYWNoKGZ1bmN0aW9uKG4pe3ZhciBvPXIrbixpPXQuX2J1cy5hZGRMaXN0ZW5lcihvLGZ1bmN0aW9uKHIpe2lmKHIuZnJvbSE9PWUuX293bmVyKXN3aXRjaChjb25zb2xlLmxvZygiRGF0YU9iamVjdC1DaGlsZHJlbi1SQ1Y6ICIsciksci50eXBlKXtjYXNlImNyZWF0ZSI6dC5fb25DaGlsZENyZWF0ZShyKTticmVhaztjYXNlImRlbGV0ZSI6Y29uc29sZS5sb2cocik7YnJlYWs7ZGVmYXVsdDp0Ll9jaGFuZ2VDaGlsZHJlbihyKX19KTt0Ll9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGkpfSl9fSx7a2V5OiJfcmVsZWFzZUxpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2UuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5yZW1vdmUoKX0pLCgwLGFbImRlZmF1bHQiXSkoZS5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2UuX2NoaWxkcmVuT2JqZWN0c1t0XS5fcmVsZWFzZUxpc3RlbmVycygpfSl9fSx7a2V5OiJwYXVzZSIsdmFsdWU6ZnVuY3Rpb24oKXt0aHJvdyJOb3QgaW1wbGVtZW50ZWQifX0se2tleToicmVzdW1lIix2YWx1ZTpmdW5jdGlvbigpe3Rocm93Ik5vdCBpbXBsZW1lbnRlZCJ9fSx7a2V5OiJzdG9wIix2YWx1ZTpmdW5jdGlvbigpe3Rocm93Ik5vdCBpbXBsZW1lbnRlZCJ9fSx7a2V5OiJhZGRDaGlsZCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcj10aGlzO3IuX2NoaWxkSWQrKzt2YXIgbj1yLl9vd25lcisiIyIrci5fY2hpbGRJZCxvPXIuX3VybCsiL2NoaWxkcmVuLyIrZSxzPXt0eXBlOiJjcmVhdGUiLGZyb206ci5fb3duZXIsdG86byxib2R5OntyZXNvdXJjZTpuLHZhbHVlOnR9fTtyZXR1cm4gbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbihlKXt2YXIgaT1yLl9idXMucG9zdE1lc3NhZ2Uocyk7Y29uc29sZS5sb2coImNyZWF0ZS1yZXBvcnRlci1jaGlsZCggIityLl9vd25lcisiICk6ICIscyk7dmFyIGE9bmV3IGhbImRlZmF1bHQiXShyLG4sdCxyLl9vd25lcixpKTthLm9uQ2hhbmdlKGZ1bmN0aW9uKGUpe3IuX29uQ2hhbmdlKGUse3BhdGg6byxjaGlsZElkOm59KX0pLHIuX2NoaWxkcmVuT2JqZWN0c1tuXT1hLGUoYSl9KX19LHtrZXk6Im9uQWRkQ2hpbGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyPWV9fSx7a2V5OiJfb25DaGlsZENyZWF0ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPWUuYm9keS5yZXNvdXJjZTtjb25zb2xlLmxvZygiY3JlYXRlLW9ic2VydmVyLWNoaWxkKCAiK3QuX293bmVyKyIgKTogIixlKTt2YXIgbj1uZXcgaFsiZGVmYXVsdCJdKHQscixlLmJvZHkudmFsdWUpO3QuX2NoaWxkcmVuT2JqZWN0c1tyXT1uLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0Ll9idXMucG9zdE1lc3NhZ2Uoe2lkOmUuaWQsdHlwZToicmVzcG9uc2UiLGZyb206ZS50byx0bzplLmZyb20sYm9keTp7Y29kZToyMDAsc291cmNlOnQuX293bmVyfX0pfSk7dmFyIG89e3R5cGU6ZS50eXBlLGZyb206ZS5mcm9tLHVybDplLnRvLHZhbHVlOmUuYm9keS52YWx1ZSxjaGlsZElkOnIsaWRlbnRpdHk6ZS5ib2R5LmlkZW50aXR5fTt0Ll9vbkFkZENoaWxkcmVuSGFuZGxlciYmKGNvbnNvbGUubG9nKCJBREQtQ0hJTERSRU4tRVZFTlQ6ICIsbyksdC5fb25BZGRDaGlsZHJlbkhhbmRsZXIobykpfX0se2tleToiX29uQ2hhbmdlIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXM7aWYoci5fdmVyc2lvbisrLCJvbiI9PT1yLl9zdGF0dXMpe3ZhciBuPXt0eXBlOiJ1cGRhdGUiLGZyb206ci5fdXJsLHRvOnIuX3VybCsiL2NoYW5nZXMiLGJvZHk6e3ZlcnNpb246ci5fdmVyc2lvbixzb3VyY2U6ci5fb3duZXIsYXR0cmlidXRlOmUuZmllbGR9fTtlLm9UeXBlPT09ZC5PYmplY3RUeXBlLk9CSkVDVD9lLmNUeXBlIT09ZC5DaGFuZ2VUeXBlLlJFTU9WRSYmKG4uYm9keS52YWx1ZT1lLmRhdGEpOihuLmJvZHkuYXR0cmlidXRlVHlwZT1lLm9UeXBlLG4uYm9keS52YWx1ZT1lLmRhdGEsZS5jVHlwZSE9PWQuQ2hhbmdlVHlwZS5VUERBVEUmJihuLmJvZHkub3BlcmF0aW9uPWUuY1R5cGUpKSx0JiYobi50bz10LnBhdGgsbi5ib2R5LnJlc291cmNlPXQuY2hpbGRJZCksci5fYnVzLnBvc3RNZXNzYWdlKG4pfX19LHtrZXk6Il9jaGFuZ2VPYmplY3QiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcztpZihyLl92ZXJzaW9uKzE9PT10LmJvZHkudmVyc2lvbil7ci5fdmVyc2lvbisrO3ZhciBuPXQuYm9keS5hdHRyaWJ1dGUsbz0oMCx2LmRlZXBDbG9uZSkodC5ib2R5LnZhbHVlKSxpPWUuZmluZEJlZm9yZShuKTtpZih0LmJvZHkuYXR0cmlidXRlVHlwZT09PWQuT2JqZWN0VHlwZS5BUlJBWSlpZih0LmJvZHkub3BlcmF0aW9uPT09ZC5DaGFuZ2VUeXBlLkFERCl7dmFyIHM9aS5vYmosYT1pLmxhc3Q7QXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShzLFthLDBdLmNvbmNhdChvKSl9ZWxzZSBpZih0LmJvZHkub3BlcmF0aW9uPT09ZC5DaGFuZ2VUeXBlLlJFTU9WRSl7dmFyIGM9aS5vYmosdT1pLmxhc3Q7Yy5zcGxpY2UodSxvKX1lbHNlIGkub2JqW2kubGFzdF09bztlbHNlIHQuYm9keS52YWx1ZT9pLm9ialtpLmxhc3RdPW86ZGVsZXRlIGkub2JqW2kubGFzdF19ZWxzZSBjb25zb2xlLmxvZygiVU5TWU5DSFJPTklaRUQgVkVSU0lPTjogKGRhdGEgPT4gIityLl92ZXJzaW9uKyIsIG1zZyA9PiAiK3QuYm9keS52ZXJzaW9uKyIpIil9fSx7a2V5OiJfY2hhbmdlQ2hpbGRyZW4iLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7Y29uc29sZS5sb2coIkNoYW5nZSBjaGlsZHJlbjogIix0Ll9vd25lcixlKTt2YXIgcj1lLmJvZHkucmVzb3VyY2Usbj10Ll9jaGlsZHJlbk9iamVjdHNbcl07bj90Ll9jaGFuZ2VPYmplY3Qobi5fc3luY09iaixlKTpjb25zb2xlLmxvZygiTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAiLHIpfX0se2tleToidXJsIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdXJsfX0se2tleToic2NoZW1hIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NoZW1hfX0se2tleToic3RhdHVzIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhdHVzfX0se2tleToiZGF0YSIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N5bmNPYmouZGF0YX19LHtrZXk6ImNoaWxkcmVucyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NoaWxkcmVuT2JqZWN0c319XSksZX0oKTtyWyJkZWZhdWx0Il09eSx0LmV4cG9ydHM9clsiZGVmYXVsdCJdfSx7Ii4uL3V0aWxzL3V0aWxzLmpzIjoxMDAsIi4vRGF0YU9iamVjdENoaWxkIjo5NCwiLi9TeW5jT2JqZWN0Ijo5OCwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjo3LCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSI6OSwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjoxMSwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjoxMn1dLDk0OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO3ZhciBvPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLGk9bihvKSxzPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLGE9bihzKSxjPWUoIi4vU3luY09iamVjdCIpLHU9bihjKSxsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LHIsbixvLHMpeygwLGlbImRlZmF1bHQiXSkodGhpcyxlKTt2YXIgYT10aGlzO2EuX3BhcmVudD10LGEuX2NoaWxkSWQ9cixhLl9vd25lcj1vLGEuX21zZ0lkPXMsYS5fc3luY09iaj1uZXcgdVsiZGVmYXVsdCJdKG4pLGEuX2J1cz10Ll9idXMsYS5fYWxsb2NhdGVMaXN0ZW5lcnMoKX1yZXR1cm4oMCxhWyJkZWZhdWx0Il0pKGUsW3trZXk6Il9hbGxvY2F0ZUxpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2UuX293bmVyJiYoZS5fbGlzdGVuZXI9ZS5fYnVzLmFkZExpc3RlbmVyKGUuX293bmVyLGZ1bmN0aW9uKHQpeyJyZXNwb25zZSI9PT10LnR5cGUmJnQuaWQ9PT1lLl9tc2dJZCYmKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZToiLHQpLGUuX29uUmVzcG9uc2UodCkpfSkpfX0se2tleToiX3JlbGVhc2VMaXN0ZW5lcnMiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztlLl9saXN0ZW5lciYmZS5fbGlzdGVuZXIucmVtb3ZlKCl9fSx7a2V5OiJkZWxldGUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztkZWxldGUgZS5fcGFyZW50Ll9jaGlsZHJlbltlLl9jaGlsZElkXSxlLl9yZWxlYXNlTGlzdGVuZXJzKCl9fSx7a2V5OiJvbkNoYW5nZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uKHQpe2UodCl9KX19LHtrZXk6Im9uUmVzcG9uc2UiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyPWV9fSx7a2V5OiJfb25SZXNwb25zZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPXt0eXBlOmUudHlwZSx1cmw6ZS5ib2R5LnNvdXJjZSxjb2RlOmUuYm9keS5jb2RlfTt0Ll9vblJlc3BvbnNlSGFuZGxlciYmdC5fb25SZXNwb25zZUhhbmRsZXIocil9fSx7a2V5OiJjaGlsZElkIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2hpbGRJZH19LHtrZXk6ImRhdGEiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zeW5jT2JqLmRhdGF9fV0pLGV9KCk7clsiZGVmYXVsdCJdPWwsdC5leHBvcnRzPXJbImRlZmF1bHQiXX0seyIuL1N5bmNPYmplY3QiOjk4LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjEyfV0sOTU6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSk7dmFyIG89ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksaT1uKG8pLHM9ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIiksYT1uKHMpLGM9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksdT1uKGMpLGw9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksZj1uKGwpLGQ9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iKSxwPW4oZCksYj1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IiksaD1uKGIpLHY9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIikseT1uKHYpLF89ZSgiLi9EYXRhT2JqZWN0IiksZz1uKF8pLG09ZSgiLi9EYXRhT2JqZWN0Q2hpbGQiKSxqPW4obSksJD17QU5ZOiJhbnkiLFNUQVJUOiJzdGFydCIsRVhBQ1Q6ImV4YWN0In0sTz1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUscixuLG8scyxjLGwpeygwLHVbImRlZmF1bHQiXSkodGhpcyx0KTt2YXIgZj0oMCxwWyJkZWZhdWx0Il0pKHRoaXMsKDAsYVsiZGVmYXVsdCJdKSh0KS5jYWxsKHRoaXMsZSxyLG4sbyxzLmRhdGEsYykpLGQ9ZjtyZXR1cm4gZC5fdmVyc2lvbj1sLGQuX2ZpbHRlcnM9e30sZC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uKGUpe2QuX29uRmlsdGVyKGUpfSksKDAsaVsiZGVmYXVsdCJdKShzLmNoaWxkcmVucykuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1zLmNoaWxkcmVuc1tlXTtkLl9jaGlsZHJlbk9iamVjdHNbZV09bmV3IGpbImRlZmF1bHQiXShkLGUsdCl9KSxkLl9hbGxvY2F0ZUxpc3RlbmVycygpLGZ9cmV0dXJuKDAseVsiZGVmYXVsdCJdKSh0LGUpLCgwLGZbImRlZmF1bHQiXSkodCxbe2tleToiX2FsbG9jYXRlTGlzdGVuZXJzIix2YWx1ZTpmdW5jdGlvbigpeygwLGhbImRlZmF1bHQiXSkoKDAsYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksIl9hbGxvY2F0ZUxpc3RlbmVycyIsdGhpcykuY2FsbCh0aGlzKTt2YXIgZT10aGlzO2UuX2NoYW5nZUxpc3RlbmVyPWUuX2J1cy5hZGRMaXN0ZW5lcihlLl91cmwrIi9jaGFuZ2VzIixmdW5jdGlvbih0KXsidXBkYXRlIj09PXQudHlwZSYmKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0T2JzZXJ2ZXItIitlLl91cmwrIi1SQ1Y6ICIsdCksZS5fY2hhbmdlT2JqZWN0KGUuX3N5bmNPYmosdCkpfSl9fSx7a2V5OiJfcmVsZWFzZUxpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXsoMCxoWyJkZWZhdWx0Il0pKCgwLGFbImRlZmF1bHQiXSkodC5wcm90b3R5cGUpLCJfcmVsZWFzZUxpc3RlbmVycyIsdGhpcykuY2FsbCh0aGlzKTt2YXIgZT10aGlzO2UuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpfX0se2tleToiZGVsZXRlIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7ZS5fcmVsZWFzZUxpc3RlbmVycygpLGRlbGV0ZSBlLl9zeW5jaGVyLl9vYnNlcnZlcnNbZS5fdXJsXX19LHtrZXk6InVuc3Vic2NyaWJlIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD17dHlwZToidW5zdWJzY3JpYmUiLGZyb206ZS5fb3duZXIsdG86ZS5fc3luY2hlci5fc3ViVVJMLGJvZHk6e3Jlc291cmNlOmUuX3VybH19O2UuX2J1cy5wb3N0TWVzc2FnZSh0LGZ1bmN0aW9uKHQpe2NvbnNvbGUubG9nKCJEYXRhT2JqZWN0T2JzZXJ2ZXItVU5TVUJTQ1JJQkU6ICIsdCksMjAwPT09dC5ib2R5LmNvZGUmJihlLl9yZWxlYXNlTGlzdGVuZXJzKCksZGVsZXRlIGUuX3N5bmNoZXIuX29ic2VydmVyc1tlLl91cmxdKX0pfX0se2tleToib25DaGFuZ2UiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9ZSxuPXt0eXBlOiQuRVhBQ1QsY2FsbGJhY2s6dH0sbz1lLmluZGV4T2YoIioiKTtvPT09ZS5sZW5ndGgtMSYmKDA9PT1vP24udHlwZT0kLkFOWToobi50eXBlPSQuU1RBUlQscj1lLnN1YnN0cigwLGUubGVuZ3RoLTEpKSksdGhpcy5fZmlsdGVyc1tyXT1ufX0se2tleToiX29uRmlsdGVyIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzOygwLGlbImRlZmF1bHQiXSkodC5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbihyKXt2YXIgbj10Ll9maWx0ZXJzW3JdO24udHlwZT09PSQuQU5ZP24uY2FsbGJhY2soZSk6bi50eXBlPT09JC5TVEFSVD8wPT09ZS5maWVsZC5pbmRleE9mKHIpJiZuLmNhbGxiYWNrKGUpOm4udHlwZT09PSQuRVhBQ1QmJmUuZmllbGQ9PT1yJiZuLmNhbGxiYWNrKGUpfSl9fV0pLHR9KGdbImRlZmF1bHQiXSk7clsiZGVmYXVsdCJdPU8sdC5leHBvcnRzPXJbImRlZmF1bHQiXX0seyIuL0RhdGFPYmplY3QiOjkzLCIuL0RhdGFPYmplY3RDaGlsZCI6OTQsImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiI6NiwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjo3LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjEyLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IjoxMywiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIjoxNCwiYmFiZWwtcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOjE1fV0sOTY6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSk7dmFyIG89ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksaT1uKG8pLHM9ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIiksYT1uKHMpLGM9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksdT1uKGMpLGw9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksZj1uKGwpLGQ9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iKSxwPW4oZCksYj1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IiksaD1uKGIpLHY9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIikseT1uKHYpLF89ZSgiLi9EYXRhT2JqZWN0IiksZz1uKF8pLG09ZSgiLi4vdXRpbHMvdXRpbHMuanMiKSxqPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSxyLG4sbyxpLHMpeygwLHVbImRlZmF1bHQiXSkodGhpcyx0KTt2YXIgYz0oMCxwWyJkZWZhdWx0Il0pKHRoaXMsKDAsYVsiZGVmYXVsdCJdKSh0KS5jYWxsKHRoaXMsZSxyLG4sbyxpLHMpKSxsPWM7cmV0dXJuIGwuX3N1YnNjcmlwdGlvbnM9e30sbC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uKGUpe2NvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItIityKyItU0VORDogIixlKSxsLl9vbkNoYW5nZShlKX0pLGwuX2FsbG9jYXRlTGlzdGVuZXJzKCksY31yZXR1cm4oMCx5WyJkZWZhdWx0Il0pKHQsZSksKDAsZlsiZGVmYXVsdCJdKSh0LFt7a2V5OiJfYWxsb2NhdGVMaXN0ZW5lcnMiLHZhbHVlOmZ1bmN0aW9uKCl7KDAsaFsiZGVmYXVsdCJdKSgoMCxhWyJkZWZhdWx0Il0pKHQucHJvdG90eXBlKSwiX2FsbG9jYXRlTGlzdGVuZXJzIix0aGlzKS5jYWxsKHRoaXMpO3ZhciBlPXRoaXM7ZS5fcmVzcG9uc2VMaXN0ZW5lcj1lLl9idXMuYWRkTGlzdGVuZXIoZS5fdXJsLGZ1bmN0aW9uKHQpeyJyZXNwb25zZSI9PT10LnR5cGUmJmUuX29uUmVzcG9uc2UodCl9KX19LHtrZXk6Il9yZWxlYXNlTGlzdGVuZXJzIix2YWx1ZTpmdW5jdGlvbigpeygwLGhbImRlZmF1bHQiXSkoKDAsYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksIl9yZWxlYXNlTGlzdGVuZXJzIix0aGlzKS5jYWxsKHRoaXMpO3ZhciBlPXRoaXM7ZS5fcmVzcG9uc2VMaXN0ZW5lci5yZW1vdmUoKX19LHtrZXk6Imludml0ZU9ic2VydmVycyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPXt0eXBlOiJjcmVhdGUiLGZyb206dC5fc3luY2hlci5fb3duZXIsdG86dC5fc3luY2hlci5fc3ViVVJMLGJvZHk6e3Jlc291cmNlOnQuX3VybCxzY2hlbWE6dC5fc2NoZW1hLHZhbHVlOnQuX3N5bmNPYmouZGF0YSxhdXRob3Jpc2U6ZX19O3QuX2J1cy5wb3N0TWVzc2FnZShyKX19LHtrZXk6ImRlbGV0ZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9e3R5cGU6ImRlbGV0ZSIsZnJvbTplLl9vd25lcix0bzplLl9zeW5jaGVyLl9zdWJVUkwsYm9keTp7cmVzb3VyY2U6ZS5fdXJsfX07ZS5fYnVzLnBvc3RNZXNzYWdlKHQsZnVuY3Rpb24odCl7Y29uc29sZS5sb2coIkRhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICIsdCksMjAwPT09dC5ib2R5LmNvZGUmJihlLl9yZWxlYXNlTGlzdGVuZXJzKCksZGVsZXRlIGUuX3N5bmNoZXIuX3JlcG9ydGVyc1tlLl91cmxdKX0pfX0se2tleToib25TdWJzY3JpcHRpb24iLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcj1lfX0se2tleToib25SZXNwb25zZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fb25SZXNwb25zZUhhbmRsZXI9ZX19LHtrZXk6Il9vbkZvcndhcmQiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7c3dpdGNoKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItUkNWOiAiLGUpLGUuYm9keS50eXBlKXtjYXNlInN1YnNjcmliZSI6dC5fb25TdWJzY3JpYmUoZSk7YnJlYWs7Y2FzZSJ1bnN1YnNjcmliZSI6dC5fb25VblN1YnNjcmliZShlKX19fSx7a2V5OiJfb25TdWJzY3JpYmUiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1lLmJvZHkuZnJvbSxuPXt0eXBlOmUuYm9keS50eXBlLHVybDpyLGFjY2VwdDpmdW5jdGlvbigpe3ZhciBuPXt1cmw6cixzdGF0dXM6Im9uIn07dC5fc3Vic2NyaXB0aW9uc1tyXT1uO3ZhciBvPXt9O3JldHVybigwLGlbImRlZmF1bHQiXSkodC5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciByPXQuX2NoaWxkcmVuT2JqZWN0c1tlXS5kYXRhO29bZV09KDAsbS5kZWVwQ2xvbmUpKHIpfSksdC5fYnVzLnBvc3RNZXNzYWdlKHtpZDplLmlkLHR5cGU6InJlc3BvbnNlIixmcm9tOmUudG8sdG86ZS5mcm9tLGJvZHk6e2NvZGU6MjAwLHNjaGVtYTp0Ll9zY2hlbWEsdmVyc2lvbjp0Ll92ZXJzaW9uLHZhbHVlOntkYXRhOigwLG0uZGVlcENsb25lKSh0LmRhdGEpLGNoaWxkcmVuczpvfX19KSxufSxyZWplY3Q6ZnVuY3Rpb24ocil7dC5fYnVzLnBvc3RNZXNzYWdlKHtpZDplLmlkLHR5cGU6InJlc3BvbnNlIixmcm9tOmUudG8sdG86ZS5mcm9tLGJvZHk6e2NvZGU6NDAzLGRlc2M6cn19KX19O3QuX29uU3Vic2NyaXB0aW9uSGFuZGxlciYmKGNvbnNvbGUubG9nKCJTVUJTQ1JJUFRJT04tRVZFTlQ6ICIsbiksdC5fb25TdWJzY3JpcHRpb25IYW5kbGVyKG4pKX19LHtrZXk6Il9vblVuU3Vic2NyaWJlIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLHI9ZS5ib2R5LmZyb20sbj10Ll9zdWJzY3JpcHRpb25zW3JdO2RlbGV0ZSB0Ll9zdWJzY3JpcHRpb25zW3JdO3ZhciBvPXt0eXBlOmUuYm9keS50eXBlLHVybDpyLG9iamVjdDpufTt0Ll9vblN1YnNjcmlwdGlvbkhhbmRsZXImJihjb25zb2xlLmxvZygiVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAiLG8pLHQuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihvKSl9fSx7a2V5OiJfb25SZXNwb25zZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPXt0eXBlOmUudHlwZSx1cmw6ZS5mcm9tLGNvZGU6ZS5ib2R5LmNvZGV9O3QuX29uUmVzcG9uc2VIYW5kbGVyJiYoY29uc29sZS5sb2coIlJFU1BPTlNFLUVWRU5UOiAiLHIpLHQuX29uUmVzcG9uc2VIYW5kbGVyKHIpKX19LHtrZXk6InN1YnNjcmlwdGlvbnMiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zfX1dKSx0fShnWyJkZWZhdWx0Il0pO3JbImRlZmF1bHQiXT1qLHQuZXhwb3J0cz1yWyJkZWZhdWx0Il19LHsiLi4vdXRpbHMvdXRpbHMuanMiOjEwMCwiLi9EYXRhT2JqZWN0Ijo5MywiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjo2LCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiOjcsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6MTEsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI6MTIsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9nZXQiOjEzLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiOjE0LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI6MTV9XSw5NzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siKSxpPW4obykscz1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSxhPW4ocyksYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxyLG4sbyl7KDAsaVsiZGVmYXVsdCJdKSh0aGlzLGUpO3ZhciBzPXRoaXM7cy5fb3duZXI9dCxzLl91cmw9cixzLl9idXM9bixzLl9jaGlsZHJlbj1vLHMuX2NoYW5nZXM9W10scy5fYWxsb2NhdGVMaXN0ZW5lcnMoKX1yZXR1cm4oMCxhWyJkZWZhdWx0Il0pKGUsW3trZXk6Il9hbGxvY2F0ZUxpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2UuX2xpc3RlbmVyPWUuX2J1cy5hZGRMaXN0ZW5lcihlLl91cmwsZnVuY3Rpb24odCl7Y29uc29sZS5sb2coIkRhdGFQcm92aXNpb25hbC0iK2UuX3VybCsiLVJDVjogIix0KSxlLl9jaGFuZ2VzLnB1c2godCl9KX19LHtrZXk6Il9yZWxlYXNlTGlzdGVuZXJzIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7ZS5fbGlzdGVuZXIucmVtb3ZlKCl9fSx7a2V5OiJhcHBseSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpczt0Ll9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24odCl7ZS5fY2hhbmdlT2JqZWN0KGUuX3N5bmNPYmosdCl9KX19LHtrZXk6ImNoaWxkcmVuIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2hpbGRyZW59fV0pLGV9KCk7clsiZGVmYXVsdCJdPWMsdC5leHBvcnRzPXJbImRlZmF1bHQiXX0seyJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjEyfV0sOTg6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksci5PYmplY3RUeXBlPXIuQ2hhbmdlVHlwZT12b2lkIDA7dmFyIG89ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksaT1uKG8pLHM9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksYT1uKHMpLGM9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksdT1uKGMpLGw9ZSgiLi4vdXRpbHMvdXRpbHMuanMiKSxmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXsoMCxhWyJkZWZhdWx0Il0pKHRoaXMsZSk7dmFyIHI9dGhpcztyLl9vYnNlcnZlcnM9W10sci5fZmlsdGVycz17fSx0P3IuX2RhdGE9KDAsbC5kZWVwQ2xvbmUpKHQpOnIuX2RhdGE9e30sci5faW50ZXJuYWxPYnNlcnZlKG5ldyBkLHIuX2RhdGEpfXJldHVybigwLHVbImRlZmF1bHQiXSkoZSxbe2tleToib2JzZXJ2ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fb2JzZXJ2ZXJzLnB1c2goZSl9fSx7a2V5OiJmaW5kIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnNwbGl0KCIuIik7cmV0dXJuIHRoaXMuX2ZpbmRXaXRoU3BsaXQodCl9fSx7a2V5OiJmaW5kQmVmb3JlIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD17fSxyPWUuc3BsaXQoIi4iKTtyZXR1cm4gdC5sYXN0PXIucG9wKCksdC5vYmo9dGhpcy5fZmluZFdpdGhTcGxpdChyKSx0fX0se2tleToiX2ZpbmRXaXRoU3BsaXQiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2RhdGE7cmV0dXJuIGUuZm9yRWFjaChmdW5jdGlvbihlKXt0PXRbZV19KSx0fX0se2tleToiX2ZpcmVFdmVudCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dChlKX0pfX0se2tleToiX2lzT2JzZXJ2YWJsZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY29uc3RydWN0b3I9PT1PYmplY3R8fGUuY29uc3RydWN0b3I9PT1BcnJheX19LHtrZXk6Il9pbnRlcm5hbE9ic2VydmUiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcztpZihyLl9pc09ic2VydmFibGUodCkpe3ZhciBuPWZ1bmN0aW9uKHQpe3IuX29uQ2hhbmdlcyhlLHQpfTtpZih0LmNvbnN0cnVjdG9yPT09T2JqZWN0KXtPYmplY3Qub2JzZXJ2ZSh0LG4pO2Zvcih2YXIgbyBpbiB0KXIuX2lzT2JzZXJ2YWJsZSh0W29dKSYmci5faW50ZXJuYWxPYnNlcnZlKGVbIm5ldyJdKG8pLHRbb10pfWVsc2UgaWYodC5jb25zdHJ1Y3Rvcj09PUFycmF5KXtBcnJheS5vYnNlcnZlKHQsbik7Zm9yKHZhciBpIGluIHQpaWYoci5faXNPYnNlcnZhYmxlKHRbaV0pKXt2YXIgcz1lWyJuZXciXShuZXcgcCh0W2ldLGkpKTtyLl9pbnRlcm5hbE9ic2VydmUocyx0W2ldKX19fX19LHtrZXk6Il9vbkNoYW5nZXMiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcztmb3IodmFyIG4gaW4gdCl7dmFyIG89dFtuXS5vYmplY3QsaT12b2lkIDA7aWYoby5jb25zdHJ1Y3Rvcj09PU9iamVjdCYmKGk9aC5PQkpFQ1QpLG8uY29uc3RydWN0b3I9PT1BcnJheSYmKGk9aC5BUlJBWSksInNwbGljZSI9PT10W25dLnR5cGUpIWZ1bmN0aW9uKCl7dmFyIHM9dFtuXS5pbmRleCxhPWVbIm5ldyJdKCIiK3MpLGM9YS50b1N0cmluZygpLHU9dFtuXS5yZW1vdmVkLmxlbmd0aDtpZigwIT09dSl7dmFyIGY9dFtuXS5yZW1vdmVkO2YuZm9yRWFjaChmdW5jdGlvbih0LG4pe3IuX2lzT2JzZXJ2YWJsZSh0KSYmZS5yZW1vdmVJbmRleChzK24pfSksci5fZmlyZUV2ZW50KHtjVHlwZTpiLlJFTU9WRSxvVHlwZTppLGZpZWxkOmMsZGF0YTp1fSl9dmFyIGQ9dFtuXS5hZGRlZENvdW50O2lmKDAhPT1kKXt2YXIgaD1vLnNsaWNlKHMscytkKTtoLmZvckVhY2goZnVuY3Rpb24odCxuKXtpZihyLl9pc09ic2VydmFibGUodCkpe3ZhciBvPWVbIm5ldyJdKG5ldyBwKHQscytuKSk7ci5faW50ZXJuYWxPYnNlcnZlKG8sdCl9fSksci5fZmlyZUV2ZW50KHtjVHlwZTpiLkFERCxvVHlwZTppLGZpZWxkOmMsZGF0YTooMCxsLmRlZXBDbG9uZSkoaCl9KX1zIT09by5sZW5ndGgtMSYmZS5yZUluZGV4RnJvbShvKX0oKTtlbHNle3ZhciBzPWVbIm5ldyJdKHRbbl0ubmFtZSksYT1zLnRvU3RyaW5nKCk7aWYoLTEhPT1hLmluZGV4T2YoIlN5bWJvbCIpKWNvbnRpbnVlO3ZhciBjPW9bdFtuXS5uYW1lXTsidXBkYXRlIj09PXRbbl0udHlwZSYmdGhpcy5fZmlyZUV2ZW50KHtjVHlwZTpiLlVQREFURSxvVHlwZTppLGZpZWxkOmEsZGF0YTooMCxsLmRlZXBDbG9uZSkoYyl9KSwiYWRkIj09PXRbbl0udHlwZSYmKHRoaXMuX2ludGVybmFsT2JzZXJ2ZShzLGMpLHRoaXMuX2ZpcmVFdmVudCh7Y1R5cGU6Yi5BREQsb1R5cGU6aSxmaWVsZDphLGRhdGE6KDAsbC5kZWVwQ2xvbmUpKGMpfSkpLCJkZWxldGUiPT09dFtuXS50eXBlJiZ0aGlzLl9maXJlRXZlbnQoe2NUeXBlOmIuUkVNT1ZFLG9UeXBlOmksZmllbGQ6YX0pfX19fSx7a2V5OiJkYXRhIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGF0YX19XSksZX0oKSxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpeygwLGFbImRlZmF1bHQiXSkodGhpcyxlKSx0aGlzLl9wYXRoPVtdLHRoaXMuX29ic2VydmFibGVzPXt9fXJldHVybigwLHVbImRlZmF1bHQiXSkoZSxbe2tleToicmVtb3ZlSW5kZXgiLHZhbHVlOmZ1bmN0aW9uKGUpe2RlbGV0ZSB0aGlzLl9vYnNlcnZhYmxlc1tlXX19LHtrZXk6InJlSW5kZXhGcm9tIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzOygwLGlbImRlZmF1bHQiXSkodGhpcy5fb2JzZXJ2YWJsZXMpLmZvckVhY2goZnVuY3Rpb24ocil7dmFyIG49dC5fb2JzZXJ2YWJsZXNbcl0sbz1lLmluZGV4T2Yobi5vYmopO24uaWR4IT1vJiYobi5pZHg9byxkZWxldGUgdC5fb2JzZXJ2YWJsZXNbcl0sdC5fb2JzZXJ2YWJsZXNbb109bil9KX19LHtrZXk6Im5ldyIsdmFsdWU6ZnVuY3Rpb24oZSl7ZS5jb25zdHJ1Y3Rvcj09cCYmKHRoaXMuX29ic2VydmFibGVzW2UuaWR4XT1lKTt2YXIgdD10aGlzLmNsb25lKCk7cmV0dXJuIHQuX3BhdGgucHVzaChlKSx0fX0se2tleToiY2xvbmUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IGU7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbihlKXt0Ll9wYXRoLnB1c2goZSl9KSx0fX0se2tleToidG9TdHJpbmciLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9IiI7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbih0LHIpezA9PT1yP2U9dC50b1N0cmluZygpOmUrPSIuIit0LnRvU3RyaW5nKCl9KSxlfX1dKSxlfSgpLHA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQscil7KDAsYVsiZGVmYXVsdCJdKSh0aGlzLGUpLHRoaXMub2JqPXQsdGhpcy5pZHg9cn1yZXR1cm4oMCx1WyJkZWZhdWx0Il0pKGUsW3trZXk6InRvU3RyaW5nIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlkeC50b1N0cmluZygpfX1dKSxlfSgpLGI9ci5DaGFuZ2VUeXBlPXtVUERBVEU6InVwZGF0ZSIsQUREOiJhZGQiLFJFTU9WRToicmVtb3ZlIn0saD1yLk9iamVjdFR5cGU9e09CSkVDVDoib2JqZWN0IixBUlJBWToiYXJyYXkifTtyWyJkZWZhdWx0Il09Zn0seyIuLi91dGlscy91dGlscy5qcyI6MTAwLCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiOjcsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6MTEsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI6MTJ9XSw5OTpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLGk9bihvKSxzPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLGE9bihzKSxjPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLHU9bihjKSxsPWUoIi4vRGF0YU9iamVjdFJlcG9ydGVyIiksZj1uKGwpLGQ9ZSgiLi9EYXRhT2JqZWN0T2JzZXJ2ZXIiKSxwPW4oZCksYj1lKCIuL0RhdGFQcm92aXNpb25hbCIpLGg9bihiKSx2PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LHIsbil7KDAsYVsiZGVmYXVsdCJdKSh0aGlzLGUpO3ZhciBvPXRoaXM7by5fb3duZXI9dCxvLl9idXM9cixvLl9zdWJVUkw9bi5ydW50aW1lVVJMKyIvc20iLG8uX3JlcG9ydGVycz17fSxvLl9vYnNlcnZlcnM9e30sby5fcHJvdmlzaW9uYWxzPXt9LHIuYWRkTGlzdGVuZXIodCxmdW5jdGlvbihlKXtpZihlLmZyb20hPT10KXN3aXRjaChjb25zb2xlLmxvZygiU3luY2hlci1SQ1Y6ICIsZSksZS50eXBlKXtjYXNlImZvcndhcmQiOm8uX29uRm9yd2FyZChlKTticmVhaztjYXNlImNyZWF0ZSI6by5fb25SZW1vdGVDcmVhdGUoZSk7YnJlYWs7Y2FzZSJkZWxldGUiOm8uX29uUmVtb3RlRGVsZXRlKGUpfX0pfXJldHVybigwLHVbImRlZmF1bHQiXSkoZSxbe2tleToiY3JlYXRlIix2YWx1ZTpmdW5jdGlvbihlLHQscil7dmFyIG49dGhpcztyLnJlcG9ydGVyPW4uX293bmVyLHIuc2NoZW1hPWU7dmFyIG89e3R5cGU6ImNyZWF0ZSIsZnJvbTpuLl9vd25lcix0bzpuLl9zdWJVUkwsYm9keTp7c2NoZW1hOmUsdmFsdWU6cixhdXRob3Jpc2U6dH19O3JldHVybiBuZXcgaVsiZGVmYXVsdCJdKGZ1bmN0aW9uKHQsaSl7bi5fYnVzLnBvc3RNZXNzYWdlKG8sZnVuY3Rpb24obyl7aWYoY29uc29sZS5sb2coImNyZWF0ZS1yZXNwb25zZTogIixvKSwyMDA9PT1vLmJvZHkuY29kZSl7dmFyIHM9by5ib2R5LnJlc291cmNlLGE9bmV3IGZbImRlZmF1bHQiXShuLHMsZSwib24iLHIsby5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTtuLl9yZXBvcnRlcnNbc109YSx0KGEpfWVsc2UgaShvLmJvZHkuZGVzYyl9KX0pfX0se2tleToic3Vic2NyaWJlIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMsbj17dHlwZToic3Vic2NyaWJlIixmcm9tOnIuX293bmVyLHRvOnIuX3N1YlVSTCxib2R5OntzY2hlbWE6ZSxyZXNvdXJjZTp0fX07cmV0dXJuIG5ldyBpWyJkZWZhdWx0Il0oZnVuY3Rpb24obyxpKXtyLl9idXMucG9zdE1lc3NhZ2UobixmdW5jdGlvbihuKXtjb25zb2xlLmxvZygic3Vic2NyaWJlLXJlc3BvbnNlOiAiLG4pO3ZhciBzPXIuX3Byb3Zpc2lvbmFsc1t0XTtpZihkZWxldGUgci5fcHJvdmlzaW9uYWxzW3RdLHMmJnMuX3JlbGVhc2VMaXN0ZW5lcnMoKSxuLmJvZHkuY29kZTwyMDApcz1uZXcgaFsiZGVmYXVsdCJdKHIuX293bmVyLHQsci5fYnVzLG4uYm9keS5jaGlsZHJlblJlc291cmNlcyksci5fcHJvdmlzaW9uYWxzW3RdPXM7ZWxzZSBpZigyMDA9PT1uLmJvZHkuY29kZSl7dmFyIGE9bmV3IHBbImRlZmF1bHQiXShyLHQsZSwib24iLG4uYm9keS52YWx1ZSxzLmNoaWxkcmVuLG4uYm9keS52ZXJzaW9uKTtyLl9vYnNlcnZlcnNbdF09YSxvKGEpLHMuYXBwbHkoYSl9ZWxzZSBpKG4uYm9keS5kZXNjKX0pfSl9fSx7a2V5OiJvbk5vdGlmaWNhdGlvbiIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyPWV9fSx7a2V5OiJfb25Gb3J3YXJkIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLHI9dC5fcmVwb3J0ZXJzW2UuYm9keS50b107ci5fb25Gb3J3YXJkKGUpfX0se2tleToiX29uUmVtb3RlQ3JlYXRlIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLHI9ZS5mcm9tLnNsaWNlKDAsLTEzKSxuPXt0eXBlOmUudHlwZSxmcm9tOmUuYm9keS5zb3VyY2UsdXJsOnIsc2NoZW1hOmUuYm9keS5zY2hlbWEsdmFsdWU6ZS5ib2R5LnZhbHVlLGlkZW50aXR5OmUuYm9keS5pZGVudGl0eSxhY2s6ZnVuY3Rpb24ocil7dmFyIG49MjAwO3ImJihuPXIpLHQuX2J1cy5wb3N0TWVzc2FnZSh7aWQ6ZS5pZCx0eXBlOiJyZXNwb25zZSIsZnJvbTplLnRvLHRvOmUuZnJvbSxib2R5Ontjb2RlOm59fSl9fTt0Ll9vbk5vdGlmaWNhdGlvbkhhbmRsZXImJihjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLG4pLHQuX29uTm90aWZpY2F0aW9uSGFuZGxlcihuKSl9fSx7a2V5OiJfb25SZW1vdGVEZWxldGUiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1lLmJvZHkucmVzb3VyY2Usbj10Ll9vYnNlcnZlcnNbcl07aWYobil7dmFyIG89e3R5cGU6ZS50eXBlLHVybDpyLGlkZW50aXR5OmUuYm9keS5pZGVudGl0eSxhY2s6ZnVuY3Rpb24ocil7dmFyIG89MjAwO3ImJihvPXIpLDIwMD09PW8mJm5bImRlbGV0ZSJdKCksdC5fYnVzLnBvc3RNZXNzYWdlKHtpZDplLmlkLHR5cGU6InJlc3BvbnNlIixmcm9tOmUudG8sdG86ZS5mcm9tLGJvZHk6e2NvZGU6byxzb3VyY2U6dC5fb3duZXJ9fSl9fTt0Ll9vbk5vdGlmaWNhdGlvbkhhbmRsZXImJihjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLG8pLHQuX29uTm90aWZpY2F0aW9uSGFuZGxlcihvKSl9ZWxzZSB0Ll9idXMucG9zdE1lc3NhZ2Uoe2lkOmUuaWQsdHlwZToicmVzcG9uc2UiLGZyb206ZS50byx0bzplLmZyb20sYm9keTp7Y29kZTo0MDQsc291cmNlOnQuX293bmVyfX0pfX0se2tleToib3duZXIiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vd25lcn19LHtrZXk6InJlcG9ydGVycyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlcG9ydGVyc319LHtrZXk6Im9ic2VydmVycyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29ic2VydmVyc319XSksZX0oKTtyWyJkZWZhdWx0Il09dix0LmV4cG9ydHM9clsiZGVmYXVsdCJdfSx7Ii4vRGF0YU9iamVjdE9ic2VydmVyIjo5NSwiLi9EYXRhT2JqZWN0UmVwb3J0ZXIiOjk2LCIuL0RhdGFQcm92aXNpb25hbCI6OTcsImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIjo5LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjEyfV0sMTAwOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19ZnVuY3Rpb24gbyhlKXt2YXIgdD0vKFthLXpBLVotXSopOlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naSxyPSIkMSwkMiwkMyIsbj1lLnJlcGxhY2UodCxyKS5zcGxpdCgiLCIpO25bMF09PT1lJiYoblswXT0iaHR0cHMiLG5bMV09ZSk7dmFyIG89e3R5cGU6blswXSxkb21haW46blsxXSxpZGVudGl0eTpuWzJdfTtyZXR1cm4gb31mdW5jdGlvbiBpKGUpe3JldHVybiBlP0pTT04ucGFyc2UoKDAsYVsiZGVmYXVsdCJdKShlKSk6dm9pZCAwfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgcz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvanNvbi9zdHJpbmdpZnkiKSxhPW4ocyk7ci5kaXZpZGVVUkw9byxyLmRlZXBDbG9uZT1pfSx7ImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSI6Mn1dfSx7fSxbOTJdKSg5Mil9KTsKfSkuY2FsbCh0aGlzLHR5cGVvZiBnbG9iYWwgIT09ICJ1bmRlZmluZWQiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDoge30pCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKiEKICogVVJJLmpzIC0gTXV0YXRpbmcgVVJMcwogKiBJUHY2IFN1cHBvcnQKICoKICogVmVyc2lvbjogMS4xOC4wCiAqCiAqIEF1dGhvcjogUm9kbmV5IFJlaG0KICogV2ViOiBodHRwOi8vbWVkaWFsaXplLmdpdGh1Yi5pby9VUkkuanMvCiAqCiAqIExpY2Vuc2VkIHVuZGVyCiAqICAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZQogKgogKi8KCihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkgewogICd1c2Ugc3RyaWN0JzsKICAvLyBodHRwczovL2dpdGh1Yi5jb20vdW1kanMvdW1kL2Jsb2IvbWFzdGVyL3JldHVybkV4cG9ydHMuanMKICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7CiAgICAvLyBOb2RlCiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgewogICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLgogICAgZGVmaW5lKGZhY3RvcnkpOwogIH0gZWxzZSB7CiAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KQogICAgcm9vdC5JUHY2ID0gZmFjdG9yeShyb290KTsKICB9Cn0odGhpcywgZnVuY3Rpb24gKHJvb3QpIHsKICAndXNlIHN0cmljdCc7CgogIC8qCiAgdmFyIF9pbiA9ICJmZTgwOjAwMDA6MDAwMDowMDAwOjAyMDQ6NjFmZjpmZTlkOmYxNTYiOwogIHZhciBfb3V0ID0gSVB2Ni5iZXN0KF9pbik7CiAgdmFyIF9leHBlY3RlZCA9ICJmZTgwOjoyMDQ6NjFmZjpmZTlkOmYxNTYiOwoKICBjb25zb2xlLmxvZyhfaW4sIF9vdXQsIF9leHBlY3RlZCwgX291dCA9PT0gX2V4cGVjdGVkKTsKICAqLwoKICAvLyBzYXZlIGN1cnJlbnQgSVB2NiB2YXJpYWJsZSwgaWYgYW55CiAgdmFyIF9JUHY2ID0gcm9vdCAmJiByb290LklQdjY7CgogIGZ1bmN0aW9uIGJlc3RQcmVzZW50YXRpb24oYWRkcmVzcykgewogICAgLy8gYmFzZWQgb246CiAgICAvLyBKYXZhc2NyaXB0IHRvIHRlc3QgYW4gSVB2NiBhZGRyZXNzIGZvciBwcm9wZXIgZm9ybWF0LCBhbmQgdG8KICAgIC8vIHByZXNlbnQgdGhlICJiZXN0IHRleHQgcmVwcmVzZW50YXRpb24iIGFjY29yZGluZyB0byBJRVRGIERyYWZ0IFJGQyBhdAogICAgLy8gaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvZHJhZnQtaWV0Zi02bWFuLXRleHQtYWRkci1yZXByZXNlbnRhdGlvbi0wNAogICAgLy8gOCBGZWIgMjAxMCBSaWNoIEJyb3duLCBEYXJ0d2FyZSwgTExDCiAgICAvLyBQbGVhc2UgZmVlbCBmcmVlIHRvIHVzZSB0aGlzIGNvZGUgYXMgbG9uZyBhcyB5b3UgcHJvdmlkZSBhIGxpbmsgdG8KICAgIC8vIGh0dHA6Ly93d3cuaW50ZXJtYXBwZXIuY29tCiAgICAvLyBodHRwOi8vaW50ZXJtYXBwZXIuY29tL3N1cHBvcnQvdG9vbHMvSVBWNi1WYWxpZGF0b3IuYXNweAogICAgLy8gaHR0cDovL2Rvd25sb2FkLmRhcnR3YXJlLmNvbS90aGlyZHBhcnR5L2lwdjZ2YWxpZGF0b3IuanMKCiAgICB2YXIgX2FkZHJlc3MgPSBhZGRyZXNzLnRvTG93ZXJDYXNlKCk7CiAgICB2YXIgc2VnbWVudHMgPSBfYWRkcmVzcy5zcGxpdCgnOicpOwogICAgdmFyIGxlbmd0aCA9IHNlZ21lbnRzLmxlbmd0aDsKICAgIHZhciB0b3RhbCA9IDg7CgogICAgLy8gdHJpbSBjb2xvbnMgKDo6IG9yIDo6YTpiOmPigKYgb3Ig4oCmYTpiOmM6OikKICAgIGlmIChzZWdtZW50c1swXSA9PT0gJycgJiYgc2VnbWVudHNbMV0gPT09ICcnICYmIHNlZ21lbnRzWzJdID09PSAnJykgewogICAgICAvLyBtdXN0IGhhdmUgYmVlbiA6OgogICAgICAvLyByZW1vdmUgZmlyc3QgdHdvIGl0ZW1zCiAgICAgIHNlZ21lbnRzLnNoaWZ0KCk7CiAgICAgIHNlZ21lbnRzLnNoaWZ0KCk7CiAgICB9IGVsc2UgaWYgKHNlZ21lbnRzWzBdID09PSAnJyAmJiBzZWdtZW50c1sxXSA9PT0gJycpIHsKICAgICAgLy8gbXVzdCBoYXZlIGJlZW4gOjp4eHh4CiAgICAgIC8vIHJlbW92ZSB0aGUgZmlyc3QgaXRlbQogICAgICBzZWdtZW50cy5zaGlmdCgpOwogICAgfSBlbHNlIGlmIChzZWdtZW50c1tsZW5ndGggLSAxXSA9PT0gJycgJiYgc2VnbWVudHNbbGVuZ3RoIC0gMl0gPT09ICcnKSB7CiAgICAgIC8vIG11c3QgaGF2ZSBiZWVuIHh4eHg6OgogICAgICBzZWdtZW50cy5wb3AoKTsKICAgIH0KCiAgICBsZW5ndGggPSBzZWdtZW50cy5sZW5ndGg7CgogICAgLy8gYWRqdXN0IHRvdGFsIHNlZ21lbnRzIGZvciBJUHY0IHRyYWlsZXIKICAgIGlmIChzZWdtZW50c1tsZW5ndGggLSAxXS5pbmRleE9mKCcuJykgIT09IC0xKSB7CiAgICAgIC8vIGZvdW5kIGEgIi4iIHdoaWNoIG1lYW5zIElQdjQKICAgICAgdG90YWwgPSA3OwogICAgfQoKICAgIC8vIGZpbGwgZW1wdHkgc2VnbWVudHMgdGhlbSB3aXRoICIwMDAwIgogICAgdmFyIHBvczsKICAgIGZvciAocG9zID0gMDsgcG9zIDwgbGVuZ3RoOyBwb3MrKykgewogICAgICBpZiAoc2VnbWVudHNbcG9zXSA9PT0gJycpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGlmIChwb3MgPCB0b3RhbCkgewogICAgICBzZWdtZW50cy5zcGxpY2UocG9zLCAxLCAnMDAwMCcpOwogICAgICB3aGlsZSAoc2VnbWVudHMubGVuZ3RoIDwgdG90YWwpIHsKICAgICAgICBzZWdtZW50cy5zcGxpY2UocG9zLCAwLCAnMDAwMCcpOwogICAgICB9CiAgICB9CgogICAgLy8gc3RyaXAgbGVhZGluZyB6ZXJvcwogICAgdmFyIF9zZWdtZW50czsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG90YWw7IGkrKykgewogICAgICBfc2VnbWVudHMgPSBzZWdtZW50c1tpXS5zcGxpdCgnJyk7CiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMyA7IGorKykgewogICAgICAgIGlmIChfc2VnbWVudHNbMF0gPT09ICcwJyAmJiBfc2VnbWVudHMubGVuZ3RoID4gMSkgewogICAgICAgICAgX3NlZ21lbnRzLnNwbGljZSgwLDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHNlZ21lbnRzW2ldID0gX3NlZ21lbnRzLmpvaW4oJycpOwogICAgfQoKICAgIC8vIGZpbmQgbG9uZ2VzdCBzZXF1ZW5jZSBvZiB6ZXJvZXMgYW5kIGNvYWxlc2NlIHRoZW0gaW50byBvbmUgc2VnbWVudAogICAgdmFyIGJlc3QgPSAtMTsKICAgIHZhciBfYmVzdCA9IDA7CiAgICB2YXIgX2N1cnJlbnQgPSAwOwogICAgdmFyIGN1cnJlbnQgPSAtMTsKICAgIHZhciBpbnplcm9lcyA9IGZhbHNlOwogICAgLy8gaTsgYWxyZWFkeSBkZWNsYXJlZAoKICAgIGZvciAoaSA9IDA7IGkgPCB0b3RhbDsgaSsrKSB7CiAgICAgIGlmIChpbnplcm9lcykgewogICAgICAgIGlmIChzZWdtZW50c1tpXSA9PT0gJzAnKSB7CiAgICAgICAgICBfY3VycmVudCArPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpbnplcm9lcyA9IGZhbHNlOwogICAgICAgICAgaWYgKF9jdXJyZW50ID4gX2Jlc3QpIHsKICAgICAgICAgICAgYmVzdCA9IGN1cnJlbnQ7CiAgICAgICAgICAgIF9iZXN0ID0gX2N1cnJlbnQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChzZWdtZW50c1tpXSA9PT0gJzAnKSB7CiAgICAgICAgICBpbnplcm9lcyA9IHRydWU7CiAgICAgICAgICBjdXJyZW50ID0gaTsKICAgICAgICAgIF9jdXJyZW50ID0gMTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoX2N1cnJlbnQgPiBfYmVzdCkgewogICAgICBiZXN0ID0gY3VycmVudDsKICAgICAgX2Jlc3QgPSBfY3VycmVudDsKICAgIH0KCiAgICBpZiAoX2Jlc3QgPiAxKSB7CiAgICAgIHNlZ21lbnRzLnNwbGljZShiZXN0LCBfYmVzdCwgJycpOwogICAgfQoKICAgIGxlbmd0aCA9IHNlZ21lbnRzLmxlbmd0aDsKCiAgICAvLyBhc3NlbWJsZSByZW1haW5pbmcgc2VnbWVudHMKICAgIHZhciByZXN1bHQgPSAnJzsKICAgIGlmIChzZWdtZW50c1swXSA9PT0gJycpICB7CiAgICAgIHJlc3VsdCA9ICc6JzsKICAgIH0KCiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgcmVzdWx0ICs9IHNlZ21lbnRzW2ldOwogICAgICBpZiAoaSA9PT0gbGVuZ3RoIC0gMSkgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICByZXN1bHQgKz0gJzonOwogICAgfQoKICAgIGlmIChzZWdtZW50c1tsZW5ndGggLSAxXSA9PT0gJycpIHsKICAgICAgcmVzdWx0ICs9ICc6JzsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgZnVuY3Rpb24gbm9Db25mbGljdCgpIHsKICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqLwogICAgaWYgKHJvb3QuSVB2NiA9PT0gdGhpcykgewogICAgICByb290LklQdjYgPSBfSVB2NjsKICAgIH0KICAKICAgIHJldHVybiB0aGlzOwogIH0KCiAgcmV0dXJuIHsKICAgIGJlc3Q6IGJlc3RQcmVzZW50YXRpb24sCiAgICBub0NvbmZsaWN0OiBub0NvbmZsaWN0CiAgfTsKfSkpOwoKfSx7fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qIQogKiBVUkkuanMgLSBNdXRhdGluZyBVUkxzCiAqIFNlY29uZCBMZXZlbCBEb21haW4gKFNMRCkgU3VwcG9ydAogKgogKiBWZXJzaW9uOiAxLjE4LjAKICoKICogQXV0aG9yOiBSb2RuZXkgUmVobQogKiBXZWI6IGh0dHA6Ly9tZWRpYWxpemUuZ2l0aHViLmlvL1VSSS5qcy8KICoKICogTGljZW5zZWQgdW5kZXIKICogICBNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlCiAqCiAqLwoKKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7CiAgJ3VzZSBzdHJpY3QnOwogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS91bWRqcy91bWQvYmxvYi9tYXN0ZXIvcmV0dXJuRXhwb3J0cy5qcwogIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHsKICAgIC8vIE5vZGUKICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpOwogIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7CiAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuCiAgICBkZWZpbmUoZmFjdG9yeSk7CiAgfSBlbHNlIHsKICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpCiAgICByb290LlNlY29uZExldmVsRG9tYWlucyA9IGZhY3Rvcnkocm9vdCk7CiAgfQp9KHRoaXMsIGZ1bmN0aW9uIChyb290KSB7CiAgJ3VzZSBzdHJpY3QnOwoKICAvLyBzYXZlIGN1cnJlbnQgU2Vjb25kTGV2ZWxEb21haW5zIHZhcmlhYmxlLCBpZiBhbnkKICB2YXIgX1NlY29uZExldmVsRG9tYWlucyA9IHJvb3QgJiYgcm9vdC5TZWNvbmRMZXZlbERvbWFpbnM7CgogIHZhciBTTEQgPSB7CiAgICAvLyBsaXN0IG9mIGtub3duIFNlY29uZCBMZXZlbCBEb21haW5zCiAgICAvLyBjb252ZXJ0ZWQgbGlzdCBvZiBTTERzIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2dhdmluZ21pbGxlci9zZWNvbmQtbGV2ZWwtZG9tYWlucwogICAgLy8gLS0tLQogICAgLy8gcHVibGljc3VmZml4Lm9yZyBpcyBtb3JlIGN1cnJlbnQgYW5kIGFjdHVhbGx5IHVzZWQgYnkgYSBjb3VwbGUgb2YgYnJvd3NlcnMgaW50ZXJuYWxseS4KICAgIC8vIGRvd25zaWRlIGlzIGl0IGFsc28gY29udGFpbnMgZG9tYWlucyBsaWtlICJkeW5kbnMub3JnIiAtIHdoaWNoIGlzIGZpbmUgZm9yIHRoZSBzZWN1cml0eQogICAgLy8gaXNzdWVzIGJyb3dzZXIgaGF2ZSB0byBkZWFsIHdpdGggKFNPUCBmb3IgY29va2llcywgZXRjKSAtIGJ1dCBpcyB3YXkgb3ZlcmJvYXJkIGZvciBVUkkuanMKICAgIC8vIC0tLS0KICAgIGxpc3Q6IHsKICAgICAgJ2FjJzonIGNvbSBnb3YgbWlsIG5ldCBvcmcgJywKICAgICAgJ2FlJzonIGFjIGNvIGdvdiBtaWwgbmFtZSBuZXQgb3JnIHBybyBzY2ggJywKICAgICAgJ2FmJzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ2FsJzonIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnICcsCiAgICAgICdhbyc6JyBjbyBlZCBndiBpdCBvZyBwYiAnLAogICAgICAnYXInOicgY29tIGVkdSBnb2IgZ292IGludCBtaWwgbmV0IG9yZyB0dXIgJywKICAgICAgJ2F0JzonIGFjIGNvIGd2IG9yICcsCiAgICAgICdhdSc6JyBhc24gY29tIGNzaXJvIGVkdSBnb3YgaWQgbmV0IG9yZyAnLAogICAgICAnYmEnOicgY28gY29tIGVkdSBnb3YgbWlsIG5ldCBvcmcgcnMgdW5iaSB1bm1vIHVuc2EgdW50eiB1bnplICcsCiAgICAgICdiYic6JyBiaXogY28gY29tIGVkdSBnb3YgaW5mbyBuZXQgb3JnIHN0b3JlIHR2ICcsCiAgICAgICdiaCc6JyBiaXogY2MgY29tIGVkdSBnb3YgaW5mbyBuZXQgb3JnICcsCiAgICAgICdibic6JyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdibyc6JyBjb20gZWR1IGdvYiBnb3YgaW50IG1pbCBuZXQgb3JnIHR2ICcsCiAgICAgICdicic6JyBhZG0gYWR2IGFnciBhbSBhcnEgYXJ0IGF0byBiIGJpbyBibG9nIGJtZCBjaW0gY25nIGNudCBjb20gY29vcCBlY24gZWR1IGVuZyBlc3AgZXRjIGV0aSBmYXIgZmxvZyBmbSBmbmQgZm90IGZzdCBnMTIgZ2dmIGdvdiBpbWIgaW5kIGluZiBqb3IganVzIGxlbCBtYXQgbWVkIG1pbCBtdXMgbmV0IG5vbSBub3QgbnRyIG9kbyBvcmcgcHBnIHBybyBwc2MgcHNpIHFzbCByZWMgc2xnIHNydiB0bXAgdHJkIHR1ciB0diB2ZXQgdmxvZyB3aWtpIHpsZyAnLAogICAgICAnYnMnOicgY29tIGVkdSBnb3YgbmV0IG9yZyAnLAogICAgICAnYnonOicgZHUgZXQgb20gb3YgcmcgJywKICAgICAgJ2NhJzonIGFiIGJjIG1iIG5iIG5mIG5sIG5zIG50IG51IG9uIHBlIHFjIHNrIHlrICcsCiAgICAgICdjayc6JyBiaXogY28gZWR1IGdlbiBnb3YgaW5mbyBuZXQgb3JnICcsCiAgICAgICdjbic6JyBhYyBhaCBiaiBjb20gY3EgZWR1IGZqIGdkIGdvdiBncyBneCBneiBoYSBoYiBoZSBoaSBobCBobiBqbCBqcyBqeCBsbiBtaWwgbmV0IG5tIG54IG9yZyBxaCBzYyBzZCBzaCBzbiBzeCB0aiB0dyB4aiB4eiB5biB6aiAnLAogICAgICAnY28nOicgY29tIGVkdSBnb3YgbWlsIG5ldCBub20gb3JnICcsCiAgICAgICdjcic6JyBhYyBjIGNvIGVkIGZpIGdvIG9yIHNhICcsCiAgICAgICdjeSc6JyBhYyBiaXogY29tIGVrbG9nZXMgZ292IGx0ZCBuYW1lIG5ldCBvcmcgcGFybGlhbWVudCBwcmVzcyBwcm8gdG0gJywKICAgICAgJ2RvJzonIGFydCBjb20gZWR1IGdvYiBnb3YgbWlsIG5ldCBvcmcgc2xkIHdlYiAnLAogICAgICAnZHonOicgYXJ0IGFzc28gY29tIGVkdSBnb3YgbmV0IG9yZyBwb2wgJywKICAgICAgJ2VjJzonIGNvbSBlZHUgZmluIGdvdiBpbmZvIG1lZCBtaWwgbmV0IG9yZyBwcm8gJywKICAgICAgJ2VnJzonIGNvbSBlZHUgZXVuIGdvdiBtaWwgbmFtZSBuZXQgb3JnIHNjaSAnLAogICAgICAnZXInOicgY29tIGVkdSBnb3YgaW5kIG1pbCBuZXQgb3JnIHJvY2hlc3QgdyAnLAogICAgICAnZXMnOicgY29tIGVkdSBnb2Igbm9tIG9yZyAnLAogICAgICAnZXQnOicgYml6IGNvbSBlZHUgZ292IGluZm8gbmFtZSBuZXQgb3JnICcsCiAgICAgICdmaic6JyBhYyBiaXogY29tIGluZm8gbWlsIG5hbWUgbmV0IG9yZyBwcm8gJywKICAgICAgJ2ZrJzonIGFjIGNvIGdvdiBuZXQgbm9tIG9yZyAnLAogICAgICAnZnInOicgYXNzbyBjb20gZiBnb3V2IG5vbSBwcmQgcHJlc3NlIHRtICcsCiAgICAgICdnZyc6JyBjbyBuZXQgb3JnICcsCiAgICAgICdnaCc6JyBjb20gZWR1IGdvdiBtaWwgb3JnICcsCiAgICAgICdnbic6JyBhYyBjb20gZ292IG5ldCBvcmcgJywKICAgICAgJ2dyJzonIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnICcsCiAgICAgICdndCc6JyBjb20gZWR1IGdvYiBpbmQgbWlsIG5ldCBvcmcgJywKICAgICAgJ2d1JzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ2hrJzonIGNvbSBlZHUgZ292IGlkdiBuZXQgb3JnICcsCiAgICAgICdodSc6JyAyMDAwIGFncmFyIGJvbHQgY2FzaW5vIGNpdHkgY28gZXJvdGljYSBlcm90aWthIGZpbG0gZm9ydW0gZ2FtZXMgaG90ZWwgaW5mbyBpbmdhdGxhbiBqb2dhc3oga29ueXZlbG8gbGFrYXMgbWVkaWEgbmV3cyBvcmcgcHJpdiByZWtsYW0gc2V4IHNob3Agc3BvcnQgc3VsaSBzemV4IHRtIHRvenNkZSB1dGF6YXMgdmlkZW8gJywKICAgICAgJ2lkJzonIGFjIGNvIGdvIG1pbCBuZXQgb3Igc2NoIHdlYiAnLAogICAgICAnaWwnOicgYWMgY28gZ292IGlkZiBrMTIgbXVuaSBuZXQgb3JnICcsCiAgICAgICdpbic6JyBhYyBjbyBlZHUgZXJuZXQgZmlybSBnZW4gZ292IGkgaW5kIG1pbCBuZXQgbmljIG9yZyByZXMgJywKICAgICAgJ2lxJzonIGNvbSBlZHUgZ292IGkgbWlsIG5ldCBvcmcgJywKICAgICAgJ2lyJzonIGFjIGNvIGRuc3NlYyBnb3YgaSBpZCBuZXQgb3JnIHNjaCAnLAogICAgICAnaXQnOicgZWR1IGdvdiAnLAogICAgICAnamUnOicgY28gbmV0IG9yZyAnLAogICAgICAnam8nOicgY29tIGVkdSBnb3YgbWlsIG5hbWUgbmV0IG9yZyBzY2ggJywKICAgICAgJ2pwJzonIGFjIGFkIGNvIGVkIGdvIGdyIGxnIG5lIG9yICcsCiAgICAgICdrZSc6JyBhYyBjbyBnbyBpbmZvIG1lIG1vYmkgbmUgb3Igc2MgJywKICAgICAgJ2toJzonIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnIHBlciAnLAogICAgICAna2knOicgYml6IGNvbSBkZSBlZHUgZ292IGluZm8gbW9iIG5ldCBvcmcgdGVsICcsCiAgICAgICdrbSc6JyBhc3NvIGNvbSBjb29wIGVkdSBnb3V2IGsgbWVkZWNpbiBtaWwgbm9tIG5vdGFpcmVzIHBoYXJtYWNpZW5zIHByZXNzZSB0bSB2ZXRlcmluYWlyZSAnLAogICAgICAna24nOicgZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdrcic6JyBhYyBidXNhbiBjaHVuZ2J1ayBjaHVuZ25hbSBjbyBkYWVndSBkYWVqZW9uIGVzIGdhbmd3b24gZ28gZ3dhbmdqdSBneWVvbmdidWsgZ3llb25nZ2kgZ3llb25nbmFtIGhzIGluY2hlb24gamVqdSBqZW9uYnVrIGplb25uYW0gayBrZyBtaWwgbXMgbmUgb3IgcGUgcmUgc2Mgc2VvdWwgdWxzYW4gJywKICAgICAgJ2t3JzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ2t5JzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ2t6JzonIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnICcsCiAgICAgICdsYic6JyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdsayc6JyBhc3NuIGNvbSBlZHUgZ292IGdycCBob3RlbCBpbnQgbHRkIG5ldCBuZ28gb3JnIHNjaCBzb2Mgd2ViICcsCiAgICAgICdscic6JyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdsdic6JyBhc24gY29tIGNvbmYgZWR1IGdvdiBpZCBtaWwgbmV0IG9yZyAnLAogICAgICAnbHknOicgY29tIGVkdSBnb3YgaWQgbWVkIG5ldCBvcmcgcGxjIHNjaCAnLAogICAgICAnbWEnOicgYWMgY28gZ292IG0gbmV0IG9yZyBwcmVzcyAnLAogICAgICAnbWMnOicgYXNzbyB0bSAnLAogICAgICAnbWUnOicgYWMgY28gZWR1IGdvdiBpdHMgbmV0IG9yZyBwcml2ICcsCiAgICAgICdtZyc6JyBjb20gZWR1IGdvdiBtaWwgbm9tIG9yZyBwcmQgdG0gJywKICAgICAgJ21rJzonIGNvbSBlZHUgZ292IGluZiBuYW1lIG5ldCBvcmcgcHJvICcsCiAgICAgICdtbCc6JyBjb20gZWR1IGdvdiBuZXQgb3JnIHByZXNzZSAnLAogICAgICAnbW4nOicgZWR1IGdvdiBvcmcgJywKICAgICAgJ21vJzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ210JzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ212JzonIGFlcm8gYml6IGNvbSBjb29wIGVkdSBnb3YgaW5mbyBpbnQgbWlsIG11c2V1bSBuYW1lIG5ldCBvcmcgcHJvICcsCiAgICAgICdtdyc6JyBhYyBjbyBjb20gY29vcCBlZHUgZ292IGludCBtdXNldW0gbmV0IG9yZyAnLAogICAgICAnbXgnOicgY29tIGVkdSBnb2IgbmV0IG9yZyAnLAogICAgICAnbXknOicgY29tIGVkdSBnb3YgbWlsIG5hbWUgbmV0IG9yZyBzY2ggJywKICAgICAgJ25mJzonIGFydHMgY29tIGZpcm0gaW5mbyBuZXQgb3RoZXIgcGVyIHJlYyBzdG9yZSB3ZWIgJywKICAgICAgJ25nJzonIGJpeiBjb20gZWR1IGdvdiBtaWwgbW9iaSBuYW1lIG5ldCBvcmcgc2NoICcsCiAgICAgICduaSc6JyBhYyBjbyBjb20gZWR1IGdvYiBtaWwgbmV0IG5vbSBvcmcgJywKICAgICAgJ25wJzonIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnICcsCiAgICAgICducic6JyBiaXogY29tIGVkdSBnb3YgaW5mbyBuZXQgb3JnICcsCiAgICAgICdvbSc6JyBhYyBiaXogY28gY29tIGVkdSBnb3YgbWVkIG1pbCBtdXNldW0gbmV0IG9yZyBwcm8gc2NoICcsCiAgICAgICdwZSc6JyBjb20gZWR1IGdvYiBtaWwgbmV0IG5vbSBvcmcgc2xkICcsCiAgICAgICdwaCc6JyBjb20gZWR1IGdvdiBpIG1pbCBuZXQgbmdvIG9yZyAnLAogICAgICAncGsnOicgYml6IGNvbSBlZHUgZmFtIGdvYiBnb2sgZ29uIGdvcCBnb3MgZ292IG5ldCBvcmcgd2ViICcsCiAgICAgICdwbCc6JyBhcnQgYmlhbHlzdG9rIGJpeiBjb20gZWR1IGdkYSBnZGFuc2sgZ29yem93IGdvdiBpbmZvIGthdG93aWNlIGtyYWtvdyBsb2R6IGx1YmxpbiBtaWwgbmV0IG5nbyBvbHN6dHluIG9yZyBwb3puYW4gcHdyIHJhZG9tIHNsdXBzayBzemN6ZWNpbiB0b3J1biB3YXJzemF3YSB3YXcgd3JvYyB3cm9jbGF3IHpnb3JhICcsCiAgICAgICdwcic6JyBhYyBiaXogY29tIGVkdSBlc3QgZ292IGluZm8gaXNsYSBuYW1lIG5ldCBvcmcgcHJvIHByb2YgJywKICAgICAgJ3BzJzonIGNvbSBlZHUgZ292IG5ldCBvcmcgcGxvIHNlYyAnLAogICAgICAncHcnOicgYmVsYXUgY28gZWQgZ28gbmUgb3IgJywKICAgICAgJ3JvJzonIGFydHMgY29tIGZpcm0gaW5mbyBub20gbnQgb3JnIHJlYyBzdG9yZSB0bSB3d3cgJywKICAgICAgJ3JzJzonIGFjIGNvIGVkdSBnb3YgaW4gb3JnICcsCiAgICAgICdzYic6JyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdzYyc6JyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdzaCc6JyBjbyBjb20gZWR1IGdvdiBuZXQgbm9tIG9yZyAnLAogICAgICAnc2wnOicgY29tIGVkdSBnb3YgbmV0IG9yZyAnLAogICAgICAnc3QnOicgY28gY29tIGNvbnN1bGFkbyBlZHUgZW1iYWl4YWRhIGdvdiBtaWwgbmV0IG9yZyBwcmluY2lwZSBzYW90b21lIHN0b3JlICcsCiAgICAgICdzdic6JyBjb20gZWR1IGdvYiBvcmcgcmVkICcsCiAgICAgICdzeic6JyBhYyBjbyBvcmcgJywKICAgICAgJ3RyJzonIGF2IGJicyBiZWwgYml6IGNvbSBkciBlZHUgZ2VuIGdvdiBpbmZvIGsxMiBuYW1lIG5ldCBvcmcgcG9sIHRlbCB0c2sgdHYgd2ViICcsCiAgICAgICd0dCc6JyBhZXJvIGJpeiBjYXQgY28gY29tIGNvb3AgZWR1IGdvdiBpbmZvIGludCBqb2JzIG1pbCBtb2JpIG11c2V1bSBuYW1lIG5ldCBvcmcgcHJvIHRlbCB0cmF2ZWwgJywKICAgICAgJ3R3JzonIGNsdWIgY29tIGViaXogZWR1IGdhbWUgZ292IGlkdiBtaWwgbmV0IG9yZyAnLAogICAgICAnbXUnOicgYWMgY28gY29tIGdvdiBuZXQgb3Igb3JnICcsCiAgICAgICdteic6JyBhYyBjbyBlZHUgZ292IG9yZyAnLAogICAgICAnbmEnOicgY28gY29tICcsCiAgICAgICdueic6JyBhYyBjbyBjcmkgZ2VlayBnZW4gZ292dCBoZWFsdGggaXdpIG1hb3JpIG1pbCBuZXQgb3JnIHBhcmxpYW1lbnQgc2Nob29sICcsCiAgICAgICdwYSc6JyBhYm8gYWMgY29tIGVkdSBnb2IgaW5nIG1lZCBuZXQgbm9tIG9yZyBzbGQgJywKICAgICAgJ3B0JzonIGNvbSBlZHUgZ292IGludCBuZXQgbm9tZSBvcmcgcHVibCAnLAogICAgICAncHknOicgY29tIGVkdSBnb3YgbWlsIG5ldCBvcmcgJywKICAgICAgJ3FhJzonIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnICcsCiAgICAgICdyZSc6JyBhc3NvIGNvbSBub20gJywKICAgICAgJ3J1JzonIGFjIGFkeWdleWEgYWx0YWkgYW11ciBhcmtoYW5nZWxzayBhc3RyYWtoYW4gYmFzaGtpcmlhIGJlbGdvcm9kIGJpciBicnlhbnNrIGJ1cnlhdGlhIGNiZyBjaGVsIGNoZWx5YWJpbnNrIGNoaXRhIGNodWtvdGthIGNodXZhc2hpYSBjb20gZGFnZXN0YW4gZS1idXJnIGVkdSBnb3YgZ3Jvem55IGludCBpcmt1dHNrIGl2YW5vdm8gaXpoZXZzayBqYXIgam9zaGthci1vbGEga2FsbXlraWEga2FsdWdhIGthbWNoYXRrYSBrYXJlbGlhIGthemFuIGtjaHIga2VtZXJvdm8ga2hhYmFyb3ZzayBraGFrYXNzaWEga2h2IGtpcm92IGtvZW5pZyBrb21pIGtvc3Ryb21hIGtyYW5veWFyc2sga3ViYW4ga3VyZ2FuIGt1cnNrIGxpcGV0c2sgbWFnYWRhbiBtYXJpIG1hcmktZWwgbWFyaW5lIG1pbCBtb3Jkb3ZpYSBtb3NyZWcgbXNrIG11cm1hbnNrIG5hbGNoaWsgbmV0IG5ub3Ygbm92IG5vdm9zaWJpcnNrIG5zayBvbXNrIG9yZW5idXJnIG9yZyBvcnlvbCBwZW56YSBwZXJtIHBwIHBza292IHB0eiBybmQgcnlhemFuIHNha2hhbGluIHNhbWFyYSBzYXJhdG92IHNpbWJpcnNrIHNtb2xlbnNrIHNwYiBzdGF2cm9wb2wgc3R2IHN1cmd1dCB0YW1ib3YgdGF0YXJzdGFuIHRvbSB0b21zayB0c2FyaXRzeW4gdHNrIHR1bGEgdHV2YSB0dmVyIHR5dW1lbiB1ZG0gdWRtdXJ0aWEgdWxhbi11ZGUgdmxhZGlrYXZrYXogdmxhZGltaXIgdmxhZGl2b3N0b2sgdm9sZ29ncmFkIHZvbG9nZGEgdm9yb25lemggdnJuIHZ5YXRrYSB5YWt1dGlhIHlhbWFsIHlla2F0ZXJpbmJ1cmcgeXV6aG5vLXNha2hhbGluc2sgJywKICAgICAgJ3J3JzonIGFjIGNvIGNvbSBlZHUgZ291diBnb3YgaW50IG1pbCBuZXQgJywKICAgICAgJ3NhJzonIGNvbSBlZHUgZ292IG1lZCBuZXQgb3JnIHB1YiBzY2ggJywKICAgICAgJ3NkJzonIGNvbSBlZHUgZ292IGluZm8gbWVkIG5ldCBvcmcgdHYgJywKICAgICAgJ3NlJzonIGEgYWMgYiBiZCBjIGQgZSBmIGcgaCBpIGsgbCBtIG4gbyBvcmcgcCBwYXJ0aSBwcCBwcmVzcyByIHMgdCB0bSB1IHcgeCB5IHogJywKICAgICAgJ3NnJzonIGNvbSBlZHUgZ292IGlkbiBuZXQgb3JnIHBlciAnLAogICAgICAnc24nOicgYXJ0IGNvbSBlZHUgZ291diBvcmcgcGVyc28gdW5pdiAnLAogICAgICAnc3knOicgY29tIGVkdSBnb3YgbWlsIG5ldCBuZXdzIG9yZyAnLAogICAgICAndGgnOicgYWMgY28gZ28gaW4gbWkgbmV0IG9yICcsCiAgICAgICd0aic6JyBhYyBiaXogY28gY29tIGVkdSBnbyBnb3YgaW5mbyBpbnQgbWlsIG5hbWUgbmV0IG5pYyBvcmcgdGVzdCB3ZWIgJywKICAgICAgJ3RuJzonIGFncmluZXQgY29tIGRlZmVuc2UgZWR1bmV0IGVucyBmaW4gZ292IGluZCBpbmZvIGludGwgbWluY29tIG5hdCBuZXQgb3JnIHBlcnNvIHJucnQgcm5zIHJudSB0b3VyaXNtICcsCiAgICAgICd0eic6JyBhYyBjbyBnbyBuZSBvciAnLAogICAgICAndWEnOicgYml6IGNoZXJrYXNzeSBjaGVybmlnb3YgY2hlcm5vdnRzeSBjayBjbiBjbyBjb20gY3JpbWVhIGN2IGRuIGRuZXByb3BldHJvdnNrIGRvbmV0c2sgZHAgZWR1IGdvdiBpZiBpbiBpdmFuby1mcmFua2l2c2sga2gga2hhcmtvdiBraGVyc29uIGtobWVsbml0c2tpeSBraWV2IGtpcm92b2dyYWQga20ga3Iga3Mga3YgbGcgbHVnYW5zayBsdXRzayBsdml2IG1lIG1rIG5ldCBuaWtvbGFldiBvZCBvZGVzc2Egb3JnIHBsIHBvbHRhdmEgcHAgcm92bm8gcnYgc2ViYXN0b3BvbCBzdW15IHRlIHRlcm5vcGlsIHV6aGdvcm9kIHZpbm5pY2Egdm4gemFwb3Jpemh6aGUgemhpdG9taXIgenAgenQgJywKICAgICAgJ3VnJzonIGFjIGNvIGdvIG5lIG9yIG9yZyBzYyAnLAogICAgICAndWsnOicgYWMgYmwgYnJpdGlzaC1saWJyYXJ5IGNvIGN5bSBnb3YgZ292dCBpY25ldCBqZXQgbGVhIGx0ZCBtZSBtaWwgbW9kIG5hdGlvbmFsLWxpYnJhcnktc2NvdGxhbmQgbmVsIG5ldCBuaHMgbmljIG5scyBvcmcgb3JnbiBwYXJsaWFtZW50IHBsYyBwb2xpY2Ugc2NoIHNjb3Qgc29jICcsCiAgICAgICd1cyc6JyBkbmkgZmVkIGlzYSBraWRzIG5zbiAnLAogICAgICAndXknOicgY29tIGVkdSBndWIgbWlsIG5ldCBvcmcgJywKICAgICAgJ3ZlJzonIGNvIGNvbSBlZHUgZ29iIGluZm8gbWlsIG5ldCBvcmcgd2ViICcsCiAgICAgICd2aSc6JyBjbyBjb20gazEyIG5ldCBvcmcgJywKICAgICAgJ3ZuJzonIGFjIGJpeiBjb20gZWR1IGdvdiBoZWFsdGggaW5mbyBpbnQgbmFtZSBuZXQgb3JnIHBybyAnLAogICAgICAneWUnOicgY28gY29tIGdvdiBsdGQgbWUgbmV0IG9yZyBwbGMgJywKICAgICAgJ3l1JzonIGFjIGNvIGVkdSBnb3Ygb3JnICcsCiAgICAgICd6YSc6JyBhYyBhZ3JpYyBhbHQgYm91cnNlIGNpdHkgY28gY3liZXJuZXQgZGIgZWR1IGdvdiBncm9uZGFyIGlhY2Nlc3MgaW10IGluY2EgbGFuZGVzaWduIGxhdyBtaWwgbmV0IG5nbyBuaXMgbm9tIG9saXZldHRpIG9yZyBwaXggc2Nob29sIHRtIHdlYiAnLAogICAgICAnem0nOicgYWMgY28gY29tIGVkdSBnb3YgbmV0IG9yZyBzY2ggJwogICAgfSwKICAgIC8vIGdvcmhpbGwgMjAxMy0xMC0yNTogVXNpbmcgaW5kZXhPZigpIGluc3RlYWQgUmVnZXhwKCkuIFNpZ25pZmljYW50IGJvb3N0CiAgICAvLyBpbiBib3RoIHBlcmZvcm1hbmNlIGFuZCBtZW1vcnkgZm9vdHByaW50LiBObyBpbml0aWFsaXphdGlvbiByZXF1aXJlZC4KICAgIC8vIGh0dHA6Ly9qc3BlcmYuY29tL3VyaS1qcy1zbGQtcmVnZXgtdnMtYmluYXJ5LXNlYXJjaC80CiAgICAvLyBGb2xsb3dpbmcgbWV0aG9kcyB1c2UgbGFzdEluZGV4T2YoKSByYXRoZXIgdGhhbiBhcnJheS5zcGxpdCgpIGluIG9yZGVyCiAgICAvLyB0byBhdm9pZCBhbnkgbWVtb3J5IGFsbG9jYXRpb25zLgogICAgaGFzOiBmdW5jdGlvbihkb21haW4pIHsKICAgICAgdmFyIHRsZE9mZnNldCA9IGRvbWFpbi5sYXN0SW5kZXhPZignLicpOwogICAgICBpZiAodGxkT2Zmc2V0IDw9IDAgfHwgdGxkT2Zmc2V0ID49IChkb21haW4ubGVuZ3RoLTEpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciBzbGRPZmZzZXQgPSBkb21haW4ubGFzdEluZGV4T2YoJy4nLCB0bGRPZmZzZXQtMSk7CiAgICAgIGlmIChzbGRPZmZzZXQgPD0gMCB8fCBzbGRPZmZzZXQgPj0gKHRsZE9mZnNldC0xKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB2YXIgc2xkTGlzdCA9IFNMRC5saXN0W2RvbWFpbi5zbGljZSh0bGRPZmZzZXQrMSldOwogICAgICBpZiAoIXNsZExpc3QpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHNsZExpc3QuaW5kZXhPZignICcgKyBkb21haW4uc2xpY2Uoc2xkT2Zmc2V0KzEsIHRsZE9mZnNldCkgKyAnICcpID49IDA7CiAgICB9LAogICAgaXM6IGZ1bmN0aW9uKGRvbWFpbikgewogICAgICB2YXIgdGxkT2Zmc2V0ID0gZG9tYWluLmxhc3RJbmRleE9mKCcuJyk7CiAgICAgIGlmICh0bGRPZmZzZXQgPD0gMCB8fCB0bGRPZmZzZXQgPj0gKGRvbWFpbi5sZW5ndGgtMSkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgdmFyIHNsZE9mZnNldCA9IGRvbWFpbi5sYXN0SW5kZXhPZignLicsIHRsZE9mZnNldC0xKTsKICAgICAgaWYgKHNsZE9mZnNldCA+PSAwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciBzbGRMaXN0ID0gU0xELmxpc3RbZG9tYWluLnNsaWNlKHRsZE9mZnNldCsxKV07CiAgICAgIGlmICghc2xkTGlzdCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gc2xkTGlzdC5pbmRleE9mKCcgJyArIGRvbWFpbi5zbGljZSgwLCB0bGRPZmZzZXQpICsgJyAnKSA+PSAwOwogICAgfSwKICAgIGdldDogZnVuY3Rpb24oZG9tYWluKSB7CiAgICAgIHZhciB0bGRPZmZzZXQgPSBkb21haW4ubGFzdEluZGV4T2YoJy4nKTsKICAgICAgaWYgKHRsZE9mZnNldCA8PSAwIHx8IHRsZE9mZnNldCA+PSAoZG9tYWluLmxlbmd0aC0xKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHZhciBzbGRPZmZzZXQgPSBkb21haW4ubGFzdEluZGV4T2YoJy4nLCB0bGRPZmZzZXQtMSk7CiAgICAgIGlmIChzbGRPZmZzZXQgPD0gMCB8fCBzbGRPZmZzZXQgPj0gKHRsZE9mZnNldC0xKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHZhciBzbGRMaXN0ID0gU0xELmxpc3RbZG9tYWluLnNsaWNlKHRsZE9mZnNldCsxKV07CiAgICAgIGlmICghc2xkTGlzdCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGlmIChzbGRMaXN0LmluZGV4T2YoJyAnICsgZG9tYWluLnNsaWNlKHNsZE9mZnNldCsxLCB0bGRPZmZzZXQpICsgJyAnKSA8IDApIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICByZXR1cm4gZG9tYWluLnNsaWNlKHNsZE9mZnNldCsxKTsKICAgIH0sCiAgICBub0NvbmZsaWN0OiBmdW5jdGlvbigpewogICAgICBpZiAocm9vdC5TZWNvbmRMZXZlbERvbWFpbnMgPT09IHRoaXMpIHsKICAgICAgICByb290LlNlY29uZExldmVsRG9tYWlucyA9IF9TZWNvbmRMZXZlbERvbWFpbnM7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKCiAgcmV0dXJuIFNMRDsKfSkpOwoKfSx7fV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qIQogKiBVUkkuanMgLSBNdXRhdGluZyBVUkxzCiAqCiAqIFZlcnNpb246IDEuMTguMAogKgogKiBBdXRob3I6IFJvZG5leSBSZWhtCiAqIFdlYjogaHR0cDovL21lZGlhbGl6ZS5naXRodWIuaW8vVVJJLmpzLwogKgogKiBMaWNlbnNlZCB1bmRlcgogKiAgIE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UKICoKICovCihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkgewogICd1c2Ugc3RyaWN0JzsKICAvLyBodHRwczovL2dpdGh1Yi5jb20vdW1kanMvdW1kL2Jsb2IvbWFzdGVyL3JldHVybkV4cG9ydHMuanMKICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7CiAgICAvLyBOb2RlCiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgnLi9wdW55Y29kZScpLCByZXF1aXJlKCcuL0lQdjYnKSwgcmVxdWlyZSgnLi9TZWNvbmRMZXZlbERvbWFpbnMnKSk7CiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsKICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS4KICAgIGRlZmluZShbJy4vcHVueWNvZGUnLCAnLi9JUHY2JywgJy4vU2Vjb25kTGV2ZWxEb21haW5zJ10sIGZhY3RvcnkpOwogIH0gZWxzZSB7CiAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KQogICAgcm9vdC5VUkkgPSBmYWN0b3J5KHJvb3QucHVueWNvZGUsIHJvb3QuSVB2Niwgcm9vdC5TZWNvbmRMZXZlbERvbWFpbnMsIHJvb3QpOwogIH0KfSh0aGlzLCBmdW5jdGlvbiAocHVueWNvZGUsIElQdjYsIFNMRCwgcm9vdCkgewogICd1c2Ugc3RyaWN0JzsKICAvKmdsb2JhbCBsb2NhdGlvbiwgZXNjYXBlLCB1bmVzY2FwZSAqLwogIC8vIEZJWE1FOiB2Mi4wLjAgcmVuYW1jZSBub24tY2FtZWxDYXNlIHByb3BlcnRpZXMgdG8gdXBwZXJjYXNlCiAgLypqc2hpbnQgY2FtZWxjYXNlOiBmYWxzZSAqLwoKICAvLyBzYXZlIGN1cnJlbnQgVVJJIHZhcmlhYmxlLCBpZiBhbnkKICB2YXIgX1VSSSA9IHJvb3QgJiYgcm9vdC5VUkk7CgogIGZ1bmN0aW9uIFVSSSh1cmwsIGJhc2UpIHsKICAgIHZhciBfdXJsU3VwcGxpZWQgPSBhcmd1bWVudHMubGVuZ3RoID49IDE7CiAgICB2YXIgX2Jhc2VTdXBwbGllZCA9IGFyZ3VtZW50cy5sZW5ndGggPj0gMjsKCiAgICAvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgdGhlICduZXcnIGtleXdvcmQKICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBVUkkpKSB7CiAgICAgIGlmIChfdXJsU3VwcGxpZWQpIHsKICAgICAgICBpZiAoX2Jhc2VTdXBwbGllZCkgewogICAgICAgICAgcmV0dXJuIG5ldyBVUkkodXJsLCBiYXNlKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBuZXcgVVJJKHVybCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgVVJJKCk7CiAgICB9CgogICAgaWYgKHVybCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmIChfdXJsU3VwcGxpZWQpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCd1bmRlZmluZWQgaXMgbm90IGEgdmFsaWQgYXJndW1lbnQgZm9yIFVSSScpOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIGxvY2F0aW9uICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIHVybCA9IGxvY2F0aW9uLmhyZWYgKyAnJzsKICAgICAgfSBlbHNlIHsKICAgICAgICB1cmwgPSAnJzsKICAgICAgfQogICAgfQoKICAgIHRoaXMuaHJlZih1cmwpOwoKICAgIC8vIHJlc29sdmUgdG8gYmFzZSBhY2NvcmRpbmcgdG8gaHR0cDovL2R2Y3MudzMub3JnL2hnL3VybC9yYXctZmlsZS90aXAvT3ZlcnZpZXcuaHRtbCNjb25zdHJ1Y3RvcgogICAgaWYgKGJhc2UgIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdGhpcy5hYnNvbHV0ZVRvKGJhc2UpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0KCiAgVVJJLnZlcnNpb24gPSAnMS4xOC4wJzsKCiAgdmFyIHAgPSBVUkkucHJvdG90eXBlOwogIHZhciBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5OwoKICBmdW5jdGlvbiBlc2NhcGVSZWdFeChzdHJpbmcpIHsKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL2NvbW1pdC84NWFjMjE3ODNjMTFmOGNjYWIwNjEwNmRiYTk3MzVhMzFhODY5MjRkI2NvbW1pdGNvbW1lbnQtODIxOTYzCiAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoLyhbLiorP149IToke30oKXxbXF1cL1xcXSkvZywgJ1xcJDEnKTsKICB9CgogIGZ1bmN0aW9uIGdldFR5cGUodmFsdWUpIHsKICAgIC8vIElFOCBkb2Vzbid0IHJldHVybiBbT2JqZWN0IFVuZGVmaW5lZF0gYnV0IFtPYmplY3QgT2JqZWN0XSBmb3IgdW5kZWZpbmVkIHZhbHVlCiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gJ1VuZGVmaW5lZCc7CiAgICB9CgogICAgcmV0dXJuIFN0cmluZyhPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpKS5zbGljZSg4LCAtMSk7CiAgfQoKICBmdW5jdGlvbiBpc0FycmF5KG9iaikgewogICAgcmV0dXJuIGdldFR5cGUob2JqKSA9PT0gJ0FycmF5JzsKICB9CgogIGZ1bmN0aW9uIGZpbHRlckFycmF5VmFsdWVzKGRhdGEsIHZhbHVlKSB7CiAgICB2YXIgbG9va3VwID0ge307CiAgICB2YXIgaSwgbGVuZ3RoOwoKICAgIGlmIChnZXRUeXBlKHZhbHVlKSA9PT0gJ1JlZ0V4cCcpIHsKICAgICAgbG9va3VwID0gbnVsbDsKICAgIH0gZWxzZSBpZiAoaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICBsb29rdXBbdmFsdWVbaV1dID0gdHJ1ZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbG9va3VwW3ZhbHVlXSA9IHRydWU7CiAgICB9CgogICAgZm9yIChpID0gMCwgbGVuZ3RoID0gZGF0YS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAvKmpzaGludCBsYXhicmVhazogdHJ1ZSAqLwogICAgICB2YXIgX21hdGNoID0gbG9va3VwICYmIGxvb2t1cFtkYXRhW2ldXSAhPT0gdW5kZWZpbmVkCiAgICAgICAgfHwgIWxvb2t1cCAmJiB2YWx1ZS50ZXN0KGRhdGFbaV0pOwogICAgICAvKmpzaGludCBsYXhicmVhazogZmFsc2UgKi8KICAgICAgaWYgKF9tYXRjaCkgewogICAgICAgIGRhdGEuc3BsaWNlKGksIDEpOwogICAgICAgIGxlbmd0aC0tOwogICAgICAgIGktLTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBkYXRhOwogIH0KCiAgZnVuY3Rpb24gYXJyYXlDb250YWlucyhsaXN0LCB2YWx1ZSkgewogICAgdmFyIGksIGxlbmd0aDsKCiAgICAvLyB2YWx1ZSBtYXkgYmUgc3RyaW5nLCBudW1iZXIsIGFycmF5LCByZWdleHAKICAgIGlmIChpc0FycmF5KHZhbHVlKSkgewogICAgICAvLyBOb3RlOiB0aGlzIGNhbiBiZSBvcHRpbWl6ZWQgdG8gTyhuKSAoaW5zdGVhZCBvZiBjdXJyZW50IE8obSAqIG4pKQogICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSB2YWx1ZS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGlmICghYXJyYXlDb250YWlucyhsaXN0LCB2YWx1ZVtpXSkpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHZhciBfdHlwZSA9IGdldFR5cGUodmFsdWUpOwogICAgZm9yIChpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICBpZiAoX3R5cGUgPT09ICdSZWdFeHAnKSB7CiAgICAgICAgaWYgKHR5cGVvZiBsaXN0W2ldID09PSAnc3RyaW5nJyAmJiBsaXN0W2ldLm1hdGNoKHZhbHVlKSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGxpc3RbaV0gPT09IHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBhcnJheXNFcXVhbChvbmUsIHR3bykgewogICAgaWYgKCFpc0FycmF5KG9uZSkgfHwgIWlzQXJyYXkodHdvKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8gYXJyYXlzIGNhbid0IGJlIGVxdWFsIGlmIHRoZXkgaGF2ZSBkaWZmZXJlbnQgYW1vdW50IG9mIGNvbnRlbnQKICAgIGlmIChvbmUubGVuZ3RoICE9PSB0d28ubGVuZ3RoKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBvbmUuc29ydCgpOwogICAgdHdvLnNvcnQoKTsKCiAgICBmb3IgKHZhciBpID0gMCwgbCA9IG9uZS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgaWYgKG9uZVtpXSAhPT0gdHdvW2ldKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiB0cmltU2xhc2hlcyh0ZXh0KSB7CiAgICB2YXIgdHJpbV9leHByZXNzaW9uID0gL15cLyt8XC8rJC9nOwogICAgcmV0dXJuIHRleHQucmVwbGFjZSh0cmltX2V4cHJlc3Npb24sICcnKTsKICB9CgogIFVSSS5fcGFydHMgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIHByb3RvY29sOiBudWxsLAogICAgICB1c2VybmFtZTogbnVsbCwKICAgICAgcGFzc3dvcmQ6IG51bGwsCiAgICAgIGhvc3RuYW1lOiBudWxsLAogICAgICB1cm46IG51bGwsCiAgICAgIHBvcnQ6IG51bGwsCiAgICAgIHBhdGg6IG51bGwsCiAgICAgIHF1ZXJ5OiBudWxsLAogICAgICBmcmFnbWVudDogbnVsbCwKICAgICAgLy8gc3RhdGUKICAgICAgZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzOiBVUkkuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLAogICAgICBlc2NhcGVRdWVyeVNwYWNlOiBVUkkuZXNjYXBlUXVlcnlTcGFjZQogICAgfTsKICB9OwogIC8vIHN0YXRlOiBhbGxvdyBkdXBsaWNhdGUgcXVlcnkgcGFyYW1ldGVycyAoYT0xJmE9MSkKICBVUkkuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzID0gZmFsc2U7CiAgLy8gc3RhdGU6IHJlcGxhY2VzICsgd2l0aCAlMjAgKHNwYWNlIGluIHF1ZXJ5IHN0cmluZ3MpCiAgVVJJLmVzY2FwZVF1ZXJ5U3BhY2UgPSB0cnVlOwogIC8vIHN0YXRpYyBwcm9wZXJ0aWVzCiAgVVJJLnByb3RvY29sX2V4cHJlc3Npb24gPSAvXlthLXpdW2EtejAtOS4rLV0qJC9pOwogIFVSSS5pZG5fZXhwcmVzc2lvbiA9IC9bXmEtejAtOVwuLV0vaTsKICBVUkkucHVueWNvZGVfZXhwcmVzc2lvbiA9IC8oeG4tLSkvaTsKICAvLyB3ZWxsLCAzMzMuNDQ0LjU1NS42NjYgbWF0Y2hlcywgYnV0IGl0IHN1cmUgYWluJ3Qgbm8gSVB2NCAtIGRvIHdlIGNhcmU/CiAgVVJJLmlwNF9leHByZXNzaW9uID0gL15cZHsxLDN9XC5cZHsxLDN9XC5cZHsxLDN9XC5cZHsxLDN9JC87CiAgLy8gY3JlZGl0cyB0byBSaWNoIEJyb3duCiAgLy8gc291cmNlOiBodHRwOi8vZm9ydW1zLmludGVybWFwcGVyLmNvbS92aWV3dG9waWMucGhwP3A9MTA5NiMxMDk2CiAgLy8gc3BlY2lmaWNhdGlvbjogaHR0cDovL3d3dy5pZXRmLm9yZy9yZmMvcmZjNDI5MS50eHQKICBVUkkuaXA2X2V4cHJlc3Npb24gPSAvXlxzKigoKFswLTlBLUZhLWZdezEsNH06KXs3fShbMC05QS1GYS1mXXsxLDR9fDopKXwoKFswLTlBLUZhLWZdezEsNH06KXs2fSg6WzAtOUEtRmEtZl17MSw0fXwoKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKFwuKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKXszfSl8OikpfCgoWzAtOUEtRmEtZl17MSw0fTopezV9KCgoOlswLTlBLUZhLWZdezEsNH0pezEsMn0pfDooKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKFwuKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKXszfSl8OikpfCgoWzAtOUEtRmEtZl17MSw0fTopezR9KCgoOlswLTlBLUZhLWZdezEsNH0pezEsM30pfCgoOlswLTlBLUZhLWZdezEsNH0pPzooKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKFwuKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKXszfSkpfDopKXwoKFswLTlBLUZhLWZdezEsNH06KXszfSgoKDpbMC05QS1GYS1mXXsxLDR9KXsxLDR9KXwoKDpbMC05QS1GYS1mXXsxLDR9KXswLDJ9OigoMjVbMC01XXwyWzAtNF1cZHwxXGRcZHxbMS05XT9cZCkoXC4oMjVbMC01XXwyWzAtNF1cZHwxXGRcZHxbMS05XT9cZCkpezN9KSl8OikpfCgoWzAtOUEtRmEtZl17MSw0fTopezJ9KCgoOlswLTlBLUZhLWZdezEsNH0pezEsNX0pfCgoOlswLTlBLUZhLWZdezEsNH0pezAsM306KCgyNVswLTVdfDJbMC00XVxkfDFcZFxkfFsxLTldP1xkKShcLigyNVswLTVdfDJbMC00XVxkfDFcZFxkfFsxLTldP1xkKSl7M30pKXw6KSl8KChbMC05QS1GYS1mXXsxLDR9Oil7MX0oKCg6WzAtOUEtRmEtZl17MSw0fSl7MSw2fSl8KCg6WzAtOUEtRmEtZl17MSw0fSl7MCw0fTooKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKFwuKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKXszfSkpfDopKXwoOigoKDpbMC05QS1GYS1mXXsxLDR9KXsxLDd9KXwoKDpbMC05QS1GYS1mXXsxLDR9KXswLDV9OigoMjVbMC01XXwyWzAtNF1cZHwxXGRcZHxbMS05XT9cZCkoXC4oMjVbMC01XXwyWzAtNF1cZHwxXGRcZHxbMS05XT9cZCkpezN9KSl8OikpKSglLispP1xzKiQvOwogIC8vIGV4cHJlc3Npb24gdXNlZCBpcyAiZ3J1YmVyIHJldmlzZWQiIChAZ3J1YmVyIHYyKSBkZXRlcm1pbmVkIHRvIGJlIHRoZQogIC8vIGJlc3Qgc29sdXRpb24gaW4gYSByZWdleC1nb2xmIHdlIGRpZCBhIGNvdXBsZSBvZiBhZ2VzIGFnbyBhdAogIC8vICogaHR0cDovL21hdGhpYXNieW5lbnMuYmUvZGVtby91cmwtcmVnZXgKICAvLyAqIGh0dHA6Ly9yb2RuZXlyZWhtLmRlL3QvdXJsLXJlZ2V4Lmh0bWwKICBVUkkuZmluZF91cmlfZXhwcmVzc2lvbiA9IC9cYigoPzpbYS16XVtcdy1dKzooPzpcL3sxLDN9fFthLXowLTklXSl8d3d3XGR7MCwzfVsuXXxbYS16MC05LlwtXStbLl1bYS16XXsyLDR9XC8pKD86W15ccygpPD5dK3xcKChbXlxzKCk8Pl0rfChcKFteXHMoKTw+XStcKSkpKlwpKSsoPzpcKChbXlxzKCk8Pl0rfChcKFteXHMoKTw+XStcKSkpKlwpfFteXHNgISgpXFtcXXt9OzonIi4sPD4/wqvCu+KAnOKAneKAmOKAmV0pKS9pZzsKICBVUkkuZmluZFVyaSA9IHsKICAgIC8vIHZhbGlkICJzY2hlbWU6Ly8iIG9yICJ3d3cuIgogICAgc3RhcnQ6IC9cYig/OihbYS16XVthLXowLTkuKy1dKjpcL1wvKXx3d3dcLikvZ2ksCiAgICAvLyBldmVyeXRoaW5nIHVwIHRvIHRoZSBuZXh0IHdoaXRlc3BhY2UKICAgIGVuZDogL1tcc1xyXG5dfCQvLAogICAgLy8gdHJpbSB0cmFpbGluZyBwdW5jdHVhdGlvbiBjYXB0dXJlZCBieSBlbmQgUmVnRXhwCiAgICB0cmltOiAvW2AhKClcW1xde307OiciLiw8Pj/Cq8K74oCc4oCd4oCe4oCY4oCZXSskLwogIH07CiAgLy8gaHR0cDovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy91cmktc2NoZW1lcy5odG1sCiAgLy8gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9MaXN0X29mX1RDUF9hbmRfVURQX3BvcnRfbnVtYmVycyNXZWxsLWtub3duX3BvcnRzCiAgVVJJLmRlZmF1bHRQb3J0cyA9IHsKICAgIGh0dHA6ICc4MCcsCiAgICBodHRwczogJzQ0MycsCiAgICBmdHA6ICcyMScsCiAgICBnb3BoZXI6ICc3MCcsCiAgICB3czogJzgwJywKICAgIHdzczogJzQ0MycKICB9OwogIC8vIGFsbG93ZWQgaG9zdG5hbWUgY2hhcmFjdGVycyBhY2NvcmRpbmcgdG8gUkZDIDM5ODYKICAvLyBBTFBIQSBESUdJVCAiLSIgIi4iICJfIiAifiIgIiEiICIkIiAiJiIgIiciICIoIiAiKSIgIioiICIrIiAiLCIgIjsiICI9IiAlZW5jb2RlZAogIC8vIEkndmUgbmV2ZXIgc2VlbiBhIChub24tSUROKSBob3N0bmFtZSBvdGhlciB0aGFuOiBBTFBIQSBESUdJVCAuIC0KICBVUkkuaW52YWxpZF9ob3N0bmFtZV9jaGFyYWN0ZXJzID0gL1teYS16QS1aMC05XC4tXS87CiAgLy8gbWFwIERPTSBFbGVtZW50cyB0byB0aGVpciBVUkkgYXR0cmlidXRlCiAgVVJJLmRvbUF0dHJpYnV0ZXMgPSB7CiAgICAnYSc6ICdocmVmJywKICAgICdibG9ja3F1b3RlJzogJ2NpdGUnLAogICAgJ2xpbmsnOiAnaHJlZicsCiAgICAnYmFzZSc6ICdocmVmJywKICAgICdzY3JpcHQnOiAnc3JjJywKICAgICdmb3JtJzogJ2FjdGlvbicsCiAgICAnaW1nJzogJ3NyYycsCiAgICAnYXJlYSc6ICdocmVmJywKICAgICdpZnJhbWUnOiAnc3JjJywKICAgICdlbWJlZCc6ICdzcmMnLAogICAgJ3NvdXJjZSc6ICdzcmMnLAogICAgJ3RyYWNrJzogJ3NyYycsCiAgICAnaW5wdXQnOiAnc3JjJywgLy8gYnV0IG9ubHkgaWYgdHlwZT0iaW1hZ2UiCiAgICAnYXVkaW8nOiAnc3JjJywKICAgICd2aWRlbyc6ICdzcmMnCiAgfTsKICBVUkkuZ2V0RG9tQXR0cmlidXRlID0gZnVuY3Rpb24obm9kZSkgewogICAgaWYgKCFub2RlIHx8ICFub2RlLm5vZGVOYW1lKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgdmFyIG5vZGVOYW1lID0gbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgLy8gPGlucHV0PiBzaG91bGQgb25seSBleHBvc2Ugc3JjIGZvciB0eXBlPSJpbWFnZSIKICAgIGlmIChub2RlTmFtZSA9PT0gJ2lucHV0JyAmJiBub2RlLnR5cGUgIT09ICdpbWFnZScpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICByZXR1cm4gVVJJLmRvbUF0dHJpYnV0ZXNbbm9kZU5hbWVdOwogIH07CgogIGZ1bmN0aW9uIGVzY2FwZUZvckR1bWJGaXJlZm94MzYodmFsdWUpIHsKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL2lzc3Vlcy85MQogICAgcmV0dXJuIGVzY2FwZSh2YWx1ZSk7CiAgfQoKICAvLyBlbmNvZGluZyAvIGRlY29kaW5nIGFjY29yZGluZyB0byBSRkMzOTg2CiAgZnVuY3Rpb24gc3RyaWN0RW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykgewogICAgLy8gc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvZW5jb2RlVVJJQ29tcG9uZW50CiAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykKICAgICAgLnJlcGxhY2UoL1shJygpKl0vZywgZXNjYXBlRm9yRHVtYkZpcmVmb3gzNikKICAgICAgLnJlcGxhY2UoL1wqL2csICclMkEnKTsKICB9CiAgVVJJLmVuY29kZSA9IHN0cmljdEVuY29kZVVSSUNvbXBvbmVudDsKICBVUkkuZGVjb2RlID0gZGVjb2RlVVJJQ29tcG9uZW50OwogIFVSSS5pc284ODU5ID0gZnVuY3Rpb24oKSB7CiAgICBVUkkuZW5jb2RlID0gZXNjYXBlOwogICAgVVJJLmRlY29kZSA9IHVuZXNjYXBlOwogIH07CiAgVVJJLnVuaWNvZGUgPSBmdW5jdGlvbigpIHsKICAgIFVSSS5lbmNvZGUgPSBzdHJpY3RFbmNvZGVVUklDb21wb25lbnQ7CiAgICBVUkkuZGVjb2RlID0gZGVjb2RlVVJJQ29tcG9uZW50OwogIH07CiAgVVJJLmNoYXJhY3RlcnMgPSB7CiAgICBwYXRobmFtZTogewogICAgICBlbmNvZGU6IHsKICAgICAgICAvLyBSRkMzOTg2IDIuMTogRm9yIGNvbnNpc3RlbmN5LCBVUkkgcHJvZHVjZXJzIGFuZCBub3JtYWxpemVycyBzaG91bGQKICAgICAgICAvLyB1c2UgdXBwZXJjYXNlIGhleGFkZWNpbWFsIGRpZ2l0cyBmb3IgYWxsIHBlcmNlbnQtZW5jb2RpbmdzLgogICAgICAgIGV4cHJlc3Npb246IC8lKDI0fDI2fDJCfDJDfDNCfDNEfDNBfDQwKS9pZywKICAgICAgICBtYXA6IHsKICAgICAgICAgIC8vIC0uX34hJygpKgogICAgICAgICAgJyUyNCc6ICckJywKICAgICAgICAgICclMjYnOiAnJicsCiAgICAgICAgICAnJTJCJzogJysnLAogICAgICAgICAgJyUyQyc6ICcsJywKICAgICAgICAgICclM0InOiAnOycsCiAgICAgICAgICAnJTNEJzogJz0nLAogICAgICAgICAgJyUzQSc6ICc6JywKICAgICAgICAgICclNDAnOiAnQCcKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlY29kZTogewogICAgICAgIGV4cHJlc3Npb246IC9bXC9cPyNdL2csCiAgICAgICAgbWFwOiB7CiAgICAgICAgICAnLyc6ICclMkYnLAogICAgICAgICAgJz8nOiAnJTNGJywKICAgICAgICAgICcjJzogJyUyMycKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICByZXNlcnZlZDogewogICAgICBlbmNvZGU6IHsKICAgICAgICAvLyBSRkMzOTg2IDIuMTogRm9yIGNvbnNpc3RlbmN5LCBVUkkgcHJvZHVjZXJzIGFuZCBub3JtYWxpemVycyBzaG91bGQKICAgICAgICAvLyB1c2UgdXBwZXJjYXNlIGhleGFkZWNpbWFsIGRpZ2l0cyBmb3IgYWxsIHBlcmNlbnQtZW5jb2RpbmdzLgogICAgICAgIGV4cHJlc3Npb246IC8lKDIxfDIzfDI0fDI2fDI3fDI4fDI5fDJBfDJCfDJDfDJGfDNBfDNCfDNEfDNGfDQwfDVCfDVEKS9pZywKICAgICAgICBtYXA6IHsKICAgICAgICAgIC8vIGdlbi1kZWxpbXMKICAgICAgICAgICclM0EnOiAnOicsCiAgICAgICAgICAnJTJGJzogJy8nLAogICAgICAgICAgJyUzRic6ICc/JywKICAgICAgICAgICclMjMnOiAnIycsCiAgICAgICAgICAnJTVCJzogJ1snLAogICAgICAgICAgJyU1RCc6ICddJywKICAgICAgICAgICclNDAnOiAnQCcsCiAgICAgICAgICAvLyBzdWItZGVsaW1zCiAgICAgICAgICAnJTIxJzogJyEnLAogICAgICAgICAgJyUyNCc6ICckJywKICAgICAgICAgICclMjYnOiAnJicsCiAgICAgICAgICAnJTI3JzogJ1wnJywKICAgICAgICAgICclMjgnOiAnKCcsCiAgICAgICAgICAnJTI5JzogJyknLAogICAgICAgICAgJyUyQSc6ICcqJywKICAgICAgICAgICclMkInOiAnKycsCiAgICAgICAgICAnJTJDJzogJywnLAogICAgICAgICAgJyUzQic6ICc7JywKICAgICAgICAgICclM0QnOiAnPScKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB1cm5wYXRoOiB7CiAgICAgIC8vIFRoZSBjaGFyYWN0ZXJzIHVuZGVyIGBlbmNvZGVgIGFyZSB0aGUgY2hhcmFjdGVycyBjYWxsZWQgb3V0IGJ5IFJGQyAyMTQxIGFzIGJlaW5nIGFjY2VwdGFibGUKICAgICAgLy8gZm9yIHVzYWdlIGluIGEgVVJOLiBSRkMyMTQxIGFsc28gY2FsbHMgb3V0ICItIiwgIi4iLCBhbmQgIl8iIGFzIGFjY2VwdGFibGUgY2hhcmFjdGVycywgYnV0CiAgICAgIC8vIHRoZXNlIGFyZW4ndCBlbmNvZGVkIGJ5IGVuY29kZVVSSUNvbXBvbmVudCwgc28gd2UgZG9uJ3QgaGF2ZSB0byBjYWxsIHRoZW0gb3V0IGhlcmUuIEFsc28KICAgICAgLy8gbm90ZSB0aGF0IHRoZSBjb2xvbiBjaGFyYWN0ZXIgaXMgbm90IGZlYXR1cmVkIGluIHRoZSBlbmNvZGluZyBtYXA7IHRoaXMgaXMgYmVjYXVzZSBVUkkuanMKICAgICAgLy8gZ2l2ZXMgdGhlIGNvbG9ucyBpbiBVUk5zIHNlbWFudGljIG1lYW5pbmcgYXMgdGhlIGRlbGltaXRlcnMgb2YgcGF0aCBzZWdlbWVudHMsIGFuZCBzbyBpdAogICAgICAvLyBzaG91bGQgbm90IGFwcGVhciB1bmVuY29kZWQgaW4gYSBzZWdtZW50IGl0c2VsZi4KICAgICAgLy8gU2VlIGFsc28gdGhlIG5vdGUgYWJvdmUgYWJvdXQgUkZDMzk4NiBhbmQgY2FwaXRhbGFsaXplZCBoZXggZGlnaXRzLgogICAgICBlbmNvZGU6IHsKICAgICAgICBleHByZXNzaW9uOiAvJSgyMXwyNHwyN3wyOHwyOXwyQXwyQnwyQ3wzQnwzRHw0MCkvaWcsCiAgICAgICAgbWFwOiB7CiAgICAgICAgICAnJTIxJzogJyEnLAogICAgICAgICAgJyUyNCc6ICckJywKICAgICAgICAgICclMjcnOiAnXCcnLAogICAgICAgICAgJyUyOCc6ICcoJywKICAgICAgICAgICclMjknOiAnKScsCiAgICAgICAgICAnJTJBJzogJyonLAogICAgICAgICAgJyUyQic6ICcrJywKICAgICAgICAgICclMkMnOiAnLCcsCiAgICAgICAgICAnJTNCJzogJzsnLAogICAgICAgICAgJyUzRCc6ICc9JywKICAgICAgICAgICclNDAnOiAnQCcKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIFRoZXNlIGNoYXJhY3RlcnMgYXJlIHRoZSBjaGFyYWN0ZXJzIGNhbGxlZCBvdXQgYnkgUkZDMjE0MSBhcyAicmVzZXJ2ZWQiIGNoYXJhY3RlcnMgdGhhdAogICAgICAvLyBzaG91bGQgbmV2ZXIgYXBwZWFyIGluIGEgVVJOLCBwbHVzIHRoZSBjb2xvbiBjaGFyYWN0ZXIgKHNlZSBub3RlIGFib3ZlKS4KICAgICAgZGVjb2RlOiB7CiAgICAgICAgZXhwcmVzc2lvbjogL1tcL1w/IzpdL2csCiAgICAgICAgbWFwOiB7CiAgICAgICAgICAnLyc6ICclMkYnLAogICAgICAgICAgJz8nOiAnJTNGJywKICAgICAgICAgICcjJzogJyUyMycsCiAgICAgICAgICAnOic6ICclM0EnCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfTsKICBVUkkuZW5jb2RlUXVlcnkgPSBmdW5jdGlvbihzdHJpbmcsIGVzY2FwZVF1ZXJ5U3BhY2UpIHsKICAgIHZhciBlc2NhcGVkID0gVVJJLmVuY29kZShzdHJpbmcgKyAnJyk7CiAgICBpZiAoZXNjYXBlUXVlcnlTcGFjZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGVzY2FwZVF1ZXJ5U3BhY2UgPSBVUkkuZXNjYXBlUXVlcnlTcGFjZTsKICAgIH0KCiAgICByZXR1cm4gZXNjYXBlUXVlcnlTcGFjZSA/IGVzY2FwZWQucmVwbGFjZSgvJTIwL2csICcrJykgOiBlc2NhcGVkOwogIH07CiAgVVJJLmRlY29kZVF1ZXJ5ID0gZnVuY3Rpb24oc3RyaW5nLCBlc2NhcGVRdWVyeVNwYWNlKSB7CiAgICBzdHJpbmcgKz0gJyc7CiAgICBpZiAoZXNjYXBlUXVlcnlTcGFjZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGVzY2FwZVF1ZXJ5U3BhY2UgPSBVUkkuZXNjYXBlUXVlcnlTcGFjZTsKICAgIH0KCiAgICB0cnkgewogICAgICByZXR1cm4gVVJJLmRlY29kZShlc2NhcGVRdWVyeVNwYWNlID8gc3RyaW5nLnJlcGxhY2UoL1wrL2csICclMjAnKSA6IHN0cmluZyk7CiAgICB9IGNhdGNoKGUpIHsKICAgICAgLy8gd2UncmUgbm90IGdvaW5nIHRvIG1lc3Mgd2l0aCB3ZWlyZCBlbmNvZGluZ3MsCiAgICAgIC8vIGdpdmUgdXAgYW5kIHJldHVybiB0aGUgdW5kZWNvZGVkIG9yaWdpbmFsIHN0cmluZwogICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL21lZGlhbGl6ZS9VUkkuanMvaXNzdWVzLzg3CiAgICAgIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vbWVkaWFsaXplL1VSSS5qcy9pc3N1ZXMvOTIKICAgICAgcmV0dXJuIHN0cmluZzsKICAgIH0KICB9OwogIC8vIGdlbmVyYXRlIGVuY29kZS9kZWNvZGUgcGF0aCBmdW5jdGlvbnMKICB2YXIgX3BhcnRzID0geydlbmNvZGUnOidlbmNvZGUnLCAnZGVjb2RlJzonZGVjb2RlJ307CiAgdmFyIF9wYXJ0OwogIHZhciBnZW5lcmF0ZUFjY2Vzc29yID0gZnVuY3Rpb24oX2dyb3VwLCBfcGFydCkgewogICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmluZykgewogICAgICB0cnkgewogICAgICAgIHJldHVybiBVUklbX3BhcnRdKHN0cmluZyArICcnKS5yZXBsYWNlKFVSSS5jaGFyYWN0ZXJzW19ncm91cF1bX3BhcnRdLmV4cHJlc3Npb24sIGZ1bmN0aW9uKGMpIHsKICAgICAgICAgIHJldHVybiBVUkkuY2hhcmFjdGVyc1tfZ3JvdXBdW19wYXJ0XS5tYXBbY107CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyB3ZSdyZSBub3QgZ29pbmcgdG8gbWVzcyB3aXRoIHdlaXJkIGVuY29kaW5ncywKICAgICAgICAvLyBnaXZlIHVwIGFuZCByZXR1cm4gdGhlIHVuZGVjb2RlZCBvcmlnaW5hbCBzdHJpbmcKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL21lZGlhbGl6ZS9VUkkuanMvaXNzdWVzLzg3CiAgICAgICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL2lzc3Vlcy85MgogICAgICAgIHJldHVybiBzdHJpbmc7CiAgICAgIH0KICAgIH07CiAgfTsKCiAgZm9yIChfcGFydCBpbiBfcGFydHMpIHsKICAgIFVSSVtfcGFydCArICdQYXRoU2VnbWVudCddID0gZ2VuZXJhdGVBY2Nlc3NvcigncGF0aG5hbWUnLCBfcGFydHNbX3BhcnRdKTsKICAgIFVSSVtfcGFydCArICdVcm5QYXRoU2VnbWVudCddID0gZ2VuZXJhdGVBY2Nlc3NvcigndXJucGF0aCcsIF9wYXJ0c1tfcGFydF0pOwogIH0KCiAgdmFyIGdlbmVyYXRlU2VnbWVudGVkUGF0aEZ1bmN0aW9uID0gZnVuY3Rpb24oX3NlcCwgX2NvZGluZ0Z1bmNOYW1lLCBfaW5uZXJDb2RpbmdGdW5jTmFtZSkgewogICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmluZykgewogICAgICAvLyBXaHkgcGFzcyBpbiBuYW1lcyBvZiBmdW5jdGlvbnMsIHJhdGhlciB0aGFuIHRoZSBmdW5jdGlvbiBvYmplY3RzIHRoZW1zZWx2ZXM/IFRoZQogICAgICAvLyBkZWZpbml0aW9ucyBvZiBzb21lIGZ1bmN0aW9ucyAoYnV0IGluIHBhcnRpY3VsYXIsIFVSSS5kZWNvZGUpIHdpbGwgb2NjYXNpb25hbGx5IGNoYW5nZSBkdWUKICAgICAgLy8gdG8gVVJJLmpzIGhhdmluZyBJU084ODU5IGFuZCBVbmljb2RlIG1vZGVzLiBQYXNzaW5nIGluIHRoZSBuYW1lIGFuZCBnZXR0aW5nIGl0IHdpbGwgZW5zdXJlCiAgICAgIC8vIHRoYXQgdGhlIGZ1bmN0aW9ucyB3ZSB1c2UgaGVyZSBhcmUgImZyZXNoIi4KICAgICAgdmFyIGFjdHVhbENvZGluZ0Z1bmM7CiAgICAgIGlmICghX2lubmVyQ29kaW5nRnVuY05hbWUpIHsKICAgICAgICBhY3R1YWxDb2RpbmdGdW5jID0gVVJJW19jb2RpbmdGdW5jTmFtZV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWN0dWFsQ29kaW5nRnVuYyA9IGZ1bmN0aW9uKHN0cmluZykgewogICAgICAgICAgcmV0dXJuIFVSSVtfY29kaW5nRnVuY05hbWVdKFVSSVtfaW5uZXJDb2RpbmdGdW5jTmFtZV0oc3RyaW5nKSk7CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgdmFyIHNlZ21lbnRzID0gKHN0cmluZyArICcnKS5zcGxpdChfc2VwKTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBzZWdtZW50cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIHNlZ21lbnRzW2ldID0gYWN0dWFsQ29kaW5nRnVuYyhzZWdtZW50c1tpXSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBzZWdtZW50cy5qb2luKF9zZXApOwogICAgfTsKICB9OwoKICAvLyBUaGlzIHRha2VzIHBsYWNlIG91dHNpZGUgdGhlIGFib3ZlIGxvb3AgYmVjYXVzZSB3ZSBkb24ndCB3YW50LCBlLmcuLCBlbmNvZGVVcm5QYXRoIGZ1bmN0aW9ucy4KICBVUkkuZGVjb2RlUGF0aCA9IGdlbmVyYXRlU2VnbWVudGVkUGF0aEZ1bmN0aW9uKCcvJywgJ2RlY29kZVBhdGhTZWdtZW50Jyk7CiAgVVJJLmRlY29kZVVyblBhdGggPSBnZW5lcmF0ZVNlZ21lbnRlZFBhdGhGdW5jdGlvbignOicsICdkZWNvZGVVcm5QYXRoU2VnbWVudCcpOwogIFVSSS5yZWNvZGVQYXRoID0gZ2VuZXJhdGVTZWdtZW50ZWRQYXRoRnVuY3Rpb24oJy8nLCAnZW5jb2RlUGF0aFNlZ21lbnQnLCAnZGVjb2RlJyk7CiAgVVJJLnJlY29kZVVyblBhdGggPSBnZW5lcmF0ZVNlZ21lbnRlZFBhdGhGdW5jdGlvbignOicsICdlbmNvZGVVcm5QYXRoU2VnbWVudCcsICdkZWNvZGUnKTsKCiAgVVJJLmVuY29kZVJlc2VydmVkID0gZ2VuZXJhdGVBY2Nlc3NvcigncmVzZXJ2ZWQnLCAnZW5jb2RlJyk7CgogIFVSSS5wYXJzZSA9IGZ1bmN0aW9uKHN0cmluZywgcGFydHMpIHsKICAgIHZhciBwb3M7CiAgICBpZiAoIXBhcnRzKSB7CiAgICAgIHBhcnRzID0ge307CiAgICB9CiAgICAvLyBbcHJvdG9jb2wiOi8vIlt1c2VybmFtZVsiOiJwYXNzd29yZF0iQCJdaG9zdG5hbWVbIjoicG9ydF0iLyI/XVtwYXRoXVsiPyJxdWVyeXN0cmluZ11bIiMiZnJhZ21lbnRdCgogICAgLy8gZXh0cmFjdCBmcmFnbWVudAogICAgcG9zID0gc3RyaW5nLmluZGV4T2YoJyMnKTsKICAgIGlmIChwb3MgPiAtMSkgewogICAgICAvLyBlc2NhcGluZz8KICAgICAgcGFydHMuZnJhZ21lbnQgPSBzdHJpbmcuc3Vic3RyaW5nKHBvcyArIDEpIHx8IG51bGw7CiAgICAgIHN0cmluZyA9IHN0cmluZy5zdWJzdHJpbmcoMCwgcG9zKTsKICAgIH0KCiAgICAvLyBleHRyYWN0IHF1ZXJ5CiAgICBwb3MgPSBzdHJpbmcuaW5kZXhPZignPycpOwogICAgaWYgKHBvcyA+IC0xKSB7CiAgICAgIC8vIGVzY2FwaW5nPwogICAgICBwYXJ0cy5xdWVyeSA9IHN0cmluZy5zdWJzdHJpbmcocG9zICsgMSkgfHwgbnVsbDsKICAgICAgc3RyaW5nID0gc3RyaW5nLnN1YnN0cmluZygwLCBwb3MpOwogICAgfQoKICAgIC8vIGV4dHJhY3QgcHJvdG9jb2wKICAgIGlmIChzdHJpbmcuc3Vic3RyaW5nKDAsIDIpID09PSAnLy8nKSB7CiAgICAgIC8vIHJlbGF0aXZlLXNjaGVtZQogICAgICBwYXJ0cy5wcm90b2NvbCA9IG51bGw7CiAgICAgIHN0cmluZyA9IHN0cmluZy5zdWJzdHJpbmcoMik7CiAgICAgIC8vIGV4dHJhY3QgInVzZXI6cGFzc0Bob3N0OnBvcnQiCiAgICAgIHN0cmluZyA9IFVSSS5wYXJzZUF1dGhvcml0eShzdHJpbmcsIHBhcnRzKTsKICAgIH0gZWxzZSB7CiAgICAgIHBvcyA9IHN0cmluZy5pbmRleE9mKCc6Jyk7CiAgICAgIGlmIChwb3MgPiAtMSkgewogICAgICAgIHBhcnRzLnByb3RvY29sID0gc3RyaW5nLnN1YnN0cmluZygwLCBwb3MpIHx8IG51bGw7CiAgICAgICAgaWYgKHBhcnRzLnByb3RvY29sICYmICFwYXJ0cy5wcm90b2NvbC5tYXRjaChVUkkucHJvdG9jb2xfZXhwcmVzc2lvbikpIHsKICAgICAgICAgIC8vIDogbWF5IGJlIHdpdGhpbiB0aGUgcGF0aAogICAgICAgICAgcGFydHMucHJvdG9jb2wgPSB1bmRlZmluZWQ7CiAgICAgICAgfSBlbHNlIGlmIChzdHJpbmcuc3Vic3RyaW5nKHBvcyArIDEsIHBvcyArIDMpID09PSAnLy8nKSB7CiAgICAgICAgICBzdHJpbmcgPSBzdHJpbmcuc3Vic3RyaW5nKHBvcyArIDMpOwoKICAgICAgICAgIC8vIGV4dHJhY3QgInVzZXI6cGFzc0Bob3N0OnBvcnQiCiAgICAgICAgICBzdHJpbmcgPSBVUkkucGFyc2VBdXRob3JpdHkoc3RyaW5nLCBwYXJ0cyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0cmluZyA9IHN0cmluZy5zdWJzdHJpbmcocG9zICsgMSk7CiAgICAgICAgICBwYXJ0cy51cm4gPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC8vIHdoYXQncyBsZWZ0IG11c3QgYmUgdGhlIHBhdGgKICAgIHBhcnRzLnBhdGggPSBzdHJpbmc7CgogICAgLy8gYW5kIHdlJ3JlIGRvbmUKICAgIHJldHVybiBwYXJ0czsKICB9OwogIFVSSS5wYXJzZUhvc3QgPSBmdW5jdGlvbihzdHJpbmcsIHBhcnRzKSB7CiAgICAvLyBDb3B5IGNocm9tZSwgSUUsIG9wZXJhIGJhY2tzbGFzaC1oYW5kbGluZyBiZWhhdmlvci4KICAgIC8vIEJhY2sgc2xhc2hlcyBiZWZvcmUgdGhlIHF1ZXJ5IHN0cmluZyBnZXQgY29udmVydGVkIHRvIGZvcndhcmQgc2xhc2hlcwogICAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vam95ZW50L25vZGUvYmxvYi8zODZmZDI0ZjQ5YjBlOWQxYThhMDc2NTkyYTQwNDE2OGZhZWVjYzM0L2xpYi91cmwuanMjTDExNS1MMTI0CiAgICAvLyBTZWU6IGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yNTkxNgogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL21lZGlhbGl6ZS9VUkkuanMvcHVsbC8yMzMKICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cXC9nLCAnLycpOwoKICAgIC8vIGV4dHJhY3QgaG9zdDpwb3J0CiAgICB2YXIgcG9zID0gc3RyaW5nLmluZGV4T2YoJy8nKTsKICAgIHZhciBicmFja2V0UG9zOwogICAgdmFyIHQ7CgogICAgaWYgKHBvcyA9PT0gLTEpIHsKICAgICAgcG9zID0gc3RyaW5nLmxlbmd0aDsKICAgIH0KCiAgICBpZiAoc3RyaW5nLmNoYXJBdCgwKSA9PT0gJ1snKSB7CiAgICAgIC8vIElQdjYgaG9zdCAtIGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL2RyYWZ0LWlldGYtNm1hbi10ZXh0LWFkZHItcmVwcmVzZW50YXRpb24tMDQjc2VjdGlvbi02CiAgICAgIC8vIEkgY2xhaW0gbW9zdCBjbGllbnQgc29mdHdhcmUgYnJlYWtzIG9uIElQdjYgYW55d2F5cy4gVG8gc2ltcGxpZnkgdGhpbmdzLCBVUkkgb25seSBhY2NlcHRzCiAgICAgIC8vIElQdjYrcG9ydCBpbiB0aGUgZm9ybWF0IFsyMDAxOmRiODo6MV06ODAgKGZvciB0aGUgdGltZSBiZWluZykKICAgICAgYnJhY2tldFBvcyA9IHN0cmluZy5pbmRleE9mKCddJyk7CiAgICAgIHBhcnRzLmhvc3RuYW1lID0gc3RyaW5nLnN1YnN0cmluZygxLCBicmFja2V0UG9zKSB8fCBudWxsOwogICAgICBwYXJ0cy5wb3J0ID0gc3RyaW5nLnN1YnN0cmluZyhicmFja2V0UG9zICsgMiwgcG9zKSB8fCBudWxsOwogICAgICBpZiAocGFydHMucG9ydCA9PT0gJy8nKSB7CiAgICAgICAgcGFydHMucG9ydCA9IG51bGw7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHZhciBmaXJzdENvbG9uID0gc3RyaW5nLmluZGV4T2YoJzonKTsKICAgICAgdmFyIGZpcnN0U2xhc2ggPSBzdHJpbmcuaW5kZXhPZignLycpOwogICAgICB2YXIgbmV4dENvbG9uID0gc3RyaW5nLmluZGV4T2YoJzonLCBmaXJzdENvbG9uICsgMSk7CiAgICAgIGlmIChuZXh0Q29sb24gIT09IC0xICYmIChmaXJzdFNsYXNoID09PSAtMSB8fCBuZXh0Q29sb24gPCBmaXJzdFNsYXNoKSkgewogICAgICAgIC8vIElQdjYgaG9zdCBjb250YWlucyBtdWx0aXBsZSBjb2xvbnMgLSBidXQgbm8gcG9ydAogICAgICAgIC8vIHRoaXMgbm90YXRpb24gaXMgYWN0dWFsbHkgbm90IGFsbG93ZWQgYnkgUkZDIDM5ODYsIGJ1dCB3ZSdyZSBhIGxpYmVyYWwgcGFyc2VyCiAgICAgICAgcGFydHMuaG9zdG5hbWUgPSBzdHJpbmcuc3Vic3RyaW5nKDAsIHBvcykgfHwgbnVsbDsKICAgICAgICBwYXJ0cy5wb3J0ID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ID0gc3RyaW5nLnN1YnN0cmluZygwLCBwb3MpLnNwbGl0KCc6Jyk7CiAgICAgICAgcGFydHMuaG9zdG5hbWUgPSB0WzBdIHx8IG51bGw7CiAgICAgICAgcGFydHMucG9ydCA9IHRbMV0gfHwgbnVsbDsKICAgICAgfQogICAgfQoKICAgIGlmIChwYXJ0cy5ob3N0bmFtZSAmJiBzdHJpbmcuc3Vic3RyaW5nKHBvcykuY2hhckF0KDApICE9PSAnLycpIHsKICAgICAgcG9zKys7CiAgICAgIHN0cmluZyA9ICcvJyArIHN0cmluZzsKICAgIH0KCiAgICByZXR1cm4gc3RyaW5nLnN1YnN0cmluZyhwb3MpIHx8ICcvJzsKICB9OwogIFVSSS5wYXJzZUF1dGhvcml0eSA9IGZ1bmN0aW9uKHN0cmluZywgcGFydHMpIHsKICAgIHN0cmluZyA9IFVSSS5wYXJzZVVzZXJpbmZvKHN0cmluZywgcGFydHMpOwogICAgcmV0dXJuIFVSSS5wYXJzZUhvc3Qoc3RyaW5nLCBwYXJ0cyk7CiAgfTsKICBVUkkucGFyc2VVc2VyaW5mbyA9IGZ1bmN0aW9uKHN0cmluZywgcGFydHMpIHsKICAgIC8vIGV4dHJhY3QgdXNlcm5hbWU6cGFzc3dvcmQKICAgIHZhciBmaXJzdFNsYXNoID0gc3RyaW5nLmluZGV4T2YoJy8nKTsKICAgIHZhciBwb3MgPSBzdHJpbmcubGFzdEluZGV4T2YoJ0AnLCBmaXJzdFNsYXNoID4gLTEgPyBmaXJzdFNsYXNoIDogc3RyaW5nLmxlbmd0aCAtIDEpOwogICAgdmFyIHQ7CgogICAgLy8gYXV0aG9yaXR5QCBtdXN0IGNvbWUgYmVmb3JlIC9wYXRoCiAgICBpZiAocG9zID4gLTEgJiYgKGZpcnN0U2xhc2ggPT09IC0xIHx8IHBvcyA8IGZpcnN0U2xhc2gpKSB7CiAgICAgIHQgPSBzdHJpbmcuc3Vic3RyaW5nKDAsIHBvcykuc3BsaXQoJzonKTsKICAgICAgcGFydHMudXNlcm5hbWUgPSB0WzBdID8gVVJJLmRlY29kZSh0WzBdKSA6IG51bGw7CiAgICAgIHQuc2hpZnQoKTsKICAgICAgcGFydHMucGFzc3dvcmQgPSB0WzBdID8gVVJJLmRlY29kZSh0LmpvaW4oJzonKSkgOiBudWxsOwogICAgICBzdHJpbmcgPSBzdHJpbmcuc3Vic3RyaW5nKHBvcyArIDEpOwogICAgfSBlbHNlIHsKICAgICAgcGFydHMudXNlcm5hbWUgPSBudWxsOwogICAgICBwYXJ0cy5wYXNzd29yZCA9IG51bGw7CiAgICB9CgogICAgcmV0dXJuIHN0cmluZzsKICB9OwogIFVSSS5wYXJzZVF1ZXJ5ID0gZnVuY3Rpb24oc3RyaW5nLCBlc2NhcGVRdWVyeVNwYWNlKSB7CiAgICBpZiAoIXN0cmluZykgewogICAgICByZXR1cm4ge307CiAgICB9CgogICAgLy8gdGhyb3cgb3V0IHRoZSBmdW5reSBidXNpbmVzcyAtICI/IltuYW1lIj0idmFsdWUiJiJdKwogICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoLyYrL2csICcmJykucmVwbGFjZSgvXlw/KiYqfCYrJC9nLCAnJyk7CgogICAgaWYgKCFzdHJpbmcpIHsKICAgICAgcmV0dXJuIHt9OwogICAgfQoKICAgIHZhciBpdGVtcyA9IHt9OwogICAgdmFyIHNwbGl0cyA9IHN0cmluZy5zcGxpdCgnJicpOwogICAgdmFyIGxlbmd0aCA9IHNwbGl0cy5sZW5ndGg7CiAgICB2YXIgdiwgbmFtZSwgdmFsdWU7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICB2ID0gc3BsaXRzW2ldLnNwbGl0KCc9Jyk7CiAgICAgIG5hbWUgPSBVUkkuZGVjb2RlUXVlcnkodi5zaGlmdCgpLCBlc2NhcGVRdWVyeVNwYWNlKTsKICAgICAgLy8gbm8gIj0iIGlzIG51bGwgYWNjb3JkaW5nIHRvIGh0dHA6Ly9kdmNzLnczLm9yZy9oZy91cmwvcmF3LWZpbGUvdGlwL092ZXJ2aWV3Lmh0bWwjY29sbGVjdC11cmwtcGFyYW1ldGVycwogICAgICB2YWx1ZSA9IHYubGVuZ3RoID8gVVJJLmRlY29kZVF1ZXJ5KHYuam9pbignPScpLCBlc2NhcGVRdWVyeVNwYWNlKSA6IG51bGw7CgogICAgICBpZiAoaGFzT3duLmNhbGwoaXRlbXMsIG5hbWUpKSB7CiAgICAgICAgaWYgKHR5cGVvZiBpdGVtc1tuYW1lXSA9PT0gJ3N0cmluZycgfHwgaXRlbXNbbmFtZV0gPT09IG51bGwpIHsKICAgICAgICAgIGl0ZW1zW25hbWVdID0gW2l0ZW1zW25hbWVdXTsKICAgICAgICB9CgogICAgICAgIGl0ZW1zW25hbWVdLnB1c2godmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIGl0ZW1zW25hbWVdID0gdmFsdWU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gaXRlbXM7CiAgfTsKCiAgVVJJLmJ1aWxkID0gZnVuY3Rpb24ocGFydHMpIHsKICAgIHZhciB0ID0gJyc7CgogICAgaWYgKHBhcnRzLnByb3RvY29sKSB7CiAgICAgIHQgKz0gcGFydHMucHJvdG9jb2wgKyAnOic7CiAgICB9CgogICAgaWYgKCFwYXJ0cy51cm4gJiYgKHQgfHwgcGFydHMuaG9zdG5hbWUpKSB7CiAgICAgIHQgKz0gJy8vJzsKICAgIH0KCiAgICB0ICs9IChVUkkuYnVpbGRBdXRob3JpdHkocGFydHMpIHx8ICcnKTsKCiAgICBpZiAodHlwZW9mIHBhcnRzLnBhdGggPT09ICdzdHJpbmcnKSB7CiAgICAgIGlmIChwYXJ0cy5wYXRoLmNoYXJBdCgwKSAhPT0gJy8nICYmIHR5cGVvZiBwYXJ0cy5ob3N0bmFtZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICB0ICs9ICcvJzsKICAgICAgfQoKICAgICAgdCArPSBwYXJ0cy5wYXRoOwogICAgfQoKICAgIGlmICh0eXBlb2YgcGFydHMucXVlcnkgPT09ICdzdHJpbmcnICYmIHBhcnRzLnF1ZXJ5KSB7CiAgICAgIHQgKz0gJz8nICsgcGFydHMucXVlcnk7CiAgICB9CgogICAgaWYgKHR5cGVvZiBwYXJ0cy5mcmFnbWVudCA9PT0gJ3N0cmluZycgJiYgcGFydHMuZnJhZ21lbnQpIHsKICAgICAgdCArPSAnIycgKyBwYXJ0cy5mcmFnbWVudDsKICAgIH0KICAgIHJldHVybiB0OwogIH07CiAgVVJJLmJ1aWxkSG9zdCA9IGZ1bmN0aW9uKHBhcnRzKSB7CiAgICB2YXIgdCA9ICcnOwoKICAgIGlmICghcGFydHMuaG9zdG5hbWUpIHsKICAgICAgcmV0dXJuICcnOwogICAgfSBlbHNlIGlmIChVUkkuaXA2X2V4cHJlc3Npb24udGVzdChwYXJ0cy5ob3N0bmFtZSkpIHsKICAgICAgdCArPSAnWycgKyBwYXJ0cy5ob3N0bmFtZSArICddJzsKICAgIH0gZWxzZSB7CiAgICAgIHQgKz0gcGFydHMuaG9zdG5hbWU7CiAgICB9CgogICAgaWYgKHBhcnRzLnBvcnQpIHsKICAgICAgdCArPSAnOicgKyBwYXJ0cy5wb3J0OwogICAgfQoKICAgIHJldHVybiB0OwogIH07CiAgVVJJLmJ1aWxkQXV0aG9yaXR5ID0gZnVuY3Rpb24ocGFydHMpIHsKICAgIHJldHVybiBVUkkuYnVpbGRVc2VyaW5mbyhwYXJ0cykgKyBVUkkuYnVpbGRIb3N0KHBhcnRzKTsKICB9OwogIFVSSS5idWlsZFVzZXJpbmZvID0gZnVuY3Rpb24ocGFydHMpIHsKICAgIHZhciB0ID0gJyc7CgogICAgaWYgKHBhcnRzLnVzZXJuYW1lKSB7CiAgICAgIHQgKz0gVVJJLmVuY29kZShwYXJ0cy51c2VybmFtZSk7CiAgICB9CgogICAgaWYgKHBhcnRzLnBhc3N3b3JkKSB7CiAgICAgIHQgKz0gJzonICsgVVJJLmVuY29kZShwYXJ0cy5wYXNzd29yZCk7CiAgICB9CgogICAgaWYgKHQpIHsKICAgICAgdCArPSAnQCc7CiAgICB9CgogICAgcmV0dXJuIHQ7CiAgfTsKICBVUkkuYnVpbGRRdWVyeSA9IGZ1bmN0aW9uKGRhdGEsIGR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycywgZXNjYXBlUXVlcnlTcGFjZSkgewogICAgLy8gYWNjb3JkaW5nIHRvIGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzM5ODYgb3IgaHR0cDovL2xhYnMuYXBhY2hlLm9yZy93ZWJhcmNoL3VyaS9yZmMvcmZjMzk4Ni5odG1sCiAgICAvLyBiZWluZyDCuy0uX34hJCYnKCkqKyw7PTpALz/CqyAlSEVYIGFuZCBhbG51bSBhcmUgYWxsb3dlZAogICAgLy8gdGhlIFJGQyBleHBsaWNpdGx5IHN0YXRlcyA/L2ZvbyBiZWluZyBhIHZhbGlkIHVzZSBjYXNlLCBubyBtZW50aW9uIG9mIHBhcmFtZXRlciBzeW50YXghCiAgICAvLyBVUkkuanMgdHJlYXRzIHRoZSBxdWVyeSBzdHJpbmcgYXMgYmVpbmcgYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkCiAgICAvLyBzZWUgaHR0cDovL3d3dy53My5vcmcvVFIvUkVDLWh0bWw0MC9pbnRlcmFjdC9mb3Jtcy5odG1sI2Zvcm0tY29udGVudC10eXBlCgogICAgdmFyIHQgPSAnJzsKICAgIHZhciB1bmlxdWUsIGtleSwgaSwgbGVuZ3RoOwogICAgZm9yIChrZXkgaW4gZGF0YSkgewogICAgICBpZiAoaGFzT3duLmNhbGwoZGF0YSwga2V5KSAmJiBrZXkpIHsKICAgICAgICBpZiAoaXNBcnJheShkYXRhW2tleV0pKSB7CiAgICAgICAgICB1bmlxdWUgPSB7fTsKICAgICAgICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IGRhdGFba2V5XS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoZGF0YVtrZXldW2ldICE9PSB1bmRlZmluZWQgJiYgdW5pcXVlW2RhdGFba2V5XVtpXSArICcnXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgdCArPSAnJicgKyBVUkkuYnVpbGRRdWVyeVBhcmFtZXRlcihrZXksIGRhdGFba2V5XVtpXSwgZXNjYXBlUXVlcnlTcGFjZSk7CiAgICAgICAgICAgICAgaWYgKGR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycyAhPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgdW5pcXVlW2RhdGFba2V5XVtpXSArICcnXSA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChkYXRhW2tleV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdCArPSAnJicgKyBVUkkuYnVpbGRRdWVyeVBhcmFtZXRlcihrZXksIGRhdGFba2V5XSwgZXNjYXBlUXVlcnlTcGFjZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHQuc3Vic3RyaW5nKDEpOwogIH07CiAgVVJJLmJ1aWxkUXVlcnlQYXJhbWV0ZXIgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSwgZXNjYXBlUXVlcnlTcGFjZSkgewogICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvUkVDLWh0bWw0MC9pbnRlcmFjdC9mb3Jtcy5odG1sI2Zvcm0tY29udGVudC10eXBlIC0tIGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZAogICAgLy8gZG9uJ3QgYXBwZW5kICI9IiBmb3IgbnVsbCB2YWx1ZXMsIGFjY29yZGluZyB0byBodHRwOi8vZHZjcy53My5vcmcvaGcvdXJsL3Jhdy1maWxlL3RpcC9PdmVydmlldy5odG1sI3VybC1wYXJhbWV0ZXItc2VyaWFsaXphdGlvbgogICAgcmV0dXJuIFVSSS5lbmNvZGVRdWVyeShuYW1lLCBlc2NhcGVRdWVyeVNwYWNlKSArICh2YWx1ZSAhPT0gbnVsbCA/ICc9JyArIFVSSS5lbmNvZGVRdWVyeSh2YWx1ZSwgZXNjYXBlUXVlcnlTcGFjZSkgOiAnJyk7CiAgfTsKCiAgVVJJLmFkZFF1ZXJ5ID0gZnVuY3Rpb24oZGF0YSwgbmFtZSwgdmFsdWUpIHsKICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG5hbWUpIHsKICAgICAgICBpZiAoaGFzT3duLmNhbGwobmFtZSwga2V5KSkgewogICAgICAgICAgVVJJLmFkZFF1ZXJ5KGRhdGEsIGtleSwgbmFtZVtrZXldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnKSB7CiAgICAgIGlmIChkYXRhW25hbWVdID09PSB1bmRlZmluZWQpIHsKICAgICAgICBkYXRhW25hbWVdID0gdmFsdWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRhW25hbWVdID09PSAnc3RyaW5nJykgewogICAgICAgIGRhdGFbbmFtZV0gPSBbZGF0YVtuYW1lXV07CiAgICAgIH0KCiAgICAgIGlmICghaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICB2YWx1ZSA9IFt2YWx1ZV07CiAgICAgIH0KCiAgICAgIGRhdGFbbmFtZV0gPSAoZGF0YVtuYW1lXSB8fCBbXSkuY29uY2F0KHZhbHVlKTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5hZGRRdWVyeSgpIGFjY2VwdHMgYW4gb2JqZWN0LCBzdHJpbmcgYXMgdGhlIG5hbWUgcGFyYW1ldGVyJyk7CiAgICB9CiAgfTsKICBVUkkucmVtb3ZlUXVlcnkgPSBmdW5jdGlvbihkYXRhLCBuYW1lLCB2YWx1ZSkgewogICAgdmFyIGksIGxlbmd0aCwga2V5OwoKICAgIGlmIChpc0FycmF5KG5hbWUpKSB7CiAgICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IG5hbWUubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICBkYXRhW25hbWVbaV1dID0gdW5kZWZpbmVkOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGdldFR5cGUobmFtZSkgPT09ICdSZWdFeHAnKSB7CiAgICAgIGZvciAoa2V5IGluIGRhdGEpIHsKICAgICAgICBpZiAobmFtZS50ZXN0KGtleSkpIHsKICAgICAgICAgIGRhdGFba2V5XSA9IHVuZGVmaW5lZDsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodHlwZW9mIG5hbWUgPT09ICdvYmplY3QnKSB7CiAgICAgIGZvciAoa2V5IGluIG5hbWUpIHsKICAgICAgICBpZiAoaGFzT3duLmNhbGwobmFtZSwga2V5KSkgewogICAgICAgICAgVVJJLnJlbW92ZVF1ZXJ5KGRhdGEsIGtleSwgbmFtZVtrZXldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnKSB7CiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKGdldFR5cGUodmFsdWUpID09PSAnUmVnRXhwJykgewogICAgICAgICAgaWYgKCFpc0FycmF5KGRhdGFbbmFtZV0pICYmIHZhbHVlLnRlc3QoZGF0YVtuYW1lXSkpIHsKICAgICAgICAgICAgZGF0YVtuYW1lXSA9IHVuZGVmaW5lZDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRhdGFbbmFtZV0gPSBmaWx0ZXJBcnJheVZhbHVlcyhkYXRhW25hbWVdLCB2YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChkYXRhW25hbWVdID09PSBTdHJpbmcodmFsdWUpICYmICghaXNBcnJheSh2YWx1ZSkgfHwgdmFsdWUubGVuZ3RoID09PSAxKSkgewogICAgICAgICAgZGF0YVtuYW1lXSA9IHVuZGVmaW5lZDsKICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkoZGF0YVtuYW1lXSkpIHsKICAgICAgICAgIGRhdGFbbmFtZV0gPSBmaWx0ZXJBcnJheVZhbHVlcyhkYXRhW25hbWVdLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGRhdGFbbmFtZV0gPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5yZW1vdmVRdWVyeSgpIGFjY2VwdHMgYW4gb2JqZWN0LCBzdHJpbmcsIFJlZ0V4cCBhcyB0aGUgZmlyc3QgcGFyYW1ldGVyJyk7CiAgICB9CiAgfTsKICBVUkkuaGFzUXVlcnkgPSBmdW5jdGlvbihkYXRhLCBuYW1lLCB2YWx1ZSwgd2l0aGluQXJyYXkpIHsKICAgIHN3aXRjaCAoZ2V0VHlwZShuYW1lKSkgewogICAgICBjYXNlICdTdHJpbmcnOgogICAgICAgIC8vIE5vdGhpbmcgdG8gZG8gaGVyZQogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnUmVnRXhwJzoKICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkgewogICAgICAgICAgaWYgKGhhc093bi5jYWxsKGRhdGEsIGtleSkpIHsKICAgICAgICAgICAgaWYgKG5hbWUudGVzdChrZXkpICYmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IFVSSS5oYXNRdWVyeShkYXRhLCBrZXksIHZhbHVlKSkpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgY2FzZSAnT2JqZWN0JzoKICAgICAgICBmb3IgKHZhciBfa2V5IGluIG5hbWUpIHsKICAgICAgICAgIGlmIChoYXNPd24uY2FsbChuYW1lLCBfa2V5KSkgewogICAgICAgICAgICBpZiAoIVVSSS5oYXNRdWVyeShkYXRhLCBfa2V5LCBuYW1lW19rZXldKSkgewogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5oYXNRdWVyeSgpIGFjY2VwdHMgYSBzdHJpbmcsIHJlZ3VsYXIgZXhwcmVzc2lvbiBvciBvYmplY3QgYXMgdGhlIG5hbWUgcGFyYW1ldGVyJyk7CiAgICB9CgogICAgc3dpdGNoIChnZXRUeXBlKHZhbHVlKSkgewogICAgICBjYXNlICdVbmRlZmluZWQnOgogICAgICAgIC8vIHRydWUgaWYgZXhpc3RzIChidXQgbWF5IGJlIGVtcHR5KQogICAgICAgIHJldHVybiBuYW1lIGluIGRhdGE7IC8vIGRhdGFbbmFtZV0gIT09IHVuZGVmaW5lZDsKCiAgICAgIGNhc2UgJ0Jvb2xlYW4nOgogICAgICAgIC8vIHRydWUgaWYgZXhpc3RzIGFuZCBub24tZW1wdHkKICAgICAgICB2YXIgX2Jvb2x5ID0gQm9vbGVhbihpc0FycmF5KGRhdGFbbmFtZV0pID8gZGF0YVtuYW1lXS5sZW5ndGggOiBkYXRhW25hbWVdKTsKICAgICAgICByZXR1cm4gdmFsdWUgPT09IF9ib29seTsKCiAgICAgIGNhc2UgJ0Z1bmN0aW9uJzoKICAgICAgICAvLyBhbGxvdyBjb21wbGV4IGNvbXBhcmlzb24KICAgICAgICByZXR1cm4gISF2YWx1ZShkYXRhW25hbWVdLCBuYW1lLCBkYXRhKTsKCiAgICAgIGNhc2UgJ0FycmF5JzoKICAgICAgICBpZiAoIWlzQXJyYXkoZGF0YVtuYW1lXSkpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciBvcCA9IHdpdGhpbkFycmF5ID8gYXJyYXlDb250YWlucyA6IGFycmF5c0VxdWFsOwogICAgICAgIHJldHVybiBvcChkYXRhW25hbWVdLCB2YWx1ZSk7CgogICAgICBjYXNlICdSZWdFeHAnOgogICAgICAgIGlmICghaXNBcnJheShkYXRhW25hbWVdKSkgewogICAgICAgICAgcmV0dXJuIEJvb2xlYW4oZGF0YVtuYW1lXSAmJiBkYXRhW25hbWVdLm1hdGNoKHZhbHVlKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXdpdGhpbkFycmF5KSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYXJyYXlDb250YWlucyhkYXRhW25hbWVdLCB2YWx1ZSk7CgogICAgICBjYXNlICdOdW1iZXInOgogICAgICAgIHZhbHVlID0gU3RyaW5nKHZhbHVlKTsKICAgICAgICAvKiBmYWxscyB0aHJvdWdoICovCiAgICAgIGNhc2UgJ1N0cmluZyc6CiAgICAgICAgaWYgKCFpc0FycmF5KGRhdGFbbmFtZV0pKSB7CiAgICAgICAgICByZXR1cm4gZGF0YVtuYW1lXSA9PT0gdmFsdWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXdpdGhpbkFycmF5KSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYXJyYXlDb250YWlucyhkYXRhW25hbWVdLCB2YWx1ZSk7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5oYXNRdWVyeSgpIGFjY2VwdHMgdW5kZWZpbmVkLCBib29sZWFuLCBzdHJpbmcsIG51bWJlciwgUmVnRXhwLCBGdW5jdGlvbiBhcyB0aGUgdmFsdWUgcGFyYW1ldGVyJyk7CiAgICB9CiAgfTsKCgogIFVSSS5qb2luUGF0aHMgPSBmdW5jdGlvbigpIHsKICAgIHZhciBpbnB1dCA9IFtdOwogICAgdmFyIHNlZ21lbnRzID0gW107CiAgICB2YXIgbm9uRW1wdHlTZWdtZW50cyA9IDA7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHVybCA9IG5ldyBVUkkoYXJndW1lbnRzW2ldKTsKICAgICAgaW5wdXQucHVzaCh1cmwpOwogICAgICB2YXIgX3NlZ21lbnRzID0gdXJsLnNlZ21lbnQoKTsKICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBfc2VnbWVudHMubGVuZ3RoOyBzKyspIHsKICAgICAgICBpZiAodHlwZW9mIF9zZWdtZW50c1tzXSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIHNlZ21lbnRzLnB1c2goX3NlZ21lbnRzW3NdKTsKICAgICAgICB9CgogICAgICAgIGlmIChfc2VnbWVudHNbc10pIHsKICAgICAgICAgIG5vbkVtcHR5U2VnbWVudHMrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXNlZ21lbnRzLmxlbmd0aCB8fCAhbm9uRW1wdHlTZWdtZW50cykgewogICAgICByZXR1cm4gbmV3IFVSSSgnJyk7CiAgICB9CgogICAgdmFyIHVyaSA9IG5ldyBVUkkoJycpLnNlZ21lbnQoc2VnbWVudHMpOwoKICAgIGlmIChpbnB1dFswXS5wYXRoKCkgPT09ICcnIHx8IGlucHV0WzBdLnBhdGgoKS5zbGljZSgwLCAxKSA9PT0gJy8nKSB7CiAgICAgIHVyaS5wYXRoKCcvJyArIHVyaS5wYXRoKCkpOwogICAgfQoKICAgIHJldHVybiB1cmkubm9ybWFsaXplKCk7CiAgfTsKCiAgVVJJLmNvbW1vblBhdGggPSBmdW5jdGlvbihvbmUsIHR3bykgewogICAgdmFyIGxlbmd0aCA9IE1hdGgubWluKG9uZS5sZW5ndGgsIHR3by5sZW5ndGgpOwogICAgdmFyIHBvczsKCiAgICAvLyBmaW5kIGZpcnN0IG5vbi1tYXRjaGluZyBjaGFyYWN0ZXIKICAgIGZvciAocG9zID0gMDsgcG9zIDwgbGVuZ3RoOyBwb3MrKykgewogICAgICBpZiAob25lLmNoYXJBdChwb3MpICE9PSB0d28uY2hhckF0KHBvcykpIHsKICAgICAgICBwb3MtLTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGlmIChwb3MgPCAxKSB7CiAgICAgIHJldHVybiBvbmUuY2hhckF0KDApID09PSB0d28uY2hhckF0KDApICYmIG9uZS5jaGFyQXQoMCkgPT09ICcvJyA/ICcvJyA6ICcnOwogICAgfQoKICAgIC8vIHJldmVydCB0byBsYXN0IC8KICAgIGlmIChvbmUuY2hhckF0KHBvcykgIT09ICcvJyB8fCB0d28uY2hhckF0KHBvcykgIT09ICcvJykgewogICAgICBwb3MgPSBvbmUuc3Vic3RyaW5nKDAsIHBvcykubGFzdEluZGV4T2YoJy8nKTsKICAgIH0KCiAgICByZXR1cm4gb25lLnN1YnN0cmluZygwLCBwb3MgKyAxKTsKICB9OwoKICBVUkkud2l0aGluU3RyaW5nID0gZnVuY3Rpb24oc3RyaW5nLCBjYWxsYmFjaywgb3B0aW9ucykgewogICAgb3B0aW9ucyB8fCAob3B0aW9ucyA9IHt9KTsKICAgIHZhciBfc3RhcnQgPSBvcHRpb25zLnN0YXJ0IHx8IFVSSS5maW5kVXJpLnN0YXJ0OwogICAgdmFyIF9lbmQgPSBvcHRpb25zLmVuZCB8fCBVUkkuZmluZFVyaS5lbmQ7CiAgICB2YXIgX3RyaW0gPSBvcHRpb25zLnRyaW0gfHwgVVJJLmZpbmRVcmkudHJpbTsKICAgIHZhciBfYXR0cmlidXRlT3BlbiA9IC9bYS16MC05LV09WyInXT8kL2k7CgogICAgX3N0YXJ0Lmxhc3RJbmRleCA9IDA7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICB2YXIgbWF0Y2ggPSBfc3RhcnQuZXhlYyhzdHJpbmcpOwogICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHZhciBzdGFydCA9IG1hdGNoLmluZGV4OwogICAgICBpZiAob3B0aW9ucy5pZ25vcmVIdG1sKSB7CiAgICAgICAgLy8gYXR0cmlidXQoZT1bIiddPyQpCiAgICAgICAgdmFyIGF0dHJpYnV0ZU9wZW4gPSBzdHJpbmcuc2xpY2UoTWF0aC5tYXgoc3RhcnQgLSAzLCAwKSwgc3RhcnQpOwogICAgICAgIGlmIChhdHRyaWJ1dGVPcGVuICYmIF9hdHRyaWJ1dGVPcGVuLnRlc3QoYXR0cmlidXRlT3BlbikpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGVuZCA9IHN0YXJ0ICsgc3RyaW5nLnNsaWNlKHN0YXJ0KS5zZWFyY2goX2VuZCk7CiAgICAgIHZhciBzbGljZSA9IHN0cmluZy5zbGljZShzdGFydCwgZW5kKS5yZXBsYWNlKF90cmltLCAnJyk7CiAgICAgIGlmIChvcHRpb25zLmlnbm9yZSAmJiBvcHRpb25zLmlnbm9yZS50ZXN0KHNsaWNlKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBlbmQgPSBzdGFydCArIHNsaWNlLmxlbmd0aDsKICAgICAgdmFyIHJlc3VsdCA9IGNhbGxiYWNrKHNsaWNlLCBzdGFydCwgZW5kLCBzdHJpbmcpOwogICAgICBzdHJpbmcgPSBzdHJpbmcuc2xpY2UoMCwgc3RhcnQpICsgcmVzdWx0ICsgc3RyaW5nLnNsaWNlKGVuZCk7CiAgICAgIF9zdGFydC5sYXN0SW5kZXggPSBzdGFydCArIHJlc3VsdC5sZW5ndGg7CiAgICB9CgogICAgX3N0YXJ0Lmxhc3RJbmRleCA9IDA7CiAgICByZXR1cm4gc3RyaW5nOwogIH07CgogIFVSSS5lbnN1cmVWYWxpZEhvc3RuYW1lID0gZnVuY3Rpb24odikgewogICAgLy8gVGhlb3JldGljYWxseSBVUklzIGFsbG93IHBlcmNlbnQtZW5jb2RpbmcgaW4gSG9zdG5hbWVzIChhY2NvcmRpbmcgdG8gUkZDIDM5ODYpCiAgICAvLyB0aGV5IGFyZSBub3QgcGFydCBvZiBETlMgYW5kIHRoZXJlZm9yZSBpZ25vcmVkIGJ5IFVSSS5qcwoKICAgIGlmICh2Lm1hdGNoKFVSSS5pbnZhbGlkX2hvc3RuYW1lX2NoYXJhY3RlcnMpKSB7CiAgICAgIC8vIHRlc3QgcHVueWNvZGUKICAgICAgaWYgKCFwdW55Y29kZSkgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hvc3RuYW1lICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05Li1dIGFuZCBQdW55Y29kZS5qcyBpcyBub3QgYXZhaWxhYmxlJyk7CiAgICAgIH0KCiAgICAgIGlmIChwdW55Y29kZS50b0FTQ0lJKHYpLm1hdGNoKFVSSS5pbnZhbGlkX2hvc3RuYW1lX2NoYXJhY3RlcnMpKSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSG9zdG5hbWUgIicgKyB2ICsgJyIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFtBLVowLTkuLV0nKTsKICAgICAgfQogICAgfQogIH07CgogIC8vIG5vQ29uZmxpY3QKICBVUkkubm9Db25mbGljdCA9IGZ1bmN0aW9uKHJlbW92ZUFsbCkgewogICAgaWYgKHJlbW92ZUFsbCkgewogICAgICB2YXIgdW5jb25mbGljdGVkID0gewogICAgICAgIFVSSTogdGhpcy5ub0NvbmZsaWN0KCkKICAgICAgfTsKCiAgICAgIGlmIChyb290LlVSSVRlbXBsYXRlICYmIHR5cGVvZiByb290LlVSSVRlbXBsYXRlLm5vQ29uZmxpY3QgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB1bmNvbmZsaWN0ZWQuVVJJVGVtcGxhdGUgPSByb290LlVSSVRlbXBsYXRlLm5vQ29uZmxpY3QoKTsKICAgICAgfQoKICAgICAgaWYgKHJvb3QuSVB2NiAmJiB0eXBlb2Ygcm9vdC5JUHY2Lm5vQ29uZmxpY3QgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB1bmNvbmZsaWN0ZWQuSVB2NiA9IHJvb3QuSVB2Ni5ub0NvbmZsaWN0KCk7CiAgICAgIH0KCiAgICAgIGlmIChyb290LlNlY29uZExldmVsRG9tYWlucyAmJiB0eXBlb2Ygcm9vdC5TZWNvbmRMZXZlbERvbWFpbnMubm9Db25mbGljdCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHVuY29uZmxpY3RlZC5TZWNvbmRMZXZlbERvbWFpbnMgPSByb290LlNlY29uZExldmVsRG9tYWlucy5ub0NvbmZsaWN0KCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB1bmNvbmZsaWN0ZWQ7CiAgICB9IGVsc2UgaWYgKHJvb3QuVVJJID09PSB0aGlzKSB7CiAgICAgIHJvb3QuVVJJID0gX1VSSTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwoKICBwLmJ1aWxkID0gZnVuY3Rpb24oZGVmZXJCdWlsZCkgewogICAgaWYgKGRlZmVyQnVpbGQgPT09IHRydWUpIHsKICAgICAgdGhpcy5fZGVmZXJyZWRfYnVpbGQgPSB0cnVlOwogICAgfSBlbHNlIGlmIChkZWZlckJ1aWxkID09PSB1bmRlZmluZWQgfHwgdGhpcy5fZGVmZXJyZWRfYnVpbGQpIHsKICAgICAgdGhpcy5fc3RyaW5nID0gVVJJLmJ1aWxkKHRoaXMuX3BhcnRzKTsKICAgICAgdGhpcy5fZGVmZXJyZWRfYnVpbGQgPSBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwoKICBwLmNsb25lID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gbmV3IFVSSSh0aGlzKTsKICB9OwoKICBwLnZhbHVlT2YgPSBwLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5idWlsZChmYWxzZSkuX3N0cmluZzsKICB9OwoKCiAgZnVuY3Rpb24gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcihfcGFydCl7CiAgICByZXR1cm4gZnVuY3Rpb24odiwgYnVpbGQpIHsKICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLl9wYXJ0c1tfcGFydF0gfHwgJyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5fcGFydHNbX3BhcnRdID0gdiB8fCBudWxsOwogICAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgfTsKICB9CgogIGZ1bmN0aW9uIGdlbmVyYXRlUHJlZml4QWNjZXNzb3IoX3BhcnQsIF9rZXkpewogICAgcmV0dXJuIGZ1bmN0aW9uKHYsIGJ1aWxkKSB7CiAgICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpcy5fcGFydHNbX3BhcnRdIHx8ICcnOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh2ICE9PSBudWxsKSB7CiAgICAgICAgICB2ID0gdiArICcnOwogICAgICAgICAgaWYgKHYuY2hhckF0KDApID09PSBfa2V5KSB7CiAgICAgICAgICAgIHYgPSB2LnN1YnN0cmluZygxKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuX3BhcnRzW19wYXJ0XSA9IHY7CiAgICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICB9OwogIH0KCiAgcC5wcm90b2NvbCA9IGdlbmVyYXRlU2ltcGxlQWNjZXNzb3IoJ3Byb3RvY29sJyk7CiAgcC51c2VybmFtZSA9IGdlbmVyYXRlU2ltcGxlQWNjZXNzb3IoJ3VzZXJuYW1lJyk7CiAgcC5wYXNzd29yZCA9IGdlbmVyYXRlU2ltcGxlQWNjZXNzb3IoJ3Bhc3N3b3JkJyk7CiAgcC5ob3N0bmFtZSA9IGdlbmVyYXRlU2ltcGxlQWNjZXNzb3IoJ2hvc3RuYW1lJyk7CiAgcC5wb3J0ID0gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcigncG9ydCcpOwogIHAucXVlcnkgPSBnZW5lcmF0ZVByZWZpeEFjY2Vzc29yKCdxdWVyeScsICc/Jyk7CiAgcC5mcmFnbWVudCA9IGdlbmVyYXRlUHJlZml4QWNjZXNzb3IoJ2ZyYWdtZW50JywgJyMnKTsKCiAgcC5zZWFyY2ggPSBmdW5jdGlvbih2LCBidWlsZCkgewogICAgdmFyIHQgPSB0aGlzLnF1ZXJ5KHYsIGJ1aWxkKTsKICAgIHJldHVybiB0eXBlb2YgdCA9PT0gJ3N0cmluZycgJiYgdC5sZW5ndGggPyAoJz8nICsgdCkgOiB0OwogIH07CiAgcC5oYXNoID0gZnVuY3Rpb24odiwgYnVpbGQpIHsKICAgIHZhciB0ID0gdGhpcy5mcmFnbWVudCh2LCBidWlsZCk7CiAgICByZXR1cm4gdHlwZW9mIHQgPT09ICdzdHJpbmcnICYmIHQubGVuZ3RoID8gKCcjJyArIHQpIDogdDsKICB9OwoKICBwLnBhdGhuYW1lID0gZnVuY3Rpb24odiwgYnVpbGQpIHsKICAgIGlmICh2ID09PSB1bmRlZmluZWQgfHwgdiA9PT0gdHJ1ZSkgewogICAgICB2YXIgcmVzID0gdGhpcy5fcGFydHMucGF0aCB8fCAodGhpcy5fcGFydHMuaG9zdG5hbWUgPyAnLycgOiAnJyk7CiAgICAgIHJldHVybiB2ID8gKHRoaXMuX3BhcnRzLnVybiA/IFVSSS5kZWNvZGVVcm5QYXRoIDogVVJJLmRlY29kZVBhdGgpKHJlcykgOiByZXM7CiAgICB9IGVsc2UgewogICAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgICAgdGhpcy5fcGFydHMucGF0aCA9IHYgPyBVUkkucmVjb2RlVXJuUGF0aCh2KSA6ICcnOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSB2ID8gVVJJLnJlY29kZVBhdGgodikgOiAnLyc7CiAgICAgIH0KICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwogIHAucGF0aCA9IHAucGF0aG5hbWU7CiAgcC5ocmVmID0gZnVuY3Rpb24oaHJlZiwgYnVpbGQpIHsKICAgIHZhciBrZXk7CgogICAgaWYgKGhyZWYgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpOwogICAgfQoKICAgIHRoaXMuX3N0cmluZyA9ICcnOwogICAgdGhpcy5fcGFydHMgPSBVUkkuX3BhcnRzKCk7CgogICAgdmFyIF9VUkkgPSBocmVmIGluc3RhbmNlb2YgVVJJOwogICAgdmFyIF9vYmplY3QgPSB0eXBlb2YgaHJlZiA9PT0gJ29iamVjdCcgJiYgKGhyZWYuaG9zdG5hbWUgfHwgaHJlZi5wYXRoIHx8IGhyZWYucGF0aG5hbWUpOwogICAgaWYgKGhyZWYubm9kZU5hbWUpIHsKICAgICAgdmFyIGF0dHJpYnV0ZSA9IFVSSS5nZXREb21BdHRyaWJ1dGUoaHJlZik7CiAgICAgIGhyZWYgPSBocmVmW2F0dHJpYnV0ZV0gfHwgJyc7CiAgICAgIF9vYmplY3QgPSBmYWxzZTsKICAgIH0KCiAgICAvLyB3aW5kb3cubG9jYXRpb24gaXMgcmVwb3J0ZWQgdG8gYmUgYW4gb2JqZWN0LCBidXQgaXQncyBub3QgdGhlIHNvcnQKICAgIC8vIG9mIG9iamVjdCB3ZSdyZSBsb29raW5nIGZvcjoKICAgIC8vICogbG9jYXRpb24ucHJvdG9jb2wgZW5kcyB3aXRoIGEgY29sb24KICAgIC8vICogbG9jYXRpb24ucXVlcnkgIT0gb2JqZWN0LnNlYXJjaAogICAgLy8gKiBsb2NhdGlvbi5oYXNoICE9IG9iamVjdC5mcmFnbWVudAogICAgLy8gc2ltcGx5IHNlcmlhbGl6aW5nIHRoZSB1bmtub3duIG9iamVjdCBzaG91bGQgZG8gdGhlIHRyaWNrCiAgICAvLyAoZm9yIGxvY2F0aW9uLCBub3QgZm9yIGV2ZXJ5dGhpbmcuLi4pCiAgICBpZiAoIV9VUkkgJiYgX29iamVjdCAmJiBocmVmLnBhdGhuYW1lICE9PSB1bmRlZmluZWQpIHsKICAgICAgaHJlZiA9IGhyZWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGhyZWYgPT09ICdzdHJpbmcnIHx8IGhyZWYgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgdGhpcy5fcGFydHMgPSBVUkkucGFyc2UoU3RyaW5nKGhyZWYpLCB0aGlzLl9wYXJ0cyk7CiAgICB9IGVsc2UgaWYgKF9VUkkgfHwgX29iamVjdCkgewogICAgICB2YXIgc3JjID0gX1VSSSA/IGhyZWYuX3BhcnRzIDogaHJlZjsKICAgICAgZm9yIChrZXkgaW4gc3JjKSB7CiAgICAgICAgaWYgKGhhc093bi5jYWxsKHRoaXMuX3BhcnRzLCBrZXkpKSB7CiAgICAgICAgICB0aGlzLl9wYXJ0c1trZXldID0gc3JjW2tleV07CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIGlucHV0Jyk7CiAgICB9CgogICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLy8gaWRlbnRpZmljYXRpb24gYWNjZXNzb3JzCiAgcC5pcyA9IGZ1bmN0aW9uKHdoYXQpIHsKICAgIHZhciBpcCA9IGZhbHNlOwogICAgdmFyIGlwNCA9IGZhbHNlOwogICAgdmFyIGlwNiA9IGZhbHNlOwogICAgdmFyIG5hbWUgPSBmYWxzZTsKICAgIHZhciBzbGQgPSBmYWxzZTsKICAgIHZhciBpZG4gPSBmYWxzZTsKICAgIHZhciBwdW55Y29kZSA9IGZhbHNlOwogICAgdmFyIHJlbGF0aXZlID0gIXRoaXMuX3BhcnRzLnVybjsKCiAgICBpZiAodGhpcy5fcGFydHMuaG9zdG5hbWUpIHsKICAgICAgcmVsYXRpdmUgPSBmYWxzZTsKICAgICAgaXA0ID0gVVJJLmlwNF9leHByZXNzaW9uLnRlc3QodGhpcy5fcGFydHMuaG9zdG5hbWUpOwogICAgICBpcDYgPSBVUkkuaXA2X2V4cHJlc3Npb24udGVzdCh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICAgIGlwID0gaXA0IHx8IGlwNjsKICAgICAgbmFtZSA9ICFpcDsKICAgICAgc2xkID0gbmFtZSAmJiBTTEQgJiYgU0xELmhhcyh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICAgIGlkbiA9IG5hbWUgJiYgVVJJLmlkbl9leHByZXNzaW9uLnRlc3QodGhpcy5fcGFydHMuaG9zdG5hbWUpOwogICAgICBwdW55Y29kZSA9IG5hbWUgJiYgVVJJLnB1bnljb2RlX2V4cHJlc3Npb24udGVzdCh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICB9CgogICAgc3dpdGNoICh3aGF0LnRvTG93ZXJDYXNlKCkpIHsKICAgICAgY2FzZSAncmVsYXRpdmUnOgogICAgICAgIHJldHVybiByZWxhdGl2ZTsKCiAgICAgIGNhc2UgJ2Fic29sdXRlJzoKICAgICAgICByZXR1cm4gIXJlbGF0aXZlOwoKICAgICAgLy8gaG9zdG5hbWUgaWRlbnRpZmljYXRpb24KICAgICAgY2FzZSAnZG9tYWluJzoKICAgICAgY2FzZSAnbmFtZSc6CiAgICAgICAgcmV0dXJuIG5hbWU7CgogICAgICBjYXNlICdzbGQnOgogICAgICAgIHJldHVybiBzbGQ7CgogICAgICBjYXNlICdpcCc6CiAgICAgICAgcmV0dXJuIGlwOwoKICAgICAgY2FzZSAnaXA0JzoKICAgICAgY2FzZSAnaXB2NCc6CiAgICAgIGNhc2UgJ2luZXQ0JzoKICAgICAgICByZXR1cm4gaXA0OwoKICAgICAgY2FzZSAnaXA2JzoKICAgICAgY2FzZSAnaXB2Nic6CiAgICAgIGNhc2UgJ2luZXQ2JzoKICAgICAgICByZXR1cm4gaXA2OwoKICAgICAgY2FzZSAnaWRuJzoKICAgICAgICByZXR1cm4gaWRuOwoKICAgICAgY2FzZSAndXJsJzoKICAgICAgICByZXR1cm4gIXRoaXMuX3BhcnRzLnVybjsKCiAgICAgIGNhc2UgJ3Vybic6CiAgICAgICAgcmV0dXJuICEhdGhpcy5fcGFydHMudXJuOwoKICAgICAgY2FzZSAncHVueWNvZGUnOgogICAgICAgIHJldHVybiBwdW55Y29kZTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9OwoKICAvLyBjb21wb25lbnQgc3BlY2lmaWMgaW5wdXQgdmFsaWRhdGlvbgogIHZhciBfcHJvdG9jb2wgPSBwLnByb3RvY29sOwogIHZhciBfcG9ydCA9IHAucG9ydDsKICB2YXIgX2hvc3RuYW1lID0gcC5ob3N0bmFtZTsKCiAgcC5wcm90b2NvbCA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7CiAgICBpZiAodiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICh2KSB7CiAgICAgICAgLy8gYWNjZXB0IHRyYWlsaW5nIDovLwogICAgICAgIHYgPSB2LnJlcGxhY2UoLzooXC9cLyk/JC8sICcnKTsKCiAgICAgICAgaWYgKCF2Lm1hdGNoKFVSSS5wcm90b2NvbF9leHByZXNzaW9uKSkgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUHJvdG9jb2wgIicgKyB2ICsgJyIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFtBLVowLTkuKy1dIG9yIGRvZXNuXCd0IHN0YXJ0IHdpdGggW0EtWl0nKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBfcHJvdG9jb2wuY2FsbCh0aGlzLCB2LCBidWlsZCk7CiAgfTsKICBwLnNjaGVtZSA9IHAucHJvdG9jb2w7CiAgcC5wb3J0ID0gZnVuY3Rpb24odiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICBpZiAodiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICh2ID09PSAwKSB7CiAgICAgICAgdiA9IG51bGw7CiAgICAgIH0KCiAgICAgIGlmICh2KSB7CiAgICAgICAgdiArPSAnJzsKICAgICAgICBpZiAodi5jaGFyQXQoMCkgPT09ICc6JykgewogICAgICAgICAgdiA9IHYuc3Vic3RyaW5nKDEpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHYubWF0Y2goL1teMC05XS8pKSB7CiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQb3J0ICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbMC05XScpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIF9wb3J0LmNhbGwodGhpcywgdiwgYnVpbGQpOwogIH07CiAgcC5ob3N0bmFtZSA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHYgIT09IHVuZGVmaW5lZCkgewogICAgICB2YXIgeCA9IHt9OwogICAgICB2YXIgcmVzID0gVVJJLnBhcnNlSG9zdCh2LCB4KTsKICAgICAgaWYgKHJlcyAhPT0gJy8nKSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSG9zdG5hbWUgIicgKyB2ICsgJyIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFtBLVowLTkuLV0nKTsKICAgICAgfQoKICAgICAgdiA9IHguaG9zdG5hbWU7CiAgICB9CiAgICByZXR1cm4gX2hvc3RuYW1lLmNhbGwodGhpcywgdiwgYnVpbGQpOwogIH07CgogIC8vIGNvbXBvdW5kIGFjY2Vzc29ycwogIHAub3JpZ2luID0gZnVuY3Rpb24odiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhciBwcm90b2NvbCA9IHRoaXMucHJvdG9jb2woKTsKICAgICAgdmFyIGF1dGhvcml0eSA9IHRoaXMuYXV0aG9yaXR5KCk7CiAgICAgIGlmICghYXV0aG9yaXR5KSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICByZXR1cm4gKHByb3RvY29sID8gcHJvdG9jb2wgKyAnOi8vJyA6ICcnKSArIHRoaXMuYXV0aG9yaXR5KCk7CiAgICB9IGVsc2UgewogICAgICB2YXIgb3JpZ2luID0gVVJJKHYpOwogICAgICB0aGlzCiAgICAgICAgLnByb3RvY29sKG9yaWdpbi5wcm90b2NvbCgpKQogICAgICAgIC5hdXRob3JpdHkob3JpZ2luLmF1dGhvcml0eSgpKQogICAgICAgIC5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwogIHAuaG9zdCA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdGhpcy5fcGFydHMuaG9zdG5hbWUgPyBVUkkuYnVpbGRIb3N0KHRoaXMuX3BhcnRzKSA6ICcnOwogICAgfSBlbHNlIHsKICAgICAgdmFyIHJlcyA9IFVSSS5wYXJzZUhvc3QodiwgdGhpcy5fcGFydHMpOwogICAgICBpZiAocmVzICE9PSAnLycpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdIb3N0bmFtZSAiJyArIHYgKyAnIiBjb250YWlucyBjaGFyYWN0ZXJzIG90aGVyIHRoYW4gW0EtWjAtOS4tXScpOwogICAgICB9CgogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcC5hdXRob3JpdHkgPSBmdW5jdGlvbih2LCBidWlsZCkgewogICAgaWYgKHRoaXMuX3BhcnRzLnVybikgewogICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzOwogICAgfQoKICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXMuX3BhcnRzLmhvc3RuYW1lID8gVVJJLmJ1aWxkQXV0aG9yaXR5KHRoaXMuX3BhcnRzKSA6ICcnOwogICAgfSBlbHNlIHsKICAgICAgdmFyIHJlcyA9IFVSSS5wYXJzZUF1dGhvcml0eSh2LCB0aGlzLl9wYXJ0cyk7CiAgICAgIGlmIChyZXMgIT09ICcvJykgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hvc3RuYW1lICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05Li1dJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKICBwLnVzZXJpbmZvID0gZnVuY3Rpb24odiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhciB0ID0gVVJJLmJ1aWxkVXNlcmluZm8odGhpcy5fcGFydHMpOwogICAgICByZXR1cm4gdCA/IHQuc3Vic3RyaW5nKDAsIHQubGVuZ3RoIC0xKSA6IHQ7CiAgICB9IGVsc2UgewogICAgICBpZiAodlt2Lmxlbmd0aC0xXSAhPT0gJ0AnKSB7CiAgICAgICAgdiArPSAnQCc7CiAgICAgIH0KCiAgICAgIFVSSS5wYXJzZVVzZXJpbmZvKHYsIHRoaXMuX3BhcnRzKTsKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwogIHAucmVzb3VyY2UgPSBmdW5jdGlvbih2LCBidWlsZCkgewogICAgdmFyIHBhcnRzOwoKICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXMucGF0aCgpICsgdGhpcy5zZWFyY2goKSArIHRoaXMuaGFzaCgpOwogICAgfQoKICAgIHBhcnRzID0gVVJJLnBhcnNlKHYpOwogICAgdGhpcy5fcGFydHMucGF0aCA9IHBhcnRzLnBhdGg7CiAgICB0aGlzLl9wYXJ0cy5xdWVyeSA9IHBhcnRzLnF1ZXJ5OwogICAgdGhpcy5fcGFydHMuZnJhZ21lbnQgPSBwYXJ0cy5mcmFnbWVudDsKICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIC8vIGZyYWN0aW9uIGFjY2Vzc29ycwogIHAuc3ViZG9tYWluID0gZnVuY3Rpb24odiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICAvLyBjb252ZW5pZW5jZSwgcmV0dXJuICJ3d3ciIGZyb20gInd3dy5leGFtcGxlLm9yZyIKICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKCF0aGlzLl9wYXJ0cy5ob3N0bmFtZSB8fCB0aGlzLmlzKCdJUCcpKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICAvLyBncmFiIGRvbWFpbiBhbmQgYWRkIGFub3RoZXIgc2VnbWVudAogICAgICB2YXIgZW5kID0gdGhpcy5fcGFydHMuaG9zdG5hbWUubGVuZ3RoIC0gdGhpcy5kb21haW4oKS5sZW5ndGggLSAxOwogICAgICByZXR1cm4gdGhpcy5fcGFydHMuaG9zdG5hbWUuc3Vic3RyaW5nKDAsIGVuZCkgfHwgJyc7CiAgICB9IGVsc2UgewogICAgICB2YXIgZSA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLmxlbmd0aCAtIHRoaXMuZG9tYWluKCkubGVuZ3RoOwogICAgICB2YXIgc3ViID0gdGhpcy5fcGFydHMuaG9zdG5hbWUuc3Vic3RyaW5nKDAsIGUpOwogICAgICB2YXIgcmVwbGFjZSA9IG5ldyBSZWdFeHAoJ14nICsgZXNjYXBlUmVnRXgoc3ViKSk7CgogICAgICBpZiAodiAmJiB2LmNoYXJBdCh2Lmxlbmd0aCAtIDEpICE9PSAnLicpIHsKICAgICAgICB2ICs9ICcuJzsKICAgICAgfQoKICAgICAgaWYgKHYpIHsKICAgICAgICBVUkkuZW5zdXJlVmFsaWRIb3N0bmFtZSh2KTsKICAgICAgfQoKICAgICAgdGhpcy5fcGFydHMuaG9zdG5hbWUgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5yZXBsYWNlKHJlcGxhY2UsIHYpOwogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcC5kb21haW4gPSBmdW5jdGlvbih2LCBidWlsZCkgewogICAgaWYgKHRoaXMuX3BhcnRzLnVybikgewogICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzOwogICAgfQoKICAgIGlmICh0eXBlb2YgdiA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgIGJ1aWxkID0gdjsKICAgICAgdiA9IHVuZGVmaW5lZDsKICAgIH0KCiAgICAvLyBjb252ZW5pZW5jZSwgcmV0dXJuICJleGFtcGxlLm9yZyIgZnJvbSAid3d3LmV4YW1wbGUub3JnIgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICBpZiAoIXRoaXMuX3BhcnRzLmhvc3RuYW1lIHx8IHRoaXMuaXMoJ0lQJykpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICAgIC8vIGlmIGhvc3RuYW1lIGNvbnNpc3RzIG9mIDEgb3IgMiBzZWdtZW50cywgaXQgbXVzdCBiZSB0aGUgZG9tYWluCiAgICAgIHZhciB0ID0gdGhpcy5fcGFydHMuaG9zdG5hbWUubWF0Y2goL1wuL2cpOwogICAgICBpZiAodCAmJiB0Lmxlbmd0aCA8IDIpIHsKICAgICAgICByZXR1cm4gdGhpcy5fcGFydHMuaG9zdG5hbWU7CiAgICAgIH0KCiAgICAgIC8vIGdyYWIgdGxkIGFuZCBhZGQgYW5vdGhlciBzZWdtZW50CiAgICAgIHZhciBlbmQgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5sZW5ndGggLSB0aGlzLnRsZChidWlsZCkubGVuZ3RoIC0gMTsKICAgICAgZW5kID0gdGhpcy5fcGFydHMuaG9zdG5hbWUubGFzdEluZGV4T2YoJy4nLCBlbmQgLTEpICsgMTsKICAgICAgcmV0dXJuIHRoaXMuX3BhcnRzLmhvc3RuYW1lLnN1YnN0cmluZyhlbmQpIHx8ICcnOwogICAgfSBlbHNlIHsKICAgICAgaWYgKCF2KSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignY2Fubm90IHNldCBkb21haW4gZW1wdHknKTsKICAgICAgfQoKICAgICAgVVJJLmVuc3VyZVZhbGlkSG9zdG5hbWUodik7CgogICAgICBpZiAoIXRoaXMuX3BhcnRzLmhvc3RuYW1lIHx8IHRoaXMuaXMoJ0lQJykpIHsKICAgICAgICB0aGlzLl9wYXJ0cy5ob3N0bmFtZSA9IHY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIHJlcGxhY2UgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4KHRoaXMuZG9tYWluKCkpICsgJyQnKTsKICAgICAgICB0aGlzLl9wYXJ0cy5ob3N0bmFtZSA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLnJlcGxhY2UocmVwbGFjZSwgdik7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKICBwLnRsZCA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHR5cGVvZiB2ID09PSAnYm9vbGVhbicpIHsKICAgICAgYnVpbGQgPSB2OwogICAgICB2ID0gdW5kZWZpbmVkOwogICAgfQoKICAgIC8vIHJldHVybiAib3JnIiBmcm9tICJ3d3cuZXhhbXBsZS5vcmciCiAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICghdGhpcy5fcGFydHMuaG9zdG5hbWUgfHwgdGhpcy5pcygnSVAnKSkgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgdmFyIHBvcyA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLmxhc3RJbmRleE9mKCcuJyk7CiAgICAgIHZhciB0bGQgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5zdWJzdHJpbmcocG9zICsgMSk7CgogICAgICBpZiAoYnVpbGQgIT09IHRydWUgJiYgU0xEICYmIFNMRC5saXN0W3RsZC50b0xvd2VyQ2FzZSgpXSkgewogICAgICAgIHJldHVybiBTTEQuZ2V0KHRoaXMuX3BhcnRzLmhvc3RuYW1lKSB8fCB0bGQ7CiAgICAgIH0KCiAgICAgIHJldHVybiB0bGQ7CiAgICB9IGVsc2UgewogICAgICB2YXIgcmVwbGFjZTsKCiAgICAgIGlmICghdikgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2Nhbm5vdCBzZXQgVExEIGVtcHR5Jyk7CiAgICAgIH0gZWxzZSBpZiAodi5tYXRjaCgvW15hLXpBLVowLTktXS8pKSB7CiAgICAgICAgaWYgKFNMRCAmJiBTTEQuaXModikpIHsKICAgICAgICAgIHJlcGxhY2UgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4KHRoaXMudGxkKCkpICsgJyQnKTsKICAgICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gdGhpcy5fcGFydHMuaG9zdG5hbWUucmVwbGFjZShyZXBsYWNlLCB2KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVExEICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05XScpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICghdGhpcy5fcGFydHMuaG9zdG5hbWUgfHwgdGhpcy5pcygnSVAnKSkgewogICAgICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcignY2Fubm90IHNldCBUTEQgb24gbm9uLWRvbWFpbiBob3N0Jyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVwbGFjZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXgodGhpcy50bGQoKSkgKyAnJCcpOwogICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gdGhpcy5fcGFydHMuaG9zdG5hbWUucmVwbGFjZShyZXBsYWNlLCB2KTsKICAgICAgfQoKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwogIHAuZGlyZWN0b3J5ID0gZnVuY3Rpb24odiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICBpZiAodiA9PT0gdW5kZWZpbmVkIHx8IHYgPT09IHRydWUpIHsKICAgICAgaWYgKCF0aGlzLl9wYXJ0cy5wYXRoICYmICF0aGlzLl9wYXJ0cy5ob3N0bmFtZSkgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuX3BhcnRzLnBhdGggPT09ICcvJykgewogICAgICAgIHJldHVybiAnLyc7CiAgICAgIH0KCiAgICAgIHZhciBlbmQgPSB0aGlzLl9wYXJ0cy5wYXRoLmxlbmd0aCAtIHRoaXMuZmlsZW5hbWUoKS5sZW5ndGggLSAxOwogICAgICB2YXIgcmVzID0gdGhpcy5fcGFydHMucGF0aC5zdWJzdHJpbmcoMCwgZW5kKSB8fCAodGhpcy5fcGFydHMuaG9zdG5hbWUgPyAnLycgOiAnJyk7CgogICAgICByZXR1cm4gdiA/IFVSSS5kZWNvZGVQYXRoKHJlcykgOiByZXM7CgogICAgfSBlbHNlIHsKICAgICAgdmFyIGUgPSB0aGlzLl9wYXJ0cy5wYXRoLmxlbmd0aCAtIHRoaXMuZmlsZW5hbWUoKS5sZW5ndGg7CiAgICAgIHZhciBkaXJlY3RvcnkgPSB0aGlzLl9wYXJ0cy5wYXRoLnN1YnN0cmluZygwLCBlKTsKICAgICAgdmFyIHJlcGxhY2UgPSBuZXcgUmVnRXhwKCdeJyArIGVzY2FwZVJlZ0V4KGRpcmVjdG9yeSkpOwoKICAgICAgLy8gZnVsbHkgcXVhbGlmaWVyIGRpcmVjdG9yaWVzIGJlZ2luIHdpdGggYSBzbGFzaAogICAgICBpZiAoIXRoaXMuaXMoJ3JlbGF0aXZlJykpIHsKICAgICAgICBpZiAoIXYpIHsKICAgICAgICAgIHYgPSAnLyc7CiAgICAgICAgfQoKICAgICAgICBpZiAodi5jaGFyQXQoMCkgIT09ICcvJykgewogICAgICAgICAgdiA9ICcvJyArIHY7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBkaXJlY3RvcmllcyBhbHdheXMgZW5kIHdpdGggYSBzbGFzaAogICAgICBpZiAodiAmJiB2LmNoYXJBdCh2Lmxlbmd0aCAtIDEpICE9PSAnLycpIHsKICAgICAgICB2ICs9ICcvJzsKICAgICAgfQoKICAgICAgdiA9IFVSSS5yZWNvZGVQYXRoKHYpOwogICAgICB0aGlzLl9wYXJ0cy5wYXRoID0gdGhpcy5fcGFydHMucGF0aC5yZXBsYWNlKHJlcGxhY2UsIHYpOwogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcC5maWxlbmFtZSA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCB8fCB2ID09PSB0cnVlKSB7CiAgICAgIGlmICghdGhpcy5fcGFydHMucGF0aCB8fCB0aGlzLl9wYXJ0cy5wYXRoID09PSAnLycpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICAgIHZhciBwb3MgPSB0aGlzLl9wYXJ0cy5wYXRoLmxhc3RJbmRleE9mKCcvJyk7CiAgICAgIHZhciByZXMgPSB0aGlzLl9wYXJ0cy5wYXRoLnN1YnN0cmluZyhwb3MrMSk7CgogICAgICByZXR1cm4gdiA/IFVSSS5kZWNvZGVQYXRoU2VnbWVudChyZXMpIDogcmVzOwogICAgfSBlbHNlIHsKICAgICAgdmFyIG11dGF0ZWREaXJlY3RvcnkgPSBmYWxzZTsKCiAgICAgIGlmICh2LmNoYXJBdCgwKSA9PT0gJy8nKSB7CiAgICAgICAgdiA9IHYuc3Vic3RyaW5nKDEpOwogICAgICB9CgogICAgICBpZiAodi5tYXRjaCgvXC4/XC8vKSkgewogICAgICAgIG11dGF0ZWREaXJlY3RvcnkgPSB0cnVlOwogICAgICB9CgogICAgICB2YXIgcmVwbGFjZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXgodGhpcy5maWxlbmFtZSgpKSArICckJyk7CiAgICAgIHYgPSBVUkkucmVjb2RlUGF0aCh2KTsKICAgICAgdGhpcy5fcGFydHMucGF0aCA9IHRoaXMuX3BhcnRzLnBhdGgucmVwbGFjZShyZXBsYWNlLCB2KTsKCiAgICAgIGlmIChtdXRhdGVkRGlyZWN0b3J5KSB7CiAgICAgICAgdGhpcy5ub3JtYWxpemVQYXRoKGJ1aWxkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcC5zdWZmaXggPSBmdW5jdGlvbih2LCBidWlsZCkgewogICAgaWYgKHRoaXMuX3BhcnRzLnVybikgewogICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzOwogICAgfQoKICAgIGlmICh2ID09PSB1bmRlZmluZWQgfHwgdiA9PT0gdHJ1ZSkgewogICAgICBpZiAoIXRoaXMuX3BhcnRzLnBhdGggfHwgdGhpcy5fcGFydHMucGF0aCA9PT0gJy8nKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICB2YXIgZmlsZW5hbWUgPSB0aGlzLmZpbGVuYW1lKCk7CiAgICAgIHZhciBwb3MgPSBmaWxlbmFtZS5sYXN0SW5kZXhPZignLicpOwogICAgICB2YXIgcywgcmVzOwoKICAgICAgaWYgKHBvcyA9PT0gLTEpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICAgIC8vIHN1ZmZpeCBtYXkgb25seSBjb250YWluIGFsbnVtIGNoYXJhY3RlcnMgKHl1cCwgSSBtYWRlIHRoaXMgdXAuKQogICAgICBzID0gZmlsZW5hbWUuc3Vic3RyaW5nKHBvcysxKTsKICAgICAgcmVzID0gKC9eW2EtejAtOSVdKyQvaSkudGVzdChzKSA/IHMgOiAnJzsKICAgICAgcmV0dXJuIHYgPyBVUkkuZGVjb2RlUGF0aFNlZ21lbnQocmVzKSA6IHJlczsKICAgIH0gZWxzZSB7CiAgICAgIGlmICh2LmNoYXJBdCgwKSA9PT0gJy4nKSB7CiAgICAgICAgdiA9IHYuc3Vic3RyaW5nKDEpOwogICAgICB9CgogICAgICB2YXIgc3VmZml4ID0gdGhpcy5zdWZmaXgoKTsKICAgICAgdmFyIHJlcGxhY2U7CgogICAgICBpZiAoIXN1ZmZpeCkgewogICAgICAgIGlmICghdikgewogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9wYXJ0cy5wYXRoICs9ICcuJyArIFVSSS5yZWNvZGVQYXRoKHYpOwogICAgICB9IGVsc2UgaWYgKCF2KSB7CiAgICAgICAgcmVwbGFjZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXgoJy4nICsgc3VmZml4KSArICckJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVwbGFjZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXgoc3VmZml4KSArICckJyk7CiAgICAgIH0KCiAgICAgIGlmIChyZXBsYWNlKSB7CiAgICAgICAgdiA9IFVSSS5yZWNvZGVQYXRoKHYpOwogICAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSB0aGlzLl9wYXJ0cy5wYXRoLnJlcGxhY2UocmVwbGFjZSwgdik7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKICBwLnNlZ21lbnQgPSBmdW5jdGlvbihzZWdtZW50LCB2LCBidWlsZCkgewogICAgdmFyIHNlcGFyYXRvciA9IHRoaXMuX3BhcnRzLnVybiA/ICc6JyA6ICcvJzsKICAgIHZhciBwYXRoID0gdGhpcy5wYXRoKCk7CiAgICB2YXIgYWJzb2x1dGUgPSBwYXRoLnN1YnN0cmluZygwLCAxKSA9PT0gJy8nOwogICAgdmFyIHNlZ21lbnRzID0gcGF0aC5zcGxpdChzZXBhcmF0b3IpOwoKICAgIGlmIChzZWdtZW50ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHNlZ21lbnQgIT09ICdudW1iZXInKSB7CiAgICAgIGJ1aWxkID0gdjsKICAgICAgdiA9IHNlZ21lbnQ7CiAgICAgIHNlZ21lbnQgPSB1bmRlZmluZWQ7CiAgICB9CgogICAgaWYgKHNlZ21lbnQgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygc2VnbWVudCAhPT0gJ251bWJlcicpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdCYWQgc2VnbWVudCAiJyArIHNlZ21lbnQgKyAnIiwgbXVzdCBiZSAwLWJhc2VkIGludGVnZXInKTsKICAgIH0KCiAgICBpZiAoYWJzb2x1dGUpIHsKICAgICAgc2VnbWVudHMuc2hpZnQoKTsKICAgIH0KCiAgICBpZiAoc2VnbWVudCA8IDApIHsKICAgICAgLy8gYWxsb3cgbmVnYXRpdmUgaW5kZXhlcyB0byBhZGRyZXNzIGZyb20gdGhlIGVuZAogICAgICBzZWdtZW50ID0gTWF0aC5tYXgoc2VnbWVudHMubGVuZ3RoICsgc2VnbWVudCwgMCk7CiAgICB9CgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICAvKmpzaGludCBsYXhicmVhazogdHJ1ZSAqLwogICAgICByZXR1cm4gc2VnbWVudCA9PT0gdW5kZWZpbmVkCiAgICAgICAgPyBzZWdtZW50cwogICAgICAgIDogc2VnbWVudHNbc2VnbWVudF07CiAgICAgIC8qanNoaW50IGxheGJyZWFrOiBmYWxzZSAqLwogICAgfSBlbHNlIGlmIChzZWdtZW50ID09PSBudWxsIHx8IHNlZ21lbnRzW3NlZ21lbnRdID09PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKGlzQXJyYXkodikpIHsKICAgICAgICBzZWdtZW50cyA9IFtdOwogICAgICAgIC8vIGNvbGxhcHNlIGVtcHR5IGVsZW1lbnRzIHdpdGhpbiBhcnJheQogICAgICAgIGZvciAodmFyIGk9MCwgbD12Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgaWYgKCF2W2ldLmxlbmd0aCAmJiAoIXNlZ21lbnRzLmxlbmd0aCB8fCAhc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0xXS5sZW5ndGgpKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChzZWdtZW50cy5sZW5ndGggJiYgIXNlZ21lbnRzW3NlZ21lbnRzLmxlbmd0aCAtMV0ubGVuZ3RoKSB7CiAgICAgICAgICAgIHNlZ21lbnRzLnBvcCgpOwogICAgICAgICAgfQoKICAgICAgICAgIHNlZ21lbnRzLnB1c2godHJpbVNsYXNoZXModltpXSkpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh2IHx8IHR5cGVvZiB2ID09PSAnc3RyaW5nJykgewogICAgICAgIHYgPSB0cmltU2xhc2hlcyh2KTsKICAgICAgICBpZiAoc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0xXSA9PT0gJycpIHsKICAgICAgICAgIC8vIGVtcHR5IHRyYWlsaW5nIGVsZW1lbnRzIGhhdmUgdG8gYmUgb3ZlcndyaXR0ZW4KICAgICAgICAgIC8vIHRvIHByZXZlbnQgcmVzdWx0cyBzdWNoIGFzIC9mb28vL2JhcgogICAgICAgICAgc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0xXSA9IHY7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNlZ21lbnRzLnB1c2godik7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAodikgewogICAgICAgIHNlZ21lbnRzW3NlZ21lbnRdID0gdHJpbVNsYXNoZXModik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2VnbWVudHMuc3BsaWNlKHNlZ21lbnQsIDEpOwogICAgICB9CiAgICB9CgogICAgaWYgKGFic29sdXRlKSB7CiAgICAgIHNlZ21lbnRzLnVuc2hpZnQoJycpOwogICAgfQoKICAgIHJldHVybiB0aGlzLnBhdGgoc2VnbWVudHMuam9pbihzZXBhcmF0b3IpLCBidWlsZCk7CiAgfTsKICBwLnNlZ21lbnRDb2RlZCA9IGZ1bmN0aW9uKHNlZ21lbnQsIHYsIGJ1aWxkKSB7CiAgICB2YXIgc2VnbWVudHMsIGksIGw7CgogICAgaWYgKHR5cGVvZiBzZWdtZW50ICE9PSAnbnVtYmVyJykgewogICAgICBidWlsZCA9IHY7CiAgICAgIHYgPSBzZWdtZW50OwogICAgICBzZWdtZW50ID0gdW5kZWZpbmVkOwogICAgfQoKICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHsKICAgICAgc2VnbWVudHMgPSB0aGlzLnNlZ21lbnQoc2VnbWVudCwgdiwgYnVpbGQpOwogICAgICBpZiAoIWlzQXJyYXkoc2VnbWVudHMpKSB7CiAgICAgICAgc2VnbWVudHMgPSBzZWdtZW50cyAhPT0gdW5kZWZpbmVkID8gVVJJLmRlY29kZShzZWdtZW50cykgOiB1bmRlZmluZWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChpID0gMCwgbCA9IHNlZ21lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgc2VnbWVudHNbaV0gPSBVUkkuZGVjb2RlKHNlZ21lbnRzW2ldKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBzZWdtZW50czsKICAgIH0KCiAgICBpZiAoIWlzQXJyYXkodikpIHsKICAgICAgdiA9ICh0eXBlb2YgdiA9PT0gJ3N0cmluZycgfHwgdiBpbnN0YW5jZW9mIFN0cmluZykgPyBVUkkuZW5jb2RlKHYpIDogdjsKICAgIH0gZWxzZSB7CiAgICAgIGZvciAoaSA9IDAsIGwgPSB2Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZbaV0gPSBVUkkuZW5jb2RlKHZbaV0pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRoaXMuc2VnbWVudChzZWdtZW50LCB2LCBidWlsZCk7CiAgfTsKCiAgLy8gbXV0YXRpbmcgcXVlcnkgc3RyaW5nCiAgdmFyIHEgPSBwLnF1ZXJ5OwogIHAucXVlcnkgPSBmdW5jdGlvbih2LCBidWlsZCkgewogICAgaWYgKHYgPT09IHRydWUpIHsKICAgICAgcmV0dXJuIFVSSS5wYXJzZVF1ZXJ5KHRoaXMuX3BhcnRzLnF1ZXJ5LCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIHYgPT09ICdmdW5jdGlvbicpIHsKICAgICAgdmFyIGRhdGEgPSBVUkkucGFyc2VRdWVyeSh0aGlzLl9wYXJ0cy5xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7CiAgICAgIHZhciByZXN1bHQgPSB2LmNhbGwodGhpcywgZGF0YSk7CiAgICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gVVJJLmJ1aWxkUXVlcnkocmVzdWx0IHx8IGRhdGEsIHRoaXMuX3BhcnRzLmR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycywgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7CiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9IGVsc2UgaWYgKHYgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgdiAhPT0gJ3N0cmluZycpIHsKICAgICAgdGhpcy5fcGFydHMucXVlcnkgPSBVUkkuYnVpbGRRdWVyeSh2LCB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMsIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHEuY2FsbCh0aGlzLCB2LCBidWlsZCk7CiAgICB9CiAgfTsKICBwLnNldFF1ZXJ5ID0gZnVuY3Rpb24obmFtZSwgdmFsdWUsIGJ1aWxkKSB7CiAgICB2YXIgZGF0YSA9IFVSSS5wYXJzZVF1ZXJ5KHRoaXMuX3BhcnRzLnF1ZXJ5LCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTsKCiAgICBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnIHx8IG5hbWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgZGF0YVtuYW1lXSA9IHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IG51bGw7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0JykgewogICAgICBmb3IgKHZhciBrZXkgaW4gbmFtZSkgewogICAgICAgIGlmIChoYXNPd24uY2FsbChuYW1lLCBrZXkpKSB7CiAgICAgICAgICBkYXRhW2tleV0gPSBuYW1lW2tleV07CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVUkkuYWRkUXVlcnkoKSBhY2NlcHRzIGFuIG9iamVjdCwgc3RyaW5nIGFzIHRoZSBuYW1lIHBhcmFtZXRlcicpOwogICAgfQoKICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gVVJJLmJ1aWxkUXVlcnkoZGF0YSwgdGhpcy5fcGFydHMuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTsKICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHsKICAgICAgYnVpbGQgPSB2YWx1ZTsKICAgIH0KCiAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICByZXR1cm4gdGhpczsKICB9OwogIHAuYWRkUXVlcnkgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSwgYnVpbGQpIHsKICAgIHZhciBkYXRhID0gVVJJLnBhcnNlUXVlcnkodGhpcy5fcGFydHMucXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgVVJJLmFkZFF1ZXJ5KGRhdGEsIG5hbWUsIHZhbHVlID09PSB1bmRlZmluZWQgPyBudWxsIDogdmFsdWUpOwogICAgdGhpcy5fcGFydHMucXVlcnkgPSBVUkkuYnVpbGRRdWVyeShkYXRhLCB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMsIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykgewogICAgICBidWlsZCA9IHZhbHVlOwogICAgfQoKICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIHJldHVybiB0aGlzOwogIH07CiAgcC5yZW1vdmVRdWVyeSA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlLCBidWlsZCkgewogICAgdmFyIGRhdGEgPSBVUkkucGFyc2VRdWVyeSh0aGlzLl9wYXJ0cy5xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7CiAgICBVUkkucmVtb3ZlUXVlcnkoZGF0YSwgbmFtZSwgdmFsdWUpOwogICAgdGhpcy5fcGFydHMucXVlcnkgPSBVUkkuYnVpbGRRdWVyeShkYXRhLCB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMsIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykgewogICAgICBidWlsZCA9IHZhbHVlOwogICAgfQoKICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIHJldHVybiB0aGlzOwogIH07CiAgcC5oYXNRdWVyeSA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlLCB3aXRoaW5BcnJheSkgewogICAgdmFyIGRhdGEgPSBVUkkucGFyc2VRdWVyeSh0aGlzLl9wYXJ0cy5xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7CiAgICByZXR1cm4gVVJJLmhhc1F1ZXJ5KGRhdGEsIG5hbWUsIHZhbHVlLCB3aXRoaW5BcnJheSk7CiAgfTsKICBwLnNldFNlYXJjaCA9IHAuc2V0UXVlcnk7CiAgcC5hZGRTZWFyY2ggPSBwLmFkZFF1ZXJ5OwogIHAucmVtb3ZlU2VhcmNoID0gcC5yZW1vdmVRdWVyeTsKICBwLmhhc1NlYXJjaCA9IHAuaGFzUXVlcnk7CgogIC8vIHNhbml0aXppbmcgVVJMcwogIHAubm9ybWFsaXplID0gZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB0aGlzCiAgICAgICAgLm5vcm1hbGl6ZVByb3RvY29sKGZhbHNlKQogICAgICAgIC5ub3JtYWxpemVQYXRoKGZhbHNlKQogICAgICAgIC5ub3JtYWxpemVRdWVyeShmYWxzZSkKICAgICAgICAubm9ybWFsaXplRnJhZ21lbnQoZmFsc2UpCiAgICAgICAgLmJ1aWxkKCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMKICAgICAgLm5vcm1hbGl6ZVByb3RvY29sKGZhbHNlKQogICAgICAubm9ybWFsaXplSG9zdG5hbWUoZmFsc2UpCiAgICAgIC5ub3JtYWxpemVQb3J0KGZhbHNlKQogICAgICAubm9ybWFsaXplUGF0aChmYWxzZSkKICAgICAgLm5vcm1hbGl6ZVF1ZXJ5KGZhbHNlKQogICAgICAubm9ybWFsaXplRnJhZ21lbnQoZmFsc2UpCiAgICAgIC5idWlsZCgpOwogIH07CiAgcC5ub3JtYWxpemVQcm90b2NvbCA9IGZ1bmN0aW9uKGJ1aWxkKSB7CiAgICBpZiAodHlwZW9mIHRoaXMuX3BhcnRzLnByb3RvY29sID09PSAnc3RyaW5nJykgewogICAgICB0aGlzLl9wYXJ0cy5wcm90b2NvbCA9IHRoaXMuX3BhcnRzLnByb3RvY29sLnRvTG93ZXJDYXNlKCk7CiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwogIHAubm9ybWFsaXplSG9zdG5hbWUgPSBmdW5jdGlvbihidWlsZCkgewogICAgaWYgKHRoaXMuX3BhcnRzLmhvc3RuYW1lKSB7CiAgICAgIGlmICh0aGlzLmlzKCdJRE4nKSAmJiBwdW55Y29kZSkgewogICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gcHVueWNvZGUudG9BU0NJSSh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pcygnSVB2NicpICYmIElQdjYpIHsKICAgICAgICB0aGlzLl9wYXJ0cy5ob3N0bmFtZSA9IElQdjYuYmVzdCh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICAgIH0KCiAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gdGhpcy5fcGFydHMuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH07CiAgcC5ub3JtYWxpemVQb3J0ID0gZnVuY3Rpb24oYnVpbGQpIHsKICAgIC8vIHJlbW92ZSBwb3J0IG9mIGl0J3MgdGhlIHByb3RvY29sJ3MgZGVmYXVsdAogICAgaWYgKHR5cGVvZiB0aGlzLl9wYXJ0cy5wcm90b2NvbCA9PT0gJ3N0cmluZycgJiYgdGhpcy5fcGFydHMucG9ydCA9PT0gVVJJLmRlZmF1bHRQb3J0c1t0aGlzLl9wYXJ0cy5wcm90b2NvbF0pIHsKICAgICAgdGhpcy5fcGFydHMucG9ydCA9IG51bGw7CiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwogIHAubm9ybWFsaXplUGF0aCA9IGZ1bmN0aW9uKGJ1aWxkKSB7CiAgICB2YXIgX3BhdGggPSB0aGlzLl9wYXJ0cy5wYXRoOwogICAgaWYgKCFfcGF0aCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSBVUkkucmVjb2RlVXJuUGF0aCh0aGlzLl9wYXJ0cy5wYXRoKTsKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBpZiAodGhpcy5fcGFydHMucGF0aCA9PT0gJy8nKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIF9wYXRoID0gVVJJLnJlY29kZVBhdGgoX3BhdGgpOwoKICAgIHZhciBfd2FzX3JlbGF0aXZlOwogICAgdmFyIF9sZWFkaW5nUGFyZW50cyA9ICcnOwogICAgdmFyIF9wYXJlbnQsIF9wb3M7CgogICAgLy8gaGFuZGxlIHJlbGF0aXZlIHBhdGhzCiAgICBpZiAoX3BhdGguY2hhckF0KDApICE9PSAnLycpIHsKICAgICAgX3dhc19yZWxhdGl2ZSA9IHRydWU7CiAgICAgIF9wYXRoID0gJy8nICsgX3BhdGg7CiAgICB9CgogICAgLy8gaGFuZGxlIHJlbGF0aXZlIGZpbGVzIChhcyBvcHBvc2VkIHRvIGRpcmVjdG9yaWVzKQogICAgaWYgKF9wYXRoLnNsaWNlKC0zKSA9PT0gJy8uLicgfHwgX3BhdGguc2xpY2UoLTIpID09PSAnLy4nKSB7CiAgICAgIF9wYXRoICs9ICcvJzsKICAgIH0KCiAgICAvLyByZXNvbHZlIHNpbXBsZXMKICAgIF9wYXRoID0gX3BhdGgKICAgICAgLnJlcGxhY2UoLyhcLyhcLlwvKSspfChcL1wuJCkvZywgJy8nKQogICAgICAucmVwbGFjZSgvXC97Mix9L2csICcvJyk7CgogICAgLy8gcmVtZW1iZXIgbGVhZGluZyBwYXJlbnRzCiAgICBpZiAoX3dhc19yZWxhdGl2ZSkgewogICAgICBfbGVhZGluZ1BhcmVudHMgPSBfcGF0aC5zdWJzdHJpbmcoMSkubWF0Y2goL14oXC5cLlwvKSsvKSB8fCAnJzsKICAgICAgaWYgKF9sZWFkaW5nUGFyZW50cykgewogICAgICAgIF9sZWFkaW5nUGFyZW50cyA9IF9sZWFkaW5nUGFyZW50c1swXTsKICAgICAgfQogICAgfQoKICAgIC8vIHJlc29sdmUgcGFyZW50cwogICAgd2hpbGUgKHRydWUpIHsKICAgICAgX3BhcmVudCA9IF9wYXRoLnNlYXJjaCgvXC9cLlwuKFwvfCQpLyk7CiAgICAgIGlmIChfcGFyZW50ID09PSAtMSkgewogICAgICAgIC8vIG5vIG1vcmUgLi4vIHRvIHJlc29sdmUKICAgICAgICBicmVhazsKICAgICAgfSBlbHNlIGlmIChfcGFyZW50ID09PSAwKSB7CiAgICAgICAgLy8gdG9wIGxldmVsIGNhbm5vdCBiZSByZWxhdGl2ZSwgc2tpcCBpdAogICAgICAgIF9wYXRoID0gX3BhdGguc3Vic3RyaW5nKDMpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBfcG9zID0gX3BhdGguc3Vic3RyaW5nKDAsIF9wYXJlbnQpLmxhc3RJbmRleE9mKCcvJyk7CiAgICAgIGlmIChfcG9zID09PSAtMSkgewogICAgICAgIF9wb3MgPSBfcGFyZW50OwogICAgICB9CiAgICAgIF9wYXRoID0gX3BhdGguc3Vic3RyaW5nKDAsIF9wb3MpICsgX3BhdGguc3Vic3RyaW5nKF9wYXJlbnQgKyAzKTsKICAgIH0KCiAgICAvLyByZXZlcnQgdG8gcmVsYXRpdmUKICAgIGlmIChfd2FzX3JlbGF0aXZlICYmIHRoaXMuaXMoJ3JlbGF0aXZlJykpIHsKICAgICAgX3BhdGggPSBfbGVhZGluZ1BhcmVudHMgKyBfcGF0aC5zdWJzdHJpbmcoMSk7CiAgICB9CgogICAgdGhpcy5fcGFydHMucGF0aCA9IF9wYXRoOwogICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKICBwLm5vcm1hbGl6ZVBhdGhuYW1lID0gcC5ub3JtYWxpemVQYXRoOwogIHAubm9ybWFsaXplUXVlcnkgPSBmdW5jdGlvbihidWlsZCkgewogICAgaWYgKHR5cGVvZiB0aGlzLl9wYXJ0cy5xdWVyeSA9PT0gJ3N0cmluZycpIHsKICAgICAgaWYgKCF0aGlzLl9wYXJ0cy5xdWVyeS5sZW5ndGgpIHsKICAgICAgICB0aGlzLl9wYXJ0cy5xdWVyeSA9IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5xdWVyeShVUkkucGFyc2VRdWVyeSh0aGlzLl9wYXJ0cy5xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSkpOwogICAgICB9CgogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKICBwLm5vcm1hbGl6ZUZyYWdtZW50ID0gZnVuY3Rpb24oYnVpbGQpIHsKICAgIGlmICghdGhpcy5fcGFydHMuZnJhZ21lbnQpIHsKICAgICAgdGhpcy5fcGFydHMuZnJhZ21lbnQgPSBudWxsOwogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKICBwLm5vcm1hbGl6ZVNlYXJjaCA9IHAubm9ybWFsaXplUXVlcnk7CiAgcC5ub3JtYWxpemVIYXNoID0gcC5ub3JtYWxpemVGcmFnbWVudDsKCiAgcC5pc284ODU5ID0gZnVuY3Rpb24oKSB7CiAgICAvLyBleHBlY3QgdW5pY29kZSBpbnB1dCwgaXNvODg1OSBvdXRwdXQKICAgIHZhciBlID0gVVJJLmVuY29kZTsKICAgIHZhciBkID0gVVJJLmRlY29kZTsKCiAgICBVUkkuZW5jb2RlID0gZXNjYXBlOwogICAgVVJJLmRlY29kZSA9IGRlY29kZVVSSUNvbXBvbmVudDsKICAgIHRyeSB7CiAgICAgIHRoaXMubm9ybWFsaXplKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBVUkkuZW5jb2RlID0gZTsKICAgICAgVVJJLmRlY29kZSA9IGQ7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9OwoKICBwLnVuaWNvZGUgPSBmdW5jdGlvbigpIHsKICAgIC8vIGV4cGVjdCBpc284ODU5IGlucHV0LCB1bmljb2RlIG91dHB1dAogICAgdmFyIGUgPSBVUkkuZW5jb2RlOwogICAgdmFyIGQgPSBVUkkuZGVjb2RlOwoKICAgIFVSSS5lbmNvZGUgPSBzdHJpY3RFbmNvZGVVUklDb21wb25lbnQ7CiAgICBVUkkuZGVjb2RlID0gdW5lc2NhcGU7CiAgICB0cnkgewogICAgICB0aGlzLm5vcm1hbGl6ZSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgVVJJLmVuY29kZSA9IGU7CiAgICAgIFVSSS5kZWNvZGUgPSBkOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgcC5yZWFkYWJsZSA9IGZ1bmN0aW9uKCkgewogICAgdmFyIHVyaSA9IHRoaXMuY2xvbmUoKTsKICAgIC8vIHJlbW92aW5nIHVzZXJuYW1lLCBwYXNzd29yZCwgYmVjYXVzZSB0aGV5IHNob3VsZG4ndCBiZSBkaXNwbGF5ZWQgYWNjb3JkaW5nIHRvIFJGQyAzOTg2CiAgICB1cmkudXNlcm5hbWUoJycpLnBhc3N3b3JkKCcnKS5ub3JtYWxpemUoKTsKICAgIHZhciB0ID0gJyc7CiAgICBpZiAodXJpLl9wYXJ0cy5wcm90b2NvbCkgewogICAgICB0ICs9IHVyaS5fcGFydHMucHJvdG9jb2wgKyAnOi8vJzsKICAgIH0KCiAgICBpZiAodXJpLl9wYXJ0cy5ob3N0bmFtZSkgewogICAgICBpZiAodXJpLmlzKCdwdW55Y29kZScpICYmIHB1bnljb2RlKSB7CiAgICAgICAgdCArPSBwdW55Y29kZS50b1VuaWNvZGUodXJpLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICAgICAgaWYgKHVyaS5fcGFydHMucG9ydCkgewogICAgICAgICAgdCArPSAnOicgKyB1cmkuX3BhcnRzLnBvcnQ7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHQgKz0gdXJpLmhvc3QoKTsKICAgICAgfQogICAgfQoKICAgIGlmICh1cmkuX3BhcnRzLmhvc3RuYW1lICYmIHVyaS5fcGFydHMucGF0aCAmJiB1cmkuX3BhcnRzLnBhdGguY2hhckF0KDApICE9PSAnLycpIHsKICAgICAgdCArPSAnLyc7CiAgICB9CgogICAgdCArPSB1cmkucGF0aCh0cnVlKTsKICAgIGlmICh1cmkuX3BhcnRzLnF1ZXJ5KSB7CiAgICAgIHZhciBxID0gJyc7CiAgICAgIGZvciAodmFyIGkgPSAwLCBxcCA9IHVyaS5fcGFydHMucXVlcnkuc3BsaXQoJyYnKSwgbCA9IHFwLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZhciBrdiA9IChxcFtpXSB8fCAnJykuc3BsaXQoJz0nKTsKICAgICAgICBxICs9ICcmJyArIFVSSS5kZWNvZGVRdWVyeShrdlswXSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSkKICAgICAgICAgIC5yZXBsYWNlKC8mL2csICclMjYnKTsKCiAgICAgICAgaWYgKGt2WzFdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHEgKz0gJz0nICsgVVJJLmRlY29kZVF1ZXJ5KGt2WzFdLCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKQogICAgICAgICAgICAucmVwbGFjZSgvJi9nLCAnJTI2Jyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHQgKz0gJz8nICsgcS5zdWJzdHJpbmcoMSk7CiAgICB9CgogICAgdCArPSBVUkkuZGVjb2RlUXVlcnkodXJpLmhhc2goKSwgdHJ1ZSk7CiAgICByZXR1cm4gdDsKICB9OwoKICAvLyByZXNvbHZpbmcgcmVsYXRpdmUgYW5kIGFic29sdXRlIFVSTHMKICBwLmFic29sdXRlVG8gPSBmdW5jdGlvbihiYXNlKSB7CiAgICB2YXIgcmVzb2x2ZWQgPSB0aGlzLmNsb25lKCk7CiAgICB2YXIgcHJvcGVydGllcyA9IFsncHJvdG9jb2wnLCAndXNlcm5hbWUnLCAncGFzc3dvcmQnLCAnaG9zdG5hbWUnLCAncG9ydCddOwogICAgdmFyIGJhc2VkaXIsIGksIHA7CgogICAgaWYgKHRoaXMuX3BhcnRzLnVybikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VSTnMgZG8gbm90IGhhdmUgYW55IGdlbmVyYWxseSBkZWZpbmVkIGhpZXJhcmNoaWNhbCBjb21wb25lbnRzJyk7CiAgICB9CgogICAgaWYgKCEoYmFzZSBpbnN0YW5jZW9mIFVSSSkpIHsKICAgICAgYmFzZSA9IG5ldyBVUkkoYmFzZSk7CiAgICB9CgogICAgaWYgKCFyZXNvbHZlZC5fcGFydHMucHJvdG9jb2wpIHsKICAgICAgcmVzb2x2ZWQuX3BhcnRzLnByb3RvY29sID0gYmFzZS5fcGFydHMucHJvdG9jb2w7CiAgICB9CgogICAgaWYgKHRoaXMuX3BhcnRzLmhvc3RuYW1lKSB7CiAgICAgIHJldHVybiByZXNvbHZlZDsKICAgIH0KCiAgICBmb3IgKGkgPSAwOyAocCA9IHByb3BlcnRpZXNbaV0pOyBpKyspIHsKICAgICAgcmVzb2x2ZWQuX3BhcnRzW3BdID0gYmFzZS5fcGFydHNbcF07CiAgICB9CgogICAgaWYgKCFyZXNvbHZlZC5fcGFydHMucGF0aCkgewogICAgICByZXNvbHZlZC5fcGFydHMucGF0aCA9IGJhc2UuX3BhcnRzLnBhdGg7CiAgICAgIGlmICghcmVzb2x2ZWQuX3BhcnRzLnF1ZXJ5KSB7CiAgICAgICAgcmVzb2x2ZWQuX3BhcnRzLnF1ZXJ5ID0gYmFzZS5fcGFydHMucXVlcnk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAocmVzb2x2ZWQuX3BhcnRzLnBhdGguc3Vic3RyaW5nKC0yKSA9PT0gJy4uJykgewogICAgICByZXNvbHZlZC5fcGFydHMucGF0aCArPSAnLyc7CiAgICB9CgogICAgaWYgKHJlc29sdmVkLnBhdGgoKS5jaGFyQXQoMCkgIT09ICcvJykgewogICAgICBiYXNlZGlyID0gYmFzZS5kaXJlY3RvcnkoKTsKICAgICAgYmFzZWRpciA9IGJhc2VkaXIgPyBiYXNlZGlyIDogYmFzZS5wYXRoKCkuaW5kZXhPZignLycpID09PSAwID8gJy8nIDogJyc7CiAgICAgIHJlc29sdmVkLl9wYXJ0cy5wYXRoID0gKGJhc2VkaXIgPyAoYmFzZWRpciArICcvJykgOiAnJykgKyByZXNvbHZlZC5fcGFydHMucGF0aDsKICAgICAgcmVzb2x2ZWQubm9ybWFsaXplUGF0aCgpOwogICAgfQoKICAgIHJlc29sdmVkLmJ1aWxkKCk7CiAgICByZXR1cm4gcmVzb2x2ZWQ7CiAgfTsKICBwLnJlbGF0aXZlVG8gPSBmdW5jdGlvbihiYXNlKSB7CiAgICB2YXIgcmVsYXRpdmUgPSB0aGlzLmNsb25lKCkubm9ybWFsaXplKCk7CiAgICB2YXIgcmVsYXRpdmVQYXJ0cywgYmFzZVBhcnRzLCBjb21tb24sIHJlbGF0aXZlUGF0aCwgYmFzZVBhdGg7CgogICAgaWYgKHJlbGF0aXZlLl9wYXJ0cy51cm4pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdVUk5zIGRvIG5vdCBoYXZlIGFueSBnZW5lcmFsbHkgZGVmaW5lZCBoaWVyYXJjaGljYWwgY29tcG9uZW50cycpOwogICAgfQoKICAgIGJhc2UgPSBuZXcgVVJJKGJhc2UpLm5vcm1hbGl6ZSgpOwogICAgcmVsYXRpdmVQYXJ0cyA9IHJlbGF0aXZlLl9wYXJ0czsKICAgIGJhc2VQYXJ0cyA9IGJhc2UuX3BhcnRzOwogICAgcmVsYXRpdmVQYXRoID0gcmVsYXRpdmUucGF0aCgpOwogICAgYmFzZVBhdGggPSBiYXNlLnBhdGgoKTsKCiAgICBpZiAocmVsYXRpdmVQYXRoLmNoYXJBdCgwKSAhPT0gJy8nKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVVJJIGlzIGFscmVhZHkgcmVsYXRpdmUnKTsKICAgIH0KCiAgICBpZiAoYmFzZVBhdGguY2hhckF0KDApICE9PSAnLycpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY2FsY3VsYXRlIGEgVVJJIHJlbGF0aXZlIHRvIGFub3RoZXIgcmVsYXRpdmUgVVJJJyk7CiAgICB9CgogICAgaWYgKHJlbGF0aXZlUGFydHMucHJvdG9jb2wgPT09IGJhc2VQYXJ0cy5wcm90b2NvbCkgewogICAgICByZWxhdGl2ZVBhcnRzLnByb3RvY29sID0gbnVsbDsKICAgIH0KCiAgICBpZiAocmVsYXRpdmVQYXJ0cy51c2VybmFtZSAhPT0gYmFzZVBhcnRzLnVzZXJuYW1lIHx8IHJlbGF0aXZlUGFydHMucGFzc3dvcmQgIT09IGJhc2VQYXJ0cy5wYXNzd29yZCkgewogICAgICByZXR1cm4gcmVsYXRpdmUuYnVpbGQoKTsKICAgIH0KCiAgICBpZiAocmVsYXRpdmVQYXJ0cy5wcm90b2NvbCAhPT0gbnVsbCB8fCByZWxhdGl2ZVBhcnRzLnVzZXJuYW1lICE9PSBudWxsIHx8IHJlbGF0aXZlUGFydHMucGFzc3dvcmQgIT09IG51bGwpIHsKICAgICAgcmV0dXJuIHJlbGF0aXZlLmJ1aWxkKCk7CiAgICB9CgogICAgaWYgKHJlbGF0aXZlUGFydHMuaG9zdG5hbWUgPT09IGJhc2VQYXJ0cy5ob3N0bmFtZSAmJiByZWxhdGl2ZVBhcnRzLnBvcnQgPT09IGJhc2VQYXJ0cy5wb3J0KSB7CiAgICAgIHJlbGF0aXZlUGFydHMuaG9zdG5hbWUgPSBudWxsOwogICAgICByZWxhdGl2ZVBhcnRzLnBvcnQgPSBudWxsOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHJlbGF0aXZlLmJ1aWxkKCk7CiAgICB9CgogICAgaWYgKHJlbGF0aXZlUGF0aCA9PT0gYmFzZVBhdGgpIHsKICAgICAgcmVsYXRpdmVQYXJ0cy5wYXRoID0gJyc7CiAgICAgIHJldHVybiByZWxhdGl2ZS5idWlsZCgpOwogICAgfQoKICAgIC8vIGRldGVybWluZSBjb21tb24gc3ViIHBhdGgKICAgIGNvbW1vbiA9IFVSSS5jb21tb25QYXRoKHJlbGF0aXZlUGF0aCwgYmFzZVBhdGgpOwoKICAgIC8vIElmIHRoZSBwYXRocyBoYXZlIG5vdGhpbmcgaW4gY29tbW9uLCByZXR1cm4gYSByZWxhdGl2ZSBVUkwgd2l0aCB0aGUgYWJzb2x1dGUgcGF0aC4KICAgIGlmICghY29tbW9uKSB7CiAgICAgIHJldHVybiByZWxhdGl2ZS5idWlsZCgpOwogICAgfQoKICAgIHZhciBwYXJlbnRzID0gYmFzZVBhcnRzLnBhdGgKICAgICAgLnN1YnN0cmluZyhjb21tb24ubGVuZ3RoKQogICAgICAucmVwbGFjZSgvW15cL10qJC8sICcnKQogICAgICAucmVwbGFjZSgvLio/XC8vZywgJy4uLycpOwoKICAgIHJlbGF0aXZlUGFydHMucGF0aCA9IChwYXJlbnRzICsgcmVsYXRpdmVQYXJ0cy5wYXRoLnN1YnN0cmluZyhjb21tb24ubGVuZ3RoKSkgfHwgJy4vJzsKCiAgICByZXR1cm4gcmVsYXRpdmUuYnVpbGQoKTsKICB9OwoKICAvLyBjb21wYXJpbmcgVVJJcwogIHAuZXF1YWxzID0gZnVuY3Rpb24odXJpKSB7CiAgICB2YXIgb25lID0gdGhpcy5jbG9uZSgpOwogICAgdmFyIHR3byA9IG5ldyBVUkkodXJpKTsKICAgIHZhciBvbmVfbWFwID0ge307CiAgICB2YXIgdHdvX21hcCA9IHt9OwogICAgdmFyIGNoZWNrZWQgPSB7fTsKICAgIHZhciBvbmVfcXVlcnksIHR3b19xdWVyeSwga2V5OwoKICAgIG9uZS5ub3JtYWxpemUoKTsKICAgIHR3by5ub3JtYWxpemUoKTsKCiAgICAvLyBleGFjdCBtYXRjaAogICAgaWYgKG9uZS50b1N0cmluZygpID09PSB0d28udG9TdHJpbmcoKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBleHRyYWN0IHF1ZXJ5IHN0cmluZwogICAgb25lX3F1ZXJ5ID0gb25lLnF1ZXJ5KCk7CiAgICB0d29fcXVlcnkgPSB0d28ucXVlcnkoKTsKICAgIG9uZS5xdWVyeSgnJyk7CiAgICB0d28ucXVlcnkoJycpOwoKICAgIC8vIGRlZmluaXRlbHkgbm90IGVxdWFsIGlmIG5vdCBldmVuIG5vbi1xdWVyeSBwYXJ0cyBtYXRjaAogICAgaWYgKG9uZS50b1N0cmluZygpICE9PSB0d28udG9TdHJpbmcoKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8gcXVlcnkgcGFyYW1ldGVycyBoYXZlIHRoZSBzYW1lIGxlbmd0aCwgZXZlbiBpZiB0aGV5J3JlIHBlcm11dGVkCiAgICBpZiAob25lX3F1ZXJ5Lmxlbmd0aCAhPT0gdHdvX3F1ZXJ5Lmxlbmd0aCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgb25lX21hcCA9IFVSSS5wYXJzZVF1ZXJ5KG9uZV9xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7CiAgICB0d29fbWFwID0gVVJJLnBhcnNlUXVlcnkodHdvX3F1ZXJ5LCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTsKCiAgICBmb3IgKGtleSBpbiBvbmVfbWFwKSB7CiAgICAgIGlmIChoYXNPd24uY2FsbChvbmVfbWFwLCBrZXkpKSB7CiAgICAgICAgaWYgKCFpc0FycmF5KG9uZV9tYXBba2V5XSkpIHsKICAgICAgICAgIGlmIChvbmVfbWFwW2tleV0gIT09IHR3b19tYXBba2V5XSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICghYXJyYXlzRXF1YWwob25lX21hcFtrZXldLCB0d29fbWFwW2tleV0pKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBjaGVja2VkW2tleV0gPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgZm9yIChrZXkgaW4gdHdvX21hcCkgewogICAgICBpZiAoaGFzT3duLmNhbGwodHdvX21hcCwga2V5KSkgewogICAgICAgIGlmICghY2hlY2tlZFtrZXldKSB7CiAgICAgICAgICAvLyB0d28gY29udGFpbnMgYSBwYXJhbWV0ZXIgbm90IHByZXNlbnQgaW4gb25lCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfTsKCiAgLy8gc3RhdGUKICBwLmR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycyA9IGZ1bmN0aW9uKHYpIHsKICAgIHRoaXMuX3BhcnRzLmR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycyA9ICEhdjsKICAgIHJldHVybiB0aGlzOwogIH07CgogIHAuZXNjYXBlUXVlcnlTcGFjZSA9IGZ1bmN0aW9uKHYpIHsKICAgIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UgPSAhIXY7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICByZXR1cm4gVVJJOwp9KSk7Cgp9LHsiLi9JUHY2IjozLCIuL1NlY29uZExldmVsRG9tYWlucyI6NCwiLi9wdW55Y29kZSI6Nn1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewooZnVuY3Rpb24gKGdsb2JhbCl7Ci8qISBodHRwczovL210aHMuYmUvcHVueWNvZGUgdjEuNC4wIGJ5IEBtYXRoaWFzICovCjsoZnVuY3Rpb24ocm9vdCkgewoKCS8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZXMgKi8KCXZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYKCQkhZXhwb3J0cy5ub2RlVHlwZSAmJiBleHBvcnRzOwoJdmFyIGZyZWVNb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJgoJCSFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlOwoJdmFyIGZyZWVHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGdsb2JhbDsKCWlmICgKCQlmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCB8fAoJCWZyZWVHbG9iYWwud2luZG93ID09PSBmcmVlR2xvYmFsIHx8CgkJZnJlZUdsb2JhbC5zZWxmID09PSBmcmVlR2xvYmFsCgkpIHsKCQlyb290ID0gZnJlZUdsb2JhbDsKCX0KCgkvKioKCSAqIFRoZSBgcHVueWNvZGVgIG9iamVjdC4KCSAqIEBuYW1lIHB1bnljb2RlCgkgKiBAdHlwZSBPYmplY3QKCSAqLwoJdmFyIHB1bnljb2RlLAoKCS8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi8KCW1heEludCA9IDIxNDc0ODM2NDcsIC8vIGFrYS4gMHg3RkZGRkZGRiBvciAyXjMxLTEKCgkvKiogQm9vdHN0cmluZyBwYXJhbWV0ZXJzICovCgliYXNlID0gMzYsCgl0TWluID0gMSwKCXRNYXggPSAyNiwKCXNrZXcgPSAzOCwKCWRhbXAgPSA3MDAsCglpbml0aWFsQmlhcyA9IDcyLAoJaW5pdGlhbE4gPSAxMjgsIC8vIDB4ODAKCWRlbGltaXRlciA9ICctJywgLy8gJ1x4MkQnCgoJLyoqIFJlZ3VsYXIgZXhwcmVzc2lvbnMgKi8KCXJlZ2V4UHVueWNvZGUgPSAvXnhuLS0vLAoJcmVnZXhOb25BU0NJSSA9IC9bXlx4MjAtXHg3RV0vLCAvLyB1bnByaW50YWJsZSBBU0NJSSBjaGFycyArIG5vbi1BU0NJSSBjaGFycwoJcmVnZXhTZXBhcmF0b3JzID0gL1tceDJFXHUzMDAyXHVGRjBFXHVGRjYxXS9nLCAvLyBSRkMgMzQ5MCBzZXBhcmF0b3JzCgoJLyoqIEVycm9yIG1lc3NhZ2VzICovCgllcnJvcnMgPSB7CgkJJ292ZXJmbG93JzogJ092ZXJmbG93OiBpbnB1dCBuZWVkcyB3aWRlciBpbnRlZ2VycyB0byBwcm9jZXNzJywKCQknbm90LWJhc2ljJzogJ0lsbGVnYWwgaW5wdXQgPj0gMHg4MCAobm90IGEgYmFzaWMgY29kZSBwb2ludCknLAoJCSdpbnZhbGlkLWlucHV0JzogJ0ludmFsaWQgaW5wdXQnCgl9LAoKCS8qKiBDb252ZW5pZW5jZSBzaG9ydGN1dHMgKi8KCWJhc2VNaW51c1RNaW4gPSBiYXNlIC0gdE1pbiwKCWZsb29yID0gTWF0aC5mbG9vciwKCXN0cmluZ0Zyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUsCgoJLyoqIFRlbXBvcmFyeSB2YXJpYWJsZSAqLwoJa2V5OwoKCS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCS8qKgoJICogQSBnZW5lcmljIGVycm9yIHV0aWxpdHkgZnVuY3Rpb24uCgkgKiBAcHJpdmF0ZQoJICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVGhlIGVycm9yIHR5cGUuCgkgKiBAcmV0dXJucyB7RXJyb3J9IFRocm93cyBhIGBSYW5nZUVycm9yYCB3aXRoIHRoZSBhcHBsaWNhYmxlIGVycm9yIG1lc3NhZ2UuCgkgKi8KCWZ1bmN0aW9uIGVycm9yKHR5cGUpIHsKCQl0aHJvdyBuZXcgUmFuZ2VFcnJvcihlcnJvcnNbdHlwZV0pOwoJfQoKCS8qKgoJICogQSBnZW5lcmljIGBBcnJheSNtYXBgIHV0aWxpdHkgZnVuY3Rpb24uCgkgKiBAcHJpdmF0ZQoJICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci4KCSAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeSBhcnJheQoJICogaXRlbS4KCSAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgYXJyYXkgb2YgdmFsdWVzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjayBmdW5jdGlvbi4KCSAqLwoJZnVuY3Rpb24gbWFwKGFycmF5LCBmbikgewoJCXZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7CgkJdmFyIHJlc3VsdCA9IFtdOwoJCXdoaWxlIChsZW5ndGgtLSkgewoJCQlyZXN1bHRbbGVuZ3RoXSA9IGZuKGFycmF5W2xlbmd0aF0pOwoJCX0KCQlyZXR1cm4gcmVzdWx0OwoJfQoKCS8qKgoJICogQSBzaW1wbGUgYEFycmF5I21hcGAtbGlrZSB3cmFwcGVyIHRvIHdvcmsgd2l0aCBkb21haW4gbmFtZSBzdHJpbmdzIG9yIGVtYWlsCgkgKiBhZGRyZXNzZXMuCgkgKiBAcHJpdmF0ZQoJICogQHBhcmFtIHtTdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcy4KCSAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeQoJICogY2hhcmFjdGVyLgoJICogQHJldHVybnMge0FycmF5fSBBIG5ldyBzdHJpbmcgb2YgY2hhcmFjdGVycyByZXR1cm5lZCBieSB0aGUgY2FsbGJhY2sKCSAqIGZ1bmN0aW9uLgoJICovCglmdW5jdGlvbiBtYXBEb21haW4oc3RyaW5nLCBmbikgewoJCXZhciBwYXJ0cyA9IHN0cmluZy5zcGxpdCgnQCcpOwoJCXZhciByZXN1bHQgPSAnJzsKCQlpZiAocGFydHMubGVuZ3RoID4gMSkgewoJCQkvLyBJbiBlbWFpbCBhZGRyZXNzZXMsIG9ubHkgdGhlIGRvbWFpbiBuYW1lIHNob3VsZCBiZSBwdW55Y29kZWQuIExlYXZlCgkJCS8vIHRoZSBsb2NhbCBwYXJ0IChpLmUuIGV2ZXJ5dGhpbmcgdXAgdG8gYEBgKSBpbnRhY3QuCgkJCXJlc3VsdCA9IHBhcnRzWzBdICsgJ0AnOwoJCQlzdHJpbmcgPSBwYXJ0c1sxXTsKCQl9CgkJLy8gQXZvaWQgYHNwbGl0KHJlZ2V4KWAgZm9yIElFOCBjb21wYXRpYmlsaXR5LiBTZWUgIzE3LgoJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4U2VwYXJhdG9ycywgJ1x4MkUnKTsKCQl2YXIgbGFiZWxzID0gc3RyaW5nLnNwbGl0KCcuJyk7CgkJdmFyIGVuY29kZWQgPSBtYXAobGFiZWxzLCBmbikuam9pbignLicpOwoJCXJldHVybiByZXN1bHQgKyBlbmNvZGVkOwoJfQoKCS8qKgoJICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZQoJICogY2hhcmFjdGVyIGluIHRoZSBzdHJpbmcuIFdoaWxlIEphdmFTY3JpcHQgdXNlcyBVQ1MtMiBpbnRlcm5hbGx5LAoJICogdGhpcyBmdW5jdGlvbiB3aWxsIGNvbnZlcnQgYSBwYWlyIG9mIHN1cnJvZ2F0ZSBoYWx2ZXMgKGVhY2ggb2Ygd2hpY2gKCSAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LAoJICogbWF0Y2hpbmcgVVRGLTE2LgoJICogQHNlZSBgcHVueWNvZGUudWNzMi5lbmNvZGVgCgkgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz4KCSAqIEBtZW1iZXJPZiBwdW55Y29kZS51Y3MyCgkgKiBAbmFtZSBkZWNvZGUKCSAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIFVuaWNvZGUgaW5wdXQgc3RyaW5nIChVQ1MtMikuCgkgKiBAcmV0dXJucyB7QXJyYXl9IFRoZSBuZXcgYXJyYXkgb2YgY29kZSBwb2ludHMuCgkgKi8KCWZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7CgkJdmFyIG91dHB1dCA9IFtdLAoJCSAgICBjb3VudGVyID0gMCwKCQkgICAgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aCwKCQkgICAgdmFsdWUsCgkJICAgIGV4dHJhOwoJCXdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7CgkJCXZhbHVlID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTsKCQkJaWYgKHZhbHVlID49IDB4RDgwMCAmJiB2YWx1ZSA8PSAweERCRkYgJiYgY291bnRlciA8IGxlbmd0aCkgewoJCQkJLy8gaGlnaCBzdXJyb2dhdGUsIGFuZCB0aGVyZSBpcyBhIG5leHQgY2hhcmFjdGVyCgkJCQlleHRyYSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7CgkJCQlpZiAoKGV4dHJhICYgMHhGQzAwKSA9PSAweERDMDApIHsgLy8gbG93IHN1cnJvZ2F0ZQoJCQkJCW91dHB1dC5wdXNoKCgodmFsdWUgJiAweDNGRikgPDwgMTApICsgKGV4dHJhICYgMHgzRkYpICsgMHgxMDAwMCk7CgkJCQl9IGVsc2UgewoJCQkJCS8vIHVubWF0Y2hlZCBzdXJyb2dhdGU7IG9ubHkgYXBwZW5kIHRoaXMgY29kZSB1bml0LCBpbiBjYXNlIHRoZSBuZXh0CgkJCQkJLy8gY29kZSB1bml0IGlzIHRoZSBoaWdoIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyCgkJCQkJb3V0cHV0LnB1c2godmFsdWUpOwoJCQkJCWNvdW50ZXItLTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCW91dHB1dC5wdXNoKHZhbHVlKTsKCQkJfQoJCX0KCQlyZXR1cm4gb3V0cHV0OwoJfQoKCS8qKgoJICogQ3JlYXRlcyBhIHN0cmluZyBiYXNlZCBvbiBhbiBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLgoJICogQHNlZSBgcHVueWNvZGUudWNzMi5kZWNvZGVgCgkgKiBAbWVtYmVyT2YgcHVueWNvZGUudWNzMgoJICogQG5hbWUgZW5jb2RlCgkgKiBAcGFyYW0ge0FycmF5fSBjb2RlUG9pbnRzIFRoZSBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLgoJICogQHJldHVybnMge1N0cmluZ30gVGhlIG5ldyBVbmljb2RlIHN0cmluZyAoVUNTLTIpLgoJICovCglmdW5jdGlvbiB1Y3MyZW5jb2RlKGFycmF5KSB7CgkJcmV0dXJuIG1hcChhcnJheSwgZnVuY3Rpb24odmFsdWUpIHsKCQkJdmFyIG91dHB1dCA9ICcnOwoJCQlpZiAodmFsdWUgPiAweEZGRkYpIHsKCQkJCXZhbHVlIC09IDB4MTAwMDA7CgkJCQlvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKTsKCQkJCXZhbHVlID0gMHhEQzAwIHwgdmFsdWUgJiAweDNGRjsKCQkJfQoJCQlvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlKTsKCQkJcmV0dXJuIG91dHB1dDsKCQl9KS5qb2luKCcnKTsKCX0KCgkvKioKCSAqIENvbnZlcnRzIGEgYmFzaWMgY29kZSBwb2ludCBpbnRvIGEgZGlnaXQvaW50ZWdlci4KCSAqIEBzZWUgYGRpZ2l0VG9CYXNpYygpYAoJICogQHByaXZhdGUKCSAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlUG9pbnQgVGhlIGJhc2ljIG51bWVyaWMgY29kZSBwb2ludCB2YWx1ZS4KCSAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludCAoZm9yIHVzZSBpbgoJICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpbiB0aGUgcmFuZ2UgYDBgIHRvIGBiYXNlIC0gMWAsIG9yIGBiYXNlYCBpZgoJICogdGhlIGNvZGUgcG9pbnQgZG9lcyBub3QgcmVwcmVzZW50IGEgdmFsdWUuCgkgKi8KCWZ1bmN0aW9uIGJhc2ljVG9EaWdpdChjb2RlUG9pbnQpIHsKCQlpZiAoY29kZVBvaW50IC0gNDggPCAxMCkgewoJCQlyZXR1cm4gY29kZVBvaW50IC0gMjI7CgkJfQoJCWlmIChjb2RlUG9pbnQgLSA2NSA8IDI2KSB7CgkJCXJldHVybiBjb2RlUG9pbnQgLSA2NTsKCQl9CgkJaWYgKGNvZGVQb2ludCAtIDk3IDwgMjYpIHsKCQkJcmV0dXJuIGNvZGVQb2ludCAtIDk3OwoJCX0KCQlyZXR1cm4gYmFzZTsKCX0KCgkvKioKCSAqIENvbnZlcnRzIGEgZGlnaXQvaW50ZWdlciBpbnRvIGEgYmFzaWMgY29kZSBwb2ludC4KCSAqIEBzZWUgYGJhc2ljVG9EaWdpdCgpYAoJICogQHByaXZhdGUKCSAqIEBwYXJhbSB7TnVtYmVyfSBkaWdpdCBUaGUgbnVtZXJpYyB2YWx1ZSBvZiBhIGJhc2ljIGNvZGUgcG9pbnQuCgkgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgYmFzaWMgY29kZSBwb2ludCB3aG9zZSB2YWx1ZSAod2hlbiB1c2VkIGZvcgoJICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpcyBgZGlnaXRgLCB3aGljaCBuZWVkcyB0byBiZSBpbiB0aGUgcmFuZ2UKCSAqIGAwYCB0byBgYmFzZSAtIDFgLiBJZiBgZmxhZ2AgaXMgbm9uLXplcm8sIHRoZSB1cHBlcmNhc2UgZm9ybSBpcwoJICogdXNlZDsgZWxzZSwgdGhlIGxvd2VyY2FzZSBmb3JtIGlzIHVzZWQuIFRoZSBiZWhhdmlvciBpcyB1bmRlZmluZWQKCSAqIGlmIGBmbGFnYCBpcyBub24temVybyBhbmQgYGRpZ2l0YCBoYXMgbm8gdXBwZXJjYXNlIGZvcm0uCgkgKi8KCWZ1bmN0aW9uIGRpZ2l0VG9CYXNpYyhkaWdpdCwgZmxhZykgewoJCS8vICAwLi4yNSBtYXAgdG8gQVNDSUkgYS4ueiBvciBBLi5aCgkJLy8gMjYuLjM1IG1hcCB0byBBU0NJSSAwLi45CgkJcmV0dXJuIGRpZ2l0ICsgMjIgKyA3NSAqIChkaWdpdCA8IDI2KSAtICgoZmxhZyAhPSAwKSA8PCA1KTsKCX0KCgkvKioKCSAqIEJpYXMgYWRhcHRhdGlvbiBmdW5jdGlvbiBhcyBwZXIgc2VjdGlvbiAzLjQgb2YgUkZDIDM0OTIuCgkgKiBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzQ5MiNzZWN0aW9uLTMuNAoJICogQHByaXZhdGUKCSAqLwoJZnVuY3Rpb24gYWRhcHQoZGVsdGEsIG51bVBvaW50cywgZmlyc3RUaW1lKSB7CgkJdmFyIGsgPSAwOwoJCWRlbHRhID0gZmlyc3RUaW1lID8gZmxvb3IoZGVsdGEgLyBkYW1wKSA6IGRlbHRhID4+IDE7CgkJZGVsdGEgKz0gZmxvb3IoZGVsdGEgLyBudW1Qb2ludHMpOwoJCWZvciAoLyogbm8gaW5pdGlhbGl6YXRpb24gKi87IGRlbHRhID4gYmFzZU1pbnVzVE1pbiAqIHRNYXggPj4gMTsgayArPSBiYXNlKSB7CgkJCWRlbHRhID0gZmxvb3IoZGVsdGEgLyBiYXNlTWludXNUTWluKTsKCQl9CgkJcmV0dXJuIGZsb29yKGsgKyAoYmFzZU1pbnVzVE1pbiArIDEpICogZGVsdGEgLyAoZGVsdGEgKyBza2V3KSk7Cgl9CgoJLyoqCgkgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMgdG8gYSBzdHJpbmcgb2YgVW5pY29kZQoJICogc3ltYm9scy4KCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgoJICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzLgoJICovCglmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHsKCQkvLyBEb24ndCB1c2UgVUNTLTIKCQl2YXIgb3V0cHV0ID0gW10sCgkJICAgIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLAoJCSAgICBvdXQsCgkJICAgIGkgPSAwLAoJCSAgICBuID0gaW5pdGlhbE4sCgkJICAgIGJpYXMgPSBpbml0aWFsQmlhcywKCQkgICAgYmFzaWMsCgkJICAgIGosCgkJICAgIGluZGV4LAoJCSAgICBvbGRpLAoJCSAgICB3LAoJCSAgICBrLAoJCSAgICBkaWdpdCwKCQkgICAgdCwKCQkgICAgLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovCgkJICAgIGJhc2VNaW51c1Q7CgoJCS8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHM6IGxldCBgYmFzaWNgIGJlIHRoZSBudW1iZXIgb2YgaW5wdXQgY29kZQoJCS8vIHBvaW50cyBiZWZvcmUgdGhlIGxhc3QgZGVsaW1pdGVyLCBvciBgMGAgaWYgdGhlcmUgaXMgbm9uZSwgdGhlbiBjb3B5CgkJLy8gdGhlIGZpcnN0IGJhc2ljIGNvZGUgcG9pbnRzIHRvIHRoZSBvdXRwdXQuCgoJCWJhc2ljID0gaW5wdXQubGFzdEluZGV4T2YoZGVsaW1pdGVyKTsKCQlpZiAoYmFzaWMgPCAwKSB7CgkJCWJhc2ljID0gMDsKCQl9CgoJCWZvciAoaiA9IDA7IGogPCBiYXNpYzsgKytqKSB7CgkJCS8vIGlmIGl0J3Mgbm90IGEgYmFzaWMgY29kZSBwb2ludAoJCQlpZiAoaW5wdXQuY2hhckNvZGVBdChqKSA+PSAweDgwKSB7CgkJCQllcnJvcignbm90LWJhc2ljJyk7CgkJCX0KCQkJb3V0cHV0LnB1c2goaW5wdXQuY2hhckNvZGVBdChqKSk7CgkJfQoKCQkvLyBNYWluIGRlY29kaW5nIGxvb3A6IHN0YXJ0IGp1c3QgYWZ0ZXIgdGhlIGxhc3QgZGVsaW1pdGVyIGlmIGFueSBiYXNpYyBjb2RlCgkJLy8gcG9pbnRzIHdlcmUgY29waWVkOyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG90aGVyd2lzZS4KCgkJZm9yIChpbmRleCA9IGJhc2ljID4gMCA/IGJhc2ljICsgMSA6IDA7IGluZGV4IDwgaW5wdXRMZW5ndGg7IC8qIG5vIGZpbmFsIGV4cHJlc3Npb24gKi8pIHsKCgkJCS8vIGBpbmRleGAgaXMgdGhlIGluZGV4IG9mIHRoZSBuZXh0IGNoYXJhY3RlciB0byBiZSBjb25zdW1lZC4KCQkJLy8gRGVjb2RlIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXIgaW50byBgZGVsdGFgLAoJCQkvLyB3aGljaCBnZXRzIGFkZGVkIHRvIGBpYC4gVGhlIG92ZXJmbG93IGNoZWNraW5nIGlzIGVhc2llcgoJCQkvLyBpZiB3ZSBpbmNyZWFzZSBgaWAgYXMgd2UgZ28sIHRoZW4gc3VidHJhY3Qgb2ZmIGl0cyBzdGFydGluZwoJCQkvLyB2YWx1ZSBhdCB0aGUgZW5kIHRvIG9idGFpbiBgZGVsdGFgLgoJCQlmb3IgKG9sZGkgPSBpLCB3ID0gMSwgayA9IGJhc2U7IC8qIG5vIGNvbmRpdGlvbiAqLzsgayArPSBiYXNlKSB7CgoJCQkJaWYgKGluZGV4ID49IGlucHV0TGVuZ3RoKSB7CgkJCQkJZXJyb3IoJ2ludmFsaWQtaW5wdXQnKTsKCQkJCX0KCgkJCQlkaWdpdCA9IGJhc2ljVG9EaWdpdChpbnB1dC5jaGFyQ29kZUF0KGluZGV4KyspKTsKCgkJCQlpZiAoZGlnaXQgPj0gYmFzZSB8fCBkaWdpdCA+IGZsb29yKChtYXhJbnQgLSBpKSAvIHcpKSB7CgkJCQkJZXJyb3IoJ292ZXJmbG93Jyk7CgkJCQl9CgoJCQkJaSArPSBkaWdpdCAqIHc7CgkJCQl0ID0gayA8PSBiaWFzID8gdE1pbiA6IChrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzKTsKCgkJCQlpZiAoZGlnaXQgPCB0KSB7CgkJCQkJYnJlYWs7CgkJCQl9CgoJCQkJYmFzZU1pbnVzVCA9IGJhc2UgLSB0OwoJCQkJaWYgKHcgPiBmbG9vcihtYXhJbnQgLyBiYXNlTWludXNUKSkgewoJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJfQoKCQkJCXcgKj0gYmFzZU1pbnVzVDsKCgkJCX0KCgkJCW91dCA9IG91dHB1dC5sZW5ndGggKyAxOwoJCQliaWFzID0gYWRhcHQoaSAtIG9sZGksIG91dCwgb2xkaSA9PSAwKTsKCgkJCS8vIGBpYCB3YXMgc3VwcG9zZWQgdG8gd3JhcCBhcm91bmQgZnJvbSBgb3V0YCB0byBgMGAsCgkJCS8vIGluY3JlbWVudGluZyBgbmAgZWFjaCB0aW1lLCBzbyB3ZSdsbCBmaXggdGhhdCBub3c6CgkJCWlmIChmbG9vcihpIC8gb3V0KSA+IG1heEludCAtIG4pIHsKCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQl9CgoJCQluICs9IGZsb29yKGkgLyBvdXQpOwoJCQlpICU9IG91dDsKCgkJCS8vIEluc2VydCBgbmAgYXQgcG9zaXRpb24gYGlgIG9mIHRoZSBvdXRwdXQKCQkJb3V0cHV0LnNwbGljZShpKyssIDAsIG4pOwoKCQl9CgoJCXJldHVybiB1Y3MyZW5jb2RlKG91dHB1dCk7Cgl9CgoJLyoqCgkgKiBDb252ZXJ0cyBhIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMgKGUuZy4gYSBkb21haW4gbmFtZSBsYWJlbCkgdG8gYQoJICogUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy4KCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzLgoJICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgoJICovCglmdW5jdGlvbiBlbmNvZGUoaW5wdXQpIHsKCQl2YXIgbiwKCQkgICAgZGVsdGEsCgkJICAgIGhhbmRsZWRDUENvdW50LAoJCSAgICBiYXNpY0xlbmd0aCwKCQkgICAgYmlhcywKCQkgICAgaiwKCQkgICAgbSwKCQkgICAgcSwKCQkgICAgaywKCQkgICAgdCwKCQkgICAgY3VycmVudFZhbHVlLAoJCSAgICBvdXRwdXQgPSBbXSwKCQkgICAgLyoqIGBpbnB1dExlbmd0aGAgd2lsbCBob2xkIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgaW4gYGlucHV0YC4gKi8KCQkgICAgaW5wdXRMZW5ndGgsCgkJICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqLwoJCSAgICBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsCgkJICAgIGJhc2VNaW51c1QsCgkJICAgIHFNaW51c1Q7CgoJCS8vIENvbnZlcnQgdGhlIGlucHV0IGluIFVDUy0yIHRvIFVuaWNvZGUKCQlpbnB1dCA9IHVjczJkZWNvZGUoaW5wdXQpOwoKCQkvLyBDYWNoZSB0aGUgbGVuZ3RoCgkJaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7CgoJCS8vIEluaXRpYWxpemUgdGhlIHN0YXRlCgkJbiA9IGluaXRpYWxOOwoJCWRlbHRhID0gMDsKCQliaWFzID0gaW5pdGlhbEJpYXM7CgoJCS8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHMKCQlmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQljdXJyZW50VmFsdWUgPSBpbnB1dFtqXTsKCQkJaWYgKGN1cnJlbnRWYWx1ZSA8IDB4ODApIHsKCQkJCW91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShjdXJyZW50VmFsdWUpKTsKCQkJfQoJCX0KCgkJaGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7CgoJCS8vIGBoYW5kbGVkQ1BDb3VudGAgaXMgdGhlIG51bWJlciBvZiBjb2RlIHBvaW50cyB0aGF0IGhhdmUgYmVlbiBoYW5kbGVkOwoJCS8vIGBiYXNpY0xlbmd0aGAgaXMgdGhlIG51bWJlciBvZiBiYXNpYyBjb2RlIHBvaW50cy4KCgkJLy8gRmluaXNoIHRoZSBiYXNpYyBzdHJpbmcgLSBpZiBpdCBpcyBub3QgZW1wdHkgLSB3aXRoIGEgZGVsaW1pdGVyCgkJaWYgKGJhc2ljTGVuZ3RoKSB7CgkJCW91dHB1dC5wdXNoKGRlbGltaXRlcik7CgkJfQoKCQkvLyBNYWluIGVuY29kaW5nIGxvb3A6CgkJd2hpbGUgKGhhbmRsZWRDUENvdW50IDwgaW5wdXRMZW5ndGgpIHsKCgkJCS8vIEFsbCBub24tYmFzaWMgY29kZSBwb2ludHMgPCBuIGhhdmUgYmVlbiBoYW5kbGVkIGFscmVhZHkuIEZpbmQgdGhlIG5leHQKCQkJLy8gbGFyZ2VyIG9uZToKCQkJZm9yIChtID0gbWF4SW50LCBqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHsKCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoJCQkJaWYgKGN1cnJlbnRWYWx1ZSA+PSBuICYmIGN1cnJlbnRWYWx1ZSA8IG0pIHsKCQkJCQltID0gY3VycmVudFZhbHVlOwoJCQkJfQoJCQl9CgoJCQkvLyBJbmNyZWFzZSBgZGVsdGFgIGVub3VnaCB0byBhZHZhbmNlIHRoZSBkZWNvZGVyJ3MgPG4saT4gc3RhdGUgdG8gPG0sMD4sCgkJCS8vIGJ1dCBndWFyZCBhZ2FpbnN0IG92ZXJmbG93CgkJCWhhbmRsZWRDUENvdW50UGx1c09uZSA9IGhhbmRsZWRDUENvdW50ICsgMTsKCQkJaWYgKG0gLSBuID4gZmxvb3IoKG1heEludCAtIGRlbHRhKSAvIGhhbmRsZWRDUENvdW50UGx1c09uZSkpIHsKCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQl9CgoJCQlkZWx0YSArPSAobSAtIG4pICogaGFuZGxlZENQQ291bnRQbHVzT25lOwoJCQluID0gbTsKCgkJCWZvciAoaiA9IDA7IGogPCBpbnB1dExlbmd0aDsgKytqKSB7CgkJCQljdXJyZW50VmFsdWUgPSBpbnB1dFtqXTsKCgkJCQlpZiAoY3VycmVudFZhbHVlIDwgbiAmJiArK2RlbHRhID4gbWF4SW50KSB7CgkJCQkJZXJyb3IoJ292ZXJmbG93Jyk7CgkJCQl9CgoJCQkJaWYgKGN1cnJlbnRWYWx1ZSA9PSBuKSB7CgkJCQkJLy8gUmVwcmVzZW50IGRlbHRhIGFzIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXIKCQkJCQlmb3IgKHEgPSBkZWx0YSwgayA9IGJhc2U7IC8qIG5vIGNvbmRpdGlvbiAqLzsgayArPSBiYXNlKSB7CgkJCQkJCXQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpOwoJCQkJCQlpZiAocSA8IHQpIHsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJCXFNaW51c1QgPSBxIC0gdDsKCQkJCQkJYmFzZU1pbnVzVCA9IGJhc2UgLSB0OwoJCQkJCQlvdXRwdXQucHVzaCgKCQkJCQkJCXN0cmluZ0Zyb21DaGFyQ29kZShkaWdpdFRvQmFzaWModCArIHFNaW51c1QgJSBiYXNlTWludXNULCAwKSkKCQkJCQkJKTsKCQkJCQkJcSA9IGZsb29yKHFNaW51c1QgLyBiYXNlTWludXNUKTsKCQkJCQl9CgoJCQkJCW91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShkaWdpdFRvQmFzaWMocSwgMCkpKTsKCQkJCQliaWFzID0gYWRhcHQoZGVsdGEsIGhhbmRsZWRDUENvdW50UGx1c09uZSwgaGFuZGxlZENQQ291bnQgPT0gYmFzaWNMZW5ndGgpOwoJCQkJCWRlbHRhID0gMDsKCQkJCQkrK2hhbmRsZWRDUENvdW50OwoJCQkJfQoJCQl9CgoJCQkrK2RlbHRhOwoJCQkrK247CgoJCX0KCQlyZXR1cm4gb3V0cHV0LmpvaW4oJycpOwoJfQoKCS8qKgoJICogQ29udmVydHMgYSBQdW55Y29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzcwoJICogdG8gVW5pY29kZS4gT25seSB0aGUgUHVueWNvZGVkIHBhcnRzIG9mIHRoZSBpbnB1dCB3aWxsIGJlIGNvbnZlcnRlZCwgaS5lLgoJICogaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgb24gYSBzdHJpbmcgdGhhdCBoYXMgYWxyZWFkeSBiZWVuCgkgKiBjb252ZXJ0ZWQgdG8gVW5pY29kZS4KCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZWQgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0bwoJICogY29udmVydCB0byBVbmljb2RlLgoJICogQHJldHVybnMge1N0cmluZ30gVGhlIFVuaWNvZGUgcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIFB1bnljb2RlCgkgKiBzdHJpbmcuCgkgKi8KCWZ1bmN0aW9uIHRvVW5pY29kZShpbnB1dCkgewoJCXJldHVybiBtYXBEb21haW4oaW5wdXQsIGZ1bmN0aW9uKHN0cmluZykgewoJCQlyZXR1cm4gcmVnZXhQdW55Y29kZS50ZXN0KHN0cmluZykKCQkJCT8gZGVjb2RlKHN0cmluZy5zbGljZSg0KS50b0xvd2VyQ2FzZSgpKQoJCQkJOiBzdHJpbmc7CgkJfSk7Cgl9CgoJLyoqCgkgKiBDb252ZXJ0cyBhIFVuaWNvZGUgc3RyaW5nIHJlcHJlc2VudGluZyBhIGRvbWFpbiBuYW1lIG9yIGFuIGVtYWlsIGFkZHJlc3MgdG8KCSAqIFB1bnljb2RlLiBPbmx5IHRoZSBub24tQVNDSUkgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHdpbGwgYmUgY29udmVydGVkLAoJICogaS5lLiBpdCBkb2Vzbid0IG1hdHRlciBpZiB5b3UgY2FsbCBpdCB3aXRoIGEgZG9tYWluIHRoYXQncyBhbHJlYWR5IGluCgkgKiBBU0NJSS4KCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzIHRvIGNvbnZlcnQsIGFzIGEKCSAqIFVuaWNvZGUgc3RyaW5nLgoJICogQHJldHVybnMge1N0cmluZ30gVGhlIFB1bnljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBkb21haW4gbmFtZSBvcgoJICogZW1haWwgYWRkcmVzcy4KCSAqLwoJZnVuY3Rpb24gdG9BU0NJSShpbnB1dCkgewoJCXJldHVybiBtYXBEb21haW4oaW5wdXQsIGZ1bmN0aW9uKHN0cmluZykgewoJCQlyZXR1cm4gcmVnZXhOb25BU0NJSS50ZXN0KHN0cmluZykKCQkJCT8gJ3huLS0nICsgZW5jb2RlKHN0cmluZykKCQkJCTogc3RyaW5nOwoJCX0pOwoJfQoKCS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCS8qKiBEZWZpbmUgdGhlIHB1YmxpYyBBUEkgKi8KCXB1bnljb2RlID0gewoJCS8qKgoJCSAqIEEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBQdW55Y29kZS5qcyB2ZXJzaW9uIG51bWJlci4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkgKiBAdHlwZSBTdHJpbmcKCQkgKi8KCQkndmVyc2lvbic6ICcxLjMuMicsCgkJLyoqCgkJICogQW4gb2JqZWN0IG9mIG1ldGhvZHMgdG8gY29udmVydCBmcm9tIEphdmFTY3JpcHQncyBpbnRlcm5hbCBjaGFyYWN0ZXIKCQkgKiByZXByZXNlbnRhdGlvbiAoVUNTLTIpIHRvIFVuaWNvZGUgY29kZSBwb2ludHMsIGFuZCBiYWNrLgoJCSAqIEBzZWUgPGh0dHBzOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nPgoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCSAqIEB0eXBlIE9iamVjdAoJCSAqLwoJCSd1Y3MyJzogewoJCQknZGVjb2RlJzogdWNzMmRlY29kZSwKCQkJJ2VuY29kZSc6IHVjczJlbmNvZGUKCQl9LAoJCSdkZWNvZGUnOiBkZWNvZGUsCgkJJ2VuY29kZSc6IGVuY29kZSwKCQkndG9BU0NJSSc6IHRvQVNDSUksCgkJJ3RvVW5pY29kZSc6IHRvVW5pY29kZQoJfTsKCgkvKiogRXhwb3NlIGBwdW55Y29kZWAgKi8KCS8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJucwoJLy8gbGlrZSB0aGUgZm9sbG93aW5nOgoJaWYgKAoJCXR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJgoJCXR5cGVvZiBkZWZpbmUuYW1kID09ICdvYmplY3QnICYmCgkJZGVmaW5lLmFtZAoJKSB7CgkJZGVmaW5lKCdwdW55Y29kZScsIGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gcHVueWNvZGU7CgkJfSk7Cgl9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUpIHsKCQlpZiAobW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMpIHsKCQkJLy8gaW4gTm9kZS5qcywgaW8uanMsIG9yIFJpbmdvSlMgdjAuOC4wKwoJCQlmcmVlTW9kdWxlLmV4cG9ydHMgPSBwdW55Y29kZTsKCQl9IGVsc2UgewoJCQkvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLQoJCQlmb3IgKGtleSBpbiBwdW55Y29kZSkgewoJCQkJcHVueWNvZGUuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHB1bnljb2RlW2tleV0pOwoJCQl9CgkJfQoJfSBlbHNlIHsKCQkvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyCgkJcm9vdC5wdW55Y29kZSA9IHB1bnljb2RlOwoJfQoKfSh0aGlzKSk7Cgp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKfSx7fV0sNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JztPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywiX19lc01vZHVsZSIse3ZhbHVlOnRydWV9KTtleHBvcnRzLmRlZmF1bHQ9YWN0aXZhdGU7dmFyIF9IeXBlcnR5RGlzY292ZXJ5PXJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvSHlwZXJ0eURpc2NvdmVyeScpO3ZhciBfSHlwZXJ0eURpc2NvdmVyeTI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSHlwZXJ0eURpc2NvdmVyeSk7dmFyIF91cmlqcz1yZXF1aXJlKCd1cmlqcycpO3ZhciBfdXJpanMyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VyaWpzKTt2YXIgX1N5bmNoZXI9cmVxdWlyZSgnc2VydmljZS1mcmFtZXdvcmsvZGlzdC9TeW5jaGVyJyk7dmFyIF9Hcm91cENoYXQ9cmVxdWlyZSgnLi9Hcm91cENoYXQnKTt2YXIgX0dyb3VwQ2hhdDI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfR3JvdXBDaGF0KTtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iail7cmV0dXJuIG9iaiYmb2JqLl9fZXNNb2R1bGU/b2JqOntkZWZhdWx0Om9ian07fWZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSxDb25zdHJ1Y3Rvcil7aWYoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSl7dGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7fX12YXIgQ29tbXVuaWNhdGlvbj1mdW5jdGlvbiBDb21tdW5pY2F0aW9uKG5hbWUpe19jbGFzc0NhbGxDaGVjayh0aGlzLENvbW11bmljYXRpb24pO3RoaXMuc3RhcnRpbmdUaW1lPURhdGUubm93KCk7dGhpcy5sYXN0TW9kaWZpZWQ9RGF0ZS5ub3coKTt0aGlzLnN0YXR1cz0icGVuZGluZyI7dGhpcy5yZXNvdXJjZXM9W107dGhpcy5jaGlsZHJlbj1bXTt0aGlzLm5hbWU9bmFtZTt9O3ZhciBHcm91cENoYXRIeXBlcnR5PXtfZ2V0SHlGb3I6ZnVuY3Rpb24gX2dldEh5Rm9yKHBhcnRpY2lwYW50cyl7dmFyIF90aGlzPXRoaXM7cmV0dXJuIFByb21pc2UuYWxsKHBhcnRpY2lwYW50cy5tYXAoZnVuY3Rpb24ocCl7cmV0dXJuIF90aGlzLmh5cGVydHlEaXNjb3ZlcnlTZXJ2aWNlLmRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlcihwLmVtYWlsLHAuZG9tYWluKS50aGVuKGZ1bmN0aW9uKGh5cGVydGllcyl7cmV0dXJuIE9iamVjdC5rZXlzKGh5cGVydGllcykubWFwKGZ1bmN0aW9uKGtleSl7cmV0dXJuIHtrZXk6a2V5LGRlc2NyaXB0b3I6aHlwZXJ0aWVzW2tleV0uZGVzY3JpcHRvcixsYXN0TW9kaWZpZWQ6aHlwZXJ0aWVzW2tleV0ubGFzdE1vZGlmaWVkfTt9KS5maWx0ZXIoZnVuY3Rpb24oZGVzYyl7cmV0dXJuIGRlc2MuZGVzY3JpcHRvci5lbmRzV2l0aCgnR3JvdXBDaGF0Jyk7fSkuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBuZXcgRGF0ZShhLmxhc3RNb2RpZmllZCk8bmV3IERhdGUoYi5sYXN0TW9kaWZpZWQpPzE6LTE7fSkuc2hpZnQoKS5rZXk7fSk7fSkpO30sX2NyZWF0ZVN5bmNoZXI6ZnVuY3Rpb24gX2NyZWF0ZVN5bmNoZXIobmFtZSxoeXBlcnRpZXMpe3JldHVybiB0aGlzLnN5bmNoZXIuY3JlYXRlKHRoaXMub2JqZWN0RGVzY1VSTCxoeXBlcnRpZXMsbmV3IENvbW11bmljYXRpb24obmFtZSkpO30sY3JlYXRlOmZ1bmN0aW9uIGNyZWF0ZShuYW1lLHBhcnRpY2lwYW50cyl7dmFyIF90aGlzMj10aGlzO3JldHVybiB0aGlzLl9nZXRIeUZvcihwYXJ0aWNpcGFudHMpLnRoZW4oZnVuY3Rpb24oaHlwZXJ0aWVzKXtyZXR1cm4gX3RoaXMyLl9jcmVhdGVTeW5jaGVyKG5hbWUsaHlwZXJ0aWVzKTt9KS50aGVuKGZ1bmN0aW9uKGRhdGFPYmplY3RSZXBvcnRlcil7ZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uKGV2ZW50KXtyZXR1cm4gZXZlbnQuYWNjZXB0KCk7fSk7cmV0dXJuICgwLF9Hcm91cENoYXQyLmRlZmF1bHQpKGRhdGFPYmplY3RSZXBvcnRlcixfdGhpczIuX3Bvc2l0aW9uLmRhdGEpO30pO30sb25JbnZpdGU6ZnVuY3Rpb24gb25JbnZpdGUoY2FsbGJhY2spe3ZhciBfdGhpczM9dGhpcztyZXR1cm4gdGhpcy5zeW5jaGVyLm9uTm90aWZpY2F0aW9uKGZ1bmN0aW9uKGV2ZW50KXtpZihldmVudC5zY2hlbWE9PT1fdGhpczMubG9jYXRpb25EZXNjVVJMKXtfdGhpczMuc3luY2hlci5zdWJzY3JpYmUoX3RoaXMzLmxvY2F0aW9uRGVzY1VSTCxldmVudC51cmwpLnRoZW4oZnVuY3Rpb24oZGF0YU9iamVjdCl7X3RoaXMzLl9wb3NpdGlvbj1kYXRhT2JqZWN0O30pO31lbHNlIGlmKGV2ZW50LnNjaGVtYT09PV90aGlzMy5vYmplY3REZXNjVVJMKXtfdGhpczMuc3luY2hlci5zdWJzY3JpYmUoX3RoaXMzLm9iamVjdERlc2NVUkwsZXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uKGRhdGFPYmplY3Qpe3JldHVybiBjYWxsYmFjaygoMCxfR3JvdXBDaGF0Mi5kZWZhdWx0KShkYXRhT2JqZWN0LF90aGlzMy5fcG9zaXRpb24uZGF0YSkpO30pO319KTt9fTt2YXIgZ3JvdXBDaGF0RmFjdG9yeT1mdW5jdGlvbiBncm91cENoYXRGYWN0b3J5KGh5cGVydHlVUkwsYnVzLGNvbmZpZyl7dmFyIHN5bmNoZXI9bmV3IF9TeW5jaGVyLlN5bmNoZXIoaHlwZXJ0eVVSTCxidXMsY29uZmlnKTt2YXIgaHlwZXJ0eURpc2NvdmVyeT1uZXcgX0h5cGVydHlEaXNjb3ZlcnkyLmRlZmF1bHQoaHlwZXJ0eVVSTCxidXMpO3ZhciB1cmk9bmV3IF91cmlqczIuZGVmYXVsdChoeXBlcnR5VVJMKTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKEdyb3VwQ2hhdEh5cGVydHkpLHsnX3Bvc2l0aW9uJzp7ZGF0YTp7dmFsdWU6e2Nvb3Jkczp7fX19fSwnc3luY2hlcic6c3luY2hlciwnaHlwZXJ0eURpc2NvdmVyeVNlcnZpY2UnOmh5cGVydHlEaXNjb3ZlcnksJ29iamVjdERlc2NVUkwnOidoeXBlcnR5LWNhdGFsb2d1ZTovLycrdXJpLmhvc3RuYW1lKCkrJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hcy9Db21tdW5pY2F0aW9uJywnbG9jYXRpb25EZXNjVVJMJzonaHlwZXJ0eS1jYXRhbG9ndWU6Ly8nK3VyaS5ob3N0bmFtZSgpKycvLndlbGwta25vd24vZGF0YXNjaGVtYXMvQ29udGV4dERhdGFTY2hlbWEnfSk7fTtmdW5jdGlvbiBhY3RpdmF0ZShoeXBlcnR5VVJMLGJ1cyxjb25maWcpe3JldHVybiB7bmFtZTonR3JvdXBDaGF0JyxpbnN0YW5jZTpncm91cENoYXRGYWN0b3J5KGh5cGVydHlVUkwsYnVzLGNvbmZpZyl9O31tb2R1bGUuZXhwb3J0cz1leHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9Hcm91cENoYXQiOjgsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvSHlwZXJ0eURpc2NvdmVyeSI6MSwic2VydmljZS1mcmFtZXdvcmsvZGlzdC9TeW5jaGVyIjoyLCJ1cmlqcyI6NX1dLDg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIl9fZXNNb2R1bGUiLHt2YWx1ZTp0cnVlfSk7ZXhwb3J0cy5kZWZhdWx0PWZ1bmN0aW9uKGRhdGFPYmplY3QscG9zaXRpb24pe3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoR3JvdXBDaGF0KSx7X2RhdGFPYmplY3Q6ZGF0YU9iamVjdCxuYW1lOmRhdGFPYmplY3QuZGF0YS5uYW1lLHN0YXJ0aW5nVGltZTpkYXRhT2JqZWN0LmRhdGEuc3RhcnRpbmdUaW1lLG1lc3NhZ2VzOltdLHBvc2l0aW9uOnBvc2l0aW9ufSk7fTt2YXIgX0dyb3VwQ2hhdE1lc3NhZ2U9cmVxdWlyZSgnLi9Hcm91cENoYXRNZXNzYWdlJyk7dmFyIF9Hcm91cENoYXRNZXNzYWdlMj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Hcm91cENoYXRNZXNzYWdlKTtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iail7cmV0dXJuIG9iaiYmb2JqLl9fZXNNb2R1bGU/b2JqOntkZWZhdWx0Om9ian07fXZhciBHcm91cENoYXQ9e3NlbmRNZXNzYWdlOmZ1bmN0aW9uIHNlbmRNZXNzYWdlKG1lc3NhZ2UsZGlzdGFuY2Upe3ZhciBfdGhpcz10aGlzO3JldHVybiB0aGlzLl9kYXRhT2JqZWN0LmFkZENoaWxkKCdjaGF0bWVzc2FnZXMnLHtjaGF0TWVzc2FnZTptZXNzYWdlLGRpc3RhbmNlOmRpc3RhbmNlLHBvc2l0aW9uOnRoaXMucG9zaXRpb24udmFsdWUuY29vcmRzfSkudGhlbihmdW5jdGlvbihjaGlsZCl7X3RoaXMubWVzc2FnZXMucHVzaCgoMCxfR3JvdXBDaGF0TWVzc2FnZTIuZGVmYXVsdCkoY2hpbGQsdHJ1ZSkpO3JldHVybiBfdGhpcy5tZXNzYWdlc1tfdGhpcy5tZXNzYWdlcy5sZW5ndGgtMV07fSk7fSxvbk1lc3NhZ2U6ZnVuY3Rpb24gb25NZXNzYWdlKGNhbGxiYWNrKXt2YXIgX3RoaXMyPXRoaXM7dGhpcy5fZGF0YU9iamVjdC5vbkFkZENoaWxkKGZ1bmN0aW9uKGNoaWxkKXt2YXIgY2hpbGREYXRhPWNoaWxkLmRhdGE/Y2hpbGQuZGF0YTpjaGlsZC52YWx1ZTtpZihjaGlsZERhdGEuZGlzdGFuY2UmJl90aGlzMi5fZGlzdGFuY2UoX3RoaXMyLnBvc2l0aW9uLmNvb3JkcyxjaGlsZERhdGEucG9zaXRpb24pPmRpc3RhbmNlKXJldHVybjtfdGhpczIubWVzc2FnZXMucHVzaCgoMCxfR3JvdXBDaGF0TWVzc2FnZTIuZGVmYXVsdCkoY2hpbGQsZmFsc2UpKTtjYWxsYmFjayhfdGhpczIubWVzc2FnZXNbX3RoaXMyLm1lc3NhZ2VzLmxlbmd0aC0xXSk7fSk7fSxfZGlzdGFuY2U6ZnVuY3Rpb24gX2Rpc3RhbmNlKGxhdDEsbG9uMSxsYXQyLGxvbjIsdW5pdCl7dmFyIHJhZGxhdDE9TWF0aC5QSSpsYXQxLzE4MDt2YXIgcmFkbGF0Mj1NYXRoLlBJKmxhdDIvMTgwO3ZhciB0aGV0YT1sb24xLWxvbjI7dmFyIHJhZHRoZXRhPU1hdGguUEkqdGhldGEvMTgwO3ZhciBkaXN0PU1hdGguc2luKHJhZGxhdDEpKk1hdGguc2luKHJhZGxhdDIpK01hdGguY29zKHJhZGxhdDEpKk1hdGguY29zKHJhZGxhdDIpKk1hdGguY29zKHJhZHRoZXRhKTtkaXN0PU1hdGguYWNvcyhkaXN0KTtkaXN0PWRpc3QqMTgwL01hdGguUEk7ZGlzdD1kaXN0KjYwKjEuMTUxNTtpZih1bml0PT0iSyIpe2Rpc3Q9ZGlzdCoxLjYwOTM0NDt9aWYodW5pdD09Ik4iKXtkaXN0PWRpc3QqMC44Njg0O31yZXR1cm4gZGlzdDt9fTttb2R1bGUuZXhwb3J0cz1leHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9Hcm91cENoYXRNZXNzYWdlIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjtPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywiX19lc01vZHVsZSIse3ZhbHVlOnRydWV9KTtleHBvcnRzLmRlZmF1bHQ9ZnVuY3Rpb24oZGF0YU9iamVjdENoaWxkLGlzTWUpe3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoR3JvdXBDaGF0TWVzc2FnZSkse19kYXRhT2JqZWN0Q2hpbGQ6ZGF0YU9iamVjdENoaWxkLGlzTWU6aXNNZSx0ZXh0OmRhdGFPYmplY3RDaGlsZC5kYXRhP2RhdGFPYmplY3RDaGlsZC5kYXRhLmNoYXRNZXNzYWdlOmRhdGFPYmplY3RDaGlsZC52YWx1ZS5jaGF0TWVzc2FnZX0pO307dmFyIEdyb3VwQ2hhdE1lc3NhZ2U9e307bW9kdWxlLmV4cG9ydHM9ZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7fV19LHt9LFs3XSkoNykKfSk7",
      "sourceCodeClassname": "GroupChat",
      "encoding": "base64",
      "signature": ""
    },
    "cguid": 10005,
    "type": "Hyperties",
    "version": "0.1",
    "description": "Description of GroupChat",
    "objectName": "GroupChat",
    "configuration": {},
    "sourcePackageURL": "/sourcePackage",
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "dataObjects": [],
    "accessControlPolicy": "somePolicy"
  },
  "LocationHyperty": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCkuZGVmYXVsdH19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciK28rIiciKTt0aHJvdyBmLmNvZGU9Ik1PRFVMRV9OT1RfRk9VTkQiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgX1N5bmNPYmplY3QgPSByZXF1aXJlKCcuL1N5bmNPYmplY3QnKTsKCnZhciBfU3luY09iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TeW5jT2JqZWN0KTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gcmVxdWlyZSgnLi9EYXRhT2JqZWN0Q2hpbGQnKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7Cgp2YXIgX3V0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMuanMnKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCi8qKgogKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuCiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KICovCgp2YXIgRGF0YU9iamVjdCA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX3ZlcnNpb246IG51bWJlcgogICBfb3duZXI6IEh5cGVydHlVUkwKICBfdXJsOiBPYmplY3RVUkwKICBfc2NoZW1hOiBTY2hlbWEKICBfYnVzOiBNaW5pQnVzCiAgX3N0YXR1czogb24gfCBwYXVzZWQKICBfc3luY09iajogU3luY0RhdGEKICAgX2NoaWxkcmVuOiB7IGlkOiBEYXRhT2JqZWN0Q2hpbGQgfQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCiAgX29uQWRkQ2hpbGRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIgY3JlYXRlIG9yIHN1YnNjcmliZSBtZXRob2QncwogICAqLwoKICBmdW5jdGlvbiBEYXRhT2JqZWN0KHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YU9iamVjdCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fc3luY2hlciA9IHN5bmNoZXI7CiAgICBfdGhpcy5fdXJsID0gdXJsOwogICAgX3RoaXMuX3NjaGVtYSA9IHNjaGVtYTsKICAgIF90aGlzLl9zdGF0dXMgPSBpbml0aWFsU3RhdHVzOwogICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgX1N5bmNPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwogICAgX3RoaXMuX2NoaWxkcmVucyA9IGNoaWxkcmVuczsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRGF0YU9iamVjdCwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgY2hpbGRCYXNlVVJMID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJzsKICAgICAgaWYgKF90aGlzLl9jaGlsZHJlbnMpIHsKICAgICAgICBfdGhpcy5fY2hpbGRyZW5zLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgICB2YXIgY2hpbGRVUkwgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsKICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hpbGRVUkwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgogICAgICAgICAgICBpZiAobXNnLmZyb20gIT09IF90aGlzMi5fb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdC1DaGlsZHJlbi1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzoKICAgICAgICAgICAgICAgICAgX3RoaXMuX29uQ2hpbGRDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICBfdGhpcy5fY2hhbmdlQ2hpbGRyZW4obXNnKTticmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikgewogICAgICAgIGxpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9KTsKCiAgICAgIE9iamVjdC5rZXlzKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKICAgICAqIEB0eXBlIHtPYmplY3RVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncGF1c2UnLAoKCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdG9wJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgY2hpbGRyZW4gdG8gdGhlIHN1YnNjcmlwdGlvbiBncm91cC4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXNvdXJjZSAtIFJlc291cmNlIG5hbWUsIG9uZSBvZiB0aGUgaXRlbXMgaW4gdGhlIHNjaGVtYS5wcm9wZXJ0aWVzLnNjaGVtZSBvZiB0aGUgcGFyZW50IG9iamVjdC4KICAgICAqIEBwYXJhbSB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIGNoaWxkCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RDaGlsZD59IC0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgQ2hpbGRyZW4uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKHJlc291cmNlLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIHJlc291cmNlOwoKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICB2YXIgbXNnSWQgPSBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2cpOwoKICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRlLXJlcG9ydGVyLWNoaWxkKCAnICsgX3RoaXMuX293bmVyICsgJyApOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB2YXIgbmV3Q2hpbGQgPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgbXNnQ2hpbGRJZCwgaW5pdGlhbERhdGEsIF90aGlzLl9vd25lciwgbXNnSWQpOwogICAgICAgIG5ld0NoaWxkLm9uQ2hhbmdlKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgX3RoaXMuX29uQ2hhbmdlKGV2ZW50LCB7IHBhdGg6IG1zZ0NoaWxkUGF0aCwgY2hpbGRJZDogbXNnQ2hpbGRJZCB9KTsKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKICAgICAgICByZXNvbHZlKG5ld0NoaWxkKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBjcmVhdGUgYW5kIGRlbGV0ZSBjaGlsZHJlbnMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkFkZENoaWxkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkFkZENoaWxkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uQ2hpbGRDcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoaWxkQ3JlYXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwoKICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1vYnNlcnZlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgbXNnKTsKICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIG1zZy5ib2R5LnZhbHVlKTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIGZyb206IG1zZy5mcm9tLAogICAgICAgIHVybDogbXNnLnRvLAogICAgICAgIHZhbHVlOiBtc2cuYm9keS52YWx1ZSwKICAgICAgICBjaGlsZElkOiBtc2dDaGlsZElkLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdBREQtQ0hJTERSRU4tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9zZW5kIGRlbHRhIG1lc3NhZ2VzIHRvIHN1YnNjcmlwdGlvbnMKCiAgfSwgewogICAga2V5OiAnX29uQ2hhbmdlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2UoZXZlbnQsIGNoaWxkSW5mbykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKCiAgICAgIGlmIChfdGhpcy5fc3RhdHVzID09PSAnb24nKSB7CiAgICAgICAgdmFyIGNoYW5nZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCiAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CiAgICAgICAgfTsKCiAgICAgICAgaWYgKGV2ZW50Lm9UeXBlID09PSBfU3luY09iamVjdC5PYmplY3RUeXBlLk9CSkVDVCkgewogICAgICAgICAgaWYgKGV2ZW50LmNUeXBlICE9PSBfU3luY09iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1N5bmNPYmplY3QuQ2hhbmdlVHlwZS5VUERBVEUpIHsKICAgICAgICAgICAgY2hhbmdlTXNnLmJvZHkub3BlcmF0aW9uID0gZXZlbnQuY1R5cGU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL2NoaWxkSW5mbyBtdXN0IGhhdmUgKHBhdGgsIGNoaWxkSWQpCiAgICAgICAgaWYgKGNoaWxkSW5mbykgewogICAgICAgICAgY2hhbmdlTXNnLnRvID0gY2hpbGRJbmZvLnBhdGg7CiAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5yZXNvdXJjZSA9IGNoaWxkSW5mby5jaGlsZElkOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShjaGFuZ2VNc2cpOwogICAgICB9CiAgICB9CgogICAgLy9yZWNlaXZlIGFuZCBwcm9jZXNzIGRlbHRhIG1lc3NhZ2VzCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwogICAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gPwogICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKICAgICAgICB2YXIgcGF0aCA9IG1zZy5ib2R5LmF0dHJpYnV0ZTsKICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwogICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKICAgICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gX1N5bmNPYmplY3QuT2JqZWN0VHlwZS5BUlJBWSkgewogICAgICAgICAgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1N5bmNPYmplY3QuQ2hhbmdlVHlwZS5BREQpIHsKICAgICAgICAgICAgdmFyIGFyciA9IGZpbmRSZXN1bHQub2JqOwogICAgICAgICAgICB2YXIgaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuYXBwbHkoYXJyLCBbaW5kZXgsIDBdLmNvbmNhdCh2YWx1ZSkpOwogICAgICAgICAgfSBlbHNlIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9TeW5jT2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIHZhciBfYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAobXNnLmJvZHkudmFsdWUpIHsKICAgICAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURSBvciBBREQKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRlbGV0ZSBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdOyAvLyBSRU1PVkUKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CiAgICAgICAgICBjb25zb2xlLmxvZygnVU5TWU5DSFJPTklaRUQgVkVSU0lPTjogKGRhdGEgPT4gJyArIF90aGlzLl92ZXJzaW9uICsgJywgbXNnID0+ICcgKyBtc2cuYm9keS52ZXJzaW9uICsgJyknKTsKICAgICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX2NoYW5nZUNoaWxkcmVuJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hhbmdlQ2hpbGRyZW4obXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGNvbnNvbGUubG9nKCdDaGFuZ2UgY2hpbGRyZW46ICcsIF90aGlzLl9vd25lciwgbXNnKTsKCiAgICAgIHZhciBjaGlsZElkID0gbXNnLmJvZHkucmVzb3VyY2U7CiAgICAgIHZhciBjaGlsZHJlbiA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF07CgogICAgICBpZiAoY2hpbGRyZW4pIHsKICAgICAgICBfdGhpcy5fY2hhbmdlT2JqZWN0KGNoaWxkcmVuLl9zeW5jT2JqLCBtc2cpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCdObyBjaGlsZHJlbiBmb3VuZCBmb3I6ICcsIGNoaWxkSWQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAndXJsJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fdXJsOwogICAgfQoKICAgIC8qKgogICAgICogT2JqZWN0IHNjaGVtYSBVUkwgKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U2NoZW1hVVJMfQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3NjaGVtYScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtYTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0YXR1cyBvZiB0aGUgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIgY29ubmVjdGlvbiAodGhpcyBmaWVsZCBpcyBub3QgeWV0IHN0YWJsZSwgYW5kIGlzIHN1YnNqZWN0IHRvIGNoYW5nZSkKICAgICAqIEB0eXBlIHtTdGF0dXN9IC0gRW51bSBvZjogb24gfCBwYXVzZWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdGF0dXMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdGF0dXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBEYXRhIHN0cnVjdHVyZSB0byBiZSBzeW5jaHJvbml6ZWQuCiAgICAgKiBAdHlwZSB7SlNPTn0gLSBKU09OIHN0cnVjdHVyZSB0aGF0IHNob3VsZCBmb2xsb3cgdGhlIGRlZmluZWQgc2NoZW1hLCBpZiBhbnkuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGF0YScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N5bmNPYmouZGF0YTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbCBjcmVhdGVkIGNoaWxkcmVuJ3Mgc2luY2UgdGhlIHN1YnNjcmlwdGlvbiwgZG9lc24ndCBjb250YWluIGFsbCBjaGlsZHJlbidzIHNpbmNlIHJlcG9ydGVyIGNyZWF0aW9uLgogICAgICogQHR5cGUge09iamVjdDxDaGlsZElkLCBEYXRhT2JqZWN0Q2hpbGQ+fQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVucycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuT2JqZWN0czsKICAgIH0KICB9XSk7CgogIHJldHVybiBEYXRhT2JqZWN0Owp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0OwoKfSx7Ii4uL3V0aWxzL3V0aWxzLmpzIjo4LCIuL0RhdGFPYmplY3RDaGlsZCI6MiwiLi9TeW5jT2JqZWN0Ijo2fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnZhciBfU3luY09iamVjdCA9IHJlcXVpcmUoJy4vU3luY09iamVjdCcpOwoKdmFyIF9TeW5jT2JqZWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiAqIFRoZSBjbGFzcyByZXR1cm5lZCBmcm9tIHRoZSBEYXRhT2JqZWN0IGFkZENoaWxkcmVuIGNhbGwgb3IgZnJvbSBvbkFkZENoaWxkcmVuIGlmIHJlbW90ZWx5IGNyZWF0ZWQuCiAqIENoaWxkcmVuIG9iamVjdCBzeW5jaHJvbml6YXRpb24gaXMgYSBhIGZhc3QgZm9yd2FyZCBtZWNoYW5pc20sIG5vIG5lZWQgZm9yIGRpcmVjdCBzdWJzY3JpcHRpb25zLCBpdCB1c2VzIHRoZSBhbHJlYWR5IGF1dGhvcml6ZWQgc3Vic2NyaXB0aW9uIGZyb20gdGhlIHBhcmVudCBEYXRhT2JqZWN0LgogKi8KCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCiAgICovCgogIGZ1bmN0aW9uIERhdGFPYmplY3RDaGlsZChwYXJlbnQsIGNoaWxkSWQsIGluaXRpYWxEYXRhLCBvd25lciwgbXNnSWQpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEYXRhT2JqZWN0Q2hpbGQpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3BhcmVudCA9IHBhcmVudDsKICAgIF90aGlzLl9jaGlsZElkID0gY2hpbGRJZDsKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX21zZ0lkID0gbXNnSWQ7CgogICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgX1N5bmNPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwoKICAgIF90aGlzLl9idXMgPSBwYXJlbnQuX2J1czsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERhdGFPYmplY3RDaGlsZCwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy90aGlzIGlzIG9ubHkgbmVlZGVkIGZvciBjaGlsZHJlbiByZXBvcnRlcnMKICAgICAgaWYgKF90aGlzLl9vd25lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX293bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICBpZiAobXNnLnR5cGUgPT09ICdyZXNwb25zZScgJiYgbXNnLmlkID09PSBfdGhpcy5fbXNnSWQpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RDaGlsZC5vblJlc3BvbnNlOicsIG1zZyk7CiAgICAgICAgICAgIF90aGlzLl9vblJlc3BvbnNlKG1zZyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX2xpc3RlbmVyKSB7CiAgICAgICAgX3RoaXMuX2xpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBkZWxldGUgX3RoaXMuX3BhcmVudC5fY2hpbGRyZW5bX3RoaXMuX2NoaWxkSWRdOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgIC8vVE9ETzogc2VuZCBkZWxldGUgbWVzc2FnZSA/CiAgICB9CgogICAgLyoqCiAgICAgKiBDaGlsZHJlbiBJRCBnZW5lcmF0ZWQgb24gYWRkQ2hpbGRyZW4uIFVuaXF1ZSBpZGVudGlmaWVyCiAgICAgKiBAdHlwZSB7VVJMfSAtIFVSTCBvZiB0aGUgZm9ybWF0IDxIeXBlcnR5VVJMPiM8bnVtZXJpYy1zZXF1ZW5jZT4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCgoKICAgIC8qKgogICAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIgY2hpbGQKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjYWxsYmFjayhldmVudCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVzcG9uc2Ugbm90aWZpY2F0aW9ucyBvZiB0aGUgY3JlYXRlcwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZElkJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIERhdGFPYmplY3RDaGlsZDsKfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdENoaWxkOwoKfSx7Ii4vU3luY09iamVjdCI6Nn1dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07Cgp2YXIgX0RhdGFPYmplY3QyID0gcmVxdWlyZSgnLi9EYXRhT2JqZWN0Jyk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQgPSByZXF1aXJlKCcuL0RhdGFPYmplY3RDaGlsZCcpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikgPyBjYWxsIDogc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgRmlsdGVyVHlwZSA9IHsgQU5ZOiAnYW55JywgU1RBUlQ6ICdzdGFydCcsIEVYQUNUOiAnZXhhY3QnIH07CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgc3Vic2NyaWJlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYW4gb2JzZXJ2YXRpb24gcG9pbnQgZnJvbSBhIERhdGFPYmplY3RSZXBvcnRlciBjaGFuZ2UuCiAqLwoKdmFyIERhdGFPYmplY3RPYnNlcnZlciA9IGZ1bmN0aW9uIChfRGF0YU9iamVjdCkgewogIF9pbmhlcml0cyhEYXRhT2JqZWN0T2JzZXJ2ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9jaGFuZ2VMaXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9maWx0ZXJzOiB7PGZpbHRlcj46IHt0eXBlOiA8c3RhcnQsIGV4YWN0PiwgY2FsbGJhY2s6IDxmdW5jdGlvbj59IH0KICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuc3Vic2NyaWJlIG1ldGhvZAogICAqLwoKICBmdW5jdGlvbiBEYXRhT2JqZWN0T2JzZXJ2ZXIoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMsIGluaXRpYWxWZXJzaW9uKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKERhdGFPYmplY3RPYnNlcnZlcikuY2FsbCh0aGlzLCBzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEuZGF0YSwgY2hpbGRyZW5zKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl92ZXJzaW9uID0gaW5pdGlhbFZlcnNpb247CiAgICBfdGhpcy5fZmlsdGVycyA9IHt9OwoKICAgIF90aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIF90aGlzLl9vbkZpbHRlcihldmVudCk7CiAgICB9KTsKCiAgICAvL3NldHVwIGNoaWxkcmVucyBkYXRhIGZyb20gc3Vic2NyaXB0aW9uCiAgICBPYmplY3Qua2V5cyhpbml0aWFsRGF0YS5jaGlsZHJlbnMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERhdGFPYmplY3RPYnNlcnZlciwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIucmVtb3ZlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3Vuc3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciB1blN1YnNjcmliZU1zZyA9IHsKICAgICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IF90aGlzLl91cmwgfQogICAgICB9OwoKICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh1blN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci1VTlNVQlNDUklCRTogJywgcmVwbHkpOwogICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fb2JzZXJ2ZXJzW190aGlzLl91cmxdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWdpc3RlciB0aGUgY2hhbmdlIGxpc3RlbmVycyBzZW50IGJ5IHRoZSByZXBvcnRlcgogICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbHRlciAtIEZpbHRlciB0aGF0IGlkZW50aWZpZXMgdGhlIGZpZWxkIChzZXBhcmV0ZWQgZG90IHBhdGgpLiBBY2NlcHRzICogYXQgdGhlIGVuZCBmb3IgYSBtb3JlIHVucmVzdHJpY3RlZCBmaWx0ZXJpbmcuCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGZpbHRlciwgY2FsbGJhY2spIHsKICAgICAgdmFyIGtleSA9IGZpbHRlcjsKICAgICAgdmFyIGZpbHRlck9iaiA9IHsKICAgICAgICB0eXBlOiBGaWx0ZXJUeXBlLkVYQUNULAogICAgICAgIGNhbGxiYWNrOiBjYWxsYmFjawogICAgICB9OwoKICAgICAgdmFyIGlkeCA9IGZpbHRlci5pbmRleE9mKCcqJyk7CiAgICAgIGlmIChpZHggPT09IGZpbHRlci5sZW5ndGggLSAxKSB7CiAgICAgICAgaWYgKGlkeCA9PT0gMCkgewogICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLkFOWTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLlNUQVJUOwogICAgICAgICAga2V5ID0gZmlsdGVyLnN1YnN0cigwLCBmaWx0ZXIubGVuZ3RoIC0gMSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLl9maWx0ZXJzW2tleV0gPSBmaWx0ZXJPYmo7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uRmlsdGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25GaWx0ZXIoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIE9iamVjdC5rZXlzKF90aGlzLl9maWx0ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICB2YXIgZmlsdGVyID0gX3RoaXMuX2ZpbHRlcnNba2V5XTsKICAgICAgICBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuQU5ZKSB7CiAgICAgICAgICAvL21hdGNoIGFueXRoaW5nCiAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuU1RBUlQpIHsKICAgICAgICAgIC8vaWYgc3RhcnRzIHdpdGggZmlsdGVyLi4uCiAgICAgICAgICBpZiAoZXZlbnQuZmllbGQuaW5kZXhPZihrZXkpID09PSAwKSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5FWEFDVCkgewogICAgICAgICAgLy9leGFjdCBtYXRjaAogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkID09PSBrZXkpIHsKICAgICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwoKfSx7Ii4vRGF0YU9iamVjdCI6MSwiLi9EYXRhT2JqZWN0Q2hpbGQiOjJ9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7Cgp2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9OwoKdmFyIF9EYXRhT2JqZWN0MiA9IHJlcXVpcmUoJy4vRGF0YU9iamVjdCcpOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscy91dGlscy5qcycpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBjcmVhdGUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhIHJlcG9ydGVyIHBvaW50LCBjaGFuZ2VzIHdpbGwgYmUgc3VibWl0ZWQgdG8gRGF0YU9iamVjdE9ic2VydmVyIGluc3RhbmNlcy4KICovCgp2YXIgRGF0YU9iamVjdFJlcG9ydGVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgX2luaGVyaXRzKERhdGFPYmplY3RSZXBvcnRlciwgX0RhdGFPYmplY3QpOwoKICAvKiBwcml2YXRlCiAgX3N1YnNjcmlwdGlvbnM6IDxoeXBlcnR5VXJsOiB7IHN0YXR1czogc3RyaW5nIH0gfT4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblN1YnNjcmlwdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLmNyZWF0ZSBtZXRob2QKICAgKi8KCiAgZnVuY3Rpb24gRGF0YU9iamVjdFJlcG9ydGVyKHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKERhdGFPYmplY3RSZXBvcnRlcikuY2FsbCh0aGlzLCBzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fc3Vic2NyaXB0aW9ucyA9IHt9OwoKICAgIF90aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItJyArIHVybCArICctU0VORDogJywgZXZlbnQpOwogICAgICBfdGhpcy5fb25DaGFuZ2UoZXZlbnQpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERhdGFPYmplY3RSZXBvcnRlciwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fcmVzcG9uc2VMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJykgewogICAgICAgICAgX3RoaXMuX29uUmVzcG9uc2UobXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fcmVzcG9uc2VMaXN0ZW5lci5yZW1vdmUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdpbnZpdGVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGludml0ZU9ic2VydmVycyhvYnNlcnZlcnMpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBpbnZpdGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9zeW5jaGVyLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCwgc2NoZW1hOiBfdGhpcy5fc2NoZW1hLCB2YWx1ZTogX3RoaXMuX3N5bmNPYmouZGF0YSwgYXV0aG9yaXNlOiBvYnNlcnZlcnMgfQogICAgICB9OwoKICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShpbnZpdGVNc2cpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGRlbGV0ZU1zZyA9IHsKICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZGVsZXRlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLURFTEVURTogJywgcmVwbHkpOwogICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fcmVwb3J0ZXJzW190aGlzLl91cmxdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdWJzY3JpcHRpb25zIHJlcXVlc3RlZCBhbmQgYWNjZXB0ZWQgdG8gdGhpcyByZXBvcnRlcgogICAgICogQHR5cGUge09iamVjdDxIeXBlcnR5VVJMLCBTeW5jU3Vic2NyaXB0aW9uPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblN1YnNjcmlwdGlvbicsCgoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3Mgc3Vic2NyaWJlIGFuZCB1bnN1YnNjcmliZSBub3RpZmljYXRpb25zCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvblN1YnNjcmlwdGlvbihjYWxsYmFjaykgewogICAgICB0aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZSdzCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNwb25zZShjYWxsYmFjaykgewogICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblN1YnNjcmliZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy5ib2R5LnR5cGUsCiAgICAgICAgdXJsOiBoeXBlcnR5VXJsLAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgT2JqZWN0LmtleXMoX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRJZCkgewogICAgICAgICAgICB2YXIgY2hpbGREYXRhID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXS5kYXRhOwogICAgICAgICAgICBjaGlsZHJlblZhbHVlc1tjaGlsZElkXSA9ICgwLCBfdXRpbHMuZGVlcENsb25lKShjaGlsZERhdGEpOwogICAgICAgICAgfSk7CgogICAgICAgICAgLy9zZW5kIG9rIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmVyc2lvbjogX3RoaXMuX3ZlcnNpb24sIHZhbHVlOiB7IGRhdGE6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSwgY2hpbGRyZW5zOiBjaGlsZHJlblZhbHVlcyB9IH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19vblVuU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25VblN1YnNjcmliZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwoKICAgICAgdmFyIHN1YiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdOwogICAgICBkZWxldGUgX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLmJvZHkudHlwZSwKICAgICAgICB1cmw6IGh5cGVydHlVcmwsCiAgICAgICAgb2JqZWN0OiBzdWIKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1VOLVNVQlNDUklQVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlc3BvbnNlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdSRVNQT05TRS1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdzdWJzY3JpcHRpb25zJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaXB0aW9uczsKICAgIH0KICB9XSk7CgogIHJldHVybiBEYXRhT2JqZWN0UmVwb3J0ZXI7Cn0oX0RhdGFPYmplY3QzLmRlZmF1bHQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RSZXBvcnRlcjsKCn0seyIuLi91dGlscy91dGlscy5qcyI6OCwiLi9EYXRhT2JqZWN0IjoxfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8qKgogKiBAYWNjZXNzIHByaXZhdGUKICovCgp2YXIgRGF0YVByb3Zpc2lvbmFsID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfY2hpbGRyZW5MaXN0ZW5lcnM6IFtNc2dMaXN0ZW5lcl0KICBfbGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIF9jaGFuZ2VzOiBbXQogICovCgogIGZ1bmN0aW9uIERhdGFQcm92aXNpb25hbChvd25lciwgdXJsLCBidXMsIGNoaWxkcmVuKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YVByb3Zpc2lvbmFsKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9idXMgPSBidXM7CiAgICBfdGhpcy5fY2hpbGRyZW4gPSBjaGlsZHJlbjsKCiAgICBfdGhpcy5fY2hhbmdlcyA9IFtdOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsKICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOyovCiAgICB9CiAgfSwgewogICAga2V5OiAnYXBwbHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5KG9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgIG9ic2VydmVyLl9jaGFuZ2VPYmplY3Qob2JzZXJ2ZXIuX3N5bmNPYmosIGNoYW5nZSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVuJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRGF0YVByb3Zpc2lvbmFsOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhUHJvdmlzaW9uYWw7Cgp9LHt9XSw2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk9iamVjdFR5cGUgPSBleHBvcnRzLkNoYW5nZVR5cGUgPSB1bmRlZmluZWQ7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgX3V0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMuanMnKTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKi8KCnZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgIF9kYXRhOiBhbnk7CiAgICBfb2JzZXJ2ZXJzOiAoKGV2ZW50OiBDaGFuZ2VFdmVudCkgPT4gdm9pZClbXQogICovCgogIGZ1bmN0aW9uIFN5bmNPYmplY3QoaW5pdGlhbERhdGEpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTeW5jT2JqZWN0KTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vYnNlcnZlcnMgPSBbXTsKICAgIF90aGlzLl9maWx0ZXJzID0ge307CgogICAgaWYgKGluaXRpYWxEYXRhKSB7CiAgICAgIF90aGlzLl9kYXRhID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGluaXRpYWxEYXRhKTsKICAgIH0gZWxzZSB7CiAgICAgIF90aGlzLl9kYXRhID0ge307CiAgICB9CgogICAgX3RoaXMuX2ludGVybmFsT2JzZXJ2ZShuZXcgUGF0aCgpLCBfdGhpcy5fZGF0YSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU3luY09iamVjdCwgW3sKICAgIGtleTogJ29ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocGF0aCkgewogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCiAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmRCZWZvcmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCZWZvcmUocGF0aCkgewogICAgICB2YXIgcmVzdWx0ID0ge307CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwogICAgICByZXN1bHQubGFzdCA9IGxpc3QucG9wKCk7CiAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRXaXRoU3BsaXQobGlzdCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG9iaiA9IG9ialt2YWx1ZV07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmlyZUV2ZW50JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlyZUV2ZW50KGV2ZW50KSB7CiAgICAgIHRoaXMuX29ic2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgICAgIGNhbGxiYWNrKGV2ZW50KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2lzT2JzZXJ2YWJsZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2lzT2JzZXJ2YWJsZShvYmopIHsKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0IHx8IG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogJ19pbnRlcm5hbE9ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbE9ic2VydmUocGF0aCwgb2JqKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX2lzT2JzZXJ2YWJsZShvYmopKSB7CiAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKGNoYW5nZXMpIHsKICAgICAgICAgIF90aGlzLl9vbkNoYW5nZXMocGF0aCwgY2hhbmdlcyk7CiAgICAgICAgfTsKCiAgICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgICBPYmplY3Qub2JzZXJ2ZShvYmosIGhhbmRsZXIpOwogICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHsKICAgICAgICAgICAgaWYgKF90aGlzLl9pc09ic2VydmFibGUob2JqW3Byb3BdKSkgewogICAgICAgICAgICAgIF90aGlzLl9pbnRlcm5hbE9ic2VydmUocGF0aC5uZXcocHJvcCksIG9ialtwcm9wXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKICAgICAgICAgIEFycmF5Lm9ic2VydmUob2JqLCBoYW5kbGVyKTsKICAgICAgICAgIGZvciAodmFyIF9wcm9wIGluIG9iaikgewogICAgICAgICAgICBpZiAoX3RoaXMuX2lzT2JzZXJ2YWJsZShvYmpbX3Byb3BdKSkgewogICAgICAgICAgICAgIHZhciBucCA9IHBhdGgubmV3KG5ldyBBcnJheUluZGV4KG9ialtfcHJvcF0sIF9wcm9wKSk7CiAgICAgICAgICAgICAgX3RoaXMuX2ludGVybmFsT2JzZXJ2ZShucCwgb2JqW19wcm9wXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKHBhdGgsIGNoYW5nZXMpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBmb3IgKHZhciBpIGluIGNoYW5nZXMpIHsKICAgICAgICB2YXIgb2JqID0gY2hhbmdlc1tpXS5vYmplY3Q7CiAgICAgICAgdmFyIG9ialR5cGUgPSB2b2lkIDA7CgogICAgICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IE9iamVjdCkgewogICAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICAgIH0KCiAgICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKICAgICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNoYW5nZXNbaV0udHlwZSA9PT0gJ3NwbGljZScpIHsKICAgICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBpZHggPSBjaGFuZ2VzW2ldLmluZGV4OwogICAgICAgICAgICB2YXIgZmllbGQgPSBwYXRoLm5ldygnJyArIGlkeCk7CiAgICAgICAgICAgIHZhciBmaWVsZFN0cmluZyA9IGZpZWxkLnRvU3RyaW5nKCk7CgogICAgICAgICAgICB2YXIgcmVtb3ZlU2l6ZSA9IGNoYW5nZXNbaV0ucmVtb3ZlZC5sZW5ndGg7CiAgICAgICAgICAgIGlmIChyZW1vdmVTaXplICE9PSAwKSB7CiAgICAgICAgICAgICAgdmFyIHJlbW92ZVZhbHVlcyA9IGNoYW5nZXNbaV0ucmVtb3ZlZDsKICAgICAgICAgICAgICByZW1vdmVWYWx1ZXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9pc09ic2VydmFibGUodmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgIHBhdGgucmVtb3ZlSW5kZXgoaWR4ICsgaW5kZXgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBfdGhpczIuX2ZpcmVFdmVudCh7CiAgICAgICAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5SRU1PVkUsCiAgICAgICAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgICAgICAgIGRhdGE6IHJlbW92ZVNpemUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGFkZFNpemUgPSBjaGFuZ2VzW2ldLmFkZGVkQ291bnQ7CiAgICAgICAgICAgIGlmIChhZGRTaXplICE9PSAwKSB7CiAgICAgICAgICAgICAgdmFyIGFkZFZhbHVlcyA9IG9iai5zbGljZShpZHgsIGlkeCArIGFkZFNpemUpOwogICAgICAgICAgICAgIGFkZFZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHsKICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX2lzT2JzZXJ2YWJsZSh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgdmFyIG5wID0gcGF0aC5uZXcobmV3IEFycmF5SW5kZXgodmFsdWUsIGlkeCArIGluZGV4KSk7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5faW50ZXJuYWxPYnNlcnZlKG5wLCB2YWx1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF90aGlzMi5fZmlyZUV2ZW50KHsKICAgICAgICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLkFERCwKICAgICAgICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAogICAgICAgICAgICAgICAgZGF0YTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKGFkZFZhbHVlcykKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9yZS1kZWZpbmUgcGF0aHMuLi4KICAgICAgICAgICAgaWYgKGlkeCAhPT0gb2JqLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICBwYXRoLnJlSW5kZXhGcm9tKG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBfZmllbGQgPSBwYXRoLm5ldyhjaGFuZ2VzW2ldLm5hbWUpOwogICAgICAgICAgdmFyIF9maWVsZFN0cmluZyA9IF9maWVsZC50b1N0cmluZygpOwoKICAgICAgICAgIGlmIChfZmllbGRTdHJpbmcuaW5kZXhPZignU3ltYm9sJykgIT09IC0xKSB7CiAgICAgICAgICAgIC8vaGFjayBmb3IgUGhhbnRvbUpTMgogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdTWU1CT0w6ICcsIGNoYW5nZXNbaV0pOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICAvL2xldCBvbGRWYWx1ZSA9IGNoYW5nZXNbaV0ub2xkVmFsdWU7CiAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlc1tpXS5uYW1lXTsKICAgICAgICAgIGlmIChjaGFuZ2VzW2ldLnR5cGUgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuVVBEQVRFLAogICAgICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgICAgIGZpZWxkOiBfZmllbGRTdHJpbmcsCiAgICAgICAgICAgICAgZGF0YTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKG5ld1ZhbHVlKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY2hhbmdlc1tpXS50eXBlID09PSAnYWRkJykgewogICAgICAgICAgICB0aGlzLl9pbnRlcm5hbE9ic2VydmUoX2ZpZWxkLCBuZXdWYWx1ZSk7CiAgICAgICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAogICAgICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgICAgIGZpZWxkOiBfZmllbGRTdHJpbmcsCiAgICAgICAgICAgICAgZGF0YTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKG5ld1ZhbHVlKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY2hhbmdlc1tpXS50eXBlID09PSAnZGVsZXRlJykgewogICAgICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlJFTU9WRSwKICAgICAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgICAgICBmaWVsZDogX2ZpZWxkU3RyaW5nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kYXRhOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFN5bmNPYmplY3Q7Cn0oKTsKCi8vZHluYW1pYyBwYXRoIGZvciBBcnJheSBpbmRleC4uLgoKCnZhciBQYXRoID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFBhdGgoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGF0aCk7CgogICAgdGhpcy5fcGF0aCA9IFtdOwogICAgdGhpcy5fb2JzZXJ2YWJsZXMgPSB7fTsgLy88aW5kZXg6QXJyYXlJbmRleD4KICB9CgogIF9jcmVhdGVDbGFzcyhQYXRoLCBbewogICAga2V5OiAncmVtb3ZlSW5kZXgnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUluZGV4KGlkeCkgewogICAgICAvL2NvbnNvbGUubG9nKCdSRU1PVkUtUEFUSCAnICsgaWR4KTsKICAgICAgZGVsZXRlIHRoaXMuX29ic2VydmFibGVzW2lkeF07CiAgICB9CiAgfSwgewogICAga2V5OiAncmVJbmRleEZyb20nLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlSW5kZXhGcm9tKGFycmF5KSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgT2JqZWN0LmtleXModGhpcy5fb2JzZXJ2YWJsZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHZhciBhcnJheUluZGV4ID0gX3RoaXMzLl9vYnNlcnZhYmxlc1trZXldOwogICAgICAgIHZhciBpZHggPSBhcnJheS5pbmRleE9mKGFycmF5SW5kZXgub2JqKTsKICAgICAgICBpZiAoYXJyYXlJbmRleC5pZHggIT0gaWR4KSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdSRS1JTkRFWDogJyArIGtleSArICctPicgKyBpZHgpOwogICAgICAgICAgYXJyYXlJbmRleC5pZHggPSBpZHg7CiAgICAgICAgICBkZWxldGUgX3RoaXMzLl9vYnNlcnZhYmxlc1trZXldOwogICAgICAgICAgX3RoaXMzLl9vYnNlcnZhYmxlc1tpZHhdID0gYXJyYXlJbmRleDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ25ldycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX25ldyhpZHgpIHsKICAgICAgaWYgKGlkeC5jb25zdHJ1Y3RvciA9PSBBcnJheUluZGV4KSB7CiAgICAgICAgLy9jb25zb2xlLmxvZygnUEFUSC1PQlNFUlY6ICcsIGlkeCk7CiAgICAgICAgdGhpcy5fb2JzZXJ2YWJsZXNbaWR4LmlkeF0gPSBpZHg7CiAgICAgIH0KCiAgICAgIHZhciBuUGF0aCA9IHRoaXMuY2xvbmUoKTsKICAgICAgblBhdGguX3BhdGgucHVzaChpZHgpOwoKICAgICAgcmV0dXJuIG5QYXRoOwogICAgfQogIH0sIHsKICAgIGtleTogJ2Nsb25lJywKICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHsKICAgICAgdmFyIG5QYXRoID0gbmV3IFBhdGgoKTsKICAgICAgdGhpcy5fcGF0aC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG5QYXRoLl9wYXRoLnB1c2godmFsdWUpOwogICAgICB9KTsKCiAgICAgIHJldHVybiBuUGF0aDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICd0b1N0cmluZycsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgIC8vVE9ETzogb3B0aW1pemUhIQogICAgICB2YXIgc3RyID0gJyc7CiAgICAgIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7CiAgICAgICAgICBzdHIgPSB2YWx1ZS50b1N0cmluZygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdHIgKz0gJy4nICsgdmFsdWUudG9TdHJpbmcoKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHN0cjsKICAgIH0KICB9XSk7CgogIHJldHVybiBQYXRoOwp9KCk7Cgp2YXIgQXJyYXlJbmRleCA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBBcnJheUluZGV4KG9iaiwgaWR4KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXJyYXlJbmRleCk7CgogICAgdGhpcy5vYmogPSBvYmo7CiAgICB0aGlzLmlkeCA9IGlkeDsKICB9CgogIF9jcmVhdGVDbGFzcyhBcnJheUluZGV4LCBbewogICAga2V5OiAndG9TdHJpbmcnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogICAgICByZXR1cm4gdGhpcy5pZHgudG9TdHJpbmcoKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBcnJheUluZGV4Owp9KCk7Cgp2YXIgQ2hhbmdlVHlwZSA9IGV4cG9ydHMuQ2hhbmdlVHlwZSA9IHsgVVBEQVRFOiAndXBkYXRlJywgQUREOiAnYWRkJywgUkVNT1ZFOiAncmVtb3ZlJyB9Owp2YXIgT2JqZWN0VHlwZSA9IGV4cG9ydHMuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAnb2JqZWN0JywgQVJSQVk6ICdhcnJheScgfTsKZXhwb3J0cy5kZWZhdWx0ID0gU3luY09iamVjdDsKCn0seyIuLi91dGlscy91dGlscy5qcyI6OH1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IHJlcXVpcmUoJy4vRGF0YU9iamVjdFJlcG9ydGVyJyk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSByZXF1aXJlKCcuL0RhdGFPYmplY3RPYnNlcnZlcicpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdE9ic2VydmVyKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsID0gcmVxdWlyZSgnLi9EYXRhUHJvdmlzaW9uYWwnKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgovKioKICogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCiAqIFRoZSBTeW5jaGVyIGlzIGEgc2luZ2xldG9uIGNsYXNzIHBlciBIeXBlcnR5L1VSTCBhbmQgaXQgaXMgdGhlIG93bmVyIG9mIGFsbCBjcmVhdGVkIERhdGEgU3luYyBPYmplY3RzIGFjY29yZGluZyB0byB0aGUgUmVwb3J0ZXIgLSBPYnNlcnZlciBwYXR0ZXJuLgogKiBNYWluIGZ1bmN0aW9uYWxpdHkgaXMgdG8gY3JlYXRlIHJlcG9ydGVycyBhbmQgdG8gc3Vic2NyaWJlIHRvIGV4aXN0aW5nIG9uZXMuCiAqLwoKdmFyIFN5bmNoZXIgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9vd25lcjogVVJMCiAgX2J1czogTWluaUJ1cwogICBfc3ViVVJMOiBVUkwKICAgX3JlcG9ydGVyczogPHVybDogRGF0YU9iamVjdFJlcG9ydGVyPgogIF9vYnNlcnZlcnM6IDx1cmw6IERhdGFPYmplY3RPYnNlcnZlcj4KICBfcHJvdmlzaW9uYWxzOiA8dXJsOiBEYXRhUHJvdmlzaW9uYWw+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25Ob3RpZmljYXRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBDb25zdHJ1Y3RvciB0aGF0IHNob3VsZCBiZSB1c2VkIGJ5IHRoZSBIeXBlcnR5IG93bmVyCiAgICogQHBhcmFtIHtIeXBlcnR5VVJMfSBvd25lciAtIEh5cGVydHkgVVJMIG93bmVyLiBBbiBVUkwgYWxsb2NhdGVkIGJ5IHRoZSBydW50aW1lIHRoYXQgdW5pcXVlbHkgaWRlbnRpZmllcyB0aGUgSHlwZXJ0eS4KICAgKiBAcGFyYW0ge01pbmlCdXN9IGJ1cyAtIEFuIGluc3RhbmNlIG9mIHRoZSBNaW5pQnVzIHByb3ZpZGVkIGluIHRoZSBzYW5kYm94LiBXaGVuIGFuIG9iamVjdCAoUmVwb3J0ZXIgb3IgT2JzZXJ2ZWQpIGlzIGNyZWF0ZWQsIHRoZSBTeW5jaGVyTWFuYWdlciB3aWxsIGFkZCBhIGxpc3RlbmVyIGluIHRoZSBNaW5pQnVzIHRvIHJlY2VpdmUvc2VuZCBNZXNzYWdlcyBvZiB0aGF0IG9iamVjdC4KICAgKiBAcGFyYW0ge0pTT059IGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgZm9yIG5vdyBpcyB0aGUgcnVudGltZVVSTC4KICAgKi8KCiAgZnVuY3Rpb24gU3luY2hlcihvd25lciwgYnVzLCBjb25maWcpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTeW5jaGVyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKCiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307CiAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgogICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTeW5jaGVyLVJDVjogJywgbXNnKTsKICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CiAgICAgICAgICBjYXNlICdmb3J3YXJkJzoKICAgICAgICAgICAgX3RoaXMuX29uRm9yd2FyZChtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAnY3JlYXRlJzoKICAgICAgICAgICAgX3RoaXMuX29uUmVtb3RlQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVEZWxldGUobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0KCiAgLyoqCiAgICogVGhlIG93bmVyIG9mIHRoZSBTeW5jaGVyIGFuZCBhbGwgY3JlYXRlZCByZXBvcnRlcnMuCiAgICogQHR5cGUge0h5cGVydHlVUkx9CiAgICovCgoKICBfY3JlYXRlQ2xhc3MoU3luY2hlciwgW3sKICAgIGtleTogJ2NyZWF0ZScsCgoKICAgIC8qKgogICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uCiAgICAgKiBAcGFyYW0gIHtTY2hlbWFVUkx9IHNjaGVtYSAtIFVSTCBvZiB0aGUgb2JqZWN0IGRlc2NyaXB0b3IKICAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgogICAgICogQHBhcmFtICB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIHJlcG9ydGVyCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZShzY2hlbWEsIG9ic2VydmVycywgaW5pdGlhbERhdGEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGluaXRpYWxEYXRhLnJlcG9ydGVyID0gX3RoaXMuX293bmVyOwogICAgICBpbml0aWFsRGF0YS5zY2hlbWEgPSBzY2hlbWE7CgogICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHNjaGVtYTogc2NoZW1hLCB2YWx1ZTogaW5pdGlhbERhdGEsIGF1dGhvcmlzZTogb2JzZXJ2ZXJzIH0KICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgLy9yZXF1ZXN0IGNyZWF0ZSB0byB0aGUgQWxsb2NhdGlvbiBzeXN0ZW0/IENhbiBiZSByZWplY3RlZCBieSB0aGUgUG9saWN5RW5naW5lLgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVxdWVzdE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRlLXJlc3BvbnNlOiAnLCByZXBseSk7CiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICAvL3JlcG9ydGVyIGNyZWF0aW9uIGFjY2VwdGVkCiAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RSZXBvcnRlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsICdvbicsIGluaXRpYWxEYXRhLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3JlcG9ydGVyc1tvYmpVUkxdID0gbmV3T2JqOwoKICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiByZWplY3RlZAogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IG9iamVjdC4KICAgICAqIEBwYXJhbSB7U2NoZW1hVVJMfSBzY2hlbWEgLSBVUkwgb2YgdGhlIG9iamVjdCBkZXNjcmlwdG9yCiAgICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0CiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLgogICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHZhbGlkYXRlIGlmIHN1YnNjcmlwdGlvbiBhbHJlYWR5IGV4aXN0cyA/CiAgICAgIHZhciBzdWJzY3JpYmVNc2cgPSB7CiAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyBzY2hlbWE6IHNjaGVtYSwgcmVzb3VyY2U6IG9ialVSTCB9CiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CiAgICAgICAgICB2YXIgbmV3UHJvdmlzaW9uYWwgPSBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF07CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgaWYgKG5ld1Byb3Zpc2lvbmFsKSBuZXdQcm92aXNpb25hbC5fcmVsZWFzZUxpc3RlbmVycygpOwoKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPCAyMDApIHsKICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwgPSBuZXcgX0RhdGFQcm92aXNpb25hbDIuZGVmYXVsdChfdGhpcy5fb3duZXIsIG9ialVSTCwgX3RoaXMuX2J1cywgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXSA9IG5ld1Byb3Zpc2lvbmFsOwogICAgICAgICAgfSBlbHNlIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0T2JzZXJ2ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCByZXBseS5ib2R5LnZhbHVlLCBuZXdQcm92aXNpb25hbC5jaGlsZHJlbiwgcmVwbHkuYm9keS52ZXJzaW9uKTsKICAgICAgICAgICAgX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdID0gbmV3T2JqOwoKICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbC5hcHBseShuZXdPYmopOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgZXZlbnRzIG9mIHJlbW92ZSBSZXBvcnRlciBvYmplY3RzLgogICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbk5vdGlmaWNhdGlvbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Ob3RpZmljYXRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uRm9yd2FyZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRm9yd2FyZChtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciByZXBvcnRlciA9IF90aGlzLl9yZXBvcnRlcnNbbXNnLmJvZHkudG9dOwogICAgICByZXBvcnRlci5fb25Gb3J3YXJkKG1zZyk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAogICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlRGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVEZWxldGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5ib2R5LnJlc291cmNlOwoKICAgICAgdmFyIG9iamVjdCA9IF90aGlzLl9vYnNlcnZlcnNbcmVzb3VyY2VdOwogICAgICBpZiAob2JqZWN0KSB7CiAgICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgICB1cmw6IHJlc291cmNlLAogICAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICAgIGFjazogZnVuY3Rpb24gYWNrKHR5cGUpIHsKICAgICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgICBpZiAodHlwZSkgewogICAgICAgICAgICAgIGxUeXBlID0gdHlwZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9UT0RPOiBhbnkgb3RoZXIgZGlmZmVyZW50IG9wdGlvbnMgZm9yIHRoZSByZWxlYXNlIHByb2Nlc3MsIGxpa2UgYWNjZXB0IGJ1dCBub3IgcmVsZWFzZSBsb2NhbD8KICAgICAgICAgICAgaWYgKGxUeXBlID09PSAyMDApIHsKICAgICAgICAgICAgICBvYmplY3QuZGVsZXRlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgICBfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgIGJvZHk6IHsgY29kZTogNDA0LCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdvd25lcicsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX293bmVyOwogICAgfQoKICAgIC8qKgogICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUKICAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0UmVwb3J0ZXI+fQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlcG9ydGVycycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3JlcG9ydGVyczsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uCiAgICAgKiBAdHlwZSB7T2JqZWN0PFVSTCwgRGF0YU9iamVjdE9ic2VydmVyPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvYnNlcnZlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZlcnM7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU3luY2hlcjsKfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gU3luY2hlcjsKCn0seyIuL0RhdGFPYmplY3RPYnNlcnZlciI6MywiLi9EYXRhT2JqZWN0UmVwb3J0ZXIiOjQsIi4vRGF0YVByb3Zpc2lvbmFsIjo1fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kaXZpZGVVUkwgPSBkaXZpZGVVUkw7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8qKgogKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsCiAqIEBtb2R1bGUgdXRpbHMKICovCgovKioKICogQHR5cGVkZWYgZGl2aWRlVVJMCiAqIEB0eXBlIE9iamVjdAogKiBAcHJvcGVydHkge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG9mIFVSTAogKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTAogKi8KCi8qKgogKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICogQHBhcmFtICB7VVJMLlVSTH0gdXJsIC0gdXJsIGFkZHJlc3MKICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTAogKi8KZnVuY3Rpb24gZGl2aWRlVVJMKHVybCkgewoKICAvLyBsZXQgcmUgPSAvKFthLXpBLVotXSopPzpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKSooXC9bXC9cZFx3XC4tXSopKig/OltcP10pKiguKykqL2dpOwogIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogIHZhciBzdWJzdCA9ICckMSwkMiwkMyc7CiAgdmFyIHBhcnRzID0gdXJsLnJlcGxhY2UocmUsIHN1YnN0KS5zcGxpdCgnLCcpOwoKICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgaWYgKHBhcnRzWzBdID09PSB1cmwpIHsKICAgIHBhcnRzWzBdID0gJ2h0dHBzJzsKICAgIHBhcnRzWzFdID0gdXJsOwogIH0KCiAgdmFyIHJlc3VsdCA9IHsKICAgIHR5cGU6IHBhcnRzWzBdLAogICAgZG9tYWluOiBwYXJ0c1sxXSwKICAgIGlkZW50aXR5OiBwYXJ0c1syXQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQogKiBAcGFyYW0gIHtPYmplY3R9ICBvYmogLSBvYmplY3QgdG8gYmUgY2xvbmVkCiAqIEByZXR1cm4ge09iamVjdH0KICovCmZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHsKICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uCiAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7Cn0KCn0se31dLDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7Cgp2YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07CgovKiEKICogVVJJLmpzIC0gTXV0YXRpbmcgVVJMcwogKiBJUHY2IFN1cHBvcnQKICoKICogVmVyc2lvbjogMS4xOC4wCiAqCiAqIEF1dGhvcjogUm9kbmV5IFJlaG0KICogV2ViOiBodHRwOi8vbWVkaWFsaXplLmdpdGh1Yi5pby9VUkkuanMvCiAqCiAqIExpY2Vuc2VkIHVuZGVyCiAqICAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZQogKgogKi8KCihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkgewogICd1c2Ugc3RyaWN0JzsKICAvLyBodHRwczovL2dpdGh1Yi5jb20vdW1kanMvdW1kL2Jsb2IvbWFzdGVyL3JldHVybkV4cG9ydHMuanMKCiAgaWYgKCh0eXBlb2YgZXhwb3J0cyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZXhwb3J0cykpID09PSAnb2JqZWN0JykgewogICAgLy8gTm9kZQogICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsKICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS4KICAgIGRlZmluZShmYWN0b3J5KTsKICB9IGVsc2UgewogICAgLy8gQnJvd3NlciBnbG9iYWxzIChyb290IGlzIHdpbmRvdykKICAgIHJvb3QuSVB2NiA9IGZhY3Rvcnkocm9vdCk7CiAgfQp9KSh1bmRlZmluZWQsIGZ1bmN0aW9uIChyb290KSB7CiAgJ3VzZSBzdHJpY3QnOwoKICAvKgogIHZhciBfaW4gPSAiZmU4MDowMDAwOjAwMDA6MDAwMDowMjA0OjYxZmY6ZmU5ZDpmMTU2IjsKICB2YXIgX291dCA9IElQdjYuYmVzdChfaW4pOwogIHZhciBfZXhwZWN0ZWQgPSAiZmU4MDo6MjA0OjYxZmY6ZmU5ZDpmMTU2IjsKICAgY29uc29sZS5sb2coX2luLCBfb3V0LCBfZXhwZWN0ZWQsIF9vdXQgPT09IF9leHBlY3RlZCk7CiAgKi8KCiAgLy8gc2F2ZSBjdXJyZW50IElQdjYgdmFyaWFibGUsIGlmIGFueQoKICB2YXIgX0lQdjYgPSByb290ICYmIHJvb3QuSVB2NjsKCiAgZnVuY3Rpb24gYmVzdFByZXNlbnRhdGlvbihhZGRyZXNzKSB7CiAgICAvLyBiYXNlZCBvbjoKICAgIC8vIEphdmFzY3JpcHQgdG8gdGVzdCBhbiBJUHY2IGFkZHJlc3MgZm9yIHByb3BlciBmb3JtYXQsIGFuZCB0bwogICAgLy8gcHJlc2VudCB0aGUgImJlc3QgdGV4dCByZXByZXNlbnRhdGlvbiIgYWNjb3JkaW5nIHRvIElFVEYgRHJhZnQgUkZDIGF0CiAgICAvLyBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9kcmFmdC1pZXRmLTZtYW4tdGV4dC1hZGRyLXJlcHJlc2VudGF0aW9uLTA0CiAgICAvLyA4IEZlYiAyMDEwIFJpY2ggQnJvd24sIERhcnR3YXJlLCBMTEMKICAgIC8vIFBsZWFzZSBmZWVsIGZyZWUgdG8gdXNlIHRoaXMgY29kZSBhcyBsb25nIGFzIHlvdSBwcm92aWRlIGEgbGluayB0bwogICAgLy8gaHR0cDovL3d3dy5pbnRlcm1hcHBlci5jb20KICAgIC8vIGh0dHA6Ly9pbnRlcm1hcHBlci5jb20vc3VwcG9ydC90b29scy9JUFY2LVZhbGlkYXRvci5hc3B4CiAgICAvLyBodHRwOi8vZG93bmxvYWQuZGFydHdhcmUuY29tL3RoaXJkcGFydHkvaXB2NnZhbGlkYXRvci5qcwoKICAgIHZhciBfYWRkcmVzcyA9IGFkZHJlc3MudG9Mb3dlckNhc2UoKTsKICAgIHZhciBzZWdtZW50cyA9IF9hZGRyZXNzLnNwbGl0KCc6Jyk7CiAgICB2YXIgbGVuZ3RoID0gc2VnbWVudHMubGVuZ3RoOwogICAgdmFyIHRvdGFsID0gODsKCiAgICAvLyB0cmltIGNvbG9ucyAoOjogb3IgOjphOmI6Y+KApiBvciDigKZhOmI6Yzo6KQogICAgaWYgKHNlZ21lbnRzWzBdID09PSAnJyAmJiBzZWdtZW50c1sxXSA9PT0gJycgJiYgc2VnbWVudHNbMl0gPT09ICcnKSB7CiAgICAgIC8vIG11c3QgaGF2ZSBiZWVuIDo6CiAgICAgIC8vIHJlbW92ZSBmaXJzdCB0d28gaXRlbXMKICAgICAgc2VnbWVudHMuc2hpZnQoKTsKICAgICAgc2VnbWVudHMuc2hpZnQoKTsKICAgIH0gZWxzZSBpZiAoc2VnbWVudHNbMF0gPT09ICcnICYmIHNlZ21lbnRzWzFdID09PSAnJykgewogICAgICAvLyBtdXN0IGhhdmUgYmVlbiA6Onh4eHgKICAgICAgLy8gcmVtb3ZlIHRoZSBmaXJzdCBpdGVtCiAgICAgIHNlZ21lbnRzLnNoaWZ0KCk7CiAgICB9IGVsc2UgaWYgKHNlZ21lbnRzW2xlbmd0aCAtIDFdID09PSAnJyAmJiBzZWdtZW50c1tsZW5ndGggLSAyXSA9PT0gJycpIHsKICAgICAgLy8gbXVzdCBoYXZlIGJlZW4geHh4eDo6CiAgICAgIHNlZ21lbnRzLnBvcCgpOwogICAgfQoKICAgIGxlbmd0aCA9IHNlZ21lbnRzLmxlbmd0aDsKCiAgICAvLyBhZGp1c3QgdG90YWwgc2VnbWVudHMgZm9yIElQdjQgdHJhaWxlcgogICAgaWYgKHNlZ21lbnRzW2xlbmd0aCAtIDFdLmluZGV4T2YoJy4nKSAhPT0gLTEpIHsKICAgICAgLy8gZm91bmQgYSAiLiIgd2hpY2ggbWVhbnMgSVB2NAogICAgICB0b3RhbCA9IDc7CiAgICB9CgogICAgLy8gZmlsbCBlbXB0eSBzZWdtZW50cyB0aGVtIHdpdGggIjAwMDAiCiAgICB2YXIgcG9zOwogICAgZm9yIChwb3MgPSAwOyBwb3MgPCBsZW5ndGg7IHBvcysrKSB7CiAgICAgIGlmIChzZWdtZW50c1twb3NdID09PSAnJykgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKHBvcyA8IHRvdGFsKSB7CiAgICAgIHNlZ21lbnRzLnNwbGljZShwb3MsIDEsICcwMDAwJyk7CiAgICAgIHdoaWxlIChzZWdtZW50cy5sZW5ndGggPCB0b3RhbCkgewogICAgICAgIHNlZ21lbnRzLnNwbGljZShwb3MsIDAsICcwMDAwJyk7CiAgICAgIH0KICAgIH0KCiAgICAvLyBzdHJpcCBsZWFkaW5nIHplcm9zCiAgICB2YXIgX3NlZ21lbnRzOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b3RhbDsgaSsrKSB7CiAgICAgIF9zZWdtZW50cyA9IHNlZ21lbnRzW2ldLnNwbGl0KCcnKTsKICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICBpZiAoX3NlZ21lbnRzWzBdID09PSAnMCcgJiYgX3NlZ21lbnRzLmxlbmd0aCA+IDEpIHsKICAgICAgICAgIF9zZWdtZW50cy5zcGxpY2UoMCwgMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgc2VnbWVudHNbaV0gPSBfc2VnbWVudHMuam9pbignJyk7CiAgICB9CgogICAgLy8gZmluZCBsb25nZXN0IHNlcXVlbmNlIG9mIHplcm9lcyBhbmQgY29hbGVzY2UgdGhlbSBpbnRvIG9uZSBzZWdtZW50CiAgICB2YXIgYmVzdCA9IC0xOwogICAgdmFyIF9iZXN0ID0gMDsKICAgIHZhciBfY3VycmVudCA9IDA7CiAgICB2YXIgY3VycmVudCA9IC0xOwogICAgdmFyIGluemVyb2VzID0gZmFsc2U7CiAgICAvLyBpOyBhbHJlYWR5IGRlY2xhcmVkCgogICAgZm9yIChpID0gMDsgaSA8IHRvdGFsOyBpKyspIHsKICAgICAgaWYgKGluemVyb2VzKSB7CiAgICAgICAgaWYgKHNlZ21lbnRzW2ldID09PSAnMCcpIHsKICAgICAgICAgIF9jdXJyZW50ICs9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGluemVyb2VzID0gZmFsc2U7CiAgICAgICAgICBpZiAoX2N1cnJlbnQgPiBfYmVzdCkgewogICAgICAgICAgICBiZXN0ID0gY3VycmVudDsKICAgICAgICAgICAgX2Jlc3QgPSBfY3VycmVudDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHNlZ21lbnRzW2ldID09PSAnMCcpIHsKICAgICAgICAgIGluemVyb2VzID0gdHJ1ZTsKICAgICAgICAgIGN1cnJlbnQgPSBpOwogICAgICAgICAgX2N1cnJlbnQgPSAxOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChfY3VycmVudCA+IF9iZXN0KSB7CiAgICAgIGJlc3QgPSBjdXJyZW50OwogICAgICBfYmVzdCA9IF9jdXJyZW50OwogICAgfQoKICAgIGlmIChfYmVzdCA+IDEpIHsKICAgICAgc2VnbWVudHMuc3BsaWNlKGJlc3QsIF9iZXN0LCAnJyk7CiAgICB9CgogICAgbGVuZ3RoID0gc2VnbWVudHMubGVuZ3RoOwoKICAgIC8vIGFzc2VtYmxlIHJlbWFpbmluZyBzZWdtZW50cwogICAgdmFyIHJlc3VsdCA9ICcnOwogICAgaWYgKHNlZ21lbnRzWzBdID09PSAnJykgewogICAgICByZXN1bHQgPSAnOic7CiAgICB9CgogICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIHJlc3VsdCArPSBzZWdtZW50c1tpXTsKICAgICAgaWYgKGkgPT09IGxlbmd0aCAtIDEpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcmVzdWx0ICs9ICc6JzsKICAgIH0KCiAgICBpZiAoc2VnbWVudHNbbGVuZ3RoIC0gMV0gPT09ICcnKSB7CiAgICAgIHJlc3VsdCArPSAnOic7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIGZ1bmN0aW9uIG5vQ29uZmxpY3QoKSB7CiAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi8KICAgIGlmIChyb290LklQdjYgPT09IHRoaXMpIHsKICAgICAgcm9vdC5JUHY2ID0gX0lQdjY7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfQoKICByZXR1cm4gewogICAgYmVzdDogYmVzdFByZXNlbnRhdGlvbiwKICAgIG5vQ29uZmxpY3Q6IG5vQ29uZmxpY3QKICB9Owp9KTsKCn0se31dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKdmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKLyohCiAqIFVSSS5qcyAtIE11dGF0aW5nIFVSTHMKICogU2Vjb25kIExldmVsIERvbWFpbiAoU0xEKSBTdXBwb3J0CiAqCiAqIFZlcnNpb246IDEuMTguMAogKgogKiBBdXRob3I6IFJvZG5leSBSZWhtCiAqIFdlYjogaHR0cDovL21lZGlhbGl6ZS5naXRodWIuaW8vVVJJLmpzLwogKgogKiBMaWNlbnNlZCB1bmRlcgogKiAgIE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UKICoKICovCgooZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHsKICAndXNlIHN0cmljdCc7CiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3VtZGpzL3VtZC9ibG9iL21hc3Rlci9yZXR1cm5FeHBvcnRzLmpzCgogIGlmICgodHlwZW9mIGV4cG9ydHMgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGV4cG9ydHMpKSA9PT0gJ29iamVjdCcpIHsKICAgIC8vIE5vZGUKICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpOwogIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7CiAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuCiAgICBkZWZpbmUoZmFjdG9yeSk7CiAgfSBlbHNlIHsKICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpCiAgICByb290LlNlY29uZExldmVsRG9tYWlucyA9IGZhY3Rvcnkocm9vdCk7CiAgfQp9KSh1bmRlZmluZWQsIGZ1bmN0aW9uIChyb290KSB7CiAgJ3VzZSBzdHJpY3QnOwoKICAvLyBzYXZlIGN1cnJlbnQgU2Vjb25kTGV2ZWxEb21haW5zIHZhcmlhYmxlLCBpZiBhbnkKCiAgdmFyIF9TZWNvbmRMZXZlbERvbWFpbnMgPSByb290ICYmIHJvb3QuU2Vjb25kTGV2ZWxEb21haW5zOwoKICB2YXIgU0xEID0gewogICAgLy8gbGlzdCBvZiBrbm93biBTZWNvbmQgTGV2ZWwgRG9tYWlucwogICAgLy8gY29udmVydGVkIGxpc3Qgb2YgU0xEcyBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9nYXZpbmdtaWxsZXIvc2Vjb25kLWxldmVsLWRvbWFpbnMKICAgIC8vIC0tLS0KICAgIC8vIHB1YmxpY3N1ZmZpeC5vcmcgaXMgbW9yZSBjdXJyZW50IGFuZCBhY3R1YWxseSB1c2VkIGJ5IGEgY291cGxlIG9mIGJyb3dzZXJzIGludGVybmFsbHkuCiAgICAvLyBkb3duc2lkZSBpcyBpdCBhbHNvIGNvbnRhaW5zIGRvbWFpbnMgbGlrZSAiZHluZG5zLm9yZyIgLSB3aGljaCBpcyBmaW5lIGZvciB0aGUgc2VjdXJpdHkKICAgIC8vIGlzc3VlcyBicm93c2VyIGhhdmUgdG8gZGVhbCB3aXRoIChTT1AgZm9yIGNvb2tpZXMsIGV0YykgLSBidXQgaXMgd2F5IG92ZXJib2FyZCBmb3IgVVJJLmpzCiAgICAvLyAtLS0tCiAgICBsaXN0OiB7CiAgICAgICdhYyc6ICcgY29tIGdvdiBtaWwgbmV0IG9yZyAnLAogICAgICAnYWUnOiAnIGFjIGNvIGdvdiBtaWwgbmFtZSBuZXQgb3JnIHBybyBzY2ggJywKICAgICAgJ2FmJzogJyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdhbCc6ICcgY29tIGVkdSBnb3YgbWlsIG5ldCBvcmcgJywKICAgICAgJ2FvJzogJyBjbyBlZCBndiBpdCBvZyBwYiAnLAogICAgICAnYXInOiAnIGNvbSBlZHUgZ29iIGdvdiBpbnQgbWlsIG5ldCBvcmcgdHVyICcsCiAgICAgICdhdCc6ICcgYWMgY28gZ3Ygb3IgJywKICAgICAgJ2F1JzogJyBhc24gY29tIGNzaXJvIGVkdSBnb3YgaWQgbmV0IG9yZyAnLAogICAgICAnYmEnOiAnIGNvIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnIHJzIHVuYmkgdW5tbyB1bnNhIHVudHogdW56ZSAnLAogICAgICAnYmInOiAnIGJpeiBjbyBjb20gZWR1IGdvdiBpbmZvIG5ldCBvcmcgc3RvcmUgdHYgJywKICAgICAgJ2JoJzogJyBiaXogY2MgY29tIGVkdSBnb3YgaW5mbyBuZXQgb3JnICcsCiAgICAgICdibic6ICcgY29tIGVkdSBnb3YgbmV0IG9yZyAnLAogICAgICAnYm8nOiAnIGNvbSBlZHUgZ29iIGdvdiBpbnQgbWlsIG5ldCBvcmcgdHYgJywKICAgICAgJ2JyJzogJyBhZG0gYWR2IGFnciBhbSBhcnEgYXJ0IGF0byBiIGJpbyBibG9nIGJtZCBjaW0gY25nIGNudCBjb20gY29vcCBlY24gZWR1IGVuZyBlc3AgZXRjIGV0aSBmYXIgZmxvZyBmbSBmbmQgZm90IGZzdCBnMTIgZ2dmIGdvdiBpbWIgaW5kIGluZiBqb3IganVzIGxlbCBtYXQgbWVkIG1pbCBtdXMgbmV0IG5vbSBub3QgbnRyIG9kbyBvcmcgcHBnIHBybyBwc2MgcHNpIHFzbCByZWMgc2xnIHNydiB0bXAgdHJkIHR1ciB0diB2ZXQgdmxvZyB3aWtpIHpsZyAnLAogICAgICAnYnMnOiAnIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ2J6JzogJyBkdSBldCBvbSBvdiByZyAnLAogICAgICAnY2EnOiAnIGFiIGJjIG1iIG5iIG5mIG5sIG5zIG50IG51IG9uIHBlIHFjIHNrIHlrICcsCiAgICAgICdjayc6ICcgYml6IGNvIGVkdSBnZW4gZ292IGluZm8gbmV0IG9yZyAnLAogICAgICAnY24nOiAnIGFjIGFoIGJqIGNvbSBjcSBlZHUgZmogZ2QgZ292IGdzIGd4IGd6IGhhIGhiIGhlIGhpIGhsIGhuIGpsIGpzIGp4IGxuIG1pbCBuZXQgbm0gbnggb3JnIHFoIHNjIHNkIHNoIHNuIHN4IHRqIHR3IHhqIHh6IHluIHpqICcsCiAgICAgICdjbyc6ICcgY29tIGVkdSBnb3YgbWlsIG5ldCBub20gb3JnICcsCiAgICAgICdjcic6ICcgYWMgYyBjbyBlZCBmaSBnbyBvciBzYSAnLAogICAgICAnY3knOiAnIGFjIGJpeiBjb20gZWtsb2dlcyBnb3YgbHRkIG5hbWUgbmV0IG9yZyBwYXJsaWFtZW50IHByZXNzIHBybyB0bSAnLAogICAgICAnZG8nOiAnIGFydCBjb20gZWR1IGdvYiBnb3YgbWlsIG5ldCBvcmcgc2xkIHdlYiAnLAogICAgICAnZHonOiAnIGFydCBhc3NvIGNvbSBlZHUgZ292IG5ldCBvcmcgcG9sICcsCiAgICAgICdlYyc6ICcgY29tIGVkdSBmaW4gZ292IGluZm8gbWVkIG1pbCBuZXQgb3JnIHBybyAnLAogICAgICAnZWcnOiAnIGNvbSBlZHUgZXVuIGdvdiBtaWwgbmFtZSBuZXQgb3JnIHNjaSAnLAogICAgICAnZXInOiAnIGNvbSBlZHUgZ292IGluZCBtaWwgbmV0IG9yZyByb2NoZXN0IHcgJywKICAgICAgJ2VzJzogJyBjb20gZWR1IGdvYiBub20gb3JnICcsCiAgICAgICdldCc6ICcgYml6IGNvbSBlZHUgZ292IGluZm8gbmFtZSBuZXQgb3JnICcsCiAgICAgICdmaic6ICcgYWMgYml6IGNvbSBpbmZvIG1pbCBuYW1lIG5ldCBvcmcgcHJvICcsCiAgICAgICdmayc6ICcgYWMgY28gZ292IG5ldCBub20gb3JnICcsCiAgICAgICdmcic6ICcgYXNzbyBjb20gZiBnb3V2IG5vbSBwcmQgcHJlc3NlIHRtICcsCiAgICAgICdnZyc6ICcgY28gbmV0IG9yZyAnLAogICAgICAnZ2gnOiAnIGNvbSBlZHUgZ292IG1pbCBvcmcgJywKICAgICAgJ2duJzogJyBhYyBjb20gZ292IG5ldCBvcmcgJywKICAgICAgJ2dyJzogJyBjb20gZWR1IGdvdiBtaWwgbmV0IG9yZyAnLAogICAgICAnZ3QnOiAnIGNvbSBlZHUgZ29iIGluZCBtaWwgbmV0IG9yZyAnLAogICAgICAnZ3UnOiAnIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ2hrJzogJyBjb20gZWR1IGdvdiBpZHYgbmV0IG9yZyAnLAogICAgICAnaHUnOiAnIDIwMDAgYWdyYXIgYm9sdCBjYXNpbm8gY2l0eSBjbyBlcm90aWNhIGVyb3Rpa2EgZmlsbSBmb3J1bSBnYW1lcyBob3RlbCBpbmZvIGluZ2F0bGFuIGpvZ2FzeiBrb255dmVsbyBsYWthcyBtZWRpYSBuZXdzIG9yZyBwcml2IHJla2xhbSBzZXggc2hvcCBzcG9ydCBzdWxpIHN6ZXggdG0gdG96c2RlIHV0YXphcyB2aWRlbyAnLAogICAgICAnaWQnOiAnIGFjIGNvIGdvIG1pbCBuZXQgb3Igc2NoIHdlYiAnLAogICAgICAnaWwnOiAnIGFjIGNvIGdvdiBpZGYgazEyIG11bmkgbmV0IG9yZyAnLAogICAgICAnaW4nOiAnIGFjIGNvIGVkdSBlcm5ldCBmaXJtIGdlbiBnb3YgaSBpbmQgbWlsIG5ldCBuaWMgb3JnIHJlcyAnLAogICAgICAnaXEnOiAnIGNvbSBlZHUgZ292IGkgbWlsIG5ldCBvcmcgJywKICAgICAgJ2lyJzogJyBhYyBjbyBkbnNzZWMgZ292IGkgaWQgbmV0IG9yZyBzY2ggJywKICAgICAgJ2l0JzogJyBlZHUgZ292ICcsCiAgICAgICdqZSc6ICcgY28gbmV0IG9yZyAnLAogICAgICAnam8nOiAnIGNvbSBlZHUgZ292IG1pbCBuYW1lIG5ldCBvcmcgc2NoICcsCiAgICAgICdqcCc6ICcgYWMgYWQgY28gZWQgZ28gZ3IgbGcgbmUgb3IgJywKICAgICAgJ2tlJzogJyBhYyBjbyBnbyBpbmZvIG1lIG1vYmkgbmUgb3Igc2MgJywKICAgICAgJ2toJzogJyBjb20gZWR1IGdvdiBtaWwgbmV0IG9yZyBwZXIgJywKICAgICAgJ2tpJzogJyBiaXogY29tIGRlIGVkdSBnb3YgaW5mbyBtb2IgbmV0IG9yZyB0ZWwgJywKICAgICAgJ2ttJzogJyBhc3NvIGNvbSBjb29wIGVkdSBnb3V2IGsgbWVkZWNpbiBtaWwgbm9tIG5vdGFpcmVzIHBoYXJtYWNpZW5zIHByZXNzZSB0bSB2ZXRlcmluYWlyZSAnLAogICAgICAna24nOiAnIGVkdSBnb3YgbmV0IG9yZyAnLAogICAgICAna3InOiAnIGFjIGJ1c2FuIGNodW5nYnVrIGNodW5nbmFtIGNvIGRhZWd1IGRhZWplb24gZXMgZ2FuZ3dvbiBnbyBnd2FuZ2p1IGd5ZW9uZ2J1ayBneWVvbmdnaSBneWVvbmduYW0gaHMgaW5jaGVvbiBqZWp1IGplb25idWsgamVvbm5hbSBrIGtnIG1pbCBtcyBuZSBvciBwZSByZSBzYyBzZW91bCB1bHNhbiAnLAogICAgICAna3cnOiAnIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ2t5JzogJyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdreic6ICcgY29tIGVkdSBnb3YgbWlsIG5ldCBvcmcgJywKICAgICAgJ2xiJzogJyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdsayc6ICcgYXNzbiBjb20gZWR1IGdvdiBncnAgaG90ZWwgaW50IGx0ZCBuZXQgbmdvIG9yZyBzY2ggc29jIHdlYiAnLAogICAgICAnbHInOiAnIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ2x2JzogJyBhc24gY29tIGNvbmYgZWR1IGdvdiBpZCBtaWwgbmV0IG9yZyAnLAogICAgICAnbHknOiAnIGNvbSBlZHUgZ292IGlkIG1lZCBuZXQgb3JnIHBsYyBzY2ggJywKICAgICAgJ21hJzogJyBhYyBjbyBnb3YgbSBuZXQgb3JnIHByZXNzICcsCiAgICAgICdtYyc6ICcgYXNzbyB0bSAnLAogICAgICAnbWUnOiAnIGFjIGNvIGVkdSBnb3YgaXRzIG5ldCBvcmcgcHJpdiAnLAogICAgICAnbWcnOiAnIGNvbSBlZHUgZ292IG1pbCBub20gb3JnIHByZCB0bSAnLAogICAgICAnbWsnOiAnIGNvbSBlZHUgZ292IGluZiBuYW1lIG5ldCBvcmcgcHJvICcsCiAgICAgICdtbCc6ICcgY29tIGVkdSBnb3YgbmV0IG9yZyBwcmVzc2UgJywKICAgICAgJ21uJzogJyBlZHUgZ292IG9yZyAnLAogICAgICAnbW8nOiAnIGNvbSBlZHUgZ292IG5ldCBvcmcgJywKICAgICAgJ210JzogJyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdtdic6ICcgYWVybyBiaXogY29tIGNvb3AgZWR1IGdvdiBpbmZvIGludCBtaWwgbXVzZXVtIG5hbWUgbmV0IG9yZyBwcm8gJywKICAgICAgJ213JzogJyBhYyBjbyBjb20gY29vcCBlZHUgZ292IGludCBtdXNldW0gbmV0IG9yZyAnLAogICAgICAnbXgnOiAnIGNvbSBlZHUgZ29iIG5ldCBvcmcgJywKICAgICAgJ215JzogJyBjb20gZWR1IGdvdiBtaWwgbmFtZSBuZXQgb3JnIHNjaCAnLAogICAgICAnbmYnOiAnIGFydHMgY29tIGZpcm0gaW5mbyBuZXQgb3RoZXIgcGVyIHJlYyBzdG9yZSB3ZWIgJywKICAgICAgJ25nJzogJyBiaXogY29tIGVkdSBnb3YgbWlsIG1vYmkgbmFtZSBuZXQgb3JnIHNjaCAnLAogICAgICAnbmknOiAnIGFjIGNvIGNvbSBlZHUgZ29iIG1pbCBuZXQgbm9tIG9yZyAnLAogICAgICAnbnAnOiAnIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnICcsCiAgICAgICducic6ICcgYml6IGNvbSBlZHUgZ292IGluZm8gbmV0IG9yZyAnLAogICAgICAnb20nOiAnIGFjIGJpeiBjbyBjb20gZWR1IGdvdiBtZWQgbWlsIG11c2V1bSBuZXQgb3JnIHBybyBzY2ggJywKICAgICAgJ3BlJzogJyBjb20gZWR1IGdvYiBtaWwgbmV0IG5vbSBvcmcgc2xkICcsCiAgICAgICdwaCc6ICcgY29tIGVkdSBnb3YgaSBtaWwgbmV0IG5nbyBvcmcgJywKICAgICAgJ3BrJzogJyBiaXogY29tIGVkdSBmYW0gZ29iIGdvayBnb24gZ29wIGdvcyBnb3YgbmV0IG9yZyB3ZWIgJywKICAgICAgJ3BsJzogJyBhcnQgYmlhbHlzdG9rIGJpeiBjb20gZWR1IGdkYSBnZGFuc2sgZ29yem93IGdvdiBpbmZvIGthdG93aWNlIGtyYWtvdyBsb2R6IGx1YmxpbiBtaWwgbmV0IG5nbyBvbHN6dHluIG9yZyBwb3puYW4gcHdyIHJhZG9tIHNsdXBzayBzemN6ZWNpbiB0b3J1biB3YXJzemF3YSB3YXcgd3JvYyB3cm9jbGF3IHpnb3JhICcsCiAgICAgICdwcic6ICcgYWMgYml6IGNvbSBlZHUgZXN0IGdvdiBpbmZvIGlzbGEgbmFtZSBuZXQgb3JnIHBybyBwcm9mICcsCiAgICAgICdwcyc6ICcgY29tIGVkdSBnb3YgbmV0IG9yZyBwbG8gc2VjICcsCiAgICAgICdwdyc6ICcgYmVsYXUgY28gZWQgZ28gbmUgb3IgJywKICAgICAgJ3JvJzogJyBhcnRzIGNvbSBmaXJtIGluZm8gbm9tIG50IG9yZyByZWMgc3RvcmUgdG0gd3d3ICcsCiAgICAgICdycyc6ICcgYWMgY28gZWR1IGdvdiBpbiBvcmcgJywKICAgICAgJ3NiJzogJyBjb20gZWR1IGdvdiBuZXQgb3JnICcsCiAgICAgICdzYyc6ICcgY29tIGVkdSBnb3YgbmV0IG9yZyAnLAogICAgICAnc2gnOiAnIGNvIGNvbSBlZHUgZ292IG5ldCBub20gb3JnICcsCiAgICAgICdzbCc6ICcgY29tIGVkdSBnb3YgbmV0IG9yZyAnLAogICAgICAnc3QnOiAnIGNvIGNvbSBjb25zdWxhZG8gZWR1IGVtYmFpeGFkYSBnb3YgbWlsIG5ldCBvcmcgcHJpbmNpcGUgc2FvdG9tZSBzdG9yZSAnLAogICAgICAnc3YnOiAnIGNvbSBlZHUgZ29iIG9yZyByZWQgJywKICAgICAgJ3N6JzogJyBhYyBjbyBvcmcgJywKICAgICAgJ3RyJzogJyBhdiBiYnMgYmVsIGJpeiBjb20gZHIgZWR1IGdlbiBnb3YgaW5mbyBrMTIgbmFtZSBuZXQgb3JnIHBvbCB0ZWwgdHNrIHR2IHdlYiAnLAogICAgICAndHQnOiAnIGFlcm8gYml6IGNhdCBjbyBjb20gY29vcCBlZHUgZ292IGluZm8gaW50IGpvYnMgbWlsIG1vYmkgbXVzZXVtIG5hbWUgbmV0IG9yZyBwcm8gdGVsIHRyYXZlbCAnLAogICAgICAndHcnOiAnIGNsdWIgY29tIGViaXogZWR1IGdhbWUgZ292IGlkdiBtaWwgbmV0IG9yZyAnLAogICAgICAnbXUnOiAnIGFjIGNvIGNvbSBnb3YgbmV0IG9yIG9yZyAnLAogICAgICAnbXonOiAnIGFjIGNvIGVkdSBnb3Ygb3JnICcsCiAgICAgICduYSc6ICcgY28gY29tICcsCiAgICAgICdueic6ICcgYWMgY28gY3JpIGdlZWsgZ2VuIGdvdnQgaGVhbHRoIGl3aSBtYW9yaSBtaWwgbmV0IG9yZyBwYXJsaWFtZW50IHNjaG9vbCAnLAogICAgICAncGEnOiAnIGFibyBhYyBjb20gZWR1IGdvYiBpbmcgbWVkIG5ldCBub20gb3JnIHNsZCAnLAogICAgICAncHQnOiAnIGNvbSBlZHUgZ292IGludCBuZXQgbm9tZSBvcmcgcHVibCAnLAogICAgICAncHknOiAnIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnICcsCiAgICAgICdxYSc6ICcgY29tIGVkdSBnb3YgbWlsIG5ldCBvcmcgJywKICAgICAgJ3JlJzogJyBhc3NvIGNvbSBub20gJywKICAgICAgJ3J1JzogJyBhYyBhZHlnZXlhIGFsdGFpIGFtdXIgYXJraGFuZ2Vsc2sgYXN0cmFraGFuIGJhc2hraXJpYSBiZWxnb3JvZCBiaXIgYnJ5YW5zayBidXJ5YXRpYSBjYmcgY2hlbCBjaGVseWFiaW5zayBjaGl0YSBjaHVrb3RrYSBjaHV2YXNoaWEgY29tIGRhZ2VzdGFuIGUtYnVyZyBlZHUgZ292IGdyb3pueSBpbnQgaXJrdXRzayBpdmFub3ZvIGl6aGV2c2sgamFyIGpvc2hrYXItb2xhIGthbG15a2lhIGthbHVnYSBrYW1jaGF0a2Ega2FyZWxpYSBrYXphbiBrY2hyIGtlbWVyb3ZvIGtoYWJhcm92c2sga2hha2Fzc2lhIGtodiBraXJvdiBrb2VuaWcga29taSBrb3N0cm9tYSBrcmFub3lhcnNrIGt1YmFuIGt1cmdhbiBrdXJzayBsaXBldHNrIG1hZ2FkYW4gbWFyaSBtYXJpLWVsIG1hcmluZSBtaWwgbW9yZG92aWEgbW9zcmVnIG1zayBtdXJtYW5zayBuYWxjaGlrIG5ldCBubm92IG5vdiBub3Zvc2liaXJzayBuc2sgb21zayBvcmVuYnVyZyBvcmcgb3J5b2wgcGVuemEgcGVybSBwcCBwc2tvdiBwdHogcm5kIHJ5YXphbiBzYWtoYWxpbiBzYW1hcmEgc2FyYXRvdiBzaW1iaXJzayBzbW9sZW5zayBzcGIgc3RhdnJvcG9sIHN0diBzdXJndXQgdGFtYm92IHRhdGFyc3RhbiB0b20gdG9tc2sgdHNhcml0c3luIHRzayB0dWxhIHR1dmEgdHZlciB0eXVtZW4gdWRtIHVkbXVydGlhIHVsYW4tdWRlIHZsYWRpa2F2a2F6IHZsYWRpbWlyIHZsYWRpdm9zdG9rIHZvbGdvZ3JhZCB2b2xvZ2RhIHZvcm9uZXpoIHZybiB2eWF0a2EgeWFrdXRpYSB5YW1hbCB5ZWthdGVyaW5idXJnIHl1emhuby1zYWtoYWxpbnNrICcsCiAgICAgICdydyc6ICcgYWMgY28gY29tIGVkdSBnb3V2IGdvdiBpbnQgbWlsIG5ldCAnLAogICAgICAnc2EnOiAnIGNvbSBlZHUgZ292IG1lZCBuZXQgb3JnIHB1YiBzY2ggJywKICAgICAgJ3NkJzogJyBjb20gZWR1IGdvdiBpbmZvIG1lZCBuZXQgb3JnIHR2ICcsCiAgICAgICdzZSc6ICcgYSBhYyBiIGJkIGMgZCBlIGYgZyBoIGkgayBsIG0gbiBvIG9yZyBwIHBhcnRpIHBwIHByZXNzIHIgcyB0IHRtIHUgdyB4IHkgeiAnLAogICAgICAnc2cnOiAnIGNvbSBlZHUgZ292IGlkbiBuZXQgb3JnIHBlciAnLAogICAgICAnc24nOiAnIGFydCBjb20gZWR1IGdvdXYgb3JnIHBlcnNvIHVuaXYgJywKICAgICAgJ3N5JzogJyBjb20gZWR1IGdvdiBtaWwgbmV0IG5ld3Mgb3JnICcsCiAgICAgICd0aCc6ICcgYWMgY28gZ28gaW4gbWkgbmV0IG9yICcsCiAgICAgICd0aic6ICcgYWMgYml6IGNvIGNvbSBlZHUgZ28gZ292IGluZm8gaW50IG1pbCBuYW1lIG5ldCBuaWMgb3JnIHRlc3Qgd2ViICcsCiAgICAgICd0bic6ICcgYWdyaW5ldCBjb20gZGVmZW5zZSBlZHVuZXQgZW5zIGZpbiBnb3YgaW5kIGluZm8gaW50bCBtaW5jb20gbmF0IG5ldCBvcmcgcGVyc28gcm5ydCBybnMgcm51IHRvdXJpc20gJywKICAgICAgJ3R6JzogJyBhYyBjbyBnbyBuZSBvciAnLAogICAgICAndWEnOiAnIGJpeiBjaGVya2Fzc3kgY2hlcm5pZ292IGNoZXJub3Z0c3kgY2sgY24gY28gY29tIGNyaW1lYSBjdiBkbiBkbmVwcm9wZXRyb3ZzayBkb25ldHNrIGRwIGVkdSBnb3YgaWYgaW4gaXZhbm8tZnJhbmtpdnNrIGtoIGtoYXJrb3Yga2hlcnNvbiBraG1lbG5pdHNraXkga2lldiBraXJvdm9ncmFkIGttIGtyIGtzIGt2IGxnIGx1Z2Fuc2sgbHV0c2sgbHZpdiBtZSBtayBuZXQgbmlrb2xhZXYgb2Qgb2Rlc3NhIG9yZyBwbCBwb2x0YXZhIHBwIHJvdm5vIHJ2IHNlYmFzdG9wb2wgc3VteSB0ZSB0ZXJub3BpbCB1emhnb3JvZCB2aW5uaWNhIHZuIHphcG9yaXpoemhlIHpoaXRvbWlyIHpwIHp0ICcsCiAgICAgICd1Zyc6ICcgYWMgY28gZ28gbmUgb3Igb3JnIHNjICcsCiAgICAgICd1ayc6ICcgYWMgYmwgYnJpdGlzaC1saWJyYXJ5IGNvIGN5bSBnb3YgZ292dCBpY25ldCBqZXQgbGVhIGx0ZCBtZSBtaWwgbW9kIG5hdGlvbmFsLWxpYnJhcnktc2NvdGxhbmQgbmVsIG5ldCBuaHMgbmljIG5scyBvcmcgb3JnbiBwYXJsaWFtZW50IHBsYyBwb2xpY2Ugc2NoIHNjb3Qgc29jICcsCiAgICAgICd1cyc6ICcgZG5pIGZlZCBpc2Ega2lkcyBuc24gJywKICAgICAgJ3V5JzogJyBjb20gZWR1IGd1YiBtaWwgbmV0IG9yZyAnLAogICAgICAndmUnOiAnIGNvIGNvbSBlZHUgZ29iIGluZm8gbWlsIG5ldCBvcmcgd2ViICcsCiAgICAgICd2aSc6ICcgY28gY29tIGsxMiBuZXQgb3JnICcsCiAgICAgICd2bic6ICcgYWMgYml6IGNvbSBlZHUgZ292IGhlYWx0aCBpbmZvIGludCBuYW1lIG5ldCBvcmcgcHJvICcsCiAgICAgICd5ZSc6ICcgY28gY29tIGdvdiBsdGQgbWUgbmV0IG9yZyBwbGMgJywKICAgICAgJ3l1JzogJyBhYyBjbyBlZHUgZ292IG9yZyAnLAogICAgICAnemEnOiAnIGFjIGFncmljIGFsdCBib3Vyc2UgY2l0eSBjbyBjeWJlcm5ldCBkYiBlZHUgZ292IGdyb25kYXIgaWFjY2VzcyBpbXQgaW5jYSBsYW5kZXNpZ24gbGF3IG1pbCBuZXQgbmdvIG5pcyBub20gb2xpdmV0dGkgb3JnIHBpeCBzY2hvb2wgdG0gd2ViICcsCiAgICAgICd6bSc6ICcgYWMgY28gY29tIGVkdSBnb3YgbmV0IG9yZyBzY2ggJwogICAgfSwKICAgIC8vIGdvcmhpbGwgMjAxMy0xMC0yNTogVXNpbmcgaW5kZXhPZigpIGluc3RlYWQgUmVnZXhwKCkuIFNpZ25pZmljYW50IGJvb3N0CiAgICAvLyBpbiBib3RoIHBlcmZvcm1hbmNlIGFuZCBtZW1vcnkgZm9vdHByaW50LiBObyBpbml0aWFsaXphdGlvbiByZXF1aXJlZC4KICAgIC8vIGh0dHA6Ly9qc3BlcmYuY29tL3VyaS1qcy1zbGQtcmVnZXgtdnMtYmluYXJ5LXNlYXJjaC80CiAgICAvLyBGb2xsb3dpbmcgbWV0aG9kcyB1c2UgbGFzdEluZGV4T2YoKSByYXRoZXIgdGhhbiBhcnJheS5zcGxpdCgpIGluIG9yZGVyCiAgICAvLyB0byBhdm9pZCBhbnkgbWVtb3J5IGFsbG9jYXRpb25zLgogICAgaGFzOiBmdW5jdGlvbiBoYXMoZG9tYWluKSB7CiAgICAgIHZhciB0bGRPZmZzZXQgPSBkb21haW4ubGFzdEluZGV4T2YoJy4nKTsKICAgICAgaWYgKHRsZE9mZnNldCA8PSAwIHx8IHRsZE9mZnNldCA+PSBkb21haW4ubGVuZ3RoIC0gMSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB2YXIgc2xkT2Zmc2V0ID0gZG9tYWluLmxhc3RJbmRleE9mKCcuJywgdGxkT2Zmc2V0IC0gMSk7CiAgICAgIGlmIChzbGRPZmZzZXQgPD0gMCB8fCBzbGRPZmZzZXQgPj0gdGxkT2Zmc2V0IC0gMSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB2YXIgc2xkTGlzdCA9IFNMRC5saXN0W2RvbWFpbi5zbGljZSh0bGRPZmZzZXQgKyAxKV07CiAgICAgIGlmICghc2xkTGlzdCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gc2xkTGlzdC5pbmRleE9mKCcgJyArIGRvbWFpbi5zbGljZShzbGRPZmZzZXQgKyAxLCB0bGRPZmZzZXQpICsgJyAnKSA+PSAwOwogICAgfSwKICAgIGlzOiBmdW5jdGlvbiBpcyhkb21haW4pIHsKICAgICAgdmFyIHRsZE9mZnNldCA9IGRvbWFpbi5sYXN0SW5kZXhPZignLicpOwogICAgICBpZiAodGxkT2Zmc2V0IDw9IDAgfHwgdGxkT2Zmc2V0ID49IGRvbWFpbi5sZW5ndGggLSAxKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciBzbGRPZmZzZXQgPSBkb21haW4ubGFzdEluZGV4T2YoJy4nLCB0bGRPZmZzZXQgLSAxKTsKICAgICAgaWYgKHNsZE9mZnNldCA+PSAwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciBzbGRMaXN0ID0gU0xELmxpc3RbZG9tYWluLnNsaWNlKHRsZE9mZnNldCArIDEpXTsKICAgICAgaWYgKCFzbGRMaXN0KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybiBzbGRMaXN0LmluZGV4T2YoJyAnICsgZG9tYWluLnNsaWNlKDAsIHRsZE9mZnNldCkgKyAnICcpID49IDA7CiAgICB9LAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoZG9tYWluKSB7CiAgICAgIHZhciB0bGRPZmZzZXQgPSBkb21haW4ubGFzdEluZGV4T2YoJy4nKTsKICAgICAgaWYgKHRsZE9mZnNldCA8PSAwIHx8IHRsZE9mZnNldCA+PSBkb21haW4ubGVuZ3RoIC0gMSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHZhciBzbGRPZmZzZXQgPSBkb21haW4ubGFzdEluZGV4T2YoJy4nLCB0bGRPZmZzZXQgLSAxKTsKICAgICAgaWYgKHNsZE9mZnNldCA8PSAwIHx8IHNsZE9mZnNldCA+PSB0bGRPZmZzZXQgLSAxKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgdmFyIHNsZExpc3QgPSBTTEQubGlzdFtkb21haW4uc2xpY2UodGxkT2Zmc2V0ICsgMSldOwogICAgICBpZiAoIXNsZExpc3QpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICBpZiAoc2xkTGlzdC5pbmRleE9mKCcgJyArIGRvbWFpbi5zbGljZShzbGRPZmZzZXQgKyAxLCB0bGRPZmZzZXQpICsgJyAnKSA8IDApIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICByZXR1cm4gZG9tYWluLnNsaWNlKHNsZE9mZnNldCArIDEpOwogICAgfSwKICAgIG5vQ29uZmxpY3Q6IGZ1bmN0aW9uIG5vQ29uZmxpY3QoKSB7CiAgICAgIGlmIChyb290LlNlY29uZExldmVsRG9tYWlucyA9PT0gdGhpcykgewogICAgICAgIHJvb3QuU2Vjb25kTGV2ZWxEb21haW5zID0gX1NlY29uZExldmVsRG9tYWluczsKICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwoKICByZXR1cm4gU0xEOwp9KTsKCn0se31dLDExOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKdmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKLyohCiAqIFVSSS5qcyAtIE11dGF0aW5nIFVSTHMKICoKICogVmVyc2lvbjogMS4xOC4wCiAqCiAqIEF1dGhvcjogUm9kbmV5IFJlaG0KICogV2ViOiBodHRwOi8vbWVkaWFsaXplLmdpdGh1Yi5pby9VUkkuanMvCiAqCiAqIExpY2Vuc2VkIHVuZGVyCiAqICAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZQogKgogKi8KKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7CiAgJ3VzZSBzdHJpY3QnOwogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS91bWRqcy91bWQvYmxvYi9tYXN0ZXIvcmV0dXJuRXhwb3J0cy5qcwoKICBpZiAoKHR5cGVvZiBleHBvcnRzID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihleHBvcnRzKSkgPT09ICdvYmplY3QnKSB7CiAgICAvLyBOb2RlCiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgnLi9wdW55Y29kZScpLCByZXF1aXJlKCcuL0lQdjYnKSwgcmVxdWlyZSgnLi9TZWNvbmRMZXZlbERvbWFpbnMnKSk7CiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsKICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS4KICAgIGRlZmluZShbJy4vcHVueWNvZGUnLCAnLi9JUHY2JywgJy4vU2Vjb25kTGV2ZWxEb21haW5zJ10sIGZhY3RvcnkpOwogIH0gZWxzZSB7CiAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KQogICAgcm9vdC5VUkkgPSBmYWN0b3J5KHJvb3QucHVueWNvZGUsIHJvb3QuSVB2Niwgcm9vdC5TZWNvbmRMZXZlbERvbWFpbnMsIHJvb3QpOwogIH0KfSkodW5kZWZpbmVkLCBmdW5jdGlvbiAocHVueWNvZGUsIElQdjYsIFNMRCwgcm9vdCkgewogICd1c2Ugc3RyaWN0JzsKICAvKmdsb2JhbCBsb2NhdGlvbiwgZXNjYXBlLCB1bmVzY2FwZSAqLwogIC8vIEZJWE1FOiB2Mi4wLjAgcmVuYW1jZSBub24tY2FtZWxDYXNlIHByb3BlcnRpZXMgdG8gdXBwZXJjYXNlCiAgLypqc2hpbnQgY2FtZWxjYXNlOiBmYWxzZSAqLwoKICAvLyBzYXZlIGN1cnJlbnQgVVJJIHZhcmlhYmxlLCBpZiBhbnkKCiAgdmFyIF9VUkkgPSByb290ICYmIHJvb3QuVVJJOwoKICBmdW5jdGlvbiBVUkkodXJsLCBiYXNlKSB7CiAgICB2YXIgX3VybFN1cHBsaWVkID0gYXJndW1lbnRzLmxlbmd0aCA+PSAxOwogICAgdmFyIF9iYXNlU3VwcGxpZWQgPSBhcmd1bWVudHMubGVuZ3RoID49IDI7CgogICAgLy8gQWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IHRoZSAnbmV3JyBrZXl3b3JkCiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgVVJJKSkgewogICAgICBpZiAoX3VybFN1cHBsaWVkKSB7CiAgICAgICAgaWYgKF9iYXNlU3VwcGxpZWQpIHsKICAgICAgICAgIHJldHVybiBuZXcgVVJJKHVybCwgYmFzZSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3IFVSSSh1cmwpOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IFVSSSgpOwogICAgfQoKICAgIGlmICh1cmwgPT09IHVuZGVmaW5lZCkgewogICAgICBpZiAoX3VybFN1cHBsaWVkKSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndW5kZWZpbmVkIGlzIG5vdCBhIHZhbGlkIGFyZ3VtZW50IGZvciBVUkknKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBsb2NhdGlvbiAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICB1cmwgPSBsb2NhdGlvbi5ocmVmICsgJyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdXJsID0gJyc7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmhyZWYodXJsKTsKCiAgICAvLyByZXNvbHZlIHRvIGJhc2UgYWNjb3JkaW5nIHRvIGh0dHA6Ly9kdmNzLnczLm9yZy9oZy91cmwvcmF3LWZpbGUvdGlwL092ZXJ2aWV3Lmh0bWwjY29uc3RydWN0b3IKICAgIGlmIChiYXNlICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXMuYWJzb2x1dGVUbyhiYXNlKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9CgogIFVSSS52ZXJzaW9uID0gJzEuMTguMCc7CgogIHZhciBwID0gVVJJLnByb3RvdHlwZTsKICB2YXIgaGFzT3duID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKCiAgZnVuY3Rpb24gZXNjYXBlUmVnRXgoc3RyaW5nKSB7CiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbWVkaWFsaXplL1VSSS5qcy9jb21taXQvODVhYzIxNzgzYzExZjhjY2FiMDYxMDZkYmE5NzM1YTMxYTg2OTI0ZCNjb21taXRjb21tZW50LTgyMTk2MwogICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC8oWy4qKz9ePSE6JHt9KCl8W1xdXC9cXF0pL2csICdcXCQxJyk7CiAgfQoKICBmdW5jdGlvbiBnZXRUeXBlKHZhbHVlKSB7CiAgICAvLyBJRTggZG9lc24ndCByZXR1cm4gW09iamVjdCBVbmRlZmluZWRdIGJ1dCBbT2JqZWN0IE9iamVjdF0gZm9yIHVuZGVmaW5lZCB2YWx1ZQogICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuICdVbmRlZmluZWQnOwogICAgfQoKICAgIHJldHVybiBTdHJpbmcoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSkuc2xpY2UoOCwgLTEpOwogIH0KCiAgZnVuY3Rpb24gaXNBcnJheShvYmopIHsKICAgIHJldHVybiBnZXRUeXBlKG9iaikgPT09ICdBcnJheSc7CiAgfQoKICBmdW5jdGlvbiBmaWx0ZXJBcnJheVZhbHVlcyhkYXRhLCB2YWx1ZSkgewogICAgdmFyIGxvb2t1cCA9IHt9OwogICAgdmFyIGksIGxlbmd0aDsKCiAgICBpZiAoZ2V0VHlwZSh2YWx1ZSkgPT09ICdSZWdFeHAnKSB7CiAgICAgIGxvb2t1cCA9IG51bGw7CiAgICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7CiAgICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgbG9va3VwW3ZhbHVlW2ldXSA9IHRydWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGxvb2t1cFt2YWx1ZV0gPSB0cnVlOwogICAgfQoKICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IGRhdGEubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgLypqc2hpbnQgbGF4YnJlYWs6IHRydWUgKi8KICAgICAgdmFyIF9tYXRjaCA9IGxvb2t1cCAmJiBsb29rdXBbZGF0YVtpXV0gIT09IHVuZGVmaW5lZCB8fCAhbG9va3VwICYmIHZhbHVlLnRlc3QoZGF0YVtpXSk7CiAgICAgIC8qanNoaW50IGxheGJyZWFrOiBmYWxzZSAqLwogICAgICBpZiAoX21hdGNoKSB7CiAgICAgICAgZGF0YS5zcGxpY2UoaSwgMSk7CiAgICAgICAgbGVuZ3RoLS07CiAgICAgICAgaS0tOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfQoKICBmdW5jdGlvbiBhcnJheUNvbnRhaW5zKGxpc3QsIHZhbHVlKSB7CiAgICB2YXIgaSwgbGVuZ3RoOwoKICAgIC8vIHZhbHVlIG1heSBiZSBzdHJpbmcsIG51bWJlciwgYXJyYXksIHJlZ2V4cAogICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7CiAgICAgIC8vIE5vdGU6IHRoaXMgY2FuIGJlIG9wdGltaXplZCB0byBPKG4pIChpbnN0ZWFkIG9mIGN1cnJlbnQgTyhtICogbikpCiAgICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKCFhcnJheUNvbnRhaW5zKGxpc3QsIHZhbHVlW2ldKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgdmFyIF90eXBlID0gZ2V0VHlwZSh2YWx1ZSk7CiAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBsaXN0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGlmIChfdHlwZSA9PT0gJ1JlZ0V4cCcpIHsKICAgICAgICBpZiAodHlwZW9mIGxpc3RbaV0gPT09ICdzdHJpbmcnICYmIGxpc3RbaV0ubWF0Y2godmFsdWUpKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAobGlzdFtpXSA9PT0gdmFsdWUpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGZ1bmN0aW9uIGFycmF5c0VxdWFsKG9uZSwgdHdvKSB7CiAgICBpZiAoIWlzQXJyYXkob25lKSB8fCAhaXNBcnJheSh0d28pKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvLyBhcnJheXMgY2FuJ3QgYmUgZXF1YWwgaWYgdGhleSBoYXZlIGRpZmZlcmVudCBhbW91bnQgb2YgY29udGVudAogICAgaWYgKG9uZS5sZW5ndGggIT09IHR3by5sZW5ndGgpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIG9uZS5zb3J0KCk7CiAgICB0d28uc29ydCgpOwoKICAgIGZvciAodmFyIGkgPSAwLCBsID0gb25lLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBpZiAob25lW2ldICE9PSB0d29baV0pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIHRyaW1TbGFzaGVzKHRleHQpIHsKICAgIHZhciB0cmltX2V4cHJlc3Npb24gPSAvXlwvK3xcLyskL2c7CiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKHRyaW1fZXhwcmVzc2lvbiwgJycpOwogIH0KCiAgVVJJLl9wYXJ0cyA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7CiAgICAgIHByb3RvY29sOiBudWxsLAogICAgICB1c2VybmFtZTogbnVsbCwKICAgICAgcGFzc3dvcmQ6IG51bGwsCiAgICAgIGhvc3RuYW1lOiBudWxsLAogICAgICB1cm46IG51bGwsCiAgICAgIHBvcnQ6IG51bGwsCiAgICAgIHBhdGg6IG51bGwsCiAgICAgIHF1ZXJ5OiBudWxsLAogICAgICBmcmFnbWVudDogbnVsbCwKICAgICAgLy8gc3RhdGUKICAgICAgZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzOiBVUkkuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLAogICAgICBlc2NhcGVRdWVyeVNwYWNlOiBVUkkuZXNjYXBlUXVlcnlTcGFjZQogICAgfTsKICB9OwogIC8vIHN0YXRlOiBhbGxvdyBkdXBsaWNhdGUgcXVlcnkgcGFyYW1ldGVycyAoYT0xJmE9MSkKICBVUkkuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzID0gZmFsc2U7CiAgLy8gc3RhdGU6IHJlcGxhY2VzICsgd2l0aCAlMjAgKHNwYWNlIGluIHF1ZXJ5IHN0cmluZ3MpCiAgVVJJLmVzY2FwZVF1ZXJ5U3BhY2UgPSB0cnVlOwogIC8vIHN0YXRpYyBwcm9wZXJ0aWVzCiAgVVJJLnByb3RvY29sX2V4cHJlc3Npb24gPSAvXlthLXpdW2EtejAtOS4rLV0qJC9pOwogIFVSSS5pZG5fZXhwcmVzc2lvbiA9IC9bXmEtejAtOVwuLV0vaTsKICBVUkkucHVueWNvZGVfZXhwcmVzc2lvbiA9IC8oeG4tLSkvaTsKICAvLyB3ZWxsLCAzMzMuNDQ0LjU1NS42NjYgbWF0Y2hlcywgYnV0IGl0IHN1cmUgYWluJ3Qgbm8gSVB2NCAtIGRvIHdlIGNhcmU/CiAgVVJJLmlwNF9leHByZXNzaW9uID0gL15cZHsxLDN9XC5cZHsxLDN9XC5cZHsxLDN9XC5cZHsxLDN9JC87CiAgLy8gY3JlZGl0cyB0byBSaWNoIEJyb3duCiAgLy8gc291cmNlOiBodHRwOi8vZm9ydW1zLmludGVybWFwcGVyLmNvbS92aWV3dG9waWMucGhwP3A9MTA5NiMxMDk2CiAgLy8gc3BlY2lmaWNhdGlvbjogaHR0cDovL3d3dy5pZXRmLm9yZy9yZmMvcmZjNDI5MS50eHQKICBVUkkuaXA2X2V4cHJlc3Npb24gPSAvXlxzKigoKFswLTlBLUZhLWZdezEsNH06KXs3fShbMC05QS1GYS1mXXsxLDR9fDopKXwoKFswLTlBLUZhLWZdezEsNH06KXs2fSg6WzAtOUEtRmEtZl17MSw0fXwoKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKFwuKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKXszfSl8OikpfCgoWzAtOUEtRmEtZl17MSw0fTopezV9KCgoOlswLTlBLUZhLWZdezEsNH0pezEsMn0pfDooKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKFwuKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKXszfSl8OikpfCgoWzAtOUEtRmEtZl17MSw0fTopezR9KCgoOlswLTlBLUZhLWZdezEsNH0pezEsM30pfCgoOlswLTlBLUZhLWZdezEsNH0pPzooKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKFwuKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKXszfSkpfDopKXwoKFswLTlBLUZhLWZdezEsNH06KXszfSgoKDpbMC05QS1GYS1mXXsxLDR9KXsxLDR9KXwoKDpbMC05QS1GYS1mXXsxLDR9KXswLDJ9OigoMjVbMC01XXwyWzAtNF1cZHwxXGRcZHxbMS05XT9cZCkoXC4oMjVbMC01XXwyWzAtNF1cZHwxXGRcZHxbMS05XT9cZCkpezN9KSl8OikpfCgoWzAtOUEtRmEtZl17MSw0fTopezJ9KCgoOlswLTlBLUZhLWZdezEsNH0pezEsNX0pfCgoOlswLTlBLUZhLWZdezEsNH0pezAsM306KCgyNVswLTVdfDJbMC00XVxkfDFcZFxkfFsxLTldP1xkKShcLigyNVswLTVdfDJbMC00XVxkfDFcZFxkfFsxLTldP1xkKSl7M30pKXw6KSl8KChbMC05QS1GYS1mXXsxLDR9Oil7MX0oKCg6WzAtOUEtRmEtZl17MSw0fSl7MSw2fSl8KCg6WzAtOUEtRmEtZl17MSw0fSl7MCw0fTooKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKFwuKDI1WzAtNV18MlswLTRdXGR8MVxkXGR8WzEtOV0/XGQpKXszfSkpfDopKXwoOigoKDpbMC05QS1GYS1mXXsxLDR9KXsxLDd9KXwoKDpbMC05QS1GYS1mXXsxLDR9KXswLDV9OigoMjVbMC01XXwyWzAtNF1cZHwxXGRcZHxbMS05XT9cZCkoXC4oMjVbMC01XXwyWzAtNF1cZHwxXGRcZHxbMS05XT9cZCkpezN9KSl8OikpKSglLispP1xzKiQvOwogIC8vIGV4cHJlc3Npb24gdXNlZCBpcyAiZ3J1YmVyIHJldmlzZWQiIChAZ3J1YmVyIHYyKSBkZXRlcm1pbmVkIHRvIGJlIHRoZQogIC8vIGJlc3Qgc29sdXRpb24gaW4gYSByZWdleC1nb2xmIHdlIGRpZCBhIGNvdXBsZSBvZiBhZ2VzIGFnbyBhdAogIC8vICogaHR0cDovL21hdGhpYXNieW5lbnMuYmUvZGVtby91cmwtcmVnZXgKICAvLyAqIGh0dHA6Ly9yb2RuZXlyZWhtLmRlL3QvdXJsLXJlZ2V4Lmh0bWwKICBVUkkuZmluZF91cmlfZXhwcmVzc2lvbiA9IC9cYigoPzpbYS16XVtcdy1dKzooPzpcL3sxLDN9fFthLXowLTklXSl8d3d3XGR7MCwzfVsuXXxbYS16MC05LlwtXStbLl1bYS16XXsyLDR9XC8pKD86W15ccygpPD5dK3xcKChbXlxzKCk8Pl0rfChcKFteXHMoKTw+XStcKSkpKlwpKSsoPzpcKChbXlxzKCk8Pl0rfChcKFteXHMoKTw+XStcKSkpKlwpfFteXHNgISgpXFtcXXt9OzonIi4sPD4/wqvCu+KAnOKAneKAmOKAmV0pKS9pZzsKICBVUkkuZmluZFVyaSA9IHsKICAgIC8vIHZhbGlkICJzY2hlbWU6Ly8iIG9yICJ3d3cuIgogICAgc3RhcnQ6IC9cYig/OihbYS16XVthLXowLTkuKy1dKjpcL1wvKXx3d3dcLikvZ2ksCiAgICAvLyBldmVyeXRoaW5nIHVwIHRvIHRoZSBuZXh0IHdoaXRlc3BhY2UKICAgIGVuZDogL1tcc1xyXG5dfCQvLAogICAgLy8gdHJpbSB0cmFpbGluZyBwdW5jdHVhdGlvbiBjYXB0dXJlZCBieSBlbmQgUmVnRXhwCiAgICB0cmltOiAvW2AhKClcW1xde307OiciLiw8Pj/Cq8K74oCc4oCd4oCe4oCY4oCZXSskLwogIH07CiAgLy8gaHR0cDovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy91cmktc2NoZW1lcy5odG1sCiAgLy8gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9MaXN0X29mX1RDUF9hbmRfVURQX3BvcnRfbnVtYmVycyNXZWxsLWtub3duX3BvcnRzCiAgVVJJLmRlZmF1bHRQb3J0cyA9IHsKICAgIGh0dHA6ICc4MCcsCiAgICBodHRwczogJzQ0MycsCiAgICBmdHA6ICcyMScsCiAgICBnb3BoZXI6ICc3MCcsCiAgICB3czogJzgwJywKICAgIHdzczogJzQ0MycKICB9OwogIC8vIGFsbG93ZWQgaG9zdG5hbWUgY2hhcmFjdGVycyBhY2NvcmRpbmcgdG8gUkZDIDM5ODYKICAvLyBBTFBIQSBESUdJVCAiLSIgIi4iICJfIiAifiIgIiEiICIkIiAiJiIgIiciICIoIiAiKSIgIioiICIrIiAiLCIgIjsiICI9IiAlZW5jb2RlZAogIC8vIEkndmUgbmV2ZXIgc2VlbiBhIChub24tSUROKSBob3N0bmFtZSBvdGhlciB0aGFuOiBBTFBIQSBESUdJVCAuIC0KICBVUkkuaW52YWxpZF9ob3N0bmFtZV9jaGFyYWN0ZXJzID0gL1teYS16QS1aMC05XC4tXS87CiAgLy8gbWFwIERPTSBFbGVtZW50cyB0byB0aGVpciBVUkkgYXR0cmlidXRlCiAgVVJJLmRvbUF0dHJpYnV0ZXMgPSB7CiAgICAnYSc6ICdocmVmJywKICAgICdibG9ja3F1b3RlJzogJ2NpdGUnLAogICAgJ2xpbmsnOiAnaHJlZicsCiAgICAnYmFzZSc6ICdocmVmJywKICAgICdzY3JpcHQnOiAnc3JjJywKICAgICdmb3JtJzogJ2FjdGlvbicsCiAgICAnaW1nJzogJ3NyYycsCiAgICAnYXJlYSc6ICdocmVmJywKICAgICdpZnJhbWUnOiAnc3JjJywKICAgICdlbWJlZCc6ICdzcmMnLAogICAgJ3NvdXJjZSc6ICdzcmMnLAogICAgJ3RyYWNrJzogJ3NyYycsCiAgICAnaW5wdXQnOiAnc3JjJywgLy8gYnV0IG9ubHkgaWYgdHlwZT0iaW1hZ2UiCiAgICAnYXVkaW8nOiAnc3JjJywKICAgICd2aWRlbyc6ICdzcmMnCiAgfTsKICBVUkkuZ2V0RG9tQXR0cmlidXRlID0gZnVuY3Rpb24gKG5vZGUpIHsKICAgIGlmICghbm9kZSB8fCAhbm9kZS5ub2RlTmFtZSkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIHZhciBub2RlTmFtZSA9IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKICAgIC8vIDxpbnB1dD4gc2hvdWxkIG9ubHkgZXhwb3NlIHNyYyBmb3IgdHlwZT0iaW1hZ2UiCiAgICBpZiAobm9kZU5hbWUgPT09ICdpbnB1dCcgJiYgbm9kZS50eXBlICE9PSAnaW1hZ2UnKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIFVSSS5kb21BdHRyaWJ1dGVzW25vZGVOYW1lXTsKICB9OwoKICBmdW5jdGlvbiBlc2NhcGVGb3JEdW1iRmlyZWZveDM2KHZhbHVlKSB7CiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbWVkaWFsaXplL1VSSS5qcy9pc3N1ZXMvOTEKICAgIHJldHVybiBlc2NhcGUodmFsdWUpOwogIH0KCiAgLy8gZW5jb2RpbmcgLyBkZWNvZGluZyBhY2NvcmRpbmcgdG8gUkZDMzk4NgogIGZ1bmN0aW9uIHN0cmljdEVuY29kZVVSSUNvbXBvbmVudChzdHJpbmcpIHsKICAgIC8vIHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL2VuY29kZVVSSUNvbXBvbmVudAogICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmcpLnJlcGxhY2UoL1shJygpKl0vZywgZXNjYXBlRm9yRHVtYkZpcmVmb3gzNikucmVwbGFjZSgvXCovZywgJyUyQScpOwogIH0KICBVUkkuZW5jb2RlID0gc3RyaWN0RW5jb2RlVVJJQ29tcG9uZW50OwogIFVSSS5kZWNvZGUgPSBkZWNvZGVVUklDb21wb25lbnQ7CiAgVVJJLmlzbzg4NTkgPSBmdW5jdGlvbiAoKSB7CiAgICBVUkkuZW5jb2RlID0gZXNjYXBlOwogICAgVVJJLmRlY29kZSA9IHVuZXNjYXBlOwogIH07CiAgVVJJLnVuaWNvZGUgPSBmdW5jdGlvbiAoKSB7CiAgICBVUkkuZW5jb2RlID0gc3RyaWN0RW5jb2RlVVJJQ29tcG9uZW50OwogICAgVVJJLmRlY29kZSA9IGRlY29kZVVSSUNvbXBvbmVudDsKICB9OwogIFVSSS5jaGFyYWN0ZXJzID0gewogICAgcGF0aG5hbWU6IHsKICAgICAgZW5jb2RlOiB7CiAgICAgICAgLy8gUkZDMzk4NiAyLjE6IEZvciBjb25zaXN0ZW5jeSwgVVJJIHByb2R1Y2VycyBhbmQgbm9ybWFsaXplcnMgc2hvdWxkCiAgICAgICAgLy8gdXNlIHVwcGVyY2FzZSBoZXhhZGVjaW1hbCBkaWdpdHMgZm9yIGFsbCBwZXJjZW50LWVuY29kaW5ncy4KICAgICAgICBleHByZXNzaW9uOiAvJSgyNHwyNnwyQnwyQ3wzQnwzRHwzQXw0MCkvaWcsCiAgICAgICAgbWFwOiB7CiAgICAgICAgICAvLyAtLl9+IScoKSoKICAgICAgICAgICclMjQnOiAnJCcsCiAgICAgICAgICAnJTI2JzogJyYnLAogICAgICAgICAgJyUyQic6ICcrJywKICAgICAgICAgICclMkMnOiAnLCcsCiAgICAgICAgICAnJTNCJzogJzsnLAogICAgICAgICAgJyUzRCc6ICc9JywKICAgICAgICAgICclM0EnOiAnOicsCiAgICAgICAgICAnJTQwJzogJ0AnCiAgICAgICAgfQogICAgICB9LAogICAgICBkZWNvZGU6IHsKICAgICAgICBleHByZXNzaW9uOiAvW1wvXD8jXS9nLAogICAgICAgIG1hcDogewogICAgICAgICAgJy8nOiAnJTJGJywKICAgICAgICAgICc/JzogJyUzRicsCiAgICAgICAgICAnIyc6ICclMjMnCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcmVzZXJ2ZWQ6IHsKICAgICAgZW5jb2RlOiB7CiAgICAgICAgLy8gUkZDMzk4NiAyLjE6IEZvciBjb25zaXN0ZW5jeSwgVVJJIHByb2R1Y2VycyBhbmQgbm9ybWFsaXplcnMgc2hvdWxkCiAgICAgICAgLy8gdXNlIHVwcGVyY2FzZSBoZXhhZGVjaW1hbCBkaWdpdHMgZm9yIGFsbCBwZXJjZW50LWVuY29kaW5ncy4KICAgICAgICBleHByZXNzaW9uOiAvJSgyMXwyM3wyNHwyNnwyN3wyOHwyOXwyQXwyQnwyQ3wyRnwzQXwzQnwzRHwzRnw0MHw1Qnw1RCkvaWcsCiAgICAgICAgbWFwOiB7CiAgICAgICAgICAvLyBnZW4tZGVsaW1zCiAgICAgICAgICAnJTNBJzogJzonLAogICAgICAgICAgJyUyRic6ICcvJywKICAgICAgICAgICclM0YnOiAnPycsCiAgICAgICAgICAnJTIzJzogJyMnLAogICAgICAgICAgJyU1Qic6ICdbJywKICAgICAgICAgICclNUQnOiAnXScsCiAgICAgICAgICAnJTQwJzogJ0AnLAogICAgICAgICAgLy8gc3ViLWRlbGltcwogICAgICAgICAgJyUyMSc6ICchJywKICAgICAgICAgICclMjQnOiAnJCcsCiAgICAgICAgICAnJTI2JzogJyYnLAogICAgICAgICAgJyUyNyc6ICdcJycsCiAgICAgICAgICAnJTI4JzogJygnLAogICAgICAgICAgJyUyOSc6ICcpJywKICAgICAgICAgICclMkEnOiAnKicsCiAgICAgICAgICAnJTJCJzogJysnLAogICAgICAgICAgJyUyQyc6ICcsJywKICAgICAgICAgICclM0InOiAnOycsCiAgICAgICAgICAnJTNEJzogJz0nCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdXJucGF0aDogewogICAgICAvLyBUaGUgY2hhcmFjdGVycyB1bmRlciBgZW5jb2RlYCBhcmUgdGhlIGNoYXJhY3RlcnMgY2FsbGVkIG91dCBieSBSRkMgMjE0MSBhcyBiZWluZyBhY2NlcHRhYmxlCiAgICAgIC8vIGZvciB1c2FnZSBpbiBhIFVSTi4gUkZDMjE0MSBhbHNvIGNhbGxzIG91dCAiLSIsICIuIiwgYW5kICJfIiBhcyBhY2NlcHRhYmxlIGNoYXJhY3RlcnMsIGJ1dAogICAgICAvLyB0aGVzZSBhcmVuJ3QgZW5jb2RlZCBieSBlbmNvZGVVUklDb21wb25lbnQsIHNvIHdlIGRvbid0IGhhdmUgdG8gY2FsbCB0aGVtIG91dCBoZXJlLiBBbHNvCiAgICAgIC8vIG5vdGUgdGhhdCB0aGUgY29sb24gY2hhcmFjdGVyIGlzIG5vdCBmZWF0dXJlZCBpbiB0aGUgZW5jb2RpbmcgbWFwOyB0aGlzIGlzIGJlY2F1c2UgVVJJLmpzCiAgICAgIC8vIGdpdmVzIHRoZSBjb2xvbnMgaW4gVVJOcyBzZW1hbnRpYyBtZWFuaW5nIGFzIHRoZSBkZWxpbWl0ZXJzIG9mIHBhdGggc2VnZW1lbnRzLCBhbmQgc28gaXQKICAgICAgLy8gc2hvdWxkIG5vdCBhcHBlYXIgdW5lbmNvZGVkIGluIGEgc2VnbWVudCBpdHNlbGYuCiAgICAgIC8vIFNlZSBhbHNvIHRoZSBub3RlIGFib3ZlIGFib3V0IFJGQzM5ODYgYW5kIGNhcGl0YWxhbGl6ZWQgaGV4IGRpZ2l0cy4KICAgICAgZW5jb2RlOiB7CiAgICAgICAgZXhwcmVzc2lvbjogLyUoMjF8MjR8Mjd8Mjh8Mjl8MkF8MkJ8MkN8M0J8M0R8NDApL2lnLAogICAgICAgIG1hcDogewogICAgICAgICAgJyUyMSc6ICchJywKICAgICAgICAgICclMjQnOiAnJCcsCiAgICAgICAgICAnJTI3JzogJ1wnJywKICAgICAgICAgICclMjgnOiAnKCcsCiAgICAgICAgICAnJTI5JzogJyknLAogICAgICAgICAgJyUyQSc6ICcqJywKICAgICAgICAgICclMkInOiAnKycsCiAgICAgICAgICAnJTJDJzogJywnLAogICAgICAgICAgJyUzQic6ICc7JywKICAgICAgICAgICclM0QnOiAnPScsCiAgICAgICAgICAnJTQwJzogJ0AnCiAgICAgICAgfQogICAgICB9LAogICAgICAvLyBUaGVzZSBjaGFyYWN0ZXJzIGFyZSB0aGUgY2hhcmFjdGVycyBjYWxsZWQgb3V0IGJ5IFJGQzIxNDEgYXMgInJlc2VydmVkIiBjaGFyYWN0ZXJzIHRoYXQKICAgICAgLy8gc2hvdWxkIG5ldmVyIGFwcGVhciBpbiBhIFVSTiwgcGx1cyB0aGUgY29sb24gY2hhcmFjdGVyIChzZWUgbm90ZSBhYm92ZSkuCiAgICAgIGRlY29kZTogewogICAgICAgIGV4cHJlc3Npb246IC9bXC9cPyM6XS9nLAogICAgICAgIG1hcDogewogICAgICAgICAgJy8nOiAnJTJGJywKICAgICAgICAgICc/JzogJyUzRicsCiAgICAgICAgICAnIyc6ICclMjMnLAogICAgICAgICAgJzonOiAnJTNBJwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CiAgVVJJLmVuY29kZVF1ZXJ5ID0gZnVuY3Rpb24gKHN0cmluZywgZXNjYXBlUXVlcnlTcGFjZSkgewogICAgdmFyIGVzY2FwZWQgPSBVUkkuZW5jb2RlKHN0cmluZyArICcnKTsKICAgIGlmIChlc2NhcGVRdWVyeVNwYWNlID09PSB1bmRlZmluZWQpIHsKICAgICAgZXNjYXBlUXVlcnlTcGFjZSA9IFVSSS5lc2NhcGVRdWVyeVNwYWNlOwogICAgfQoKICAgIHJldHVybiBlc2NhcGVRdWVyeVNwYWNlID8gZXNjYXBlZC5yZXBsYWNlKC8lMjAvZywgJysnKSA6IGVzY2FwZWQ7CiAgfTsKICBVUkkuZGVjb2RlUXVlcnkgPSBmdW5jdGlvbiAoc3RyaW5nLCBlc2NhcGVRdWVyeVNwYWNlKSB7CiAgICBzdHJpbmcgKz0gJyc7CiAgICBpZiAoZXNjYXBlUXVlcnlTcGFjZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGVzY2FwZVF1ZXJ5U3BhY2UgPSBVUkkuZXNjYXBlUXVlcnlTcGFjZTsKICAgIH0KCiAgICB0cnkgewogICAgICByZXR1cm4gVVJJLmRlY29kZShlc2NhcGVRdWVyeVNwYWNlID8gc3RyaW5nLnJlcGxhY2UoL1wrL2csICclMjAnKSA6IHN0cmluZyk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIC8vIHdlJ3JlIG5vdCBnb2luZyB0byBtZXNzIHdpdGggd2VpcmQgZW5jb2RpbmdzLAogICAgICAvLyBnaXZlIHVwIGFuZCByZXR1cm4gdGhlIHVuZGVjb2RlZCBvcmlnaW5hbCBzdHJpbmcKICAgICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL2lzc3Vlcy84NwogICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL21lZGlhbGl6ZS9VUkkuanMvaXNzdWVzLzkyCiAgICAgIHJldHVybiBzdHJpbmc7CiAgICB9CiAgfTsKICAvLyBnZW5lcmF0ZSBlbmNvZGUvZGVjb2RlIHBhdGggZnVuY3Rpb25zCiAgdmFyIF9wYXJ0cyA9IHsgJ2VuY29kZSc6ICdlbmNvZGUnLCAnZGVjb2RlJzogJ2RlY29kZScgfTsKICB2YXIgX3BhcnQ7CiAgdmFyIGdlbmVyYXRlQWNjZXNzb3IgPSBmdW5jdGlvbiBnZW5lcmF0ZUFjY2Vzc29yKF9ncm91cCwgX3BhcnQpIHsKICAgIHJldHVybiBmdW5jdGlvbiAoc3RyaW5nKSB7CiAgICAgIHRyeSB7CiAgICAgICAgcmV0dXJuIFVSSVtfcGFydF0oc3RyaW5nICsgJycpLnJlcGxhY2UoVVJJLmNoYXJhY3RlcnNbX2dyb3VwXVtfcGFydF0uZXhwcmVzc2lvbiwgZnVuY3Rpb24gKGMpIHsKICAgICAgICAgIHJldHVybiBVUkkuY2hhcmFjdGVyc1tfZ3JvdXBdW19wYXJ0XS5tYXBbY107CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyB3ZSdyZSBub3QgZ29pbmcgdG8gbWVzcyB3aXRoIHdlaXJkIGVuY29kaW5ncywKICAgICAgICAvLyBnaXZlIHVwIGFuZCByZXR1cm4gdGhlIHVuZGVjb2RlZCBvcmlnaW5hbCBzdHJpbmcKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL21lZGlhbGl6ZS9VUkkuanMvaXNzdWVzLzg3CiAgICAgICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL2lzc3Vlcy85MgogICAgICAgIHJldHVybiBzdHJpbmc7CiAgICAgIH0KICAgIH07CiAgfTsKCiAgZm9yIChfcGFydCBpbiBfcGFydHMpIHsKICAgIFVSSVtfcGFydCArICdQYXRoU2VnbWVudCddID0gZ2VuZXJhdGVBY2Nlc3NvcigncGF0aG5hbWUnLCBfcGFydHNbX3BhcnRdKTsKICAgIFVSSVtfcGFydCArICdVcm5QYXRoU2VnbWVudCddID0gZ2VuZXJhdGVBY2Nlc3NvcigndXJucGF0aCcsIF9wYXJ0c1tfcGFydF0pOwogIH0KCiAgdmFyIGdlbmVyYXRlU2VnbWVudGVkUGF0aEZ1bmN0aW9uID0gZnVuY3Rpb24gZ2VuZXJhdGVTZWdtZW50ZWRQYXRoRnVuY3Rpb24oX3NlcCwgX2NvZGluZ0Z1bmNOYW1lLCBfaW5uZXJDb2RpbmdGdW5jTmFtZSkgewogICAgcmV0dXJuIGZ1bmN0aW9uIChzdHJpbmcpIHsKICAgICAgLy8gV2h5IHBhc3MgaW4gbmFtZXMgb2YgZnVuY3Rpb25zLCByYXRoZXIgdGhhbiB0aGUgZnVuY3Rpb24gb2JqZWN0cyB0aGVtc2VsdmVzPyBUaGUKICAgICAgLy8gZGVmaW5pdGlvbnMgb2Ygc29tZSBmdW5jdGlvbnMgKGJ1dCBpbiBwYXJ0aWN1bGFyLCBVUkkuZGVjb2RlKSB3aWxsIG9jY2FzaW9uYWxseSBjaGFuZ2UgZHVlCiAgICAgIC8vIHRvIFVSSS5qcyBoYXZpbmcgSVNPODg1OSBhbmQgVW5pY29kZSBtb2Rlcy4gUGFzc2luZyBpbiB0aGUgbmFtZSBhbmQgZ2V0dGluZyBpdCB3aWxsIGVuc3VyZQogICAgICAvLyB0aGF0IHRoZSBmdW5jdGlvbnMgd2UgdXNlIGhlcmUgYXJlICJmcmVzaCIuCiAgICAgIHZhciBhY3R1YWxDb2RpbmdGdW5jOwogICAgICBpZiAoIV9pbm5lckNvZGluZ0Z1bmNOYW1lKSB7CiAgICAgICAgYWN0dWFsQ29kaW5nRnVuYyA9IFVSSVtfY29kaW5nRnVuY05hbWVdOwogICAgICB9IGVsc2UgewogICAgICAgIGFjdHVhbENvZGluZ0Z1bmMgPSBmdW5jdGlvbiBhY3R1YWxDb2RpbmdGdW5jKHN0cmluZykgewogICAgICAgICAgcmV0dXJuIFVSSVtfY29kaW5nRnVuY05hbWVdKFVSSVtfaW5uZXJDb2RpbmdGdW5jTmFtZV0oc3RyaW5nKSk7CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgdmFyIHNlZ21lbnRzID0gKHN0cmluZyArICcnKS5zcGxpdChfc2VwKTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBzZWdtZW50cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIHNlZ21lbnRzW2ldID0gYWN0dWFsQ29kaW5nRnVuYyhzZWdtZW50c1tpXSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBzZWdtZW50cy5qb2luKF9zZXApOwogICAgfTsKICB9OwoKICAvLyBUaGlzIHRha2VzIHBsYWNlIG91dHNpZGUgdGhlIGFib3ZlIGxvb3AgYmVjYXVzZSB3ZSBkb24ndCB3YW50LCBlLmcuLCBlbmNvZGVVcm5QYXRoIGZ1bmN0aW9ucy4KICBVUkkuZGVjb2RlUGF0aCA9IGdlbmVyYXRlU2VnbWVudGVkUGF0aEZ1bmN0aW9uKCcvJywgJ2RlY29kZVBhdGhTZWdtZW50Jyk7CiAgVVJJLmRlY29kZVVyblBhdGggPSBnZW5lcmF0ZVNlZ21lbnRlZFBhdGhGdW5jdGlvbignOicsICdkZWNvZGVVcm5QYXRoU2VnbWVudCcpOwogIFVSSS5yZWNvZGVQYXRoID0gZ2VuZXJhdGVTZWdtZW50ZWRQYXRoRnVuY3Rpb24oJy8nLCAnZW5jb2RlUGF0aFNlZ21lbnQnLCAnZGVjb2RlJyk7CiAgVVJJLnJlY29kZVVyblBhdGggPSBnZW5lcmF0ZVNlZ21lbnRlZFBhdGhGdW5jdGlvbignOicsICdlbmNvZGVVcm5QYXRoU2VnbWVudCcsICdkZWNvZGUnKTsKCiAgVVJJLmVuY29kZVJlc2VydmVkID0gZ2VuZXJhdGVBY2Nlc3NvcigncmVzZXJ2ZWQnLCAnZW5jb2RlJyk7CgogIFVSSS5wYXJzZSA9IGZ1bmN0aW9uIChzdHJpbmcsIHBhcnRzKSB7CiAgICB2YXIgcG9zOwogICAgaWYgKCFwYXJ0cykgewogICAgICBwYXJ0cyA9IHt9OwogICAgfQogICAgLy8gW3Byb3RvY29sIjovLyJbdXNlcm5hbWVbIjoicGFzc3dvcmRdIkAiXWhvc3RuYW1lWyI6InBvcnRdIi8iP11bcGF0aF1bIj8icXVlcnlzdHJpbmddWyIjImZyYWdtZW50XQoKICAgIC8vIGV4dHJhY3QgZnJhZ21lbnQKICAgIHBvcyA9IHN0cmluZy5pbmRleE9mKCcjJyk7CiAgICBpZiAocG9zID4gLTEpIHsKICAgICAgLy8gZXNjYXBpbmc/CiAgICAgIHBhcnRzLmZyYWdtZW50ID0gc3RyaW5nLnN1YnN0cmluZyhwb3MgKyAxKSB8fCBudWxsOwogICAgICBzdHJpbmcgPSBzdHJpbmcuc3Vic3RyaW5nKDAsIHBvcyk7CiAgICB9CgogICAgLy8gZXh0cmFjdCBxdWVyeQogICAgcG9zID0gc3RyaW5nLmluZGV4T2YoJz8nKTsKICAgIGlmIChwb3MgPiAtMSkgewogICAgICAvLyBlc2NhcGluZz8KICAgICAgcGFydHMucXVlcnkgPSBzdHJpbmcuc3Vic3RyaW5nKHBvcyArIDEpIHx8IG51bGw7CiAgICAgIHN0cmluZyA9IHN0cmluZy5zdWJzdHJpbmcoMCwgcG9zKTsKICAgIH0KCiAgICAvLyBleHRyYWN0IHByb3RvY29sCiAgICBpZiAoc3RyaW5nLnN1YnN0cmluZygwLCAyKSA9PT0gJy8vJykgewogICAgICAvLyByZWxhdGl2ZS1zY2hlbWUKICAgICAgcGFydHMucHJvdG9jb2wgPSBudWxsOwogICAgICBzdHJpbmcgPSBzdHJpbmcuc3Vic3RyaW5nKDIpOwogICAgICAvLyBleHRyYWN0ICJ1c2VyOnBhc3NAaG9zdDpwb3J0IgogICAgICBzdHJpbmcgPSBVUkkucGFyc2VBdXRob3JpdHkoc3RyaW5nLCBwYXJ0cyk7CiAgICB9IGVsc2UgewogICAgICBwb3MgPSBzdHJpbmcuaW5kZXhPZignOicpOwogICAgICBpZiAocG9zID4gLTEpIHsKICAgICAgICBwYXJ0cy5wcm90b2NvbCA9IHN0cmluZy5zdWJzdHJpbmcoMCwgcG9zKSB8fCBudWxsOwogICAgICAgIGlmIChwYXJ0cy5wcm90b2NvbCAmJiAhcGFydHMucHJvdG9jb2wubWF0Y2goVVJJLnByb3RvY29sX2V4cHJlc3Npb24pKSB7CiAgICAgICAgICAvLyA6IG1heSBiZSB3aXRoaW4gdGhlIHBhdGgKICAgICAgICAgIHBhcnRzLnByb3RvY29sID0gdW5kZWZpbmVkOwogICAgICAgIH0gZWxzZSBpZiAoc3RyaW5nLnN1YnN0cmluZyhwb3MgKyAxLCBwb3MgKyAzKSA9PT0gJy8vJykgewogICAgICAgICAgc3RyaW5nID0gc3RyaW5nLnN1YnN0cmluZyhwb3MgKyAzKTsKCiAgICAgICAgICAvLyBleHRyYWN0ICJ1c2VyOnBhc3NAaG9zdDpwb3J0IgogICAgICAgICAgc3RyaW5nID0gVVJJLnBhcnNlQXV0aG9yaXR5KHN0cmluZywgcGFydHMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdHJpbmcgPSBzdHJpbmcuc3Vic3RyaW5nKHBvcyArIDEpOwogICAgICAgICAgcGFydHMudXJuID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICAvLyB3aGF0J3MgbGVmdCBtdXN0IGJlIHRoZSBwYXRoCiAgICBwYXJ0cy5wYXRoID0gc3RyaW5nOwoKICAgIC8vIGFuZCB3ZSdyZSBkb25lCiAgICByZXR1cm4gcGFydHM7CiAgfTsKICBVUkkucGFyc2VIb3N0ID0gZnVuY3Rpb24gKHN0cmluZywgcGFydHMpIHsKICAgIC8vIENvcHkgY2hyb21lLCBJRSwgb3BlcmEgYmFja3NsYXNoLWhhbmRsaW5nIGJlaGF2aW9yLgogICAgLy8gQmFjayBzbGFzaGVzIGJlZm9yZSB0aGUgcXVlcnkgc3RyaW5nIGdldCBjb252ZXJ0ZWQgdG8gZm9yd2FyZCBzbGFzaGVzCiAgICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9qb3llbnQvbm9kZS9ibG9iLzM4NmZkMjRmNDliMGU5ZDFhOGEwNzY1OTJhNDA0MTY4ZmFlZWNjMzQvbGliL3VybC5qcyNMMTE1LUwxMjQKICAgIC8vIFNlZTogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTI1OTE2CiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbWVkaWFsaXplL1VSSS5qcy9wdWxsLzIzMwogICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoL1xcL2csICcvJyk7CgogICAgLy8gZXh0cmFjdCBob3N0OnBvcnQKICAgIHZhciBwb3MgPSBzdHJpbmcuaW5kZXhPZignLycpOwogICAgdmFyIGJyYWNrZXRQb3M7CiAgICB2YXIgdDsKCiAgICBpZiAocG9zID09PSAtMSkgewogICAgICBwb3MgPSBzdHJpbmcubGVuZ3RoOwogICAgfQoKICAgIGlmIChzdHJpbmcuY2hhckF0KDApID09PSAnWycpIHsKICAgICAgLy8gSVB2NiBob3N0IC0gaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvZHJhZnQtaWV0Zi02bWFuLXRleHQtYWRkci1yZXByZXNlbnRhdGlvbi0wNCNzZWN0aW9uLTYKICAgICAgLy8gSSBjbGFpbSBtb3N0IGNsaWVudCBzb2Z0d2FyZSBicmVha3Mgb24gSVB2NiBhbnl3YXlzLiBUbyBzaW1wbGlmeSB0aGluZ3MsIFVSSSBvbmx5IGFjY2VwdHMKICAgICAgLy8gSVB2Nitwb3J0IGluIHRoZSBmb3JtYXQgWzIwMDE6ZGI4OjoxXTo4MCAoZm9yIHRoZSB0aW1lIGJlaW5nKQogICAgICBicmFja2V0UG9zID0gc3RyaW5nLmluZGV4T2YoJ10nKTsKICAgICAgcGFydHMuaG9zdG5hbWUgPSBzdHJpbmcuc3Vic3RyaW5nKDEsIGJyYWNrZXRQb3MpIHx8IG51bGw7CiAgICAgIHBhcnRzLnBvcnQgPSBzdHJpbmcuc3Vic3RyaW5nKGJyYWNrZXRQb3MgKyAyLCBwb3MpIHx8IG51bGw7CiAgICAgIGlmIChwYXJ0cy5wb3J0ID09PSAnLycpIHsKICAgICAgICBwYXJ0cy5wb3J0ID0gbnVsbDsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdmFyIGZpcnN0Q29sb24gPSBzdHJpbmcuaW5kZXhPZignOicpOwogICAgICB2YXIgZmlyc3RTbGFzaCA9IHN0cmluZy5pbmRleE9mKCcvJyk7CiAgICAgIHZhciBuZXh0Q29sb24gPSBzdHJpbmcuaW5kZXhPZignOicsIGZpcnN0Q29sb24gKyAxKTsKICAgICAgaWYgKG5leHRDb2xvbiAhPT0gLTEgJiYgKGZpcnN0U2xhc2ggPT09IC0xIHx8IG5leHRDb2xvbiA8IGZpcnN0U2xhc2gpKSB7CiAgICAgICAgLy8gSVB2NiBob3N0IGNvbnRhaW5zIG11bHRpcGxlIGNvbG9ucyAtIGJ1dCBubyBwb3J0CiAgICAgICAgLy8gdGhpcyBub3RhdGlvbiBpcyBhY3R1YWxseSBub3QgYWxsb3dlZCBieSBSRkMgMzk4NiwgYnV0IHdlJ3JlIGEgbGliZXJhbCBwYXJzZXIKICAgICAgICBwYXJ0cy5ob3N0bmFtZSA9IHN0cmluZy5zdWJzdHJpbmcoMCwgcG9zKSB8fCBudWxsOwogICAgICAgIHBhcnRzLnBvcnQgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHQgPSBzdHJpbmcuc3Vic3RyaW5nKDAsIHBvcykuc3BsaXQoJzonKTsKICAgICAgICBwYXJ0cy5ob3N0bmFtZSA9IHRbMF0gfHwgbnVsbDsKICAgICAgICBwYXJ0cy5wb3J0ID0gdFsxXSB8fCBudWxsOwogICAgICB9CiAgICB9CgogICAgaWYgKHBhcnRzLmhvc3RuYW1lICYmIHN0cmluZy5zdWJzdHJpbmcocG9zKS5jaGFyQXQoMCkgIT09ICcvJykgewogICAgICBwb3MrKzsKICAgICAgc3RyaW5nID0gJy8nICsgc3RyaW5nOwogICAgfQoKICAgIHJldHVybiBzdHJpbmcuc3Vic3RyaW5nKHBvcykgfHwgJy8nOwogIH07CiAgVVJJLnBhcnNlQXV0aG9yaXR5ID0gZnVuY3Rpb24gKHN0cmluZywgcGFydHMpIHsKICAgIHN0cmluZyA9IFVSSS5wYXJzZVVzZXJpbmZvKHN0cmluZywgcGFydHMpOwogICAgcmV0dXJuIFVSSS5wYXJzZUhvc3Qoc3RyaW5nLCBwYXJ0cyk7CiAgfTsKICBVUkkucGFyc2VVc2VyaW5mbyA9IGZ1bmN0aW9uIChzdHJpbmcsIHBhcnRzKSB7CiAgICAvLyBleHRyYWN0IHVzZXJuYW1lOnBhc3N3b3JkCiAgICB2YXIgZmlyc3RTbGFzaCA9IHN0cmluZy5pbmRleE9mKCcvJyk7CiAgICB2YXIgcG9zID0gc3RyaW5nLmxhc3RJbmRleE9mKCdAJywgZmlyc3RTbGFzaCA+IC0xID8gZmlyc3RTbGFzaCA6IHN0cmluZy5sZW5ndGggLSAxKTsKICAgIHZhciB0OwoKICAgIC8vIGF1dGhvcml0eUAgbXVzdCBjb21lIGJlZm9yZSAvcGF0aAogICAgaWYgKHBvcyA+IC0xICYmIChmaXJzdFNsYXNoID09PSAtMSB8fCBwb3MgPCBmaXJzdFNsYXNoKSkgewogICAgICB0ID0gc3RyaW5nLnN1YnN0cmluZygwLCBwb3MpLnNwbGl0KCc6Jyk7CiAgICAgIHBhcnRzLnVzZXJuYW1lID0gdFswXSA/IFVSSS5kZWNvZGUodFswXSkgOiBudWxsOwogICAgICB0LnNoaWZ0KCk7CiAgICAgIHBhcnRzLnBhc3N3b3JkID0gdFswXSA/IFVSSS5kZWNvZGUodC5qb2luKCc6JykpIDogbnVsbDsKICAgICAgc3RyaW5nID0gc3RyaW5nLnN1YnN0cmluZyhwb3MgKyAxKTsKICAgIH0gZWxzZSB7CiAgICAgIHBhcnRzLnVzZXJuYW1lID0gbnVsbDsKICAgICAgcGFydHMucGFzc3dvcmQgPSBudWxsOwogICAgfQoKICAgIHJldHVybiBzdHJpbmc7CiAgfTsKICBVUkkucGFyc2VRdWVyeSA9IGZ1bmN0aW9uIChzdHJpbmcsIGVzY2FwZVF1ZXJ5U3BhY2UpIHsKICAgIGlmICghc3RyaW5nKSB7CiAgICAgIHJldHVybiB7fTsKICAgIH0KCiAgICAvLyB0aHJvdyBvdXQgdGhlIGZ1bmt5IGJ1c2luZXNzIC0gIj8iW25hbWUiPSJ2YWx1ZSImIl0rCiAgICBzdHJpbmcgPSBzdHJpbmcucmVwbGFjZSgvJisvZywgJyYnKS5yZXBsYWNlKC9eXD8qJip8JiskL2csICcnKTsKCiAgICBpZiAoIXN0cmluZykgewogICAgICByZXR1cm4ge307CiAgICB9CgogICAgdmFyIGl0ZW1zID0ge307CiAgICB2YXIgc3BsaXRzID0gc3RyaW5nLnNwbGl0KCcmJyk7CiAgICB2YXIgbGVuZ3RoID0gc3BsaXRzLmxlbmd0aDsKICAgIHZhciB2LCBuYW1lLCB2YWx1ZTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIHYgPSBzcGxpdHNbaV0uc3BsaXQoJz0nKTsKICAgICAgbmFtZSA9IFVSSS5kZWNvZGVRdWVyeSh2LnNoaWZ0KCksIGVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgICAvLyBubyAiPSIgaXMgbnVsbCBhY2NvcmRpbmcgdG8gaHR0cDovL2R2Y3MudzMub3JnL2hnL3VybC9yYXctZmlsZS90aXAvT3ZlcnZpZXcuaHRtbCNjb2xsZWN0LXVybC1wYXJhbWV0ZXJzCiAgICAgIHZhbHVlID0gdi5sZW5ndGggPyBVUkkuZGVjb2RlUXVlcnkodi5qb2luKCc9JyksIGVzY2FwZVF1ZXJ5U3BhY2UpIDogbnVsbDsKCiAgICAgIGlmIChoYXNPd24uY2FsbChpdGVtcywgbmFtZSkpIHsKICAgICAgICBpZiAodHlwZW9mIGl0ZW1zW25hbWVdID09PSAnc3RyaW5nJyB8fCBpdGVtc1tuYW1lXSA9PT0gbnVsbCkgewogICAgICAgICAgaXRlbXNbbmFtZV0gPSBbaXRlbXNbbmFtZV1dOwogICAgICAgIH0KCiAgICAgICAgaXRlbXNbbmFtZV0ucHVzaCh2YWx1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaXRlbXNbbmFtZV0gPSB2YWx1ZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBpdGVtczsKICB9OwoKICBVUkkuYnVpbGQgPSBmdW5jdGlvbiAocGFydHMpIHsKICAgIHZhciB0ID0gJyc7CgogICAgaWYgKHBhcnRzLnByb3RvY29sKSB7CiAgICAgIHQgKz0gcGFydHMucHJvdG9jb2wgKyAnOic7CiAgICB9CgogICAgaWYgKCFwYXJ0cy51cm4gJiYgKHQgfHwgcGFydHMuaG9zdG5hbWUpKSB7CiAgICAgIHQgKz0gJy8vJzsKICAgIH0KCiAgICB0ICs9IFVSSS5idWlsZEF1dGhvcml0eShwYXJ0cykgfHwgJyc7CgogICAgaWYgKHR5cGVvZiBwYXJ0cy5wYXRoID09PSAnc3RyaW5nJykgewogICAgICBpZiAocGFydHMucGF0aC5jaGFyQXQoMCkgIT09ICcvJyAmJiB0eXBlb2YgcGFydHMuaG9zdG5hbWUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgdCArPSAnLyc7CiAgICAgIH0KCiAgICAgIHQgKz0gcGFydHMucGF0aDsKICAgIH0KCiAgICBpZiAodHlwZW9mIHBhcnRzLnF1ZXJ5ID09PSAnc3RyaW5nJyAmJiBwYXJ0cy5xdWVyeSkgewogICAgICB0ICs9ICc/JyArIHBhcnRzLnF1ZXJ5OwogICAgfQoKICAgIGlmICh0eXBlb2YgcGFydHMuZnJhZ21lbnQgPT09ICdzdHJpbmcnICYmIHBhcnRzLmZyYWdtZW50KSB7CiAgICAgIHQgKz0gJyMnICsgcGFydHMuZnJhZ21lbnQ7CiAgICB9CiAgICByZXR1cm4gdDsKICB9OwogIFVSSS5idWlsZEhvc3QgPSBmdW5jdGlvbiAocGFydHMpIHsKICAgIHZhciB0ID0gJyc7CgogICAgaWYgKCFwYXJ0cy5ob3N0bmFtZSkgewogICAgICByZXR1cm4gJyc7CiAgICB9IGVsc2UgaWYgKFVSSS5pcDZfZXhwcmVzc2lvbi50ZXN0KHBhcnRzLmhvc3RuYW1lKSkgewogICAgICB0ICs9ICdbJyArIHBhcnRzLmhvc3RuYW1lICsgJ10nOwogICAgfSBlbHNlIHsKICAgICAgdCArPSBwYXJ0cy5ob3N0bmFtZTsKICAgIH0KCiAgICBpZiAocGFydHMucG9ydCkgewogICAgICB0ICs9ICc6JyArIHBhcnRzLnBvcnQ7CiAgICB9CgogICAgcmV0dXJuIHQ7CiAgfTsKICBVUkkuYnVpbGRBdXRob3JpdHkgPSBmdW5jdGlvbiAocGFydHMpIHsKICAgIHJldHVybiBVUkkuYnVpbGRVc2VyaW5mbyhwYXJ0cykgKyBVUkkuYnVpbGRIb3N0KHBhcnRzKTsKICB9OwogIFVSSS5idWlsZFVzZXJpbmZvID0gZnVuY3Rpb24gKHBhcnRzKSB7CiAgICB2YXIgdCA9ICcnOwoKICAgIGlmIChwYXJ0cy51c2VybmFtZSkgewogICAgICB0ICs9IFVSSS5lbmNvZGUocGFydHMudXNlcm5hbWUpOwogICAgfQoKICAgIGlmIChwYXJ0cy5wYXNzd29yZCkgewogICAgICB0ICs9ICc6JyArIFVSSS5lbmNvZGUocGFydHMucGFzc3dvcmQpOwogICAgfQoKICAgIGlmICh0KSB7CiAgICAgIHQgKz0gJ0AnOwogICAgfQoKICAgIHJldHVybiB0OwogIH07CiAgVVJJLmJ1aWxkUXVlcnkgPSBmdW5jdGlvbiAoZGF0YSwgZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLCBlc2NhcGVRdWVyeVNwYWNlKSB7CiAgICAvLyBhY2NvcmRpbmcgdG8gaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzk4NiBvciBodHRwOi8vbGFicy5hcGFjaGUub3JnL3dlYmFyY2gvdXJpL3JmYy9yZmMzOTg2Lmh0bWwKICAgIC8vIGJlaW5nIMK7LS5ffiEkJicoKSorLDs9OkAvP8KrICVIRVggYW5kIGFsbnVtIGFyZSBhbGxvd2VkCiAgICAvLyB0aGUgUkZDIGV4cGxpY2l0bHkgc3RhdGVzID8vZm9vIGJlaW5nIGEgdmFsaWQgdXNlIGNhc2UsIG5vIG1lbnRpb24gb2YgcGFyYW1ldGVyIHN5bnRheCEKICAgIC8vIFVSSS5qcyB0cmVhdHMgdGhlIHF1ZXJ5IHN0cmluZyBhcyBiZWluZyBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQKICAgIC8vIHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9SRUMtaHRtbDQwL2ludGVyYWN0L2Zvcm1zLmh0bWwjZm9ybS1jb250ZW50LXR5cGUKCiAgICB2YXIgdCA9ICcnOwogICAgdmFyIHVuaXF1ZSwga2V5LCBpLCBsZW5ndGg7CiAgICBmb3IgKGtleSBpbiBkYXRhKSB7CiAgICAgIGlmIChoYXNPd24uY2FsbChkYXRhLCBrZXkpICYmIGtleSkgewogICAgICAgIGlmIChpc0FycmF5KGRhdGFba2V5XSkpIHsKICAgICAgICAgIHVuaXF1ZSA9IHt9OwogICAgICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0gZGF0YVtrZXldLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChkYXRhW2tleV1baV0gIT09IHVuZGVmaW5lZCAmJiB1bmlxdWVbZGF0YVtrZXldW2ldICsgJyddID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICB0ICs9ICcmJyArIFVSSS5idWlsZFF1ZXJ5UGFyYW1ldGVyKGtleSwgZGF0YVtrZXldW2ldLCBlc2NhcGVRdWVyeVNwYWNlKTsKICAgICAgICAgICAgICBpZiAoZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzICE9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICB1bmlxdWVbZGF0YVtrZXldW2ldICsgJyddID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGRhdGFba2V5XSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0ICs9ICcmJyArIFVSSS5idWlsZFF1ZXJ5UGFyYW1ldGVyKGtleSwgZGF0YVtrZXldLCBlc2NhcGVRdWVyeVNwYWNlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdC5zdWJzdHJpbmcoMSk7CiAgfTsKICBVUkkuYnVpbGRRdWVyeVBhcmFtZXRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSwgZXNjYXBlUXVlcnlTcGFjZSkgewogICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvUkVDLWh0bWw0MC9pbnRlcmFjdC9mb3Jtcy5odG1sI2Zvcm0tY29udGVudC10eXBlIC0tIGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZAogICAgLy8gZG9uJ3QgYXBwZW5kICI9IiBmb3IgbnVsbCB2YWx1ZXMsIGFjY29yZGluZyB0byBodHRwOi8vZHZjcy53My5vcmcvaGcvdXJsL3Jhdy1maWxlL3RpcC9PdmVydmlldy5odG1sI3VybC1wYXJhbWV0ZXItc2VyaWFsaXphdGlvbgogICAgcmV0dXJuIFVSSS5lbmNvZGVRdWVyeShuYW1lLCBlc2NhcGVRdWVyeVNwYWNlKSArICh2YWx1ZSAhPT0gbnVsbCA/ICc9JyArIFVSSS5lbmNvZGVRdWVyeSh2YWx1ZSwgZXNjYXBlUXVlcnlTcGFjZSkgOiAnJyk7CiAgfTsKCiAgVVJJLmFkZFF1ZXJ5ID0gZnVuY3Rpb24gKGRhdGEsIG5hbWUsIHZhbHVlKSB7CiAgICBpZiAoKHR5cGVvZiBuYW1lID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihuYW1lKSkgPT09ICdvYmplY3QnKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBuYW1lKSB7CiAgICAgICAgaWYgKGhhc093bi5jYWxsKG5hbWUsIGtleSkpIHsKICAgICAgICAgIFVSSS5hZGRRdWVyeShkYXRhLCBrZXksIG5hbWVba2V5XSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykgewogICAgICBpZiAoZGF0YVtuYW1lXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgZGF0YVtuYW1lXSA9IHZhbHVlOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZGF0YVtuYW1lXSA9PT0gJ3N0cmluZycpIHsKICAgICAgICBkYXRhW25hbWVdID0gW2RhdGFbbmFtZV1dOwogICAgICB9CgogICAgICBpZiAoIWlzQXJyYXkodmFsdWUpKSB7CiAgICAgICAgdmFsdWUgPSBbdmFsdWVdOwogICAgICB9CgogICAgICBkYXRhW25hbWVdID0gKGRhdGFbbmFtZV0gfHwgW10pLmNvbmNhdCh2YWx1ZSk7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVUkkuYWRkUXVlcnkoKSBhY2NlcHRzIGFuIG9iamVjdCwgc3RyaW5nIGFzIHRoZSBuYW1lIHBhcmFtZXRlcicpOwogICAgfQogIH07CiAgVVJJLnJlbW92ZVF1ZXJ5ID0gZnVuY3Rpb24gKGRhdGEsIG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgaSwgbGVuZ3RoLCBrZXk7CgogICAgaWYgKGlzQXJyYXkobmFtZSkpIHsKICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0gbmFtZS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGRhdGFbbmFtZVtpXV0gPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoZ2V0VHlwZShuYW1lKSA9PT0gJ1JlZ0V4cCcpIHsKICAgICAgZm9yIChrZXkgaW4gZGF0YSkgewogICAgICAgIGlmIChuYW1lLnRlc3Qoa2V5KSkgewogICAgICAgICAgZGF0YVtrZXldID0gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmICgodHlwZW9mIG5hbWUgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKG5hbWUpKSA9PT0gJ29iamVjdCcpIHsKICAgICAgZm9yIChrZXkgaW4gbmFtZSkgewogICAgICAgIGlmIChoYXNPd24uY2FsbChuYW1lLCBrZXkpKSB7CiAgICAgICAgICBVUkkucmVtb3ZlUXVlcnkoZGF0YSwga2V5LCBuYW1lW2tleV0pOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycpIHsKICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAoZ2V0VHlwZSh2YWx1ZSkgPT09ICdSZWdFeHAnKSB7CiAgICAgICAgICBpZiAoIWlzQXJyYXkoZGF0YVtuYW1lXSkgJiYgdmFsdWUudGVzdChkYXRhW25hbWVdKSkgewogICAgICAgICAgICBkYXRhW25hbWVdID0gdW5kZWZpbmVkOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGF0YVtuYW1lXSA9IGZpbHRlckFycmF5VmFsdWVzKGRhdGFbbmFtZV0sIHZhbHVlKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGRhdGFbbmFtZV0gPT09IFN0cmluZyh2YWx1ZSkgJiYgKCFpc0FycmF5KHZhbHVlKSB8fCB2YWx1ZS5sZW5ndGggPT09IDEpKSB7CiAgICAgICAgICBkYXRhW25hbWVdID0gdW5kZWZpbmVkOwogICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheShkYXRhW25hbWVdKSkgewogICAgICAgICAgZGF0YVtuYW1lXSA9IGZpbHRlckFycmF5VmFsdWVzKGRhdGFbbmFtZV0sIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YVtuYW1lXSA9IHVuZGVmaW5lZDsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVVJJLnJlbW92ZVF1ZXJ5KCkgYWNjZXB0cyBhbiBvYmplY3QsIHN0cmluZywgUmVnRXhwIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXInKTsKICAgIH0KICB9OwogIFVSSS5oYXNRdWVyeSA9IGZ1bmN0aW9uIChkYXRhLCBuYW1lLCB2YWx1ZSwgd2l0aGluQXJyYXkpIHsKICAgIHN3aXRjaCAoZ2V0VHlwZShuYW1lKSkgewogICAgICBjYXNlICdTdHJpbmcnOgogICAgICAgIC8vIE5vdGhpbmcgdG8gZG8gaGVyZQogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnUmVnRXhwJzoKICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkgewogICAgICAgICAgaWYgKGhhc093bi5jYWxsKGRhdGEsIGtleSkpIHsKICAgICAgICAgICAgaWYgKG5hbWUudGVzdChrZXkpICYmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IFVSSS5oYXNRdWVyeShkYXRhLCBrZXksIHZhbHVlKSkpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgY2FzZSAnT2JqZWN0JzoKICAgICAgICBmb3IgKHZhciBfa2V5IGluIG5hbWUpIHsKICAgICAgICAgIGlmIChoYXNPd24uY2FsbChuYW1lLCBfa2V5KSkgewogICAgICAgICAgICBpZiAoIVVSSS5oYXNRdWVyeShkYXRhLCBfa2V5LCBuYW1lW19rZXldKSkgewogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5oYXNRdWVyeSgpIGFjY2VwdHMgYSBzdHJpbmcsIHJlZ3VsYXIgZXhwcmVzc2lvbiBvciBvYmplY3QgYXMgdGhlIG5hbWUgcGFyYW1ldGVyJyk7CiAgICB9CgogICAgc3dpdGNoIChnZXRUeXBlKHZhbHVlKSkgewogICAgICBjYXNlICdVbmRlZmluZWQnOgogICAgICAgIC8vIHRydWUgaWYgZXhpc3RzIChidXQgbWF5IGJlIGVtcHR5KQogICAgICAgIHJldHVybiBuYW1lIGluIGRhdGE7IC8vIGRhdGFbbmFtZV0gIT09IHVuZGVmaW5lZDsKCiAgICAgIGNhc2UgJ0Jvb2xlYW4nOgogICAgICAgIC8vIHRydWUgaWYgZXhpc3RzIGFuZCBub24tZW1wdHkKICAgICAgICB2YXIgX2Jvb2x5ID0gQm9vbGVhbihpc0FycmF5KGRhdGFbbmFtZV0pID8gZGF0YVtuYW1lXS5sZW5ndGggOiBkYXRhW25hbWVdKTsKICAgICAgICByZXR1cm4gdmFsdWUgPT09IF9ib29seTsKCiAgICAgIGNhc2UgJ0Z1bmN0aW9uJzoKICAgICAgICAvLyBhbGxvdyBjb21wbGV4IGNvbXBhcmlzb24KICAgICAgICByZXR1cm4gISF2YWx1ZShkYXRhW25hbWVdLCBuYW1lLCBkYXRhKTsKCiAgICAgIGNhc2UgJ0FycmF5JzoKICAgICAgICBpZiAoIWlzQXJyYXkoZGF0YVtuYW1lXSkpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciBvcCA9IHdpdGhpbkFycmF5ID8gYXJyYXlDb250YWlucyA6IGFycmF5c0VxdWFsOwogICAgICAgIHJldHVybiBvcChkYXRhW25hbWVdLCB2YWx1ZSk7CgogICAgICBjYXNlICdSZWdFeHAnOgogICAgICAgIGlmICghaXNBcnJheShkYXRhW25hbWVdKSkgewogICAgICAgICAgcmV0dXJuIEJvb2xlYW4oZGF0YVtuYW1lXSAmJiBkYXRhW25hbWVdLm1hdGNoKHZhbHVlKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXdpdGhpbkFycmF5KSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYXJyYXlDb250YWlucyhkYXRhW25hbWVdLCB2YWx1ZSk7CgogICAgICBjYXNlICdOdW1iZXInOgogICAgICAgIHZhbHVlID0gU3RyaW5nKHZhbHVlKTsKICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwogICAgICBjYXNlICdTdHJpbmcnOgogICAgICAgIGlmICghaXNBcnJheShkYXRhW25hbWVdKSkgewogICAgICAgICAgcmV0dXJuIGRhdGFbbmFtZV0gPT09IHZhbHVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF3aXRoaW5BcnJheSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGFycmF5Q29udGFpbnMoZGF0YVtuYW1lXSwgdmFsdWUpOwoKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVUkkuaGFzUXVlcnkoKSBhY2NlcHRzIHVuZGVmaW5lZCwgYm9vbGVhbiwgc3RyaW5nLCBudW1iZXIsIFJlZ0V4cCwgRnVuY3Rpb24gYXMgdGhlIHZhbHVlIHBhcmFtZXRlcicpOwogICAgfQogIH07CgogIFVSSS5qb2luUGF0aHMgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgaW5wdXQgPSBbXTsKICAgIHZhciBzZWdtZW50cyA9IFtdOwogICAgdmFyIG5vbkVtcHR5U2VnbWVudHMgPSAwOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciB1cmwgPSBuZXcgVVJJKGFyZ3VtZW50c1tpXSk7CiAgICAgIGlucHV0LnB1c2godXJsKTsKICAgICAgdmFyIF9zZWdtZW50cyA9IHVybC5zZWdtZW50KCk7CiAgICAgIGZvciAodmFyIHMgPSAwOyBzIDwgX3NlZ21lbnRzLmxlbmd0aDsgcysrKSB7CiAgICAgICAgaWYgKHR5cGVvZiBfc2VnbWVudHNbc10gPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICBzZWdtZW50cy5wdXNoKF9zZWdtZW50c1tzXSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoX3NlZ21lbnRzW3NdKSB7CiAgICAgICAgICBub25FbXB0eVNlZ21lbnRzKys7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKCFzZWdtZW50cy5sZW5ndGggfHwgIW5vbkVtcHR5U2VnbWVudHMpIHsKICAgICAgcmV0dXJuIG5ldyBVUkkoJycpOwogICAgfQoKICAgIHZhciB1cmkgPSBuZXcgVVJJKCcnKS5zZWdtZW50KHNlZ21lbnRzKTsKCiAgICBpZiAoaW5wdXRbMF0ucGF0aCgpID09PSAnJyB8fCBpbnB1dFswXS5wYXRoKCkuc2xpY2UoMCwgMSkgPT09ICcvJykgewogICAgICB1cmkucGF0aCgnLycgKyB1cmkucGF0aCgpKTsKICAgIH0KCiAgICByZXR1cm4gdXJpLm5vcm1hbGl6ZSgpOwogIH07CgogIFVSSS5jb21tb25QYXRoID0gZnVuY3Rpb24gKG9uZSwgdHdvKSB7CiAgICB2YXIgbGVuZ3RoID0gTWF0aC5taW4ob25lLmxlbmd0aCwgdHdvLmxlbmd0aCk7CiAgICB2YXIgcG9zOwoKICAgIC8vIGZpbmQgZmlyc3Qgbm9uLW1hdGNoaW5nIGNoYXJhY3RlcgogICAgZm9yIChwb3MgPSAwOyBwb3MgPCBsZW5ndGg7IHBvcysrKSB7CiAgICAgIGlmIChvbmUuY2hhckF0KHBvcykgIT09IHR3by5jaGFyQXQocG9zKSkgewogICAgICAgIHBvcy0tOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKHBvcyA8IDEpIHsKICAgICAgcmV0dXJuIG9uZS5jaGFyQXQoMCkgPT09IHR3by5jaGFyQXQoMCkgJiYgb25lLmNoYXJBdCgwKSA9PT0gJy8nID8gJy8nIDogJyc7CiAgICB9CgogICAgLy8gcmV2ZXJ0IHRvIGxhc3QgLwogICAgaWYgKG9uZS5jaGFyQXQocG9zKSAhPT0gJy8nIHx8IHR3by5jaGFyQXQocG9zKSAhPT0gJy8nKSB7CiAgICAgIHBvcyA9IG9uZS5zdWJzdHJpbmcoMCwgcG9zKS5sYXN0SW5kZXhPZignLycpOwogICAgfQoKICAgIHJldHVybiBvbmUuc3Vic3RyaW5nKDAsIHBvcyArIDEpOwogIH07CgogIFVSSS53aXRoaW5TdHJpbmcgPSBmdW5jdGlvbiAoc3RyaW5nLCBjYWxsYmFjaywgb3B0aW9ucykgewogICAgb3B0aW9ucyB8fCAob3B0aW9ucyA9IHt9KTsKICAgIHZhciBfc3RhcnQgPSBvcHRpb25zLnN0YXJ0IHx8IFVSSS5maW5kVXJpLnN0YXJ0OwogICAgdmFyIF9lbmQgPSBvcHRpb25zLmVuZCB8fCBVUkkuZmluZFVyaS5lbmQ7CiAgICB2YXIgX3RyaW0gPSBvcHRpb25zLnRyaW0gfHwgVVJJLmZpbmRVcmkudHJpbTsKICAgIHZhciBfYXR0cmlidXRlT3BlbiA9IC9bYS16MC05LV09WyInXT8kL2k7CgogICAgX3N0YXJ0Lmxhc3RJbmRleCA9IDA7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICB2YXIgbWF0Y2ggPSBfc3RhcnQuZXhlYyhzdHJpbmcpOwogICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHZhciBzdGFydCA9IG1hdGNoLmluZGV4OwogICAgICBpZiAob3B0aW9ucy5pZ25vcmVIdG1sKSB7CiAgICAgICAgLy8gYXR0cmlidXQoZT1bIiddPyQpCiAgICAgICAgdmFyIGF0dHJpYnV0ZU9wZW4gPSBzdHJpbmcuc2xpY2UoTWF0aC5tYXgoc3RhcnQgLSAzLCAwKSwgc3RhcnQpOwogICAgICAgIGlmIChhdHRyaWJ1dGVPcGVuICYmIF9hdHRyaWJ1dGVPcGVuLnRlc3QoYXR0cmlidXRlT3BlbikpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGVuZCA9IHN0YXJ0ICsgc3RyaW5nLnNsaWNlKHN0YXJ0KS5zZWFyY2goX2VuZCk7CiAgICAgIHZhciBzbGljZSA9IHN0cmluZy5zbGljZShzdGFydCwgZW5kKS5yZXBsYWNlKF90cmltLCAnJyk7CiAgICAgIGlmIChvcHRpb25zLmlnbm9yZSAmJiBvcHRpb25zLmlnbm9yZS50ZXN0KHNsaWNlKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBlbmQgPSBzdGFydCArIHNsaWNlLmxlbmd0aDsKICAgICAgdmFyIHJlc3VsdCA9IGNhbGxiYWNrKHNsaWNlLCBzdGFydCwgZW5kLCBzdHJpbmcpOwogICAgICBzdHJpbmcgPSBzdHJpbmcuc2xpY2UoMCwgc3RhcnQpICsgcmVzdWx0ICsgc3RyaW5nLnNsaWNlKGVuZCk7CiAgICAgIF9zdGFydC5sYXN0SW5kZXggPSBzdGFydCArIHJlc3VsdC5sZW5ndGg7CiAgICB9CgogICAgX3N0YXJ0Lmxhc3RJbmRleCA9IDA7CiAgICByZXR1cm4gc3RyaW5nOwogIH07CgogIFVSSS5lbnN1cmVWYWxpZEhvc3RuYW1lID0gZnVuY3Rpb24gKHYpIHsKICAgIC8vIFRoZW9yZXRpY2FsbHkgVVJJcyBhbGxvdyBwZXJjZW50LWVuY29kaW5nIGluIEhvc3RuYW1lcyAoYWNjb3JkaW5nIHRvIFJGQyAzOTg2KQogICAgLy8gdGhleSBhcmUgbm90IHBhcnQgb2YgRE5TIGFuZCB0aGVyZWZvcmUgaWdub3JlZCBieSBVUkkuanMKCiAgICBpZiAodi5tYXRjaChVUkkuaW52YWxpZF9ob3N0bmFtZV9jaGFyYWN0ZXJzKSkgewogICAgICAvLyB0ZXN0IHB1bnljb2RlCiAgICAgIGlmICghcHVueWNvZGUpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdIb3N0bmFtZSAiJyArIHYgKyAnIiBjb250YWlucyBjaGFyYWN0ZXJzIG90aGVyIHRoYW4gW0EtWjAtOS4tXSBhbmQgUHVueWNvZGUuanMgaXMgbm90IGF2YWlsYWJsZScpOwogICAgICB9CgogICAgICBpZiAocHVueWNvZGUudG9BU0NJSSh2KS5tYXRjaChVUkkuaW52YWxpZF9ob3N0bmFtZV9jaGFyYWN0ZXJzKSkgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hvc3RuYW1lICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05Li1dJyk7CiAgICAgIH0KICAgIH0KICB9OwoKICAvLyBub0NvbmZsaWN0CiAgVVJJLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAocmVtb3ZlQWxsKSB7CiAgICBpZiAocmVtb3ZlQWxsKSB7CiAgICAgIHZhciB1bmNvbmZsaWN0ZWQgPSB7CiAgICAgICAgVVJJOiB0aGlzLm5vQ29uZmxpY3QoKQogICAgICB9OwoKICAgICAgaWYgKHJvb3QuVVJJVGVtcGxhdGUgJiYgdHlwZW9mIHJvb3QuVVJJVGVtcGxhdGUubm9Db25mbGljdCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHVuY29uZmxpY3RlZC5VUklUZW1wbGF0ZSA9IHJvb3QuVVJJVGVtcGxhdGUubm9Db25mbGljdCgpOwogICAgICB9CgogICAgICBpZiAocm9vdC5JUHY2ICYmIHR5cGVvZiByb290LklQdjYubm9Db25mbGljdCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHVuY29uZmxpY3RlZC5JUHY2ID0gcm9vdC5JUHY2Lm5vQ29uZmxpY3QoKTsKICAgICAgfQoKICAgICAgaWYgKHJvb3QuU2Vjb25kTGV2ZWxEb21haW5zICYmIHR5cGVvZiByb290LlNlY29uZExldmVsRG9tYWlucy5ub0NvbmZsaWN0ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdW5jb25mbGljdGVkLlNlY29uZExldmVsRG9tYWlucyA9IHJvb3QuU2Vjb25kTGV2ZWxEb21haW5zLm5vQ29uZmxpY3QoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHVuY29uZmxpY3RlZDsKICAgIH0gZWxzZSBpZiAocm9vdC5VUkkgPT09IHRoaXMpIHsKICAgICAgcm9vdC5VUkkgPSBfVVJJOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH07CgogIHAuYnVpbGQgPSBmdW5jdGlvbiAoZGVmZXJCdWlsZCkgewogICAgaWYgKGRlZmVyQnVpbGQgPT09IHRydWUpIHsKICAgICAgdGhpcy5fZGVmZXJyZWRfYnVpbGQgPSB0cnVlOwogICAgfSBlbHNlIGlmIChkZWZlckJ1aWxkID09PSB1bmRlZmluZWQgfHwgdGhpcy5fZGVmZXJyZWRfYnVpbGQpIHsKICAgICAgdGhpcy5fc3RyaW5nID0gVVJJLmJ1aWxkKHRoaXMuX3BhcnRzKTsKICAgICAgdGhpcy5fZGVmZXJyZWRfYnVpbGQgPSBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwoKICBwLmNsb25lID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIG5ldyBVUkkodGhpcyk7CiAgfTsKCiAgcC52YWx1ZU9mID0gcC50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLmJ1aWxkKGZhbHNlKS5fc3RyaW5nOwogIH07CgogIGZ1bmN0aW9uIGdlbmVyYXRlU2ltcGxlQWNjZXNzb3IoX3BhcnQpIHsKICAgIHJldHVybiBmdW5jdGlvbiAodiwgYnVpbGQpIHsKICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLl9wYXJ0c1tfcGFydF0gfHwgJyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5fcGFydHNbX3BhcnRdID0gdiB8fCBudWxsOwogICAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgfTsKICB9CgogIGZ1bmN0aW9uIGdlbmVyYXRlUHJlZml4QWNjZXNzb3IoX3BhcnQsIF9rZXkpIHsKICAgIHJldHVybiBmdW5jdGlvbiAodiwgYnVpbGQpIHsKICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLl9wYXJ0c1tfcGFydF0gfHwgJyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHYgIT09IG51bGwpIHsKICAgICAgICAgIHYgPSB2ICsgJyc7CiAgICAgICAgICBpZiAodi5jaGFyQXQoMCkgPT09IF9rZXkpIHsKICAgICAgICAgICAgdiA9IHYuc3Vic3RyaW5nKDEpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5fcGFydHNbX3BhcnRdID0gdjsKICAgICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgIH07CiAgfQoKICBwLnByb3RvY29sID0gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcigncHJvdG9jb2wnKTsKICBwLnVzZXJuYW1lID0gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcigndXNlcm5hbWUnKTsKICBwLnBhc3N3b3JkID0gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcigncGFzc3dvcmQnKTsKICBwLmhvc3RuYW1lID0gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcignaG9zdG5hbWUnKTsKICBwLnBvcnQgPSBnZW5lcmF0ZVNpbXBsZUFjY2Vzc29yKCdwb3J0Jyk7CiAgcC5xdWVyeSA9IGdlbmVyYXRlUHJlZml4QWNjZXNzb3IoJ3F1ZXJ5JywgJz8nKTsKICBwLmZyYWdtZW50ID0gZ2VuZXJhdGVQcmVmaXhBY2Nlc3NvcignZnJhZ21lbnQnLCAnIycpOwoKICBwLnNlYXJjaCA9IGZ1bmN0aW9uICh2LCBidWlsZCkgewogICAgdmFyIHQgPSB0aGlzLnF1ZXJ5KHYsIGJ1aWxkKTsKICAgIHJldHVybiB0eXBlb2YgdCA9PT0gJ3N0cmluZycgJiYgdC5sZW5ndGggPyAnPycgKyB0IDogdDsKICB9OwogIHAuaGFzaCA9IGZ1bmN0aW9uICh2LCBidWlsZCkgewogICAgdmFyIHQgPSB0aGlzLmZyYWdtZW50KHYsIGJ1aWxkKTsKICAgIHJldHVybiB0eXBlb2YgdCA9PT0gJ3N0cmluZycgJiYgdC5sZW5ndGggPyAnIycgKyB0IDogdDsKICB9OwoKICBwLnBhdGhuYW1lID0gZnVuY3Rpb24gKHYsIGJ1aWxkKSB7CiAgICBpZiAodiA9PT0gdW5kZWZpbmVkIHx8IHYgPT09IHRydWUpIHsKICAgICAgdmFyIHJlcyA9IHRoaXMuX3BhcnRzLnBhdGggfHwgKHRoaXMuX3BhcnRzLmhvc3RuYW1lID8gJy8nIDogJycpOwogICAgICByZXR1cm4gdiA/ICh0aGlzLl9wYXJ0cy51cm4gPyBVUkkuZGVjb2RlVXJuUGF0aCA6IFVSSS5kZWNvZGVQYXRoKShyZXMpIDogcmVzOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHRoaXMuX3BhcnRzLnVybikgewogICAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSB2ID8gVVJJLnJlY29kZVVyblBhdGgodikgOiAnJzsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLl9wYXJ0cy5wYXRoID0gdiA/IFVSSS5yZWNvZGVQYXRoKHYpIDogJy8nOwogICAgICB9CiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKICBwLnBhdGggPSBwLnBhdGhuYW1lOwogIHAuaHJlZiA9IGZ1bmN0aW9uIChocmVmLCBidWlsZCkgewogICAgdmFyIGtleTsKCiAgICBpZiAoaHJlZiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nKCk7CiAgICB9CgogICAgdGhpcy5fc3RyaW5nID0gJyc7CiAgICB0aGlzLl9wYXJ0cyA9IFVSSS5fcGFydHMoKTsKCiAgICB2YXIgX1VSSSA9IGhyZWYgaW5zdGFuY2VvZiBVUkk7CiAgICB2YXIgX29iamVjdCA9ICh0eXBlb2YgaHJlZiA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoaHJlZikpID09PSAnb2JqZWN0JyAmJiAoaHJlZi5ob3N0bmFtZSB8fCBocmVmLnBhdGggfHwgaHJlZi5wYXRobmFtZSk7CiAgICBpZiAoaHJlZi5ub2RlTmFtZSkgewogICAgICB2YXIgYXR0cmlidXRlID0gVVJJLmdldERvbUF0dHJpYnV0ZShocmVmKTsKICAgICAgaHJlZiA9IGhyZWZbYXR0cmlidXRlXSB8fCAnJzsKICAgICAgX29iamVjdCA9IGZhbHNlOwogICAgfQoKICAgIC8vIHdpbmRvdy5sb2NhdGlvbiBpcyByZXBvcnRlZCB0byBiZSBhbiBvYmplY3QsIGJ1dCBpdCdzIG5vdCB0aGUgc29ydAogICAgLy8gb2Ygb2JqZWN0IHdlJ3JlIGxvb2tpbmcgZm9yOgogICAgLy8gKiBsb2NhdGlvbi5wcm90b2NvbCBlbmRzIHdpdGggYSBjb2xvbgogICAgLy8gKiBsb2NhdGlvbi5xdWVyeSAhPSBvYmplY3Quc2VhcmNoCiAgICAvLyAqIGxvY2F0aW9uLmhhc2ggIT0gb2JqZWN0LmZyYWdtZW50CiAgICAvLyBzaW1wbHkgc2VyaWFsaXppbmcgdGhlIHVua25vd24gb2JqZWN0IHNob3VsZCBkbyB0aGUgdHJpY2sKICAgIC8vIChmb3IgbG9jYXRpb24sIG5vdCBmb3IgZXZlcnl0aGluZy4uLikKICAgIGlmICghX1VSSSAmJiBfb2JqZWN0ICYmIGhyZWYucGF0aG5hbWUgIT09IHVuZGVmaW5lZCkgewogICAgICBocmVmID0gaHJlZi50b1N0cmluZygpOwogICAgfQoKICAgIGlmICh0eXBlb2YgaHJlZiA9PT0gJ3N0cmluZycgfHwgaHJlZiBpbnN0YW5jZW9mIFN0cmluZykgewogICAgICB0aGlzLl9wYXJ0cyA9IFVSSS5wYXJzZShTdHJpbmcoaHJlZiksIHRoaXMuX3BhcnRzKTsKICAgIH0gZWxzZSBpZiAoX1VSSSB8fCBfb2JqZWN0KSB7CiAgICAgIHZhciBzcmMgPSBfVVJJID8gaHJlZi5fcGFydHMgOiBocmVmOwogICAgICBmb3IgKGtleSBpbiBzcmMpIHsKICAgICAgICBpZiAoaGFzT3duLmNhbGwodGhpcy5fcGFydHMsIGtleSkpIHsKICAgICAgICAgIHRoaXMuX3BhcnRzW2tleV0gPSBzcmNba2V5XTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgaW5wdXQnKTsKICAgIH0KCiAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvLyBpZGVudGlmaWNhdGlvbiBhY2Nlc3NvcnMKICBwLmlzID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgIHZhciBpcCA9IGZhbHNlOwogICAgdmFyIGlwNCA9IGZhbHNlOwogICAgdmFyIGlwNiA9IGZhbHNlOwogICAgdmFyIG5hbWUgPSBmYWxzZTsKICAgIHZhciBzbGQgPSBmYWxzZTsKICAgIHZhciBpZG4gPSBmYWxzZTsKICAgIHZhciBwdW55Y29kZSA9IGZhbHNlOwogICAgdmFyIHJlbGF0aXZlID0gIXRoaXMuX3BhcnRzLnVybjsKCiAgICBpZiAodGhpcy5fcGFydHMuaG9zdG5hbWUpIHsKICAgICAgcmVsYXRpdmUgPSBmYWxzZTsKICAgICAgaXA0ID0gVVJJLmlwNF9leHByZXNzaW9uLnRlc3QodGhpcy5fcGFydHMuaG9zdG5hbWUpOwogICAgICBpcDYgPSBVUkkuaXA2X2V4cHJlc3Npb24udGVzdCh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICAgIGlwID0gaXA0IHx8IGlwNjsKICAgICAgbmFtZSA9ICFpcDsKICAgICAgc2xkID0gbmFtZSAmJiBTTEQgJiYgU0xELmhhcyh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICAgIGlkbiA9IG5hbWUgJiYgVVJJLmlkbl9leHByZXNzaW9uLnRlc3QodGhpcy5fcGFydHMuaG9zdG5hbWUpOwogICAgICBwdW55Y29kZSA9IG5hbWUgJiYgVVJJLnB1bnljb2RlX2V4cHJlc3Npb24udGVzdCh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICB9CgogICAgc3dpdGNoICh3aGF0LnRvTG93ZXJDYXNlKCkpIHsKICAgICAgY2FzZSAncmVsYXRpdmUnOgogICAgICAgIHJldHVybiByZWxhdGl2ZTsKCiAgICAgIGNhc2UgJ2Fic29sdXRlJzoKICAgICAgICByZXR1cm4gIXJlbGF0aXZlOwoKICAgICAgLy8gaG9zdG5hbWUgaWRlbnRpZmljYXRpb24KICAgICAgY2FzZSAnZG9tYWluJzoKICAgICAgY2FzZSAnbmFtZSc6CiAgICAgICAgcmV0dXJuIG5hbWU7CgogICAgICBjYXNlICdzbGQnOgogICAgICAgIHJldHVybiBzbGQ7CgogICAgICBjYXNlICdpcCc6CiAgICAgICAgcmV0dXJuIGlwOwoKICAgICAgY2FzZSAnaXA0JzoKICAgICAgY2FzZSAnaXB2NCc6CiAgICAgIGNhc2UgJ2luZXQ0JzoKICAgICAgICByZXR1cm4gaXA0OwoKICAgICAgY2FzZSAnaXA2JzoKICAgICAgY2FzZSAnaXB2Nic6CiAgICAgIGNhc2UgJ2luZXQ2JzoKICAgICAgICByZXR1cm4gaXA2OwoKICAgICAgY2FzZSAnaWRuJzoKICAgICAgICByZXR1cm4gaWRuOwoKICAgICAgY2FzZSAndXJsJzoKICAgICAgICByZXR1cm4gIXRoaXMuX3BhcnRzLnVybjsKCiAgICAgIGNhc2UgJ3Vybic6CiAgICAgICAgcmV0dXJuICEhdGhpcy5fcGFydHMudXJuOwoKICAgICAgY2FzZSAncHVueWNvZGUnOgogICAgICAgIHJldHVybiBwdW55Y29kZTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9OwoKICAvLyBjb21wb25lbnQgc3BlY2lmaWMgaW5wdXQgdmFsaWRhdGlvbgogIHZhciBfcHJvdG9jb2wgPSBwLnByb3RvY29sOwogIHZhciBfcG9ydCA9IHAucG9ydDsKICB2YXIgX2hvc3RuYW1lID0gcC5ob3N0bmFtZTsKCiAgcC5wcm90b2NvbCA9IGZ1bmN0aW9uICh2LCBidWlsZCkgewogICAgaWYgKHYgIT09IHVuZGVmaW5lZCkgewogICAgICBpZiAodikgewogICAgICAgIC8vIGFjY2VwdCB0cmFpbGluZyA6Ly8KICAgICAgICB2ID0gdi5yZXBsYWNlKC86KFwvXC8pPyQvLCAnJyk7CgogICAgICAgIGlmICghdi5tYXRjaChVUkkucHJvdG9jb2xfZXhwcmVzc2lvbikpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Byb3RvY29sICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05ListXSBvciBkb2VzblwndCBzdGFydCB3aXRoIFtBLVpdJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICByZXR1cm4gX3Byb3RvY29sLmNhbGwodGhpcywgdiwgYnVpbGQpOwogIH07CiAgcC5zY2hlbWUgPSBwLnByb3RvY29sOwogIHAucG9ydCA9IGZ1bmN0aW9uICh2LCBidWlsZCkgewogICAgaWYgKHRoaXMuX3BhcnRzLnVybikgewogICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzOwogICAgfQoKICAgIGlmICh2ICE9PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKHYgPT09IDApIHsKICAgICAgICB2ID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKHYpIHsKICAgICAgICB2ICs9ICcnOwogICAgICAgIGlmICh2LmNoYXJBdCgwKSA9PT0gJzonKSB7CiAgICAgICAgICB2ID0gdi5zdWJzdHJpbmcoMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodi5tYXRjaCgvW14wLTldLykpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1BvcnQgIicgKyB2ICsgJyIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFswLTldJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICByZXR1cm4gX3BvcnQuY2FsbCh0aGlzLCB2LCBidWlsZCk7CiAgfTsKICBwLmhvc3RuYW1lID0gZnVuY3Rpb24gKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHYgIT09IHVuZGVmaW5lZCkgewogICAgICB2YXIgeCA9IHt9OwogICAgICB2YXIgcmVzID0gVVJJLnBhcnNlSG9zdCh2LCB4KTsKICAgICAgaWYgKHJlcyAhPT0gJy8nKSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSG9zdG5hbWUgIicgKyB2ICsgJyIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFtBLVowLTkuLV0nKTsKICAgICAgfQoKICAgICAgdiA9IHguaG9zdG5hbWU7CiAgICB9CiAgICByZXR1cm4gX2hvc3RuYW1lLmNhbGwodGhpcywgdiwgYnVpbGQpOwogIH07CgogIC8vIGNvbXBvdW5kIGFjY2Vzc29ycwogIHAub3JpZ2luID0gZnVuY3Rpb24gKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICB2YXIgcHJvdG9jb2wgPSB0aGlzLnByb3RvY29sKCk7CiAgICAgIHZhciBhdXRob3JpdHkgPSB0aGlzLmF1dGhvcml0eSgpOwogICAgICBpZiAoIWF1dGhvcml0eSkgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgcmV0dXJuIChwcm90b2NvbCA/IHByb3RvY29sICsgJzovLycgOiAnJykgKyB0aGlzLmF1dGhvcml0eSgpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIG9yaWdpbiA9IFVSSSh2KTsKICAgICAgdGhpcy5wcm90b2NvbChvcmlnaW4ucHJvdG9jb2woKSkuYXV0aG9yaXR5KG9yaWdpbi5hdXRob3JpdHkoKSkuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKICBwLmhvc3QgPSBmdW5jdGlvbiAodiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB0aGlzLl9wYXJ0cy5ob3N0bmFtZSA/IFVSSS5idWlsZEhvc3QodGhpcy5fcGFydHMpIDogJyc7CiAgICB9IGVsc2UgewogICAgICB2YXIgcmVzID0gVVJJLnBhcnNlSG9zdCh2LCB0aGlzLl9wYXJ0cyk7CiAgICAgIGlmIChyZXMgIT09ICcvJykgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hvc3RuYW1lICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05Li1dJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKICBwLmF1dGhvcml0eSA9IGZ1bmN0aW9uICh2LCBidWlsZCkgewogICAgaWYgKHRoaXMuX3BhcnRzLnVybikgewogICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzOwogICAgfQoKICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXMuX3BhcnRzLmhvc3RuYW1lID8gVVJJLmJ1aWxkQXV0aG9yaXR5KHRoaXMuX3BhcnRzKSA6ICcnOwogICAgfSBlbHNlIHsKICAgICAgdmFyIHJlcyA9IFVSSS5wYXJzZUF1dGhvcml0eSh2LCB0aGlzLl9wYXJ0cyk7CiAgICAgIGlmIChyZXMgIT09ICcvJykgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hvc3RuYW1lICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05Li1dJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKICBwLnVzZXJpbmZvID0gZnVuY3Rpb24gKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICB2YXIgdCA9IFVSSS5idWlsZFVzZXJpbmZvKHRoaXMuX3BhcnRzKTsKICAgICAgcmV0dXJuIHQgPyB0LnN1YnN0cmluZygwLCB0Lmxlbmd0aCAtIDEpIDogdDsKICAgIH0gZWxzZSB7CiAgICAgIGlmICh2W3YubGVuZ3RoIC0gMV0gIT09ICdAJykgewogICAgICAgIHYgKz0gJ0AnOwogICAgICB9CgogICAgICBVUkkucGFyc2VVc2VyaW5mbyh2LCB0aGlzLl9wYXJ0cyk7CiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfTsKICBwLnJlc291cmNlID0gZnVuY3Rpb24gKHYsIGJ1aWxkKSB7CiAgICB2YXIgcGFydHM7CgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdGhpcy5wYXRoKCkgKyB0aGlzLnNlYXJjaCgpICsgdGhpcy5oYXNoKCk7CiAgICB9CgogICAgcGFydHMgPSBVUkkucGFyc2Uodik7CiAgICB0aGlzLl9wYXJ0cy5wYXRoID0gcGFydHMucGF0aDsKICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gcGFydHMucXVlcnk7CiAgICB0aGlzLl9wYXJ0cy5mcmFnbWVudCA9IHBhcnRzLmZyYWdtZW50OwogICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLy8gZnJhY3Rpb24gYWNjZXNzb3JzCiAgcC5zdWJkb21haW4gPSBmdW5jdGlvbiAodiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICAvLyBjb252ZW5pZW5jZSwgcmV0dXJuICJ3d3ciIGZyb20gInd3dy5leGFtcGxlLm9yZyIKICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKCF0aGlzLl9wYXJ0cy5ob3N0bmFtZSB8fCB0aGlzLmlzKCdJUCcpKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICAvLyBncmFiIGRvbWFpbiBhbmQgYWRkIGFub3RoZXIgc2VnbWVudAogICAgICB2YXIgZW5kID0gdGhpcy5fcGFydHMuaG9zdG5hbWUubGVuZ3RoIC0gdGhpcy5kb21haW4oKS5sZW5ndGggLSAxOwogICAgICByZXR1cm4gdGhpcy5fcGFydHMuaG9zdG5hbWUuc3Vic3RyaW5nKDAsIGVuZCkgfHwgJyc7CiAgICB9IGVsc2UgewogICAgICB2YXIgZSA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLmxlbmd0aCAtIHRoaXMuZG9tYWluKCkubGVuZ3RoOwogICAgICB2YXIgc3ViID0gdGhpcy5fcGFydHMuaG9zdG5hbWUuc3Vic3RyaW5nKDAsIGUpOwogICAgICB2YXIgcmVwbGFjZSA9IG5ldyBSZWdFeHAoJ14nICsgZXNjYXBlUmVnRXgoc3ViKSk7CgogICAgICBpZiAodiAmJiB2LmNoYXJBdCh2Lmxlbmd0aCAtIDEpICE9PSAnLicpIHsKICAgICAgICB2ICs9ICcuJzsKICAgICAgfQoKICAgICAgaWYgKHYpIHsKICAgICAgICBVUkkuZW5zdXJlVmFsaWRIb3N0bmFtZSh2KTsKICAgICAgfQoKICAgICAgdGhpcy5fcGFydHMuaG9zdG5hbWUgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5yZXBsYWNlKHJlcGxhY2UsIHYpOwogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcC5kb21haW4gPSBmdW5jdGlvbiAodiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICBpZiAodHlwZW9mIHYgPT09ICdib29sZWFuJykgewogICAgICBidWlsZCA9IHY7CiAgICAgIHYgPSB1bmRlZmluZWQ7CiAgICB9CgogICAgLy8gY29udmVuaWVuY2UsIHJldHVybiAiZXhhbXBsZS5vcmciIGZyb20gInd3dy5leGFtcGxlLm9yZyIKICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKCF0aGlzLl9wYXJ0cy5ob3N0bmFtZSB8fCB0aGlzLmlzKCdJUCcpKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICAvLyBpZiBob3N0bmFtZSBjb25zaXN0cyBvZiAxIG9yIDIgc2VnbWVudHMsIGl0IG11c3QgYmUgdGhlIGRvbWFpbgogICAgICB2YXIgdCA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLm1hdGNoKC9cLi9nKTsKICAgICAgaWYgKHQgJiYgdC5sZW5ndGggPCAyKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX3BhcnRzLmhvc3RuYW1lOwogICAgICB9CgogICAgICAvLyBncmFiIHRsZCBhbmQgYWRkIGFub3RoZXIgc2VnbWVudAogICAgICB2YXIgZW5kID0gdGhpcy5fcGFydHMuaG9zdG5hbWUubGVuZ3RoIC0gdGhpcy50bGQoYnVpbGQpLmxlbmd0aCAtIDE7CiAgICAgIGVuZCA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLmxhc3RJbmRleE9mKCcuJywgZW5kIC0gMSkgKyAxOwogICAgICByZXR1cm4gdGhpcy5fcGFydHMuaG9zdG5hbWUuc3Vic3RyaW5nKGVuZCkgfHwgJyc7CiAgICB9IGVsc2UgewogICAgICBpZiAoIXYpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdjYW5ub3Qgc2V0IGRvbWFpbiBlbXB0eScpOwogICAgICB9CgogICAgICBVUkkuZW5zdXJlVmFsaWRIb3N0bmFtZSh2KTsKCiAgICAgIGlmICghdGhpcy5fcGFydHMuaG9zdG5hbWUgfHwgdGhpcy5pcygnSVAnKSkgewogICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gdjsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcmVwbGFjZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXgodGhpcy5kb21haW4oKSkgKyAnJCcpOwogICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gdGhpcy5fcGFydHMuaG9zdG5hbWUucmVwbGFjZShyZXBsYWNlLCB2KTsKICAgICAgfQoKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwogIHAudGxkID0gZnVuY3Rpb24gKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHR5cGVvZiB2ID09PSAnYm9vbGVhbicpIHsKICAgICAgYnVpbGQgPSB2OwogICAgICB2ID0gdW5kZWZpbmVkOwogICAgfQoKICAgIC8vIHJldHVybiAib3JnIiBmcm9tICJ3d3cuZXhhbXBsZS5vcmciCiAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICghdGhpcy5fcGFydHMuaG9zdG5hbWUgfHwgdGhpcy5pcygnSVAnKSkgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgdmFyIHBvcyA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLmxhc3RJbmRleE9mKCcuJyk7CiAgICAgIHZhciB0bGQgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5zdWJzdHJpbmcocG9zICsgMSk7CgogICAgICBpZiAoYnVpbGQgIT09IHRydWUgJiYgU0xEICYmIFNMRC5saXN0W3RsZC50b0xvd2VyQ2FzZSgpXSkgewogICAgICAgIHJldHVybiBTTEQuZ2V0KHRoaXMuX3BhcnRzLmhvc3RuYW1lKSB8fCB0bGQ7CiAgICAgIH0KCiAgICAgIHJldHVybiB0bGQ7CiAgICB9IGVsc2UgewogICAgICB2YXIgcmVwbGFjZTsKCiAgICAgIGlmICghdikgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2Nhbm5vdCBzZXQgVExEIGVtcHR5Jyk7CiAgICAgIH0gZWxzZSBpZiAodi5tYXRjaCgvW15hLXpBLVowLTktXS8pKSB7CiAgICAgICAgaWYgKFNMRCAmJiBTTEQuaXModikpIHsKICAgICAgICAgIHJlcGxhY2UgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4KHRoaXMudGxkKCkpICsgJyQnKTsKICAgICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gdGhpcy5fcGFydHMuaG9zdG5hbWUucmVwbGFjZShyZXBsYWNlLCB2KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVExEICInICsgdiArICciIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05XScpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICghdGhpcy5fcGFydHMuaG9zdG5hbWUgfHwgdGhpcy5pcygnSVAnKSkgewogICAgICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcignY2Fubm90IHNldCBUTEQgb24gbm9uLWRvbWFpbiBob3N0Jyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVwbGFjZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXgodGhpcy50bGQoKSkgKyAnJCcpOwogICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gdGhpcy5fcGFydHMuaG9zdG5hbWUucmVwbGFjZShyZXBsYWNlLCB2KTsKICAgICAgfQoKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwogIHAuZGlyZWN0b3J5ID0gZnVuY3Rpb24gKHYsIGJ1aWxkKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7CiAgICB9CgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCB8fCB2ID09PSB0cnVlKSB7CiAgICAgIGlmICghdGhpcy5fcGFydHMucGF0aCAmJiAhdGhpcy5fcGFydHMuaG9zdG5hbWUpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9wYXJ0cy5wYXRoID09PSAnLycpIHsKICAgICAgICByZXR1cm4gJy8nOwogICAgICB9CgogICAgICB2YXIgZW5kID0gdGhpcy5fcGFydHMucGF0aC5sZW5ndGggLSB0aGlzLmZpbGVuYW1lKCkubGVuZ3RoIC0gMTsKICAgICAgdmFyIHJlcyA9IHRoaXMuX3BhcnRzLnBhdGguc3Vic3RyaW5nKDAsIGVuZCkgfHwgKHRoaXMuX3BhcnRzLmhvc3RuYW1lID8gJy8nIDogJycpOwoKICAgICAgcmV0dXJuIHYgPyBVUkkuZGVjb2RlUGF0aChyZXMpIDogcmVzOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGUgPSB0aGlzLl9wYXJ0cy5wYXRoLmxlbmd0aCAtIHRoaXMuZmlsZW5hbWUoKS5sZW5ndGg7CiAgICAgIHZhciBkaXJlY3RvcnkgPSB0aGlzLl9wYXJ0cy5wYXRoLnN1YnN0cmluZygwLCBlKTsKICAgICAgdmFyIHJlcGxhY2UgPSBuZXcgUmVnRXhwKCdeJyArIGVzY2FwZVJlZ0V4KGRpcmVjdG9yeSkpOwoKICAgICAgLy8gZnVsbHkgcXVhbGlmaWVyIGRpcmVjdG9yaWVzIGJlZ2luIHdpdGggYSBzbGFzaAogICAgICBpZiAoIXRoaXMuaXMoJ3JlbGF0aXZlJykpIHsKICAgICAgICBpZiAoIXYpIHsKICAgICAgICAgIHYgPSAnLyc7CiAgICAgICAgfQoKICAgICAgICBpZiAodi5jaGFyQXQoMCkgIT09ICcvJykgewogICAgICAgICAgdiA9ICcvJyArIHY7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBkaXJlY3RvcmllcyBhbHdheXMgZW5kIHdpdGggYSBzbGFzaAogICAgICBpZiAodiAmJiB2LmNoYXJBdCh2Lmxlbmd0aCAtIDEpICE9PSAnLycpIHsKICAgICAgICB2ICs9ICcvJzsKICAgICAgfQoKICAgICAgdiA9IFVSSS5yZWNvZGVQYXRoKHYpOwogICAgICB0aGlzLl9wYXJ0cy5wYXRoID0gdGhpcy5fcGFydHMucGF0aC5yZXBsYWNlKHJlcGxhY2UsIHYpOwogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcC5maWxlbmFtZSA9IGZ1bmN0aW9uICh2LCBidWlsZCkgewogICAgaWYgKHRoaXMuX3BhcnRzLnVybikgewogICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzOwogICAgfQoKICAgIGlmICh2ID09PSB1bmRlZmluZWQgfHwgdiA9PT0gdHJ1ZSkgewogICAgICBpZiAoIXRoaXMuX3BhcnRzLnBhdGggfHwgdGhpcy5fcGFydHMucGF0aCA9PT0gJy8nKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICB2YXIgcG9zID0gdGhpcy5fcGFydHMucGF0aC5sYXN0SW5kZXhPZignLycpOwogICAgICB2YXIgcmVzID0gdGhpcy5fcGFydHMucGF0aC5zdWJzdHJpbmcocG9zICsgMSk7CgogICAgICByZXR1cm4gdiA/IFVSSS5kZWNvZGVQYXRoU2VnbWVudChyZXMpIDogcmVzOwogICAgfSBlbHNlIHsKICAgICAgdmFyIG11dGF0ZWREaXJlY3RvcnkgPSBmYWxzZTsKCiAgICAgIGlmICh2LmNoYXJBdCgwKSA9PT0gJy8nKSB7CiAgICAgICAgdiA9IHYuc3Vic3RyaW5nKDEpOwogICAgICB9CgogICAgICBpZiAodi5tYXRjaCgvXC4/XC8vKSkgewogICAgICAgIG11dGF0ZWREaXJlY3RvcnkgPSB0cnVlOwogICAgICB9CgogICAgICB2YXIgcmVwbGFjZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXgodGhpcy5maWxlbmFtZSgpKSArICckJyk7CiAgICAgIHYgPSBVUkkucmVjb2RlUGF0aCh2KTsKICAgICAgdGhpcy5fcGFydHMucGF0aCA9IHRoaXMuX3BhcnRzLnBhdGgucmVwbGFjZShyZXBsYWNlLCB2KTsKCiAgICAgIGlmIChtdXRhdGVkRGlyZWN0b3J5KSB7CiAgICAgICAgdGhpcy5ub3JtYWxpemVQYXRoKGJ1aWxkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcC5zdWZmaXggPSBmdW5jdGlvbiAodiwgYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpczsKICAgIH0KCiAgICBpZiAodiA9PT0gdW5kZWZpbmVkIHx8IHYgPT09IHRydWUpIHsKICAgICAgaWYgKCF0aGlzLl9wYXJ0cy5wYXRoIHx8IHRoaXMuX3BhcnRzLnBhdGggPT09ICcvJykgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgdmFyIGZpbGVuYW1lID0gdGhpcy5maWxlbmFtZSgpOwogICAgICB2YXIgcG9zID0gZmlsZW5hbWUubGFzdEluZGV4T2YoJy4nKTsKICAgICAgdmFyIHMsIHJlczsKCiAgICAgIGlmIChwb3MgPT09IC0xKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICAvLyBzdWZmaXggbWF5IG9ubHkgY29udGFpbiBhbG51bSBjaGFyYWN0ZXJzICh5dXAsIEkgbWFkZSB0aGlzIHVwLikKICAgICAgcyA9IGZpbGVuYW1lLnN1YnN0cmluZyhwb3MgKyAxKTsKICAgICAgcmVzID0gL15bYS16MC05JV0rJC9pLnRlc3QocykgPyBzIDogJyc7CiAgICAgIHJldHVybiB2ID8gVVJJLmRlY29kZVBhdGhTZWdtZW50KHJlcykgOiByZXM7CiAgICB9IGVsc2UgewogICAgICBpZiAodi5jaGFyQXQoMCkgPT09ICcuJykgewogICAgICAgIHYgPSB2LnN1YnN0cmluZygxKTsKICAgICAgfQoKICAgICAgdmFyIHN1ZmZpeCA9IHRoaXMuc3VmZml4KCk7CiAgICAgIHZhciByZXBsYWNlOwoKICAgICAgaWYgKCFzdWZmaXgpIHsKICAgICAgICBpZiAoIXYpIHsKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5fcGFydHMucGF0aCArPSAnLicgKyBVUkkucmVjb2RlUGF0aCh2KTsKICAgICAgfSBlbHNlIGlmICghdikgewogICAgICAgIHJlcGxhY2UgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4KCcuJyArIHN1ZmZpeCkgKyAnJCcpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlcGxhY2UgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4KHN1ZmZpeCkgKyAnJCcpOwogICAgICB9CgogICAgICBpZiAocmVwbGFjZSkgewogICAgICAgIHYgPSBVUkkucmVjb2RlUGF0aCh2KTsKICAgICAgICB0aGlzLl9wYXJ0cy5wYXRoID0gdGhpcy5fcGFydHMucGF0aC5yZXBsYWNlKHJlcGxhY2UsIHYpOwogICAgICB9CgogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcC5zZWdtZW50ID0gZnVuY3Rpb24gKHNlZ21lbnQsIHYsIGJ1aWxkKSB7CiAgICB2YXIgc2VwYXJhdG9yID0gdGhpcy5fcGFydHMudXJuID8gJzonIDogJy8nOwogICAgdmFyIHBhdGggPSB0aGlzLnBhdGgoKTsKICAgIHZhciBhYnNvbHV0ZSA9IHBhdGguc3Vic3RyaW5nKDAsIDEpID09PSAnLyc7CiAgICB2YXIgc2VnbWVudHMgPSBwYXRoLnNwbGl0KHNlcGFyYXRvcik7CgogICAgaWYgKHNlZ21lbnQgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygc2VnbWVudCAhPT0gJ251bWJlcicpIHsKICAgICAgYnVpbGQgPSB2OwogICAgICB2ID0gc2VnbWVudDsKICAgICAgc2VnbWVudCA9IHVuZGVmaW5lZDsKICAgIH0KCiAgICBpZiAoc2VnbWVudCAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBzZWdtZW50ICE9PSAnbnVtYmVyJykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JhZCBzZWdtZW50ICInICsgc2VnbWVudCArICciLCBtdXN0IGJlIDAtYmFzZWQgaW50ZWdlcicpOwogICAgfQoKICAgIGlmIChhYnNvbHV0ZSkgewogICAgICBzZWdtZW50cy5zaGlmdCgpOwogICAgfQoKICAgIGlmIChzZWdtZW50IDwgMCkgewogICAgICAvLyBhbGxvdyBuZWdhdGl2ZSBpbmRleGVzIHRvIGFkZHJlc3MgZnJvbSB0aGUgZW5kCiAgICAgIHNlZ21lbnQgPSBNYXRoLm1heChzZWdtZW50cy5sZW5ndGggKyBzZWdtZW50LCAwKTsKICAgIH0KCiAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIC8qanNoaW50IGxheGJyZWFrOiB0cnVlICovCiAgICAgIHJldHVybiBzZWdtZW50ID09PSB1bmRlZmluZWQgPyBzZWdtZW50cyA6IHNlZ21lbnRzW3NlZ21lbnRdOwogICAgICAvKmpzaGludCBsYXhicmVhazogZmFsc2UgKi8KICAgIH0gZWxzZSBpZiAoc2VnbWVudCA9PT0gbnVsbCB8fCBzZWdtZW50c1tzZWdtZW50XSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKGlzQXJyYXkodikpIHsKICAgICAgICAgIHNlZ21lbnRzID0gW107CiAgICAgICAgICAvLyBjb2xsYXBzZSBlbXB0eSBlbGVtZW50cyB3aXRoaW4gYXJyYXkKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gdi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgICAgaWYgKCF2W2ldLmxlbmd0aCAmJiAoIXNlZ21lbnRzLmxlbmd0aCB8fCAhc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0gMV0ubGVuZ3RoKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2VnbWVudHMubGVuZ3RoICYmICFzZWdtZW50c1tzZWdtZW50cy5sZW5ndGggLSAxXS5sZW5ndGgpIHsKICAgICAgICAgICAgICBzZWdtZW50cy5wb3AoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2VnbWVudHMucHVzaCh0cmltU2xhc2hlcyh2W2ldKSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh2IHx8IHR5cGVvZiB2ID09PSAnc3RyaW5nJykgewogICAgICAgICAgdiA9IHRyaW1TbGFzaGVzKHYpOwogICAgICAgICAgaWYgKHNlZ21lbnRzW3NlZ21lbnRzLmxlbmd0aCAtIDFdID09PSAnJykgewogICAgICAgICAgICAvLyBlbXB0eSB0cmFpbGluZyBlbGVtZW50cyBoYXZlIHRvIGJlIG92ZXJ3cml0dGVuCiAgICAgICAgICAgIC8vIHRvIHByZXZlbnQgcmVzdWx0cyBzdWNoIGFzIC9mb28vL2JhcgogICAgICAgICAgICBzZWdtZW50c1tzZWdtZW50cy5sZW5ndGggLSAxXSA9IHY7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZWdtZW50cy5wdXNoKHYpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodikgewogICAgICAgICAgc2VnbWVudHNbc2VnbWVudF0gPSB0cmltU2xhc2hlcyh2KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2VnbWVudHMuc3BsaWNlKHNlZ21lbnQsIDEpOwogICAgICAgIH0KICAgICAgfQoKICAgIGlmIChhYnNvbHV0ZSkgewogICAgICBzZWdtZW50cy51bnNoaWZ0KCcnKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5wYXRoKHNlZ21lbnRzLmpvaW4oc2VwYXJhdG9yKSwgYnVpbGQpOwogIH07CiAgcC5zZWdtZW50Q29kZWQgPSBmdW5jdGlvbiAoc2VnbWVudCwgdiwgYnVpbGQpIHsKICAgIHZhciBzZWdtZW50cywgaSwgbDsKCiAgICBpZiAodHlwZW9mIHNlZ21lbnQgIT09ICdudW1iZXInKSB7CiAgICAgIGJ1aWxkID0gdjsKICAgICAgdiA9IHNlZ21lbnQ7CiAgICAgIHNlZ21lbnQgPSB1bmRlZmluZWQ7CiAgICB9CgogICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgewogICAgICBzZWdtZW50cyA9IHRoaXMuc2VnbWVudChzZWdtZW50LCB2LCBidWlsZCk7CiAgICAgIGlmICghaXNBcnJheShzZWdtZW50cykpIHsKICAgICAgICBzZWdtZW50cyA9IHNlZ21lbnRzICE9PSB1bmRlZmluZWQgPyBVUkkuZGVjb2RlKHNlZ21lbnRzKSA6IHVuZGVmaW5lZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgPSAwLCBsID0gc2VnbWVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBzZWdtZW50c1tpXSA9IFVSSS5kZWNvZGUoc2VnbWVudHNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNlZ21lbnRzOwogICAgfQoKICAgIGlmICghaXNBcnJheSh2KSkgewogICAgICB2ID0gdHlwZW9mIHYgPT09ICdzdHJpbmcnIHx8IHYgaW5zdGFuY2VvZiBTdHJpbmcgPyBVUkkuZW5jb2RlKHYpIDogdjsKICAgIH0gZWxzZSB7CiAgICAgIGZvciAoaSA9IDAsIGwgPSB2Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZbaV0gPSBVUkkuZW5jb2RlKHZbaV0pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRoaXMuc2VnbWVudChzZWdtZW50LCB2LCBidWlsZCk7CiAgfTsKCiAgLy8gbXV0YXRpbmcgcXVlcnkgc3RyaW5nCiAgdmFyIHEgPSBwLnF1ZXJ5OwogIHAucXVlcnkgPSBmdW5jdGlvbiAodiwgYnVpbGQpIHsKICAgIGlmICh2ID09PSB0cnVlKSB7CiAgICAgIHJldHVybiBVUkkucGFyc2VRdWVyeSh0aGlzLl9wYXJ0cy5xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHZhciBkYXRhID0gVVJJLnBhcnNlUXVlcnkodGhpcy5fcGFydHMucXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgICB2YXIgcmVzdWx0ID0gdi5jYWxsKHRoaXMsIGRhdGEpOwogICAgICB0aGlzLl9wYXJ0cy5xdWVyeSA9IFVSSS5idWlsZFF1ZXJ5KHJlc3VsdCB8fCBkYXRhLCB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMsIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSBlbHNlIGlmICh2ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHYgIT09ICdzdHJpbmcnKSB7CiAgICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gVVJJLmJ1aWxkUXVlcnkodiwgdGhpcy5fcGFydHMuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTsKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBxLmNhbGwodGhpcywgdiwgYnVpbGQpOwogICAgfQogIH07CiAgcC5zZXRRdWVyeSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSwgYnVpbGQpIHsKICAgIHZhciBkYXRhID0gVVJJLnBhcnNlUXVlcnkodGhpcy5fcGFydHMucXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwoKICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycgfHwgbmFtZSBpbnN0YW5jZW9mIFN0cmluZykgewogICAgICBkYXRhW25hbWVdID0gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDogbnVsbDsKICAgIH0gZWxzZSBpZiAoKHR5cGVvZiBuYW1lID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihuYW1lKSkgPT09ICdvYmplY3QnKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBuYW1lKSB7CiAgICAgICAgaWYgKGhhc093bi5jYWxsKG5hbWUsIGtleSkpIHsKICAgICAgICAgIGRhdGFba2V5XSA9IG5hbWVba2V5XTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5hZGRRdWVyeSgpIGFjY2VwdHMgYW4gb2JqZWN0LCBzdHJpbmcgYXMgdGhlIG5hbWUgcGFyYW1ldGVyJyk7CiAgICB9CgogICAgdGhpcy5fcGFydHMucXVlcnkgPSBVUkkuYnVpbGRRdWVyeShkYXRhLCB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMsIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykgewogICAgICBidWlsZCA9IHZhbHVlOwogICAgfQoKICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIHJldHVybiB0aGlzOwogIH07CiAgcC5hZGRRdWVyeSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSwgYnVpbGQpIHsKICAgIHZhciBkYXRhID0gVVJJLnBhcnNlUXVlcnkodGhpcy5fcGFydHMucXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgVVJJLmFkZFF1ZXJ5KGRhdGEsIG5hbWUsIHZhbHVlID09PSB1bmRlZmluZWQgPyBudWxsIDogdmFsdWUpOwogICAgdGhpcy5fcGFydHMucXVlcnkgPSBVUkkuYnVpbGRRdWVyeShkYXRhLCB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMsIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykgewogICAgICBidWlsZCA9IHZhbHVlOwogICAgfQoKICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIHJldHVybiB0aGlzOwogIH07CiAgcC5yZW1vdmVRdWVyeSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSwgYnVpbGQpIHsKICAgIHZhciBkYXRhID0gVVJJLnBhcnNlUXVlcnkodGhpcy5fcGFydHMucXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpOwogICAgVVJJLnJlbW92ZVF1ZXJ5KGRhdGEsIG5hbWUsIHZhbHVlKTsKICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gVVJJLmJ1aWxkUXVlcnkoZGF0YSwgdGhpcy5fcGFydHMuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTsKICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHsKICAgICAgYnVpbGQgPSB2YWx1ZTsKICAgIH0KCiAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICByZXR1cm4gdGhpczsKICB9OwogIHAuaGFzUXVlcnkgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIHdpdGhpbkFycmF5KSB7CiAgICB2YXIgZGF0YSA9IFVSSS5wYXJzZVF1ZXJ5KHRoaXMuX3BhcnRzLnF1ZXJ5LCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTsKICAgIHJldHVybiBVUkkuaGFzUXVlcnkoZGF0YSwgbmFtZSwgdmFsdWUsIHdpdGhpbkFycmF5KTsKICB9OwogIHAuc2V0U2VhcmNoID0gcC5zZXRRdWVyeTsKICBwLmFkZFNlYXJjaCA9IHAuYWRkUXVlcnk7CiAgcC5yZW1vdmVTZWFyY2ggPSBwLnJlbW92ZVF1ZXJ5OwogIHAuaGFzU2VhcmNoID0gcC5oYXNRdWVyeTsKCiAgLy8gc2FuaXRpemluZyBVUkxzCiAgcC5ub3JtYWxpemUgPSBmdW5jdGlvbiAoKSB7CiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZVByb3RvY29sKGZhbHNlKS5ub3JtYWxpemVQYXRoKGZhbHNlKS5ub3JtYWxpemVRdWVyeShmYWxzZSkubm9ybWFsaXplRnJhZ21lbnQoZmFsc2UpLmJ1aWxkKCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMubm9ybWFsaXplUHJvdG9jb2woZmFsc2UpLm5vcm1hbGl6ZUhvc3RuYW1lKGZhbHNlKS5ub3JtYWxpemVQb3J0KGZhbHNlKS5ub3JtYWxpemVQYXRoKGZhbHNlKS5ub3JtYWxpemVRdWVyeShmYWxzZSkubm9ybWFsaXplRnJhZ21lbnQoZmFsc2UpLmJ1aWxkKCk7CiAgfTsKICBwLm5vcm1hbGl6ZVByb3RvY29sID0gZnVuY3Rpb24gKGJ1aWxkKSB7CiAgICBpZiAodHlwZW9mIHRoaXMuX3BhcnRzLnByb3RvY29sID09PSAnc3RyaW5nJykgewogICAgICB0aGlzLl9wYXJ0cy5wcm90b2NvbCA9IHRoaXMuX3BhcnRzLnByb3RvY29sLnRvTG93ZXJDYXNlKCk7CiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwogIHAubm9ybWFsaXplSG9zdG5hbWUgPSBmdW5jdGlvbiAoYnVpbGQpIHsKICAgIGlmICh0aGlzLl9wYXJ0cy5ob3N0bmFtZSkgewogICAgICBpZiAodGhpcy5pcygnSUROJykgJiYgcHVueWNvZGUpIHsKICAgICAgICB0aGlzLl9wYXJ0cy5ob3N0bmFtZSA9IHB1bnljb2RlLnRvQVNDSUkodGhpcy5fcGFydHMuaG9zdG5hbWUpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuaXMoJ0lQdjYnKSAmJiBJUHY2KSB7CiAgICAgICAgdGhpcy5fcGFydHMuaG9zdG5hbWUgPSBJUHY2LmJlc3QodGhpcy5fcGFydHMuaG9zdG5hbWUpOwogICAgICB9CgogICAgICB0aGlzLl9wYXJ0cy5ob3N0bmFtZSA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwogIHAubm9ybWFsaXplUG9ydCA9IGZ1bmN0aW9uIChidWlsZCkgewogICAgLy8gcmVtb3ZlIHBvcnQgb2YgaXQncyB0aGUgcHJvdG9jb2wncyBkZWZhdWx0CiAgICBpZiAodHlwZW9mIHRoaXMuX3BhcnRzLnByb3RvY29sID09PSAnc3RyaW5nJyAmJiB0aGlzLl9wYXJ0cy5wb3J0ID09PSBVUkkuZGVmYXVsdFBvcnRzW3RoaXMuX3BhcnRzLnByb3RvY29sXSkgewogICAgICB0aGlzLl9wYXJ0cy5wb3J0ID0gbnVsbDsKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH07CiAgcC5ub3JtYWxpemVQYXRoID0gZnVuY3Rpb24gKGJ1aWxkKSB7CiAgICB2YXIgX3BhdGggPSB0aGlzLl9wYXJ0cy5wYXRoOwogICAgaWYgKCFfcGF0aCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7CiAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSBVUkkucmVjb2RlVXJuUGF0aCh0aGlzLl9wYXJ0cy5wYXRoKTsKICAgICAgdGhpcy5idWlsZCghYnVpbGQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBpZiAodGhpcy5fcGFydHMucGF0aCA9PT0gJy8nKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIF9wYXRoID0gVVJJLnJlY29kZVBhdGgoX3BhdGgpOwoKICAgIHZhciBfd2FzX3JlbGF0aXZlOwogICAgdmFyIF9sZWFkaW5nUGFyZW50cyA9ICcnOwogICAgdmFyIF9wYXJlbnQsIF9wb3M7CgogICAgLy8gaGFuZGxlIHJlbGF0aXZlIHBhdGhzCiAgICBpZiAoX3BhdGguY2hhckF0KDApICE9PSAnLycpIHsKICAgICAgX3dhc19yZWxhdGl2ZSA9IHRydWU7CiAgICAgIF9wYXRoID0gJy8nICsgX3BhdGg7CiAgICB9CgogICAgLy8gaGFuZGxlIHJlbGF0aXZlIGZpbGVzIChhcyBvcHBvc2VkIHRvIGRpcmVjdG9yaWVzKQogICAgaWYgKF9wYXRoLnNsaWNlKC0zKSA9PT0gJy8uLicgfHwgX3BhdGguc2xpY2UoLTIpID09PSAnLy4nKSB7CiAgICAgIF9wYXRoICs9ICcvJzsKICAgIH0KCiAgICAvLyByZXNvbHZlIHNpbXBsZXMKICAgIF9wYXRoID0gX3BhdGgucmVwbGFjZSgvKFwvKFwuXC8pKyl8KFwvXC4kKS9nLCAnLycpLnJlcGxhY2UoL1wvezIsfS9nLCAnLycpOwoKICAgIC8vIHJlbWVtYmVyIGxlYWRpbmcgcGFyZW50cwogICAgaWYgKF93YXNfcmVsYXRpdmUpIHsKICAgICAgX2xlYWRpbmdQYXJlbnRzID0gX3BhdGguc3Vic3RyaW5nKDEpLm1hdGNoKC9eKFwuXC5cLykrLykgfHwgJyc7CiAgICAgIGlmIChfbGVhZGluZ1BhcmVudHMpIHsKICAgICAgICBfbGVhZGluZ1BhcmVudHMgPSBfbGVhZGluZ1BhcmVudHNbMF07CiAgICAgIH0KICAgIH0KCiAgICAvLyByZXNvbHZlIHBhcmVudHMKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIF9wYXJlbnQgPSBfcGF0aC5zZWFyY2goL1wvXC5cLihcL3wkKS8pOwogICAgICBpZiAoX3BhcmVudCA9PT0gLTEpIHsKICAgICAgICAvLyBubyBtb3JlIC4uLyB0byByZXNvbHZlCiAgICAgICAgYnJlYWs7CiAgICAgIH0gZWxzZSBpZiAoX3BhcmVudCA9PT0gMCkgewogICAgICAgIC8vIHRvcCBsZXZlbCBjYW5ub3QgYmUgcmVsYXRpdmUsIHNraXAgaXQKICAgICAgICBfcGF0aCA9IF9wYXRoLnN1YnN0cmluZygzKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgX3BvcyA9IF9wYXRoLnN1YnN0cmluZygwLCBfcGFyZW50KS5sYXN0SW5kZXhPZignLycpOwogICAgICBpZiAoX3BvcyA9PT0gLTEpIHsKICAgICAgICBfcG9zID0gX3BhcmVudDsKICAgICAgfQogICAgICBfcGF0aCA9IF9wYXRoLnN1YnN0cmluZygwLCBfcG9zKSArIF9wYXRoLnN1YnN0cmluZyhfcGFyZW50ICsgMyk7CiAgICB9CgogICAgLy8gcmV2ZXJ0IHRvIHJlbGF0aXZlCiAgICBpZiAoX3dhc19yZWxhdGl2ZSAmJiB0aGlzLmlzKCdyZWxhdGl2ZScpKSB7CiAgICAgIF9wYXRoID0gX2xlYWRpbmdQYXJlbnRzICsgX3BhdGguc3Vic3RyaW5nKDEpOwogICAgfQoKICAgIHRoaXMuX3BhcnRzLnBhdGggPSBfcGF0aDsKICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIHJldHVybiB0aGlzOwogIH07CiAgcC5ub3JtYWxpemVQYXRobmFtZSA9IHAubm9ybWFsaXplUGF0aDsKICBwLm5vcm1hbGl6ZVF1ZXJ5ID0gZnVuY3Rpb24gKGJ1aWxkKSB7CiAgICBpZiAodHlwZW9mIHRoaXMuX3BhcnRzLnF1ZXJ5ID09PSAnc3RyaW5nJykgewogICAgICBpZiAoIXRoaXMuX3BhcnRzLnF1ZXJ5Lmxlbmd0aCkgewogICAgICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnF1ZXJ5KFVSSS5wYXJzZVF1ZXJ5KHRoaXMuX3BhcnRzLnF1ZXJ5LCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKSk7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwogIHAubm9ybWFsaXplRnJhZ21lbnQgPSBmdW5jdGlvbiAoYnVpbGQpIHsKICAgIGlmICghdGhpcy5fcGFydHMuZnJhZ21lbnQpIHsKICAgICAgdGhpcy5fcGFydHMuZnJhZ21lbnQgPSBudWxsOwogICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKICBwLm5vcm1hbGl6ZVNlYXJjaCA9IHAubm9ybWFsaXplUXVlcnk7CiAgcC5ub3JtYWxpemVIYXNoID0gcC5ub3JtYWxpemVGcmFnbWVudDsKCiAgcC5pc284ODU5ID0gZnVuY3Rpb24gKCkgewogICAgLy8gZXhwZWN0IHVuaWNvZGUgaW5wdXQsIGlzbzg4NTkgb3V0cHV0CiAgICB2YXIgZSA9IFVSSS5lbmNvZGU7CiAgICB2YXIgZCA9IFVSSS5kZWNvZGU7CgogICAgVVJJLmVuY29kZSA9IGVzY2FwZTsKICAgIFVSSS5kZWNvZGUgPSBkZWNvZGVVUklDb21wb25lbnQ7CiAgICB0cnkgewogICAgICB0aGlzLm5vcm1hbGl6ZSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgVVJJLmVuY29kZSA9IGU7CiAgICAgIFVSSS5kZWNvZGUgPSBkOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgcC51bmljb2RlID0gZnVuY3Rpb24gKCkgewogICAgLy8gZXhwZWN0IGlzbzg4NTkgaW5wdXQsIHVuaWNvZGUgb3V0cHV0CiAgICB2YXIgZSA9IFVSSS5lbmNvZGU7CiAgICB2YXIgZCA9IFVSSS5kZWNvZGU7CgogICAgVVJJLmVuY29kZSA9IHN0cmljdEVuY29kZVVSSUNvbXBvbmVudDsKICAgIFVSSS5kZWNvZGUgPSB1bmVzY2FwZTsKICAgIHRyeSB7CiAgICAgIHRoaXMubm9ybWFsaXplKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBVUkkuZW5jb2RlID0gZTsKICAgICAgVVJJLmRlY29kZSA9IGQ7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9OwoKICBwLnJlYWRhYmxlID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHVyaSA9IHRoaXMuY2xvbmUoKTsKICAgIC8vIHJlbW92aW5nIHVzZXJuYW1lLCBwYXNzd29yZCwgYmVjYXVzZSB0aGV5IHNob3VsZG4ndCBiZSBkaXNwbGF5ZWQgYWNjb3JkaW5nIHRvIFJGQyAzOTg2CiAgICB1cmkudXNlcm5hbWUoJycpLnBhc3N3b3JkKCcnKS5ub3JtYWxpemUoKTsKICAgIHZhciB0ID0gJyc7CiAgICBpZiAodXJpLl9wYXJ0cy5wcm90b2NvbCkgewogICAgICB0ICs9IHVyaS5fcGFydHMucHJvdG9jb2wgKyAnOi8vJzsKICAgIH0KCiAgICBpZiAodXJpLl9wYXJ0cy5ob3N0bmFtZSkgewogICAgICBpZiAodXJpLmlzKCdwdW55Y29kZScpICYmIHB1bnljb2RlKSB7CiAgICAgICAgdCArPSBwdW55Y29kZS50b1VuaWNvZGUodXJpLl9wYXJ0cy5ob3N0bmFtZSk7CiAgICAgICAgaWYgKHVyaS5fcGFydHMucG9ydCkgewogICAgICAgICAgdCArPSAnOicgKyB1cmkuX3BhcnRzLnBvcnQ7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHQgKz0gdXJpLmhvc3QoKTsKICAgICAgfQogICAgfQoKICAgIGlmICh1cmkuX3BhcnRzLmhvc3RuYW1lICYmIHVyaS5fcGFydHMucGF0aCAmJiB1cmkuX3BhcnRzLnBhdGguY2hhckF0KDApICE9PSAnLycpIHsKICAgICAgdCArPSAnLyc7CiAgICB9CgogICAgdCArPSB1cmkucGF0aCh0cnVlKTsKICAgIGlmICh1cmkuX3BhcnRzLnF1ZXJ5KSB7CiAgICAgIHZhciBxID0gJyc7CiAgICAgIGZvciAodmFyIGkgPSAwLCBxcCA9IHVyaS5fcGFydHMucXVlcnkuc3BsaXQoJyYnKSwgbCA9IHFwLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZhciBrdiA9IChxcFtpXSB8fCAnJykuc3BsaXQoJz0nKTsKICAgICAgICBxICs9ICcmJyArIFVSSS5kZWNvZGVRdWVyeShrdlswXSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSkucmVwbGFjZSgvJi9nLCAnJTI2Jyk7CgogICAgICAgIGlmIChrdlsxXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBxICs9ICc9JyArIFVSSS5kZWNvZGVRdWVyeShrdlsxXSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSkucmVwbGFjZSgvJi9nLCAnJTI2Jyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHQgKz0gJz8nICsgcS5zdWJzdHJpbmcoMSk7CiAgICB9CgogICAgdCArPSBVUkkuZGVjb2RlUXVlcnkodXJpLmhhc2goKSwgdHJ1ZSk7CiAgICByZXR1cm4gdDsKICB9OwoKICAvLyByZXNvbHZpbmcgcmVsYXRpdmUgYW5kIGFic29sdXRlIFVSTHMKICBwLmFic29sdXRlVG8gPSBmdW5jdGlvbiAoYmFzZSkgewogICAgdmFyIHJlc29sdmVkID0gdGhpcy5jbG9uZSgpOwogICAgdmFyIHByb3BlcnRpZXMgPSBbJ3Byb3RvY29sJywgJ3VzZXJuYW1lJywgJ3Bhc3N3b3JkJywgJ2hvc3RuYW1lJywgJ3BvcnQnXTsKICAgIHZhciBiYXNlZGlyLCBpLCBwOwoKICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdVUk5zIGRvIG5vdCBoYXZlIGFueSBnZW5lcmFsbHkgZGVmaW5lZCBoaWVyYXJjaGljYWwgY29tcG9uZW50cycpOwogICAgfQoKICAgIGlmICghKGJhc2UgaW5zdGFuY2VvZiBVUkkpKSB7CiAgICAgIGJhc2UgPSBuZXcgVVJJKGJhc2UpOwogICAgfQoKICAgIGlmICghcmVzb2x2ZWQuX3BhcnRzLnByb3RvY29sKSB7CiAgICAgIHJlc29sdmVkLl9wYXJ0cy5wcm90b2NvbCA9IGJhc2UuX3BhcnRzLnByb3RvY29sOwogICAgfQoKICAgIGlmICh0aGlzLl9wYXJ0cy5ob3N0bmFtZSkgewogICAgICByZXR1cm4gcmVzb2x2ZWQ7CiAgICB9CgogICAgZm9yIChpID0gMDsgcCA9IHByb3BlcnRpZXNbaV07IGkrKykgewogICAgICByZXNvbHZlZC5fcGFydHNbcF0gPSBiYXNlLl9wYXJ0c1twXTsKICAgIH0KCiAgICBpZiAoIXJlc29sdmVkLl9wYXJ0cy5wYXRoKSB7CiAgICAgIHJlc29sdmVkLl9wYXJ0cy5wYXRoID0gYmFzZS5fcGFydHMucGF0aDsKICAgICAgaWYgKCFyZXNvbHZlZC5fcGFydHMucXVlcnkpIHsKICAgICAgICByZXNvbHZlZC5fcGFydHMucXVlcnkgPSBiYXNlLl9wYXJ0cy5xdWVyeTsKICAgICAgfQogICAgfSBlbHNlIGlmIChyZXNvbHZlZC5fcGFydHMucGF0aC5zdWJzdHJpbmcoLTIpID09PSAnLi4nKSB7CiAgICAgIHJlc29sdmVkLl9wYXJ0cy5wYXRoICs9ICcvJzsKICAgIH0KCiAgICBpZiAocmVzb2x2ZWQucGF0aCgpLmNoYXJBdCgwKSAhPT0gJy8nKSB7CiAgICAgIGJhc2VkaXIgPSBiYXNlLmRpcmVjdG9yeSgpOwogICAgICBiYXNlZGlyID0gYmFzZWRpciA/IGJhc2VkaXIgOiBiYXNlLnBhdGgoKS5pbmRleE9mKCcvJykgPT09IDAgPyAnLycgOiAnJzsKICAgICAgcmVzb2x2ZWQuX3BhcnRzLnBhdGggPSAoYmFzZWRpciA/IGJhc2VkaXIgKyAnLycgOiAnJykgKyByZXNvbHZlZC5fcGFydHMucGF0aDsKICAgICAgcmVzb2x2ZWQubm9ybWFsaXplUGF0aCgpOwogICAgfQoKICAgIHJlc29sdmVkLmJ1aWxkKCk7CiAgICByZXR1cm4gcmVzb2x2ZWQ7CiAgfTsKICBwLnJlbGF0aXZlVG8gPSBmdW5jdGlvbiAoYmFzZSkgewogICAgdmFyIHJlbGF0aXZlID0gdGhpcy5jbG9uZSgpLm5vcm1hbGl6ZSgpOwogICAgdmFyIHJlbGF0aXZlUGFydHMsIGJhc2VQYXJ0cywgY29tbW9uLCByZWxhdGl2ZVBhdGgsIGJhc2VQYXRoOwoKICAgIGlmIChyZWxhdGl2ZS5fcGFydHMudXJuKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVVJOcyBkbyBub3QgaGF2ZSBhbnkgZ2VuZXJhbGx5IGRlZmluZWQgaGllcmFyY2hpY2FsIGNvbXBvbmVudHMnKTsKICAgIH0KCiAgICBiYXNlID0gbmV3IFVSSShiYXNlKS5ub3JtYWxpemUoKTsKICAgIHJlbGF0aXZlUGFydHMgPSByZWxhdGl2ZS5fcGFydHM7CiAgICBiYXNlUGFydHMgPSBiYXNlLl9wYXJ0czsKICAgIHJlbGF0aXZlUGF0aCA9IHJlbGF0aXZlLnBhdGgoKTsKICAgIGJhc2VQYXRoID0gYmFzZS5wYXRoKCk7CgogICAgaWYgKHJlbGF0aXZlUGF0aC5jaGFyQXQoMCkgIT09ICcvJykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VSSSBpcyBhbHJlYWR5IHJlbGF0aXZlJyk7CiAgICB9CgogICAgaWYgKGJhc2VQYXRoLmNoYXJBdCgwKSAhPT0gJy8nKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGNhbGN1bGF0ZSBhIFVSSSByZWxhdGl2ZSB0byBhbm90aGVyIHJlbGF0aXZlIFVSSScpOwogICAgfQoKICAgIGlmIChyZWxhdGl2ZVBhcnRzLnByb3RvY29sID09PSBiYXNlUGFydHMucHJvdG9jb2wpIHsKICAgICAgcmVsYXRpdmVQYXJ0cy5wcm90b2NvbCA9IG51bGw7CiAgICB9CgogICAgaWYgKHJlbGF0aXZlUGFydHMudXNlcm5hbWUgIT09IGJhc2VQYXJ0cy51c2VybmFtZSB8fCByZWxhdGl2ZVBhcnRzLnBhc3N3b3JkICE9PSBiYXNlUGFydHMucGFzc3dvcmQpIHsKICAgICAgcmV0dXJuIHJlbGF0aXZlLmJ1aWxkKCk7CiAgICB9CgogICAgaWYgKHJlbGF0aXZlUGFydHMucHJvdG9jb2wgIT09IG51bGwgfHwgcmVsYXRpdmVQYXJ0cy51c2VybmFtZSAhPT0gbnVsbCB8fCByZWxhdGl2ZVBhcnRzLnBhc3N3b3JkICE9PSBudWxsKSB7CiAgICAgIHJldHVybiByZWxhdGl2ZS5idWlsZCgpOwogICAgfQoKICAgIGlmIChyZWxhdGl2ZVBhcnRzLmhvc3RuYW1lID09PSBiYXNlUGFydHMuaG9zdG5hbWUgJiYgcmVsYXRpdmVQYXJ0cy5wb3J0ID09PSBiYXNlUGFydHMucG9ydCkgewogICAgICByZWxhdGl2ZVBhcnRzLmhvc3RuYW1lID0gbnVsbDsKICAgICAgcmVsYXRpdmVQYXJ0cy5wb3J0ID0gbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiByZWxhdGl2ZS5idWlsZCgpOwogICAgfQoKICAgIGlmIChyZWxhdGl2ZVBhdGggPT09IGJhc2VQYXRoKSB7CiAgICAgIHJlbGF0aXZlUGFydHMucGF0aCA9ICcnOwogICAgICByZXR1cm4gcmVsYXRpdmUuYnVpbGQoKTsKICAgIH0KCiAgICAvLyBkZXRlcm1pbmUgY29tbW9uIHN1YiBwYXRoCiAgICBjb21tb24gPSBVUkkuY29tbW9uUGF0aChyZWxhdGl2ZVBhdGgsIGJhc2VQYXRoKTsKCiAgICAvLyBJZiB0aGUgcGF0aHMgaGF2ZSBub3RoaW5nIGluIGNvbW1vbiwgcmV0dXJuIGEgcmVsYXRpdmUgVVJMIHdpdGggdGhlIGFic29sdXRlIHBhdGguCiAgICBpZiAoIWNvbW1vbikgewogICAgICByZXR1cm4gcmVsYXRpdmUuYnVpbGQoKTsKICAgIH0KCiAgICB2YXIgcGFyZW50cyA9IGJhc2VQYXJ0cy5wYXRoLnN1YnN0cmluZyhjb21tb24ubGVuZ3RoKS5yZXBsYWNlKC9bXlwvXSokLywgJycpLnJlcGxhY2UoLy4qP1wvL2csICcuLi8nKTsKCiAgICByZWxhdGl2ZVBhcnRzLnBhdGggPSBwYXJlbnRzICsgcmVsYXRpdmVQYXJ0cy5wYXRoLnN1YnN0cmluZyhjb21tb24ubGVuZ3RoKSB8fCAnLi8nOwoKICAgIHJldHVybiByZWxhdGl2ZS5idWlsZCgpOwogIH07CgogIC8vIGNvbXBhcmluZyBVUklzCiAgcC5lcXVhbHMgPSBmdW5jdGlvbiAodXJpKSB7CiAgICB2YXIgb25lID0gdGhpcy5jbG9uZSgpOwogICAgdmFyIHR3byA9IG5ldyBVUkkodXJpKTsKICAgIHZhciBvbmVfbWFwID0ge307CiAgICB2YXIgdHdvX21hcCA9IHt9OwogICAgdmFyIGNoZWNrZWQgPSB7fTsKICAgIHZhciBvbmVfcXVlcnksIHR3b19xdWVyeSwga2V5OwoKICAgIG9uZS5ub3JtYWxpemUoKTsKICAgIHR3by5ub3JtYWxpemUoKTsKCiAgICAvLyBleGFjdCBtYXRjaAogICAgaWYgKG9uZS50b1N0cmluZygpID09PSB0d28udG9TdHJpbmcoKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBleHRyYWN0IHF1ZXJ5IHN0cmluZwogICAgb25lX3F1ZXJ5ID0gb25lLnF1ZXJ5KCk7CiAgICB0d29fcXVlcnkgPSB0d28ucXVlcnkoKTsKICAgIG9uZS5xdWVyeSgnJyk7CiAgICB0d28ucXVlcnkoJycpOwoKICAgIC8vIGRlZmluaXRlbHkgbm90IGVxdWFsIGlmIG5vdCBldmVuIG5vbi1xdWVyeSBwYXJ0cyBtYXRjaAogICAgaWYgKG9uZS50b1N0cmluZygpICE9PSB0d28udG9TdHJpbmcoKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8gcXVlcnkgcGFyYW1ldGVycyBoYXZlIHRoZSBzYW1lIGxlbmd0aCwgZXZlbiBpZiB0aGV5J3JlIHBlcm11dGVkCiAgICBpZiAob25lX3F1ZXJ5Lmxlbmd0aCAhPT0gdHdvX3F1ZXJ5Lmxlbmd0aCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgb25lX21hcCA9IFVSSS5wYXJzZVF1ZXJ5KG9uZV9xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7CiAgICB0d29fbWFwID0gVVJJLnBhcnNlUXVlcnkodHdvX3F1ZXJ5LCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTsKCiAgICBmb3IgKGtleSBpbiBvbmVfbWFwKSB7CiAgICAgIGlmIChoYXNPd24uY2FsbChvbmVfbWFwLCBrZXkpKSB7CiAgICAgICAgaWYgKCFpc0FycmF5KG9uZV9tYXBba2V5XSkpIHsKICAgICAgICAgIGlmIChvbmVfbWFwW2tleV0gIT09IHR3b19tYXBba2V5XSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICghYXJyYXlzRXF1YWwob25lX21hcFtrZXldLCB0d29fbWFwW2tleV0pKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBjaGVja2VkW2tleV0gPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgZm9yIChrZXkgaW4gdHdvX21hcCkgewogICAgICBpZiAoaGFzT3duLmNhbGwodHdvX21hcCwga2V5KSkgewogICAgICAgIGlmICghY2hlY2tlZFtrZXldKSB7CiAgICAgICAgICAvLyB0d28gY29udGFpbnMgYSBwYXJhbWV0ZXIgbm90IHByZXNlbnQgaW4gb25lCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfTsKCiAgLy8gc3RhdGUKICBwLmR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycyA9IGZ1bmN0aW9uICh2KSB7CiAgICB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMgPSAhIXY7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICBwLmVzY2FwZVF1ZXJ5U3BhY2UgPSBmdW5jdGlvbiAodikgewogICAgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSA9ICEhdjsKICAgIHJldHVybiB0aGlzOwogIH07CgogIHJldHVybiBVUkk7Cn0pOwoKfSx7Ii4vSVB2NiI6OSwiLi9TZWNvbmRMZXZlbERvbWFpbnMiOjEwLCIuL3B1bnljb2RlIjoxMn1dLDEyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChnbG9iYWwpewondXNlIHN0cmljdCc7Cgp2YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07CgovKiEgaHR0cHM6Ly9tdGhzLmJlL3B1bnljb2RlIHYxLjQuMCBieSBAbWF0aGlhcyAqLwo7KGZ1bmN0aW9uIChyb290KSB7CgoJLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlcyAqLwoJdmFyIGZyZWVFeHBvcnRzID0gKHR5cGVvZiBleHBvcnRzID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihleHBvcnRzKSkgPT0gJ29iamVjdCcgJiYgZXhwb3J0cyAmJiAhZXhwb3J0cy5ub2RlVHlwZSAmJiBleHBvcnRzOwoJdmFyIGZyZWVNb2R1bGUgPSAodHlwZW9mIG1vZHVsZSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YobW9kdWxlKSkgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmICFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlOwoJdmFyIGZyZWVHbG9iYWwgPSAodHlwZW9mIGdsb2JhbCA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZ2xvYmFsKSkgPT0gJ29iamVjdCcgJiYgZ2xvYmFsOwoJaWYgKGZyZWVHbG9iYWwuZ2xvYmFsID09PSBmcmVlR2xvYmFsIHx8IGZyZWVHbG9iYWwud2luZG93ID09PSBmcmVlR2xvYmFsIHx8IGZyZWVHbG9iYWwuc2VsZiA9PT0gZnJlZUdsb2JhbCkgewoJCXJvb3QgPSBmcmVlR2xvYmFsOwoJfQoKCS8qKgogICogVGhlIGBwdW55Y29kZWAgb2JqZWN0LgogICogQG5hbWUgcHVueWNvZGUKICAqIEB0eXBlIE9iamVjdAogICovCgl2YXIgcHVueWNvZGUsCgoKCS8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi8KCW1heEludCA9IDIxNDc0ODM2NDcsCgkgICAgLy8gYWthLiAweDdGRkZGRkZGIG9yIDJeMzEtMQoKCS8qKiBCb290c3RyaW5nIHBhcmFtZXRlcnMgKi8KCWJhc2UgPSAzNiwKCSAgICB0TWluID0gMSwKCSAgICB0TWF4ID0gMjYsCgkgICAgc2tldyA9IDM4LAoJICAgIGRhbXAgPSA3MDAsCgkgICAgaW5pdGlhbEJpYXMgPSA3MiwKCSAgICBpbml0aWFsTiA9IDEyOCwKCSAgICAvLyAweDgwCglkZWxpbWl0ZXIgPSAnLScsCgkgICAgLy8gJ1x4MkQnCgoJLyoqIFJlZ3VsYXIgZXhwcmVzc2lvbnMgKi8KCXJlZ2V4UHVueWNvZGUgPSAvXnhuLS0vLAoJICAgIHJlZ2V4Tm9uQVNDSUkgPSAvW15ceDIwLVx4N0VdLywKCSAgICAvLyB1bnByaW50YWJsZSBBU0NJSSBjaGFycyArIG5vbi1BU0NJSSBjaGFycwoJcmVnZXhTZXBhcmF0b3JzID0gL1tceDJFXHUzMDAyXHVGRjBFXHVGRjYxXS9nLAoJICAgIC8vIFJGQyAzNDkwIHNlcGFyYXRvcnMKCgkvKiogRXJyb3IgbWVzc2FnZXMgKi8KCWVycm9ycyA9IHsKCQknb3ZlcmZsb3cnOiAnT3ZlcmZsb3c6IGlucHV0IG5lZWRzIHdpZGVyIGludGVnZXJzIHRvIHByb2Nlc3MnLAoJCSdub3QtYmFzaWMnOiAnSWxsZWdhbCBpbnB1dCA+PSAweDgwIChub3QgYSBiYXNpYyBjb2RlIHBvaW50KScsCgkJJ2ludmFsaWQtaW5wdXQnOiAnSW52YWxpZCBpbnB1dCcKCX0sCgoKCS8qKiBDb252ZW5pZW5jZSBzaG9ydGN1dHMgKi8KCWJhc2VNaW51c1RNaW4gPSBiYXNlIC0gdE1pbiwKCSAgICBmbG9vciA9IE1hdGguZmxvb3IsCgkgICAgc3RyaW5nRnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZSwKCgoJLyoqIFRlbXBvcmFyeSB2YXJpYWJsZSAqLwoJa2V5OwoKCS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCS8qKgogICogQSBnZW5lcmljIGVycm9yIHV0aWxpdHkgZnVuY3Rpb24uCiAgKiBAcHJpdmF0ZQogICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVGhlIGVycm9yIHR5cGUuCiAgKiBAcmV0dXJucyB7RXJyb3J9IFRocm93cyBhIGBSYW5nZUVycm9yYCB3aXRoIHRoZSBhcHBsaWNhYmxlIGVycm9yIG1lc3NhZ2UuCiAgKi8KCWZ1bmN0aW9uIGVycm9yKHR5cGUpIHsKCQl0aHJvdyBuZXcgUmFuZ2VFcnJvcihlcnJvcnNbdHlwZV0pOwoJfQoKCS8qKgogICogQSBnZW5lcmljIGBBcnJheSNtYXBgIHV0aWxpdHkgZnVuY3Rpb24uCiAgKiBAcHJpdmF0ZQogICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci4KICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeSBhcnJheQogICogaXRlbS4KICAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgYXJyYXkgb2YgdmFsdWVzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjayBmdW5jdGlvbi4KICAqLwoJZnVuY3Rpb24gbWFwKGFycmF5LCBmbikgewoJCXZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7CgkJdmFyIHJlc3VsdCA9IFtdOwoJCXdoaWxlIChsZW5ndGgtLSkgewoJCQlyZXN1bHRbbGVuZ3RoXSA9IGZuKGFycmF5W2xlbmd0aF0pOwoJCX0KCQlyZXR1cm4gcmVzdWx0OwoJfQoKCS8qKgogICogQSBzaW1wbGUgYEFycmF5I21hcGAtbGlrZSB3cmFwcGVyIHRvIHdvcmsgd2l0aCBkb21haW4gbmFtZSBzdHJpbmdzIG9yIGVtYWlsCiAgKiBhZGRyZXNzZXMuCiAgKiBAcHJpdmF0ZQogICogQHBhcmFtIHtTdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcy4KICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeQogICogY2hhcmFjdGVyLgogICogQHJldHVybnMge0FycmF5fSBBIG5ldyBzdHJpbmcgb2YgY2hhcmFjdGVycyByZXR1cm5lZCBieSB0aGUgY2FsbGJhY2sKICAqIGZ1bmN0aW9uLgogICovCglmdW5jdGlvbiBtYXBEb21haW4oc3RyaW5nLCBmbikgewoJCXZhciBwYXJ0cyA9IHN0cmluZy5zcGxpdCgnQCcpOwoJCXZhciByZXN1bHQgPSAnJzsKCQlpZiAocGFydHMubGVuZ3RoID4gMSkgewoJCQkvLyBJbiBlbWFpbCBhZGRyZXNzZXMsIG9ubHkgdGhlIGRvbWFpbiBuYW1lIHNob3VsZCBiZSBwdW55Y29kZWQuIExlYXZlCgkJCS8vIHRoZSBsb2NhbCBwYXJ0IChpLmUuIGV2ZXJ5dGhpbmcgdXAgdG8gYEBgKSBpbnRhY3QuCgkJCXJlc3VsdCA9IHBhcnRzWzBdICsgJ0AnOwoJCQlzdHJpbmcgPSBwYXJ0c1sxXTsKCQl9CgkJLy8gQXZvaWQgYHNwbGl0KHJlZ2V4KWAgZm9yIElFOCBjb21wYXRpYmlsaXR5LiBTZWUgIzE3LgoJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4U2VwYXJhdG9ycywgJ1x4MkUnKTsKCQl2YXIgbGFiZWxzID0gc3RyaW5nLnNwbGl0KCcuJyk7CgkJdmFyIGVuY29kZWQgPSBtYXAobGFiZWxzLCBmbikuam9pbignLicpOwoJCXJldHVybiByZXN1bHQgKyBlbmNvZGVkOwoJfQoKCS8qKgogICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZQogICogY2hhcmFjdGVyIGluIHRoZSBzdHJpbmcuIFdoaWxlIEphdmFTY3JpcHQgdXNlcyBVQ1MtMiBpbnRlcm5hbGx5LAogICogdGhpcyBmdW5jdGlvbiB3aWxsIGNvbnZlcnQgYSBwYWlyIG9mIHN1cnJvZ2F0ZSBoYWx2ZXMgKGVhY2ggb2Ygd2hpY2gKICAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LAogICogbWF0Y2hpbmcgVVRGLTE2LgogICogQHNlZSBgcHVueWNvZGUudWNzMi5lbmNvZGVgCiAgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz4KICAqIEBtZW1iZXJPZiBwdW55Y29kZS51Y3MyCiAgKiBAbmFtZSBkZWNvZGUKICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIFVuaWNvZGUgaW5wdXQgc3RyaW5nIChVQ1MtMikuCiAgKiBAcmV0dXJucyB7QXJyYXl9IFRoZSBuZXcgYXJyYXkgb2YgY29kZSBwb2ludHMuCiAgKi8KCWZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7CgkJdmFyIG91dHB1dCA9IFtdLAoJCSAgICBjb3VudGVyID0gMCwKCQkgICAgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aCwKCQkgICAgdmFsdWUsCgkJICAgIGV4dHJhOwoJCXdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7CgkJCXZhbHVlID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTsKCQkJaWYgKHZhbHVlID49IDB4RDgwMCAmJiB2YWx1ZSA8PSAweERCRkYgJiYgY291bnRlciA8IGxlbmd0aCkgewoJCQkJLy8gaGlnaCBzdXJyb2dhdGUsIGFuZCB0aGVyZSBpcyBhIG5leHQgY2hhcmFjdGVyCgkJCQlleHRyYSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7CgkJCQlpZiAoKGV4dHJhICYgMHhGQzAwKSA9PSAweERDMDApIHsKCQkJCQkvLyBsb3cgc3Vycm9nYXRlCgkJCQkJb3V0cHV0LnB1c2goKCh2YWx1ZSAmIDB4M0ZGKSA8PCAxMCkgKyAoZXh0cmEgJiAweDNGRikgKyAweDEwMDAwKTsKCQkJCX0gZWxzZSB7CgkJCQkJLy8gdW5tYXRjaGVkIHN1cnJvZ2F0ZTsgb25seSBhcHBlbmQgdGhpcyBjb2RlIHVuaXQsIGluIGNhc2UgdGhlIG5leHQKCQkJCQkvLyBjb2RlIHVuaXQgaXMgdGhlIGhpZ2ggc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXIKCQkJCQlvdXRwdXQucHVzaCh2YWx1ZSk7CgkJCQkJY291bnRlci0tOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJb3V0cHV0LnB1c2godmFsdWUpOwoJCQl9CgkJfQoJCXJldHVybiBvdXRwdXQ7Cgl9CgoJLyoqCiAgKiBDcmVhdGVzIGEgc3RyaW5nIGJhc2VkIG9uIGFuIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuCiAgKiBAc2VlIGBwdW55Y29kZS51Y3MyLmRlY29kZWAKICAqIEBtZW1iZXJPZiBwdW55Y29kZS51Y3MyCiAgKiBAbmFtZSBlbmNvZGUKICAqIEBwYXJhbSB7QXJyYXl9IGNvZGVQb2ludHMgVGhlIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuCiAgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgbmV3IFVuaWNvZGUgc3RyaW5nIChVQ1MtMikuCiAgKi8KCWZ1bmN0aW9uIHVjczJlbmNvZGUoYXJyYXkpIHsKCQlyZXR1cm4gbWFwKGFycmF5LCBmdW5jdGlvbiAodmFsdWUpIHsKCQkJdmFyIG91dHB1dCA9ICcnOwoJCQlpZiAodmFsdWUgPiAweEZGRkYpIHsKCQkJCXZhbHVlIC09IDB4MTAwMDA7CgkJCQlvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKTsKCQkJCXZhbHVlID0gMHhEQzAwIHwgdmFsdWUgJiAweDNGRjsKCQkJfQoJCQlvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlKTsKCQkJcmV0dXJuIG91dHB1dDsKCQl9KS5qb2luKCcnKTsKCX0KCgkvKioKICAqIENvbnZlcnRzIGEgYmFzaWMgY29kZSBwb2ludCBpbnRvIGEgZGlnaXQvaW50ZWdlci4KICAqIEBzZWUgYGRpZ2l0VG9CYXNpYygpYAogICogQHByaXZhdGUKICAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlUG9pbnQgVGhlIGJhc2ljIG51bWVyaWMgY29kZSBwb2ludCB2YWx1ZS4KICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludCAoZm9yIHVzZSBpbgogICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpbiB0aGUgcmFuZ2UgYDBgIHRvIGBiYXNlIC0gMWAsIG9yIGBiYXNlYCBpZgogICogdGhlIGNvZGUgcG9pbnQgZG9lcyBub3QgcmVwcmVzZW50IGEgdmFsdWUuCiAgKi8KCWZ1bmN0aW9uIGJhc2ljVG9EaWdpdChjb2RlUG9pbnQpIHsKCQlpZiAoY29kZVBvaW50IC0gNDggPCAxMCkgewoJCQlyZXR1cm4gY29kZVBvaW50IC0gMjI7CgkJfQoJCWlmIChjb2RlUG9pbnQgLSA2NSA8IDI2KSB7CgkJCXJldHVybiBjb2RlUG9pbnQgLSA2NTsKCQl9CgkJaWYgKGNvZGVQb2ludCAtIDk3IDwgMjYpIHsKCQkJcmV0dXJuIGNvZGVQb2ludCAtIDk3OwoJCX0KCQlyZXR1cm4gYmFzZTsKCX0KCgkvKioKICAqIENvbnZlcnRzIGEgZGlnaXQvaW50ZWdlciBpbnRvIGEgYmFzaWMgY29kZSBwb2ludC4KICAqIEBzZWUgYGJhc2ljVG9EaWdpdCgpYAogICogQHByaXZhdGUKICAqIEBwYXJhbSB7TnVtYmVyfSBkaWdpdCBUaGUgbnVtZXJpYyB2YWx1ZSBvZiBhIGJhc2ljIGNvZGUgcG9pbnQuCiAgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgYmFzaWMgY29kZSBwb2ludCB3aG9zZSB2YWx1ZSAod2hlbiB1c2VkIGZvcgogICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpcyBgZGlnaXRgLCB3aGljaCBuZWVkcyB0byBiZSBpbiB0aGUgcmFuZ2UKICAqIGAwYCB0byBgYmFzZSAtIDFgLiBJZiBgZmxhZ2AgaXMgbm9uLXplcm8sIHRoZSB1cHBlcmNhc2UgZm9ybSBpcwogICogdXNlZDsgZWxzZSwgdGhlIGxvd2VyY2FzZSBmb3JtIGlzIHVzZWQuIFRoZSBiZWhhdmlvciBpcyB1bmRlZmluZWQKICAqIGlmIGBmbGFnYCBpcyBub24temVybyBhbmQgYGRpZ2l0YCBoYXMgbm8gdXBwZXJjYXNlIGZvcm0uCiAgKi8KCWZ1bmN0aW9uIGRpZ2l0VG9CYXNpYyhkaWdpdCwgZmxhZykgewoJCS8vICAwLi4yNSBtYXAgdG8gQVNDSUkgYS4ueiBvciBBLi5aCgkJLy8gMjYuLjM1IG1hcCB0byBBU0NJSSAwLi45CgkJcmV0dXJuIGRpZ2l0ICsgMjIgKyA3NSAqIChkaWdpdCA8IDI2KSAtICgoZmxhZyAhPSAwKSA8PCA1KTsKCX0KCgkvKioKICAqIEJpYXMgYWRhcHRhdGlvbiBmdW5jdGlvbiBhcyBwZXIgc2VjdGlvbiAzLjQgb2YgUkZDIDM0OTIuCiAgKiBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzQ5MiNzZWN0aW9uLTMuNAogICogQHByaXZhdGUKICAqLwoJZnVuY3Rpb24gYWRhcHQoZGVsdGEsIG51bVBvaW50cywgZmlyc3RUaW1lKSB7CgkJdmFyIGsgPSAwOwoJCWRlbHRhID0gZmlyc3RUaW1lID8gZmxvb3IoZGVsdGEgLyBkYW1wKSA6IGRlbHRhID4+IDE7CgkJZGVsdGEgKz0gZmxvb3IoZGVsdGEgLyBudW1Qb2ludHMpOwoJCWZvciAoOyAvKiBubyBpbml0aWFsaXphdGlvbiAqL2RlbHRhID4gYmFzZU1pbnVzVE1pbiAqIHRNYXggPj4gMTsgayArPSBiYXNlKSB7CgkJCWRlbHRhID0gZmxvb3IoZGVsdGEgLyBiYXNlTWludXNUTWluKTsKCQl9CgkJcmV0dXJuIGZsb29yKGsgKyAoYmFzZU1pbnVzVE1pbiArIDEpICogZGVsdGEgLyAoZGVsdGEgKyBza2V3KSk7Cgl9CgoJLyoqCiAgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMgdG8gYSBzdHJpbmcgb2YgVW5pY29kZQogICogc3ltYm9scy4KICAqIEBtZW1iZXJPZiBwdW55Y29kZQogICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgogICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzLgogICovCglmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHsKCQkvLyBEb24ndCB1c2UgVUNTLTIKCQl2YXIgb3V0cHV0ID0gW10sCgkJICAgIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLAoJCSAgICBvdXQsCgkJICAgIGkgPSAwLAoJCSAgICBuID0gaW5pdGlhbE4sCgkJICAgIGJpYXMgPSBpbml0aWFsQmlhcywKCQkgICAgYmFzaWMsCgkJICAgIGosCgkJICAgIGluZGV4LAoJCSAgICBvbGRpLAoJCSAgICB3LAoJCSAgICBrLAoJCSAgICBkaWdpdCwKCQkgICAgdCwKCgkJLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovCgkJYmFzZU1pbnVzVDsKCgkJLy8gSGFuZGxlIHRoZSBiYXNpYyBjb2RlIHBvaW50czogbGV0IGBiYXNpY2AgYmUgdGhlIG51bWJlciBvZiBpbnB1dCBjb2RlCgkJLy8gcG9pbnRzIGJlZm9yZSB0aGUgbGFzdCBkZWxpbWl0ZXIsIG9yIGAwYCBpZiB0aGVyZSBpcyBub25lLCB0aGVuIGNvcHkKCQkvLyB0aGUgZmlyc3QgYmFzaWMgY29kZSBwb2ludHMgdG8gdGhlIG91dHB1dC4KCgkJYmFzaWMgPSBpbnB1dC5sYXN0SW5kZXhPZihkZWxpbWl0ZXIpOwoJCWlmIChiYXNpYyA8IDApIHsKCQkJYmFzaWMgPSAwOwoJCX0KCgkJZm9yIChqID0gMDsgaiA8IGJhc2ljOyArK2opIHsKCQkJLy8gaWYgaXQncyBub3QgYSBiYXNpYyBjb2RlIHBvaW50CgkJCWlmIChpbnB1dC5jaGFyQ29kZUF0KGopID49IDB4ODApIHsKCQkJCWVycm9yKCdub3QtYmFzaWMnKTsKCQkJfQoJCQlvdXRwdXQucHVzaChpbnB1dC5jaGFyQ29kZUF0KGopKTsKCQl9CgoJCS8vIE1haW4gZGVjb2RpbmcgbG9vcDogc3RhcnQganVzdCBhZnRlciB0aGUgbGFzdCBkZWxpbWl0ZXIgaWYgYW55IGJhc2ljIGNvZGUKCQkvLyBwb2ludHMgd2VyZSBjb3BpZWQ7IHN0YXJ0IGF0IHRoZSBiZWdpbm5pbmcgb3RoZXJ3aXNlLgoKCQlmb3IgKGluZGV4ID0gYmFzaWMgPiAwID8gYmFzaWMgKyAxIDogMDsgaW5kZXggPCBpbnB1dExlbmd0aDspIC8qIG5vIGZpbmFsIGV4cHJlc3Npb24gKi97CgoJCQkvLyBgaW5kZXhgIGlzIHRoZSBpbmRleCBvZiB0aGUgbmV4dCBjaGFyYWN0ZXIgdG8gYmUgY29uc3VtZWQuCgkJCS8vIERlY29kZSBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyIGludG8gYGRlbHRhYCwKCQkJLy8gd2hpY2ggZ2V0cyBhZGRlZCB0byBgaWAuIFRoZSBvdmVyZmxvdyBjaGVja2luZyBpcyBlYXNpZXIKCQkJLy8gaWYgd2UgaW5jcmVhc2UgYGlgIGFzIHdlIGdvLCB0aGVuIHN1YnRyYWN0IG9mZiBpdHMgc3RhcnRpbmcKCQkJLy8gdmFsdWUgYXQgdGhlIGVuZCB0byBvYnRhaW4gYGRlbHRhYC4KCQkJZm9yIChvbGRpID0gaSwgdyA9IDEsIGsgPSBiYXNlOzsgLyogbm8gY29uZGl0aW9uICovayArPSBiYXNlKSB7CgoJCQkJaWYgKGluZGV4ID49IGlucHV0TGVuZ3RoKSB7CgkJCQkJZXJyb3IoJ2ludmFsaWQtaW5wdXQnKTsKCQkJCX0KCgkJCQlkaWdpdCA9IGJhc2ljVG9EaWdpdChpbnB1dC5jaGFyQ29kZUF0KGluZGV4KyspKTsKCgkJCQlpZiAoZGlnaXQgPj0gYmFzZSB8fCBkaWdpdCA+IGZsb29yKChtYXhJbnQgLSBpKSAvIHcpKSB7CgkJCQkJZXJyb3IoJ292ZXJmbG93Jyk7CgkJCQl9CgoJCQkJaSArPSBkaWdpdCAqIHc7CgkJCQl0ID0gayA8PSBiaWFzID8gdE1pbiA6IGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXM7CgoJCQkJaWYgKGRpZ2l0IDwgdCkgewoJCQkJCWJyZWFrOwoJCQkJfQoKCQkJCWJhc2VNaW51c1QgPSBiYXNlIC0gdDsKCQkJCWlmICh3ID4gZmxvb3IobWF4SW50IC8gYmFzZU1pbnVzVCkpIHsKCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCX0KCgkJCQl3ICo9IGJhc2VNaW51c1Q7CgkJCX0KCgkJCW91dCA9IG91dHB1dC5sZW5ndGggKyAxOwoJCQliaWFzID0gYWRhcHQoaSAtIG9sZGksIG91dCwgb2xkaSA9PSAwKTsKCgkJCS8vIGBpYCB3YXMgc3VwcG9zZWQgdG8gd3JhcCBhcm91bmQgZnJvbSBgb3V0YCB0byBgMGAsCgkJCS8vIGluY3JlbWVudGluZyBgbmAgZWFjaCB0aW1lLCBzbyB3ZSdsbCBmaXggdGhhdCBub3c6CgkJCWlmIChmbG9vcihpIC8gb3V0KSA+IG1heEludCAtIG4pIHsKCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQl9CgoJCQluICs9IGZsb29yKGkgLyBvdXQpOwoJCQlpICU9IG91dDsKCgkJCS8vIEluc2VydCBgbmAgYXQgcG9zaXRpb24gYGlgIG9mIHRoZSBvdXRwdXQKCQkJb3V0cHV0LnNwbGljZShpKyssIDAsIG4pOwoJCX0KCgkJcmV0dXJuIHVjczJlbmNvZGUob3V0cHV0KTsKCX0KCgkvKioKICAqIENvbnZlcnRzIGEgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scyAoZS5nLiBhIGRvbWFpbiBuYW1lIGxhYmVsKSB0byBhCiAgKiBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgogICogQG1lbWJlck9mIHB1bnljb2RlCiAgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuCiAgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgcmVzdWx0aW5nIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuCiAgKi8KCWZ1bmN0aW9uIGVuY29kZShpbnB1dCkgewoJCXZhciBuLAoJCSAgICBkZWx0YSwKCQkgICAgaGFuZGxlZENQQ291bnQsCgkJICAgIGJhc2ljTGVuZ3RoLAoJCSAgICBiaWFzLAoJCSAgICBqLAoJCSAgICBtLAoJCSAgICBxLAoJCSAgICBrLAoJCSAgICB0LAoJCSAgICBjdXJyZW50VmFsdWUsCgkJICAgIG91dHB1dCA9IFtdLAoKCQkvKiogYGlucHV0TGVuZ3RoYCB3aWxsIGhvbGQgdGhlIG51bWJlciBvZiBjb2RlIHBvaW50cyBpbiBgaW5wdXRgLiAqLwoJCWlucHV0TGVuZ3RoLAoKCQkvKiogQ2FjaGVkIGNhbGN1bGF0aW9uIHJlc3VsdHMgKi8KCQloYW5kbGVkQ1BDb3VudFBsdXNPbmUsCgkJICAgIGJhc2VNaW51c1QsCgkJICAgIHFNaW51c1Q7CgoJCS8vIENvbnZlcnQgdGhlIGlucHV0IGluIFVDUy0yIHRvIFVuaWNvZGUKCQlpbnB1dCA9IHVjczJkZWNvZGUoaW5wdXQpOwoKCQkvLyBDYWNoZSB0aGUgbGVuZ3RoCgkJaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7CgoJCS8vIEluaXRpYWxpemUgdGhlIHN0YXRlCgkJbiA9IGluaXRpYWxOOwoJCWRlbHRhID0gMDsKCQliaWFzID0gaW5pdGlhbEJpYXM7CgoJCS8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHMKCQlmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQljdXJyZW50VmFsdWUgPSBpbnB1dFtqXTsKCQkJaWYgKGN1cnJlbnRWYWx1ZSA8IDB4ODApIHsKCQkJCW91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShjdXJyZW50VmFsdWUpKTsKCQkJfQoJCX0KCgkJaGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7CgoJCS8vIGBoYW5kbGVkQ1BDb3VudGAgaXMgdGhlIG51bWJlciBvZiBjb2RlIHBvaW50cyB0aGF0IGhhdmUgYmVlbiBoYW5kbGVkOwoJCS8vIGBiYXNpY0xlbmd0aGAgaXMgdGhlIG51bWJlciBvZiBiYXNpYyBjb2RlIHBvaW50cy4KCgkJLy8gRmluaXNoIHRoZSBiYXNpYyBzdHJpbmcgLSBpZiBpdCBpcyBub3QgZW1wdHkgLSB3aXRoIGEgZGVsaW1pdGVyCgkJaWYgKGJhc2ljTGVuZ3RoKSB7CgkJCW91dHB1dC5wdXNoKGRlbGltaXRlcik7CgkJfQoKCQkvLyBNYWluIGVuY29kaW5nIGxvb3A6CgkJd2hpbGUgKGhhbmRsZWRDUENvdW50IDwgaW5wdXRMZW5ndGgpIHsKCgkJCS8vIEFsbCBub24tYmFzaWMgY29kZSBwb2ludHMgPCBuIGhhdmUgYmVlbiBoYW5kbGVkIGFscmVhZHkuIEZpbmQgdGhlIG5leHQKCQkJLy8gbGFyZ2VyIG9uZToKCQkJZm9yIChtID0gbWF4SW50LCBqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHsKCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoJCQkJaWYgKGN1cnJlbnRWYWx1ZSA+PSBuICYmIGN1cnJlbnRWYWx1ZSA8IG0pIHsKCQkJCQltID0gY3VycmVudFZhbHVlOwoJCQkJfQoJCQl9CgoJCQkvLyBJbmNyZWFzZSBgZGVsdGFgIGVub3VnaCB0byBhZHZhbmNlIHRoZSBkZWNvZGVyJ3MgPG4saT4gc3RhdGUgdG8gPG0sMD4sCgkJCS8vIGJ1dCBndWFyZCBhZ2FpbnN0IG92ZXJmbG93CgkJCWhhbmRsZWRDUENvdW50UGx1c09uZSA9IGhhbmRsZWRDUENvdW50ICsgMTsKCQkJaWYgKG0gLSBuID4gZmxvb3IoKG1heEludCAtIGRlbHRhKSAvIGhhbmRsZWRDUENvdW50UGx1c09uZSkpIHsKCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQl9CgoJCQlkZWx0YSArPSAobSAtIG4pICogaGFuZGxlZENQQ291bnRQbHVzT25lOwoJCQluID0gbTsKCgkJCWZvciAoaiA9IDA7IGogPCBpbnB1dExlbmd0aDsgKytqKSB7CgkJCQljdXJyZW50VmFsdWUgPSBpbnB1dFtqXTsKCgkJCQlpZiAoY3VycmVudFZhbHVlIDwgbiAmJiArK2RlbHRhID4gbWF4SW50KSB7CgkJCQkJZXJyb3IoJ292ZXJmbG93Jyk7CgkJCQl9CgoJCQkJaWYgKGN1cnJlbnRWYWx1ZSA9PSBuKSB7CgkJCQkJLy8gUmVwcmVzZW50IGRlbHRhIGFzIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXIKCQkJCQlmb3IgKHEgPSBkZWx0YSwgayA9IGJhc2U7OyAvKiBubyBjb25kaXRpb24gKi9rICs9IGJhc2UpIHsKCQkJCQkJdCA9IGsgPD0gYmlhcyA/IHRNaW4gOiBrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzOwoJCQkJCQlpZiAocSA8IHQpIHsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJCXFNaW51c1QgPSBxIC0gdDsKCQkJCQkJYmFzZU1pbnVzVCA9IGJhc2UgLSB0OwoJCQkJCQlvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCwgMCkpKTsKCQkJCQkJcSA9IGZsb29yKHFNaW51c1QgLyBiYXNlTWludXNUKTsKCQkJCQl9CgoJCQkJCW91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShkaWdpdFRvQmFzaWMocSwgMCkpKTsKCQkJCQliaWFzID0gYWRhcHQoZGVsdGEsIGhhbmRsZWRDUENvdW50UGx1c09uZSwgaGFuZGxlZENQQ291bnQgPT0gYmFzaWNMZW5ndGgpOwoJCQkJCWRlbHRhID0gMDsKCQkJCQkrK2hhbmRsZWRDUENvdW50OwoJCQkJfQoJCQl9CgoJCQkrK2RlbHRhOwoJCQkrK247CgkJfQoJCXJldHVybiBvdXRwdXQuam9pbignJyk7Cgl9CgoJLyoqCiAgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzCiAgKiB0byBVbmljb2RlLiBPbmx5IHRoZSBQdW55Y29kZWQgcGFydHMgb2YgdGhlIGlucHV0IHdpbGwgYmUgY29udmVydGVkLCBpLmUuCiAgKiBpdCBkb2Vzbid0IG1hdHRlciBpZiB5b3UgY2FsbCBpdCBvbiBhIHN0cmluZyB0aGF0IGhhcyBhbHJlYWR5IGJlZW4KICAqIGNvbnZlcnRlZCB0byBVbmljb2RlLgogICogQG1lbWJlck9mIHB1bnljb2RlCiAgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIFB1bnljb2RlZCBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzIHRvCiAgKiBjb252ZXJ0IHRvIFVuaWNvZGUuCiAgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgVW5pY29kZSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gUHVueWNvZGUKICAqIHN0cmluZy4KICAqLwoJZnVuY3Rpb24gdG9Vbmljb2RlKGlucHV0KSB7CgkJcmV0dXJuIG1hcERvbWFpbihpbnB1dCwgZnVuY3Rpb24gKHN0cmluZykgewoJCQlyZXR1cm4gcmVnZXhQdW55Y29kZS50ZXN0KHN0cmluZykgPyBkZWNvZGUoc3RyaW5nLnNsaWNlKDQpLnRvTG93ZXJDYXNlKCkpIDogc3RyaW5nOwoJCX0pOwoJfQoKCS8qKgogICogQ29udmVydHMgYSBVbmljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzIHRvCiAgKiBQdW55Y29kZS4gT25seSB0aGUgbm9uLUFTQ0lJIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB3aWxsIGJlIGNvbnZlcnRlZCwKICAqIGkuZS4gaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgd2l0aCBhIGRvbWFpbiB0aGF0J3MgYWxyZWFkeSBpbgogICogQVNDSUkuCiAgKiBAbWVtYmVyT2YgcHVueWNvZGUKICAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0byBjb252ZXJ0LCBhcyBhCiAgKiBVbmljb2RlIHN0cmluZy4KICAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBQdW55Y29kZSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gZG9tYWluIG5hbWUgb3IKICAqIGVtYWlsIGFkZHJlc3MuCiAgKi8KCWZ1bmN0aW9uIHRvQVNDSUkoaW5wdXQpIHsKCQlyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbiAoc3RyaW5nKSB7CgkJCXJldHVybiByZWdleE5vbkFTQ0lJLnRlc3Qoc3RyaW5nKSA/ICd4bi0tJyArIGVuY29kZShzdHJpbmcpIDogc3RyaW5nOwoJCX0pOwoJfQoKCS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCS8qKiBEZWZpbmUgdGhlIHB1YmxpYyBBUEkgKi8KCXB1bnljb2RlID0gewoJCS8qKgogICAqIEEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBQdW55Y29kZS5qcyB2ZXJzaW9uIG51bWJlci4KICAgKiBAbWVtYmVyT2YgcHVueWNvZGUKICAgKiBAdHlwZSBTdHJpbmcKICAgKi8KCQkndmVyc2lvbic6ICcxLjMuMicsCgkJLyoqCiAgICogQW4gb2JqZWN0IG9mIG1ldGhvZHMgdG8gY29udmVydCBmcm9tIEphdmFTY3JpcHQncyBpbnRlcm5hbCBjaGFyYWN0ZXIKICAgKiByZXByZXNlbnRhdGlvbiAoVUNTLTIpIHRvIFVuaWNvZGUgY29kZSBwb2ludHMsIGFuZCBiYWNrLgogICAqIEBzZWUgPGh0dHBzOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nPgogICAqIEBtZW1iZXJPZiBwdW55Y29kZQogICAqIEB0eXBlIE9iamVjdAogICAqLwoJCSd1Y3MyJzogewoJCQknZGVjb2RlJzogdWNzMmRlY29kZSwKCQkJJ2VuY29kZSc6IHVjczJlbmNvZGUKCQl9LAoJCSdkZWNvZGUnOiBkZWNvZGUsCgkJJ2VuY29kZSc6IGVuY29kZSwKCQkndG9BU0NJSSc6IHRvQVNDSUksCgkJJ3RvVW5pY29kZSc6IHRvVW5pY29kZQoJfTsKCgkvKiogRXhwb3NlIGBwdW55Y29kZWAgKi8KCS8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJucwoJLy8gbGlrZSB0aGUgZm9sbG93aW5nOgoJaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBfdHlwZW9mKGRlZmluZS5hbWQpID09ICdvYmplY3QnICYmIGRlZmluZS5hbWQpIHsKCQlkZWZpbmUoJ3B1bnljb2RlJywgZnVuY3Rpb24gKCkgewoJCQlyZXR1cm4gcHVueWNvZGU7CgkJfSk7Cgl9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUpIHsKCQlpZiAobW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMpIHsKCQkJLy8gaW4gTm9kZS5qcywgaW8uanMsIG9yIFJpbmdvSlMgdjAuOC4wKwoJCQlmcmVlTW9kdWxlLmV4cG9ydHMgPSBwdW55Y29kZTsKCQl9IGVsc2UgewoJCQkvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLQoJCQlmb3IgKGtleSBpbiBwdW55Y29kZSkgewoJCQkJcHVueWNvZGUuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHB1bnljb2RlW2tleV0pOwoJCQl9CgkJfQoJfSBlbHNlIHsKCQkvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyCgkJcm9vdC5wdW55Y29kZSA9IHB1bnljb2RlOwoJfQp9KSh1bmRlZmluZWQpOwoKfSkuY2FsbCh0aGlzLHR5cGVvZiBnbG9iYWwgIT09ICJ1bmRlZmluZWQiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDoge30pCn0se31dLDEzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogICAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IGFjdGl2YXRlOwoKdmFyIF9TeW5jaGVyID0gcmVxdWlyZSgnc2VydmljZS1mcmFtZXdvcmsvc3JjL3N5bmNoZXIvU3luY2hlcicpOwoKdmFyIF9TeW5jaGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXIpOwoKdmFyIF91cmlqcyA9IHJlcXVpcmUoJ3VyaWpzJyk7Cgp2YXIgX3VyaWpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VyaWpzKTsKCnZhciBfcG9zaXRpb24gPSByZXF1aXJlKCcuL3Bvc2l0aW9uJyk7Cgp2YXIgX3Bvc2l0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc2l0aW9uKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9Cgp2YXIgTG9jYXRpb25IeXBlcnR5ID0gewogICAgZ2V0Q3VycmVudFBvc2l0aW9uOiBmdW5jdGlvbiBnZXRDdXJyZW50UG9zaXRpb24oKSB7CiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgcmV0dXJuIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oZnVuY3Rpb24gKHBvc2l0aW9uKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShwb3NpdGlvbik7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfSwKICAgIHN0YXJ0UG9zaXRpb25Ccm9hZGNhc3Q6IGZ1bmN0aW9uIHN0YXJ0UG9zaXRpb25Ccm9hZGNhc3Qoc3Vic2NyaWJlcnMpIHsKICAgICAgICB0aGlzLl9zeW5jaGVyLmNyZWF0ZSh0aGlzLl9vYmplY3REZXNjVVJMLCBzdWJzY3JpYmVycywgX3Bvc2l0aW9uMi5kZWZhdWx0KS50aGVuKGZ1bmN0aW9uIChyZXBvcnRlcikgewogICAgICAgICAgICByZXBvcnRlci5vblN1YnNjcmlwdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBldmVudC5hY2NlcHQoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi53YXRjaFBvc2l0aW9uKGZ1bmN0aW9uIChwb3NpdGlvbikgewogICAgICAgICAgICAgICAgcmVwb3J0ZXIuZGF0YS52YWx1ZS5jb29yZHMgPSBwb3NpdGlvbi5jb29yZHM7CiAgICAgICAgICAgICAgICByZXBvcnRlci5kYXRhLnZhbHVlLnRpbWVzdGFtcCA9IHBvc2l0aW9uLnRpbWVzdGFtcDsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9Cn07Cgp2YXIgTG9jYXRpb25IeXBlcnR5RmFjdG9yeSA9IGZ1bmN0aW9uIExvY2F0aW9uSHlwZXJ0eUZhY3RvcnkoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWcpIHsKICAgIHZhciB1cmkgPSBuZXcgX3VyaWpzMi5kZWZhdWx0KGh5cGVydHlVUkwpOwogICAgTG9jYXRpb25IeXBlcnR5Ll9vYmplY3REZXNjVVJMID0gJ2h5cGVydHktY2F0YWxvZ3VlOi8vJyArIHVyaS5ob3N0bmFtZSgpICsgJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hcy9Db250ZXh0RGF0YVNjaGVtYSc7CiAgICBMb2NhdGlvbkh5cGVydHkuX3N5bmNoZXIgPSBuZXcgX1N5bmNoZXIyLmRlZmF1bHQoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWcpOwoKICAgIHJldHVybiBMb2NhdGlvbkh5cGVydHk7Cn07CgpmdW5jdGlvbiBhY3RpdmF0ZShoeXBlcnR5VVJMLCBidXMsIGNvbmZpZykgewogICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAnTG9jYXRpb24gSHlwZXJ0eScsCiAgICAgICAgaW5zdGFuY2U6IExvY2F0aW9uSHlwZXJ0eUZhY3RvcnkoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWcpCiAgICB9Owp9Cgp9LHsiLi9wb3NpdGlvbiI6MTQsInNlcnZpY2UtZnJhbWV3b3JrL3NyYy9zeW5jaGVyL1N5bmNoZXIiOjcsInVyaWpzIjoxMX1dLDE0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogICAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHsKICAgIGlkOiAiTG9jYXRpb25PYmplY3QiLAogICAgdHlwZTogIm9iamVjdCIsCiAgICB2YWx1ZTogewogICAgICAgIGNvb3JkczogewogICAgICAgICAgICBsYXRpdHVkZTogMCwKICAgICAgICAgICAgbG9uZ2l0dWRlOiAwLAogICAgICAgICAgICBhbHRpdHVkZTogMCwKICAgICAgICAgICAgYWNjdXJhY3k6IDAsCiAgICAgICAgICAgIGFsdGl0dWRlQWNjdXJhY3k6IDAsCiAgICAgICAgICAgIGhlYWRpbmc6IDAsCiAgICAgICAgICAgIHNwZWVkOiAwCiAgICAgICAgfSwKICAgICAgICB0aW1lc3RhbXA6IDAKICAgIH0KfTsKCn0se31dfSx7fSxbMTNdKSgxMykKfSk7",
      "sourceCodeClassname": "LocationHyperty",
      "encoding": "base64",
      "signature": ""
    },
    "cguid": 1,
    "type": "Hyperties",
    "version": "0.1",
    "description": "Description of LocationHyperty",
    "objectName": "LocationHyperty",
    "configuration": {},
    "sourcePackageURL": "/sourcePackage",
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "dataObjects": [],
    "accessControlPolicy": "somePolicy"
  },
  "FakeLocationObserverHyperty": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCkuZGVmYXVsdH19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciK28rIiciKTt0aHJvdyBmLmNvZGU9Ik1PRFVMRV9OT1RfRk9VTkQiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgX1N5bmNPYmplY3QgPSByZXF1aXJlKCcuL1N5bmNPYmplY3QnKTsKCnZhciBfU3luY09iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TeW5jT2JqZWN0KTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gcmVxdWlyZSgnLi9EYXRhT2JqZWN0Q2hpbGQnKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7Cgp2YXIgX3V0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMuanMnKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCi8qKgogKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuCiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KICovCgp2YXIgRGF0YU9iamVjdCA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX3ZlcnNpb246IG51bWJlcgogICBfb3duZXI6IEh5cGVydHlVUkwKICBfdXJsOiBPYmplY3RVUkwKICBfc2NoZW1hOiBTY2hlbWEKICBfYnVzOiBNaW5pQnVzCiAgX3N0YXR1czogb24gfCBwYXVzZWQKICBfc3luY09iajogU3luY0RhdGEKICAgX2NoaWxkcmVuOiB7IGlkOiBEYXRhT2JqZWN0Q2hpbGQgfQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCiAgX29uQWRkQ2hpbGRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIgY3JlYXRlIG9yIHN1YnNjcmliZSBtZXRob2QncwogICAqLwoKICBmdW5jdGlvbiBEYXRhT2JqZWN0KHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YU9iamVjdCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fc3luY2hlciA9IHN5bmNoZXI7CiAgICBfdGhpcy5fdXJsID0gdXJsOwogICAgX3RoaXMuX3NjaGVtYSA9IHNjaGVtYTsKICAgIF90aGlzLl9zdGF0dXMgPSBpbml0aWFsU3RhdHVzOwogICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgX1N5bmNPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwogICAgX3RoaXMuX2NoaWxkcmVucyA9IGNoaWxkcmVuczsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRGF0YU9iamVjdCwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgY2hpbGRCYXNlVVJMID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJzsKICAgICAgaWYgKF90aGlzLl9jaGlsZHJlbnMpIHsKICAgICAgICBfdGhpcy5fY2hpbGRyZW5zLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgICB2YXIgY2hpbGRVUkwgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsKICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hpbGRVUkwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgogICAgICAgICAgICBpZiAobXNnLmZyb20gIT09IF90aGlzMi5fb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdC1DaGlsZHJlbi1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzoKICAgICAgICAgICAgICAgICAgX3RoaXMuX29uQ2hpbGRDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICBfdGhpcy5fY2hhbmdlQ2hpbGRyZW4obXNnKTticmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikgewogICAgICAgIGxpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9KTsKCiAgICAgIE9iamVjdC5rZXlzKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKICAgICAqIEB0eXBlIHtPYmplY3RVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncGF1c2UnLAoKCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdG9wJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgY2hpbGRyZW4gdG8gdGhlIHN1YnNjcmlwdGlvbiBncm91cC4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXNvdXJjZSAtIFJlc291cmNlIG5hbWUsIG9uZSBvZiB0aGUgaXRlbXMgaW4gdGhlIHNjaGVtYS5wcm9wZXJ0aWVzLnNjaGVtZSBvZiB0aGUgcGFyZW50IG9iamVjdC4KICAgICAqIEBwYXJhbSB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIGNoaWxkCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RDaGlsZD59IC0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgQ2hpbGRyZW4uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKHJlc291cmNlLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIHJlc291cmNlOwoKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICB2YXIgbXNnSWQgPSBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2cpOwoKICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRlLXJlcG9ydGVyLWNoaWxkKCAnICsgX3RoaXMuX293bmVyICsgJyApOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB2YXIgbmV3Q2hpbGQgPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgbXNnQ2hpbGRJZCwgaW5pdGlhbERhdGEsIF90aGlzLl9vd25lciwgbXNnSWQpOwogICAgICAgIG5ld0NoaWxkLm9uQ2hhbmdlKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgX3RoaXMuX29uQ2hhbmdlKGV2ZW50LCB7IHBhdGg6IG1zZ0NoaWxkUGF0aCwgY2hpbGRJZDogbXNnQ2hpbGRJZCB9KTsKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKICAgICAgICByZXNvbHZlKG5ld0NoaWxkKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBjcmVhdGUgYW5kIGRlbGV0ZSBjaGlsZHJlbnMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkFkZENoaWxkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkFkZENoaWxkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uQ2hpbGRDcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoaWxkQ3JlYXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwoKICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1vYnNlcnZlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgbXNnKTsKICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIG1zZy5ib2R5LnZhbHVlKTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIGZyb206IG1zZy5mcm9tLAogICAgICAgIHVybDogbXNnLnRvLAogICAgICAgIHZhbHVlOiBtc2cuYm9keS52YWx1ZSwKICAgICAgICBjaGlsZElkOiBtc2dDaGlsZElkLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdBREQtQ0hJTERSRU4tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9zZW5kIGRlbHRhIG1lc3NhZ2VzIHRvIHN1YnNjcmlwdGlvbnMKCiAgfSwgewogICAga2V5OiAnX29uQ2hhbmdlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2UoZXZlbnQsIGNoaWxkSW5mbykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKCiAgICAgIGlmIChfdGhpcy5fc3RhdHVzID09PSAnb24nKSB7CiAgICAgICAgdmFyIGNoYW5nZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCiAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CiAgICAgICAgfTsKCiAgICAgICAgaWYgKGV2ZW50Lm9UeXBlID09PSBfU3luY09iamVjdC5PYmplY3RUeXBlLk9CSkVDVCkgewogICAgICAgICAgaWYgKGV2ZW50LmNUeXBlICE9PSBfU3luY09iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1N5bmNPYmplY3QuQ2hhbmdlVHlwZS5VUERBVEUpIHsKICAgICAgICAgICAgY2hhbmdlTXNnLmJvZHkub3BlcmF0aW9uID0gZXZlbnQuY1R5cGU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL2NoaWxkSW5mbyBtdXN0IGhhdmUgKHBhdGgsIGNoaWxkSWQpCiAgICAgICAgaWYgKGNoaWxkSW5mbykgewogICAgICAgICAgY2hhbmdlTXNnLnRvID0gY2hpbGRJbmZvLnBhdGg7CiAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5yZXNvdXJjZSA9IGNoaWxkSW5mby5jaGlsZElkOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShjaGFuZ2VNc2cpOwogICAgICB9CiAgICB9CgogICAgLy9yZWNlaXZlIGFuZCBwcm9jZXNzIGRlbHRhIG1lc3NhZ2VzCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwogICAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gPwogICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKICAgICAgICB2YXIgcGF0aCA9IG1zZy5ib2R5LmF0dHJpYnV0ZTsKICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwogICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKICAgICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gX1N5bmNPYmplY3QuT2JqZWN0VHlwZS5BUlJBWSkgewogICAgICAgICAgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1N5bmNPYmplY3QuQ2hhbmdlVHlwZS5BREQpIHsKICAgICAgICAgICAgdmFyIGFyciA9IGZpbmRSZXN1bHQub2JqOwogICAgICAgICAgICB2YXIgaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuYXBwbHkoYXJyLCBbaW5kZXgsIDBdLmNvbmNhdCh2YWx1ZSkpOwogICAgICAgICAgfSBlbHNlIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9TeW5jT2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIHZhciBfYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAobXNnLmJvZHkudmFsdWUpIHsKICAgICAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURSBvciBBREQKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRlbGV0ZSBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdOyAvLyBSRU1PVkUKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CiAgICAgICAgICBjb25zb2xlLmxvZygnVU5TWU5DSFJPTklaRUQgVkVSU0lPTjogKGRhdGEgPT4gJyArIF90aGlzLl92ZXJzaW9uICsgJywgbXNnID0+ICcgKyBtc2cuYm9keS52ZXJzaW9uICsgJyknKTsKICAgICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX2NoYW5nZUNoaWxkcmVuJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hhbmdlQ2hpbGRyZW4obXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGNvbnNvbGUubG9nKCdDaGFuZ2UgY2hpbGRyZW46ICcsIF90aGlzLl9vd25lciwgbXNnKTsKCiAgICAgIHZhciBjaGlsZElkID0gbXNnLmJvZHkucmVzb3VyY2U7CiAgICAgIHZhciBjaGlsZHJlbiA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF07CgogICAgICBpZiAoY2hpbGRyZW4pIHsKICAgICAgICBfdGhpcy5fY2hhbmdlT2JqZWN0KGNoaWxkcmVuLl9zeW5jT2JqLCBtc2cpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCdObyBjaGlsZHJlbiBmb3VuZCBmb3I6ICcsIGNoaWxkSWQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAndXJsJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fdXJsOwogICAgfQoKICAgIC8qKgogICAgICogT2JqZWN0IHNjaGVtYSBVUkwgKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U2NoZW1hVVJMfQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3NjaGVtYScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtYTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0YXR1cyBvZiB0aGUgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIgY29ubmVjdGlvbiAodGhpcyBmaWVsZCBpcyBub3QgeWV0IHN0YWJsZSwgYW5kIGlzIHN1YnNqZWN0IHRvIGNoYW5nZSkKICAgICAqIEB0eXBlIHtTdGF0dXN9IC0gRW51bSBvZjogb24gfCBwYXVzZWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdGF0dXMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdGF0dXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBEYXRhIHN0cnVjdHVyZSB0byBiZSBzeW5jaHJvbml6ZWQuCiAgICAgKiBAdHlwZSB7SlNPTn0gLSBKU09OIHN0cnVjdHVyZSB0aGF0IHNob3VsZCBmb2xsb3cgdGhlIGRlZmluZWQgc2NoZW1hLCBpZiBhbnkuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGF0YScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N5bmNPYmouZGF0YTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbCBjcmVhdGVkIGNoaWxkcmVuJ3Mgc2luY2UgdGhlIHN1YnNjcmlwdGlvbiwgZG9lc24ndCBjb250YWluIGFsbCBjaGlsZHJlbidzIHNpbmNlIHJlcG9ydGVyIGNyZWF0aW9uLgogICAgICogQHR5cGUge09iamVjdDxDaGlsZElkLCBEYXRhT2JqZWN0Q2hpbGQ+fQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVucycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuT2JqZWN0czsKICAgIH0KICB9XSk7CgogIHJldHVybiBEYXRhT2JqZWN0Owp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0OwoKfSx7Ii4uL3V0aWxzL3V0aWxzLmpzIjo4LCIuL0RhdGFPYmplY3RDaGlsZCI6MiwiLi9TeW5jT2JqZWN0Ijo2fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnZhciBfU3luY09iamVjdCA9IHJlcXVpcmUoJy4vU3luY09iamVjdCcpOwoKdmFyIF9TeW5jT2JqZWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiAqIFRoZSBjbGFzcyByZXR1cm5lZCBmcm9tIHRoZSBEYXRhT2JqZWN0IGFkZENoaWxkcmVuIGNhbGwgb3IgZnJvbSBvbkFkZENoaWxkcmVuIGlmIHJlbW90ZWx5IGNyZWF0ZWQuCiAqIENoaWxkcmVuIG9iamVjdCBzeW5jaHJvbml6YXRpb24gaXMgYSBhIGZhc3QgZm9yd2FyZCBtZWNoYW5pc20sIG5vIG5lZWQgZm9yIGRpcmVjdCBzdWJzY3JpcHRpb25zLCBpdCB1c2VzIHRoZSBhbHJlYWR5IGF1dGhvcml6ZWQgc3Vic2NyaXB0aW9uIGZyb20gdGhlIHBhcmVudCBEYXRhT2JqZWN0LgogKi8KCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCiAgICovCgogIGZ1bmN0aW9uIERhdGFPYmplY3RDaGlsZChwYXJlbnQsIGNoaWxkSWQsIGluaXRpYWxEYXRhLCBvd25lciwgbXNnSWQpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEYXRhT2JqZWN0Q2hpbGQpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3BhcmVudCA9IHBhcmVudDsKICAgIF90aGlzLl9jaGlsZElkID0gY2hpbGRJZDsKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX21zZ0lkID0gbXNnSWQ7CgogICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgX1N5bmNPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwoKICAgIF90aGlzLl9idXMgPSBwYXJlbnQuX2J1czsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERhdGFPYmplY3RDaGlsZCwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy90aGlzIGlzIG9ubHkgbmVlZGVkIGZvciBjaGlsZHJlbiByZXBvcnRlcnMKICAgICAgaWYgKF90aGlzLl9vd25lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX293bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICBpZiAobXNnLnR5cGUgPT09ICdyZXNwb25zZScgJiYgbXNnLmlkID09PSBfdGhpcy5fbXNnSWQpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RDaGlsZC5vblJlc3BvbnNlOicsIG1zZyk7CiAgICAgICAgICAgIF90aGlzLl9vblJlc3BvbnNlKG1zZyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX2xpc3RlbmVyKSB7CiAgICAgICAgX3RoaXMuX2xpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBkZWxldGUgX3RoaXMuX3BhcmVudC5fY2hpbGRyZW5bX3RoaXMuX2NoaWxkSWRdOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgIC8vVE9ETzogc2VuZCBkZWxldGUgbWVzc2FnZSA/CiAgICB9CgogICAgLyoqCiAgICAgKiBDaGlsZHJlbiBJRCBnZW5lcmF0ZWQgb24gYWRkQ2hpbGRyZW4uIFVuaXF1ZSBpZGVudGlmaWVyCiAgICAgKiBAdHlwZSB7VVJMfSAtIFVSTCBvZiB0aGUgZm9ybWF0IDxIeXBlcnR5VVJMPiM8bnVtZXJpYy1zZXF1ZW5jZT4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCgoKICAgIC8qKgogICAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIgY2hpbGQKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjYWxsYmFjayhldmVudCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVzcG9uc2Ugbm90aWZpY2F0aW9ucyBvZiB0aGUgY3JlYXRlcwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZElkJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIERhdGFPYmplY3RDaGlsZDsKfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdENoaWxkOwoKfSx7Ii4vU3luY09iamVjdCI6Nn1dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07Cgp2YXIgX0RhdGFPYmplY3QyID0gcmVxdWlyZSgnLi9EYXRhT2JqZWN0Jyk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQgPSByZXF1aXJlKCcuL0RhdGFPYmplY3RDaGlsZCcpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikgPyBjYWxsIDogc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgRmlsdGVyVHlwZSA9IHsgQU5ZOiAnYW55JywgU1RBUlQ6ICdzdGFydCcsIEVYQUNUOiAnZXhhY3QnIH07CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgc3Vic2NyaWJlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYW4gb2JzZXJ2YXRpb24gcG9pbnQgZnJvbSBhIERhdGFPYmplY3RSZXBvcnRlciBjaGFuZ2UuCiAqLwoKdmFyIERhdGFPYmplY3RPYnNlcnZlciA9IGZ1bmN0aW9uIChfRGF0YU9iamVjdCkgewogIF9pbmhlcml0cyhEYXRhT2JqZWN0T2JzZXJ2ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9jaGFuZ2VMaXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9maWx0ZXJzOiB7PGZpbHRlcj46IHt0eXBlOiA8c3RhcnQsIGV4YWN0PiwgY2FsbGJhY2s6IDxmdW5jdGlvbj59IH0KICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuc3Vic2NyaWJlIG1ldGhvZAogICAqLwoKICBmdW5jdGlvbiBEYXRhT2JqZWN0T2JzZXJ2ZXIoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMsIGluaXRpYWxWZXJzaW9uKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKERhdGFPYmplY3RPYnNlcnZlcikuY2FsbCh0aGlzLCBzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEuZGF0YSwgY2hpbGRyZW5zKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl92ZXJzaW9uID0gaW5pdGlhbFZlcnNpb247CiAgICBfdGhpcy5fZmlsdGVycyA9IHt9OwoKICAgIF90aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIF90aGlzLl9vbkZpbHRlcihldmVudCk7CiAgICB9KTsKCiAgICAvL3NldHVwIGNoaWxkcmVucyBkYXRhIGZyb20gc3Vic2NyaXB0aW9uCiAgICBPYmplY3Qua2V5cyhpbml0aWFsRGF0YS5jaGlsZHJlbnMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERhdGFPYmplY3RPYnNlcnZlciwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIucmVtb3ZlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3Vuc3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciB1blN1YnNjcmliZU1zZyA9IHsKICAgICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IF90aGlzLl91cmwgfQogICAgICB9OwoKICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh1blN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci1VTlNVQlNDUklCRTogJywgcmVwbHkpOwogICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fb2JzZXJ2ZXJzW190aGlzLl91cmxdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWdpc3RlciB0aGUgY2hhbmdlIGxpc3RlbmVycyBzZW50IGJ5IHRoZSByZXBvcnRlcgogICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbHRlciAtIEZpbHRlciB0aGF0IGlkZW50aWZpZXMgdGhlIGZpZWxkIChzZXBhcmV0ZWQgZG90IHBhdGgpLiBBY2NlcHRzICogYXQgdGhlIGVuZCBmb3IgYSBtb3JlIHVucmVzdHJpY3RlZCBmaWx0ZXJpbmcuCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGZpbHRlciwgY2FsbGJhY2spIHsKICAgICAgdmFyIGtleSA9IGZpbHRlcjsKICAgICAgdmFyIGZpbHRlck9iaiA9IHsKICAgICAgICB0eXBlOiBGaWx0ZXJUeXBlLkVYQUNULAogICAgICAgIGNhbGxiYWNrOiBjYWxsYmFjawogICAgICB9OwoKICAgICAgdmFyIGlkeCA9IGZpbHRlci5pbmRleE9mKCcqJyk7CiAgICAgIGlmIChpZHggPT09IGZpbHRlci5sZW5ndGggLSAxKSB7CiAgICAgICAgaWYgKGlkeCA9PT0gMCkgewogICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLkFOWTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLlNUQVJUOwogICAgICAgICAga2V5ID0gZmlsdGVyLnN1YnN0cigwLCBmaWx0ZXIubGVuZ3RoIC0gMSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLl9maWx0ZXJzW2tleV0gPSBmaWx0ZXJPYmo7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uRmlsdGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25GaWx0ZXIoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIE9iamVjdC5rZXlzKF90aGlzLl9maWx0ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICB2YXIgZmlsdGVyID0gX3RoaXMuX2ZpbHRlcnNba2V5XTsKICAgICAgICBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuQU5ZKSB7CiAgICAgICAgICAvL21hdGNoIGFueXRoaW5nCiAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuU1RBUlQpIHsKICAgICAgICAgIC8vaWYgc3RhcnRzIHdpdGggZmlsdGVyLi4uCiAgICAgICAgICBpZiAoZXZlbnQuZmllbGQuaW5kZXhPZihrZXkpID09PSAwKSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5FWEFDVCkgewogICAgICAgICAgLy9leGFjdCBtYXRjaAogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkID09PSBrZXkpIHsKICAgICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwoKfSx7Ii4vRGF0YU9iamVjdCI6MSwiLi9EYXRhT2JqZWN0Q2hpbGQiOjJ9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7Cgp2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9OwoKdmFyIF9EYXRhT2JqZWN0MiA9IHJlcXVpcmUoJy4vRGF0YU9iamVjdCcpOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscy91dGlscy5qcycpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBjcmVhdGUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhIHJlcG9ydGVyIHBvaW50LCBjaGFuZ2VzIHdpbGwgYmUgc3VibWl0ZWQgdG8gRGF0YU9iamVjdE9ic2VydmVyIGluc3RhbmNlcy4KICovCgp2YXIgRGF0YU9iamVjdFJlcG9ydGVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgX2luaGVyaXRzKERhdGFPYmplY3RSZXBvcnRlciwgX0RhdGFPYmplY3QpOwoKICAvKiBwcml2YXRlCiAgX3N1YnNjcmlwdGlvbnM6IDxoeXBlcnR5VXJsOiB7IHN0YXR1czogc3RyaW5nIH0gfT4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblN1YnNjcmlwdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLmNyZWF0ZSBtZXRob2QKICAgKi8KCiAgZnVuY3Rpb24gRGF0YU9iamVjdFJlcG9ydGVyKHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKERhdGFPYmplY3RSZXBvcnRlcikuY2FsbCh0aGlzLCBzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fc3Vic2NyaXB0aW9ucyA9IHt9OwoKICAgIF90aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItJyArIHVybCArICctU0VORDogJywgZXZlbnQpOwogICAgICBfdGhpcy5fb25DaGFuZ2UoZXZlbnQpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERhdGFPYmplY3RSZXBvcnRlciwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fcmVzcG9uc2VMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJykgewogICAgICAgICAgX3RoaXMuX29uUmVzcG9uc2UobXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fcmVzcG9uc2VMaXN0ZW5lci5yZW1vdmUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdpbnZpdGVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGludml0ZU9ic2VydmVycyhvYnNlcnZlcnMpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBpbnZpdGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9zeW5jaGVyLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCwgc2NoZW1hOiBfdGhpcy5fc2NoZW1hLCB2YWx1ZTogX3RoaXMuX3N5bmNPYmouZGF0YSwgYXV0aG9yaXNlOiBvYnNlcnZlcnMgfQogICAgICB9OwoKICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShpbnZpdGVNc2cpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGRlbGV0ZU1zZyA9IHsKICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZGVsZXRlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLURFTEVURTogJywgcmVwbHkpOwogICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fcmVwb3J0ZXJzW190aGlzLl91cmxdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdWJzY3JpcHRpb25zIHJlcXVlc3RlZCBhbmQgYWNjZXB0ZWQgdG8gdGhpcyByZXBvcnRlcgogICAgICogQHR5cGUge09iamVjdDxIeXBlcnR5VVJMLCBTeW5jU3Vic2NyaXB0aW9uPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblN1YnNjcmlwdGlvbicsCgoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3Mgc3Vic2NyaWJlIGFuZCB1bnN1YnNjcmliZSBub3RpZmljYXRpb25zCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvblN1YnNjcmlwdGlvbihjYWxsYmFjaykgewogICAgICB0aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZSdzCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNwb25zZShjYWxsYmFjaykgewogICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblN1YnNjcmliZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy5ib2R5LnR5cGUsCiAgICAgICAgdXJsOiBoeXBlcnR5VXJsLAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgT2JqZWN0LmtleXMoX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRJZCkgewogICAgICAgICAgICB2YXIgY2hpbGREYXRhID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXS5kYXRhOwogICAgICAgICAgICBjaGlsZHJlblZhbHVlc1tjaGlsZElkXSA9ICgwLCBfdXRpbHMuZGVlcENsb25lKShjaGlsZERhdGEpOwogICAgICAgICAgfSk7CgogICAgICAgICAgLy9zZW5kIG9rIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmVyc2lvbjogX3RoaXMuX3ZlcnNpb24sIHZhbHVlOiB7IGRhdGE6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSwgY2hpbGRyZW5zOiBjaGlsZHJlblZhbHVlcyB9IH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19vblVuU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25VblN1YnNjcmliZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwoKICAgICAgdmFyIHN1YiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdOwogICAgICBkZWxldGUgX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLmJvZHkudHlwZSwKICAgICAgICB1cmw6IGh5cGVydHlVcmwsCiAgICAgICAgb2JqZWN0OiBzdWIKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1VOLVNVQlNDUklQVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlc3BvbnNlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdSRVNQT05TRS1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdzdWJzY3JpcHRpb25zJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaXB0aW9uczsKICAgIH0KICB9XSk7CgogIHJldHVybiBEYXRhT2JqZWN0UmVwb3J0ZXI7Cn0oX0RhdGFPYmplY3QzLmRlZmF1bHQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RSZXBvcnRlcjsKCn0seyIuLi91dGlscy91dGlscy5qcyI6OCwiLi9EYXRhT2JqZWN0IjoxfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8qKgogKiBAYWNjZXNzIHByaXZhdGUKICovCgp2YXIgRGF0YVByb3Zpc2lvbmFsID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfY2hpbGRyZW5MaXN0ZW5lcnM6IFtNc2dMaXN0ZW5lcl0KICBfbGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIF9jaGFuZ2VzOiBbXQogICovCgogIGZ1bmN0aW9uIERhdGFQcm92aXNpb25hbChvd25lciwgdXJsLCBidXMsIGNoaWxkcmVuKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YVByb3Zpc2lvbmFsKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9idXMgPSBidXM7CiAgICBfdGhpcy5fY2hpbGRyZW4gPSBjaGlsZHJlbjsKCiAgICBfdGhpcy5fY2hhbmdlcyA9IFtdOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsKICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOyovCiAgICB9CiAgfSwgewogICAga2V5OiAnYXBwbHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5KG9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgIG9ic2VydmVyLl9jaGFuZ2VPYmplY3Qob2JzZXJ2ZXIuX3N5bmNPYmosIGNoYW5nZSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVuJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRGF0YVByb3Zpc2lvbmFsOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhUHJvdmlzaW9uYWw7Cgp9LHt9XSw2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk9iamVjdFR5cGUgPSBleHBvcnRzLkNoYW5nZVR5cGUgPSB1bmRlZmluZWQ7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgX3V0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMuanMnKTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKi8KCnZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgIF9kYXRhOiBhbnk7CiAgICBfb2JzZXJ2ZXJzOiAoKGV2ZW50OiBDaGFuZ2VFdmVudCkgPT4gdm9pZClbXQogICovCgogIGZ1bmN0aW9uIFN5bmNPYmplY3QoaW5pdGlhbERhdGEpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTeW5jT2JqZWN0KTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vYnNlcnZlcnMgPSBbXTsKICAgIF90aGlzLl9maWx0ZXJzID0ge307CgogICAgaWYgKGluaXRpYWxEYXRhKSB7CiAgICAgIF90aGlzLl9kYXRhID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGluaXRpYWxEYXRhKTsKICAgIH0gZWxzZSB7CiAgICAgIF90aGlzLl9kYXRhID0ge307CiAgICB9CgogICAgX3RoaXMuX2ludGVybmFsT2JzZXJ2ZShuZXcgUGF0aCgpLCBfdGhpcy5fZGF0YSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU3luY09iamVjdCwgW3sKICAgIGtleTogJ29ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocGF0aCkgewogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCiAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmRCZWZvcmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCZWZvcmUocGF0aCkgewogICAgICB2YXIgcmVzdWx0ID0ge307CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwogICAgICByZXN1bHQubGFzdCA9IGxpc3QucG9wKCk7CiAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRXaXRoU3BsaXQobGlzdCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG9iaiA9IG9ialt2YWx1ZV07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmlyZUV2ZW50JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlyZUV2ZW50KGV2ZW50KSB7CiAgICAgIHRoaXMuX29ic2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgICAgIGNhbGxiYWNrKGV2ZW50KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2lzT2JzZXJ2YWJsZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2lzT2JzZXJ2YWJsZShvYmopIHsKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0IHx8IG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogJ19pbnRlcm5hbE9ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbE9ic2VydmUocGF0aCwgb2JqKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX2lzT2JzZXJ2YWJsZShvYmopKSB7CiAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKGNoYW5nZXMpIHsKICAgICAgICAgIF90aGlzLl9vbkNoYW5nZXMocGF0aCwgY2hhbmdlcyk7CiAgICAgICAgfTsKCiAgICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgICBPYmplY3Qub2JzZXJ2ZShvYmosIGhhbmRsZXIpOwogICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHsKICAgICAgICAgICAgaWYgKF90aGlzLl9pc09ic2VydmFibGUob2JqW3Byb3BdKSkgewogICAgICAgICAgICAgIF90aGlzLl9pbnRlcm5hbE9ic2VydmUocGF0aC5uZXcocHJvcCksIG9ialtwcm9wXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKICAgICAgICAgIEFycmF5Lm9ic2VydmUob2JqLCBoYW5kbGVyKTsKICAgICAgICAgIGZvciAodmFyIF9wcm9wIGluIG9iaikgewogICAgICAgICAgICBpZiAoX3RoaXMuX2lzT2JzZXJ2YWJsZShvYmpbX3Byb3BdKSkgewogICAgICAgICAgICAgIHZhciBucCA9IHBhdGgubmV3KG5ldyBBcnJheUluZGV4KG9ialtfcHJvcF0sIF9wcm9wKSk7CiAgICAgICAgICAgICAgX3RoaXMuX2ludGVybmFsT2JzZXJ2ZShucCwgb2JqW19wcm9wXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKHBhdGgsIGNoYW5nZXMpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBmb3IgKHZhciBpIGluIGNoYW5nZXMpIHsKICAgICAgICB2YXIgb2JqID0gY2hhbmdlc1tpXS5vYmplY3Q7CiAgICAgICAgdmFyIG9ialR5cGUgPSB2b2lkIDA7CgogICAgICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IE9iamVjdCkgewogICAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICAgIH0KCiAgICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKICAgICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNoYW5nZXNbaV0udHlwZSA9PT0gJ3NwbGljZScpIHsKICAgICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBpZHggPSBjaGFuZ2VzW2ldLmluZGV4OwogICAgICAgICAgICB2YXIgZmllbGQgPSBwYXRoLm5ldygnJyArIGlkeCk7CiAgICAgICAgICAgIHZhciBmaWVsZFN0cmluZyA9IGZpZWxkLnRvU3RyaW5nKCk7CgogICAgICAgICAgICB2YXIgcmVtb3ZlU2l6ZSA9IGNoYW5nZXNbaV0ucmVtb3ZlZC5sZW5ndGg7CiAgICAgICAgICAgIGlmIChyZW1vdmVTaXplICE9PSAwKSB7CiAgICAgICAgICAgICAgdmFyIHJlbW92ZVZhbHVlcyA9IGNoYW5nZXNbaV0ucmVtb3ZlZDsKICAgICAgICAgICAgICByZW1vdmVWYWx1ZXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9pc09ic2VydmFibGUodmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgIHBhdGgucmVtb3ZlSW5kZXgoaWR4ICsgaW5kZXgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBfdGhpczIuX2ZpcmVFdmVudCh7CiAgICAgICAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5SRU1PVkUsCiAgICAgICAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgICAgICAgIGRhdGE6IHJlbW92ZVNpemUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGFkZFNpemUgPSBjaGFuZ2VzW2ldLmFkZGVkQ291bnQ7CiAgICAgICAgICAgIGlmIChhZGRTaXplICE9PSAwKSB7CiAgICAgICAgICAgICAgdmFyIGFkZFZhbHVlcyA9IG9iai5zbGljZShpZHgsIGlkeCArIGFkZFNpemUpOwogICAgICAgICAgICAgIGFkZFZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHsKICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX2lzT2JzZXJ2YWJsZSh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgdmFyIG5wID0gcGF0aC5uZXcobmV3IEFycmF5SW5kZXgodmFsdWUsIGlkeCArIGluZGV4KSk7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5faW50ZXJuYWxPYnNlcnZlKG5wLCB2YWx1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF90aGlzMi5fZmlyZUV2ZW50KHsKICAgICAgICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLkFERCwKICAgICAgICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAogICAgICAgICAgICAgICAgZGF0YTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKGFkZFZhbHVlcykKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9yZS1kZWZpbmUgcGF0aHMuLi4KICAgICAgICAgICAgaWYgKGlkeCAhPT0gb2JqLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICBwYXRoLnJlSW5kZXhGcm9tKG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBfZmllbGQgPSBwYXRoLm5ldyhjaGFuZ2VzW2ldLm5hbWUpOwogICAgICAgICAgdmFyIF9maWVsZFN0cmluZyA9IF9maWVsZC50b1N0cmluZygpOwoKICAgICAgICAgIGlmIChfZmllbGRTdHJpbmcuaW5kZXhPZignU3ltYm9sJykgIT09IC0xKSB7CiAgICAgICAgICAgIC8vaGFjayBmb3IgUGhhbnRvbUpTMgogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdTWU1CT0w6ICcsIGNoYW5nZXNbaV0pOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICAvL2xldCBvbGRWYWx1ZSA9IGNoYW5nZXNbaV0ub2xkVmFsdWU7CiAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlc1tpXS5uYW1lXTsKICAgICAgICAgIGlmIChjaGFuZ2VzW2ldLnR5cGUgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuVVBEQVRFLAogICAgICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgICAgIGZpZWxkOiBfZmllbGRTdHJpbmcsCiAgICAgICAgICAgICAgZGF0YTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKG5ld1ZhbHVlKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY2hhbmdlc1tpXS50eXBlID09PSAnYWRkJykgewogICAgICAgICAgICB0aGlzLl9pbnRlcm5hbE9ic2VydmUoX2ZpZWxkLCBuZXdWYWx1ZSk7CiAgICAgICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAogICAgICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgICAgIGZpZWxkOiBfZmllbGRTdHJpbmcsCiAgICAgICAgICAgICAgZGF0YTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKG5ld1ZhbHVlKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY2hhbmdlc1tpXS50eXBlID09PSAnZGVsZXRlJykgewogICAgICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlJFTU9WRSwKICAgICAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgICAgICBmaWVsZDogX2ZpZWxkU3RyaW5nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kYXRhOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFN5bmNPYmplY3Q7Cn0oKTsKCi8vZHluYW1pYyBwYXRoIGZvciBBcnJheSBpbmRleC4uLgoKCnZhciBQYXRoID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFBhdGgoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGF0aCk7CgogICAgdGhpcy5fcGF0aCA9IFtdOwogICAgdGhpcy5fb2JzZXJ2YWJsZXMgPSB7fTsgLy88aW5kZXg6QXJyYXlJbmRleD4KICB9CgogIF9jcmVhdGVDbGFzcyhQYXRoLCBbewogICAga2V5OiAncmVtb3ZlSW5kZXgnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUluZGV4KGlkeCkgewogICAgICAvL2NvbnNvbGUubG9nKCdSRU1PVkUtUEFUSCAnICsgaWR4KTsKICAgICAgZGVsZXRlIHRoaXMuX29ic2VydmFibGVzW2lkeF07CiAgICB9CiAgfSwgewogICAga2V5OiAncmVJbmRleEZyb20nLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlSW5kZXhGcm9tKGFycmF5KSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgT2JqZWN0LmtleXModGhpcy5fb2JzZXJ2YWJsZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHZhciBhcnJheUluZGV4ID0gX3RoaXMzLl9vYnNlcnZhYmxlc1trZXldOwogICAgICAgIHZhciBpZHggPSBhcnJheS5pbmRleE9mKGFycmF5SW5kZXgub2JqKTsKICAgICAgICBpZiAoYXJyYXlJbmRleC5pZHggIT0gaWR4KSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdSRS1JTkRFWDogJyArIGtleSArICctPicgKyBpZHgpOwogICAgICAgICAgYXJyYXlJbmRleC5pZHggPSBpZHg7CiAgICAgICAgICBkZWxldGUgX3RoaXMzLl9vYnNlcnZhYmxlc1trZXldOwogICAgICAgICAgX3RoaXMzLl9vYnNlcnZhYmxlc1tpZHhdID0gYXJyYXlJbmRleDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ25ldycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX25ldyhpZHgpIHsKICAgICAgaWYgKGlkeC5jb25zdHJ1Y3RvciA9PSBBcnJheUluZGV4KSB7CiAgICAgICAgLy9jb25zb2xlLmxvZygnUEFUSC1PQlNFUlY6ICcsIGlkeCk7CiAgICAgICAgdGhpcy5fb2JzZXJ2YWJsZXNbaWR4LmlkeF0gPSBpZHg7CiAgICAgIH0KCiAgICAgIHZhciBuUGF0aCA9IHRoaXMuY2xvbmUoKTsKICAgICAgblBhdGguX3BhdGgucHVzaChpZHgpOwoKICAgICAgcmV0dXJuIG5QYXRoOwogICAgfQogIH0sIHsKICAgIGtleTogJ2Nsb25lJywKICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHsKICAgICAgdmFyIG5QYXRoID0gbmV3IFBhdGgoKTsKICAgICAgdGhpcy5fcGF0aC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG5QYXRoLl9wYXRoLnB1c2godmFsdWUpOwogICAgICB9KTsKCiAgICAgIHJldHVybiBuUGF0aDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICd0b1N0cmluZycsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgIC8vVE9ETzogb3B0aW1pemUhIQogICAgICB2YXIgc3RyID0gJyc7CiAgICAgIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7CiAgICAgICAgICBzdHIgPSB2YWx1ZS50b1N0cmluZygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdHIgKz0gJy4nICsgdmFsdWUudG9TdHJpbmcoKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHN0cjsKICAgIH0KICB9XSk7CgogIHJldHVybiBQYXRoOwp9KCk7Cgp2YXIgQXJyYXlJbmRleCA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBBcnJheUluZGV4KG9iaiwgaWR4KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXJyYXlJbmRleCk7CgogICAgdGhpcy5vYmogPSBvYmo7CiAgICB0aGlzLmlkeCA9IGlkeDsKICB9CgogIF9jcmVhdGVDbGFzcyhBcnJheUluZGV4LCBbewogICAga2V5OiAndG9TdHJpbmcnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogICAgICByZXR1cm4gdGhpcy5pZHgudG9TdHJpbmcoKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBcnJheUluZGV4Owp9KCk7Cgp2YXIgQ2hhbmdlVHlwZSA9IGV4cG9ydHMuQ2hhbmdlVHlwZSA9IHsgVVBEQVRFOiAndXBkYXRlJywgQUREOiAnYWRkJywgUkVNT1ZFOiAncmVtb3ZlJyB9Owp2YXIgT2JqZWN0VHlwZSA9IGV4cG9ydHMuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAnb2JqZWN0JywgQVJSQVk6ICdhcnJheScgfTsKZXhwb3J0cy5kZWZhdWx0ID0gU3luY09iamVjdDsKCn0seyIuLi91dGlscy91dGlscy5qcyI6OH1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IHJlcXVpcmUoJy4vRGF0YU9iamVjdFJlcG9ydGVyJyk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSByZXF1aXJlKCcuL0RhdGFPYmplY3RPYnNlcnZlcicpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdE9ic2VydmVyKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsID0gcmVxdWlyZSgnLi9EYXRhUHJvdmlzaW9uYWwnKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgovKioKICogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCiAqIFRoZSBTeW5jaGVyIGlzIGEgc2luZ2xldG9uIGNsYXNzIHBlciBIeXBlcnR5L1VSTCBhbmQgaXQgaXMgdGhlIG93bmVyIG9mIGFsbCBjcmVhdGVkIERhdGEgU3luYyBPYmplY3RzIGFjY29yZGluZyB0byB0aGUgUmVwb3J0ZXIgLSBPYnNlcnZlciBwYXR0ZXJuLgogKiBNYWluIGZ1bmN0aW9uYWxpdHkgaXMgdG8gY3JlYXRlIHJlcG9ydGVycyBhbmQgdG8gc3Vic2NyaWJlIHRvIGV4aXN0aW5nIG9uZXMuCiAqLwoKdmFyIFN5bmNoZXIgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9vd25lcjogVVJMCiAgX2J1czogTWluaUJ1cwogICBfc3ViVVJMOiBVUkwKICAgX3JlcG9ydGVyczogPHVybDogRGF0YU9iamVjdFJlcG9ydGVyPgogIF9vYnNlcnZlcnM6IDx1cmw6IERhdGFPYmplY3RPYnNlcnZlcj4KICBfcHJvdmlzaW9uYWxzOiA8dXJsOiBEYXRhUHJvdmlzaW9uYWw+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25Ob3RpZmljYXRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBDb25zdHJ1Y3RvciB0aGF0IHNob3VsZCBiZSB1c2VkIGJ5IHRoZSBIeXBlcnR5IG93bmVyCiAgICogQHBhcmFtIHtIeXBlcnR5VVJMfSBvd25lciAtIEh5cGVydHkgVVJMIG93bmVyLiBBbiBVUkwgYWxsb2NhdGVkIGJ5IHRoZSBydW50aW1lIHRoYXQgdW5pcXVlbHkgaWRlbnRpZmllcyB0aGUgSHlwZXJ0eS4KICAgKiBAcGFyYW0ge01pbmlCdXN9IGJ1cyAtIEFuIGluc3RhbmNlIG9mIHRoZSBNaW5pQnVzIHByb3ZpZGVkIGluIHRoZSBzYW5kYm94LiBXaGVuIGFuIG9iamVjdCAoUmVwb3J0ZXIgb3IgT2JzZXJ2ZWQpIGlzIGNyZWF0ZWQsIHRoZSBTeW5jaGVyTWFuYWdlciB3aWxsIGFkZCBhIGxpc3RlbmVyIGluIHRoZSBNaW5pQnVzIHRvIHJlY2VpdmUvc2VuZCBNZXNzYWdlcyBvZiB0aGF0IG9iamVjdC4KICAgKiBAcGFyYW0ge0pTT059IGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgZm9yIG5vdyBpcyB0aGUgcnVudGltZVVSTC4KICAgKi8KCiAgZnVuY3Rpb24gU3luY2hlcihvd25lciwgYnVzLCBjb25maWcpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTeW5jaGVyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKCiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307CiAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgogICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTeW5jaGVyLVJDVjogJywgbXNnKTsKICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CiAgICAgICAgICBjYXNlICdmb3J3YXJkJzoKICAgICAgICAgICAgX3RoaXMuX29uRm9yd2FyZChtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAnY3JlYXRlJzoKICAgICAgICAgICAgX3RoaXMuX29uUmVtb3RlQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVEZWxldGUobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0KCiAgLyoqCiAgICogVGhlIG93bmVyIG9mIHRoZSBTeW5jaGVyIGFuZCBhbGwgY3JlYXRlZCByZXBvcnRlcnMuCiAgICogQHR5cGUge0h5cGVydHlVUkx9CiAgICovCgoKICBfY3JlYXRlQ2xhc3MoU3luY2hlciwgW3sKICAgIGtleTogJ2NyZWF0ZScsCgoKICAgIC8qKgogICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uCiAgICAgKiBAcGFyYW0gIHtTY2hlbWFVUkx9IHNjaGVtYSAtIFVSTCBvZiB0aGUgb2JqZWN0IGRlc2NyaXB0b3IKICAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgogICAgICogQHBhcmFtICB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIHJlcG9ydGVyCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZShzY2hlbWEsIG9ic2VydmVycywgaW5pdGlhbERhdGEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGluaXRpYWxEYXRhLnJlcG9ydGVyID0gX3RoaXMuX293bmVyOwogICAgICBpbml0aWFsRGF0YS5zY2hlbWEgPSBzY2hlbWE7CgogICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHNjaGVtYTogc2NoZW1hLCB2YWx1ZTogaW5pdGlhbERhdGEsIGF1dGhvcmlzZTogb2JzZXJ2ZXJzIH0KICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgLy9yZXF1ZXN0IGNyZWF0ZSB0byB0aGUgQWxsb2NhdGlvbiBzeXN0ZW0/IENhbiBiZSByZWplY3RlZCBieSB0aGUgUG9saWN5RW5naW5lLgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVxdWVzdE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRlLXJlc3BvbnNlOiAnLCByZXBseSk7CiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICAvL3JlcG9ydGVyIGNyZWF0aW9uIGFjY2VwdGVkCiAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RSZXBvcnRlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsICdvbicsIGluaXRpYWxEYXRhLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3JlcG9ydGVyc1tvYmpVUkxdID0gbmV3T2JqOwoKICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiByZWplY3RlZAogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IG9iamVjdC4KICAgICAqIEBwYXJhbSB7U2NoZW1hVVJMfSBzY2hlbWEgLSBVUkwgb2YgdGhlIG9iamVjdCBkZXNjcmlwdG9yCiAgICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0CiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLgogICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHZhbGlkYXRlIGlmIHN1YnNjcmlwdGlvbiBhbHJlYWR5IGV4aXN0cyA/CiAgICAgIHZhciBzdWJzY3JpYmVNc2cgPSB7CiAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyBzY2hlbWE6IHNjaGVtYSwgcmVzb3VyY2U6IG9ialVSTCB9CiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CiAgICAgICAgICB2YXIgbmV3UHJvdmlzaW9uYWwgPSBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF07CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgaWYgKG5ld1Byb3Zpc2lvbmFsKSBuZXdQcm92aXNpb25hbC5fcmVsZWFzZUxpc3RlbmVycygpOwoKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPCAyMDApIHsKICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwgPSBuZXcgX0RhdGFQcm92aXNpb25hbDIuZGVmYXVsdChfdGhpcy5fb3duZXIsIG9ialVSTCwgX3RoaXMuX2J1cywgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXSA9IG5ld1Byb3Zpc2lvbmFsOwogICAgICAgICAgfSBlbHNlIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0T2JzZXJ2ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCByZXBseS5ib2R5LnZhbHVlLCBuZXdQcm92aXNpb25hbC5jaGlsZHJlbiwgcmVwbHkuYm9keS52ZXJzaW9uKTsKICAgICAgICAgICAgX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdID0gbmV3T2JqOwoKICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbC5hcHBseShuZXdPYmopOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgZXZlbnRzIG9mIHJlbW92ZSBSZXBvcnRlciBvYmplY3RzLgogICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbk5vdGlmaWNhdGlvbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Ob3RpZmljYXRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uRm9yd2FyZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRm9yd2FyZChtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciByZXBvcnRlciA9IF90aGlzLl9yZXBvcnRlcnNbbXNnLmJvZHkudG9dOwogICAgICByZXBvcnRlci5fb25Gb3J3YXJkKG1zZyk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAogICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlRGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVEZWxldGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5ib2R5LnJlc291cmNlOwoKICAgICAgdmFyIG9iamVjdCA9IF90aGlzLl9vYnNlcnZlcnNbcmVzb3VyY2VdOwogICAgICBpZiAob2JqZWN0KSB7CiAgICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgICB1cmw6IHJlc291cmNlLAogICAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICAgIGFjazogZnVuY3Rpb24gYWNrKHR5cGUpIHsKICAgICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgICBpZiAodHlwZSkgewogICAgICAgICAgICAgIGxUeXBlID0gdHlwZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9UT0RPOiBhbnkgb3RoZXIgZGlmZmVyZW50IG9wdGlvbnMgZm9yIHRoZSByZWxlYXNlIHByb2Nlc3MsIGxpa2UgYWNjZXB0IGJ1dCBub3IgcmVsZWFzZSBsb2NhbD8KICAgICAgICAgICAgaWYgKGxUeXBlID09PSAyMDApIHsKICAgICAgICAgICAgICBvYmplY3QuZGVsZXRlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgICBfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgIGJvZHk6IHsgY29kZTogNDA0LCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdvd25lcicsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX293bmVyOwogICAgfQoKICAgIC8qKgogICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUKICAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0UmVwb3J0ZXI+fQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlcG9ydGVycycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3JlcG9ydGVyczsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uCiAgICAgKiBAdHlwZSB7T2JqZWN0PFVSTCwgRGF0YU9iamVjdE9ic2VydmVyPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvYnNlcnZlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZlcnM7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU3luY2hlcjsKfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gU3luY2hlcjsKCn0seyIuL0RhdGFPYmplY3RPYnNlcnZlciI6MywiLi9EYXRhT2JqZWN0UmVwb3J0ZXIiOjQsIi4vRGF0YVByb3Zpc2lvbmFsIjo1fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kaXZpZGVVUkwgPSBkaXZpZGVVUkw7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8qKgogKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsCiAqIEBtb2R1bGUgdXRpbHMKICovCgovKioKICogQHR5cGVkZWYgZGl2aWRlVVJMCiAqIEB0eXBlIE9iamVjdAogKiBAcHJvcGVydHkge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG9mIFVSTAogKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTAogKi8KCi8qKgogKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICogQHBhcmFtICB7VVJMLlVSTH0gdXJsIC0gdXJsIGFkZHJlc3MKICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTAogKi8KZnVuY3Rpb24gZGl2aWRlVVJMKHVybCkgewoKICAvLyBsZXQgcmUgPSAvKFthLXpBLVotXSopPzpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKSooXC9bXC9cZFx3XC4tXSopKig/OltcP10pKiguKykqL2dpOwogIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogIHZhciBzdWJzdCA9ICckMSwkMiwkMyc7CiAgdmFyIHBhcnRzID0gdXJsLnJlcGxhY2UocmUsIHN1YnN0KS5zcGxpdCgnLCcpOwoKICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgaWYgKHBhcnRzWzBdID09PSB1cmwpIHsKICAgIHBhcnRzWzBdID0gJ2h0dHBzJzsKICAgIHBhcnRzWzFdID0gdXJsOwogIH0KCiAgdmFyIHJlc3VsdCA9IHsKICAgIHR5cGU6IHBhcnRzWzBdLAogICAgZG9tYWluOiBwYXJ0c1sxXSwKICAgIGlkZW50aXR5OiBwYXJ0c1syXQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQogKiBAcGFyYW0gIHtPYmplY3R9ICBvYmogLSBvYmplY3QgdG8gYmUgY2xvbmVkCiAqIEByZXR1cm4ge09iamVjdH0KICovCmZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHsKICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uCiAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7Cn0KCn0se31dLDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kZWZhdWx0ID0gYWN0aXZhdGU7Cgp2YXIgX1N5bmNoZXIgPSByZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9zcmMvc3luY2hlci9TeW5jaGVyJyk7Cgp2YXIgX1N5bmNoZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfU3luY2hlcik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKdmFyIEZha2VMb2NhdGlvbk9ic2VydmVySHlwZXJ0eSA9IHsKICAgIHJlY2VpdmVkUG9zaXRpb246IGZhbHNlLAoKICAgIHBvc2l0aW9uOiB1bmRlZmluZWQKfTsKCnZhciBGYWtlTG9hY2F0aW9uRmFjdG9yeSA9IGZ1bmN0aW9uIEZha2VMb2FjYXRpb25GYWN0b3J5KGh5cGVydHlVUkwsIGJ1cywgY29uZmlndXJhdGlvbikgewogICAgdmFyIG9iamVjdERlc2NVUkwgPSAnaHlwZXJ0eS1jYXRhbG9ndWU6Ly9sb2NhbGhvc3QvLndlbGwta25vd24vZGF0YXNjaGVtYXMvTG9jYXRpb25EYXRhU2NoZW1hJzsKICAgIHZhciBzeW5jaGVyID0gbmV3IF9TeW5jaGVyMi5kZWZhdWx0KGh5cGVydHlVUkwsIGJ1cywgY29uZmlndXJhdGlvbik7CgogICAgc3luY2hlci5vbk5vdGlmaWNhdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBldmVudC5hY2soKTsKICAgICAgICBzeW5jaGVyLnN1YnNjcmliZShvYmplY3REZXNjVVJMLCBldmVudC51cmwpLnRoZW4oZnVuY3Rpb24gKG9ic2VydmVyKSB7CiAgICAgICAgICAgIG9ic2VydmVyLm9uQ2hhbmdlKCcqJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICBGYWtlTG9jYXRpb25PYnNlcnZlckh5cGVydHkucmVjZWl2ZWRQb3NpdGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgICBGYWtlTG9jYXRpb25PYnNlcnZlckh5cGVydHkucG9zaXRpb24gPSBldmVudC5kYXRhLmdlb3Bvc2l0aW9uOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0pOwoKICAgIHJldHVybiBGYWtlTG9jYXRpb25PYnNlcnZlckh5cGVydHk7Cn07CgpmdW5jdGlvbiBhY3RpdmF0ZShoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pIHsKICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogJ0Zha2UgbG9jYXRpb24gb2JzZXJ2ZXInLAogICAgICAgIGluc3RhbmNlOiBGYWtlTG9hY2F0aW9uRmFjdG9yeShoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pCiAgICB9Owp9Cgp9LHsic2VydmljZS1mcmFtZXdvcmsvc3JjL3N5bmNoZXIvU3luY2hlciI6N31dfSx7fSxbOV0pKDkpCn0pOw==",
      "sourceCodeClassname": "FakeLocationObserverHyperty",
      "encoding": "base64",
      "signature": ""
    },
    "cguid": 1,
    "type": "Hyperties",
    "version": "0.1",
    "description": "Description of FakeLocationObserverHyperty",
    "objectName": "FakeLocationObserverHyperty",
    "configuration": {},
    "sourcePackageURL": "/sourcePackage",
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "dataObjects": [],
    "accessControlPolicy": "somePolicy"
  },
  "default": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCkuZGVmYXVsdH19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciK28rIiciKTt0aHJvdyBmLmNvZGU9Ik1PRFVMRV9OT1RfRk9VTkQiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgovLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXIKCnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTsKdmFyIHF1ZXVlID0gW107CnZhciBkcmFpbmluZyA9IGZhbHNlOwp2YXIgY3VycmVudFF1ZXVlOwp2YXIgcXVldWVJbmRleCA9IC0xOwoKZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkgewogICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgZHJhaW5pbmcgPSBmYWxzZTsKICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7CiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcXVldWVJbmRleCA9IC0xOwogICAgfQogICAgaWYgKHF1ZXVlLmxlbmd0aCkgewogICAgICAgIGRyYWluUXVldWUoKTsKICAgIH0KfQoKZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHsKICAgIGlmIChkcmFpbmluZykgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChjbGVhblVwTmV4dFRpY2spOwogICAgZHJhaW5pbmcgPSB0cnVlOwoKICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7CiAgICB3aGlsZSAobGVuKSB7CiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7CiAgICAgICAgcXVldWUgPSBbXTsKICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBxdWV1ZUluZGV4ID0gLTE7CiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoOwogICAgfQogICAgY3VycmVudFF1ZXVlID0gbnVsbDsKICAgIGRyYWluaW5nID0gZmFsc2U7CiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7Cn0KCnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7CiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHsKICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTsKICAgICAgICB9CiAgICB9CiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpOwogICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHsKICAgICAgICBzZXRUaW1lb3V0KGRyYWluUXVldWUsIDApOwogICAgfQp9OwoKLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0cwpmdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHsKICAgIHRoaXMuZnVuID0gZnVuOwogICAgdGhpcy5hcnJheSA9IGFycmF5Owp9Ckl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpOwp9Owpwcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInOwpwcm9jZXNzLmJyb3dzZXIgPSB0cnVlOwpwcm9jZXNzLmVudiA9IHt9Owpwcm9jZXNzLmFyZ3YgPSBbXTsKcHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzCnByb2Nlc3MudmVyc2lvbnMgPSB7fTsKCmZ1bmN0aW9uIG5vb3AoKSB7fQoKcHJvY2Vzcy5vbiA9IG5vb3A7CnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wOwpwcm9jZXNzLm9uY2UgPSBub29wOwpwcm9jZXNzLm9mZiA9IG5vb3A7CnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wOwpwcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7CnByb2Nlc3MuZW1pdCA9IG5vb3A7Cgpwcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkgewogICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpOwp9OwoKcHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gJy8nOwp9Owpwcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikgewogICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTsKfTsKcHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAwOwp9OwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CihmdW5jdGlvbiAoZ2xvYmFsKXsKInVzZSBzdHJpY3QiOwoKdmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovLyBEaXN0cmlidXRpb24gZmlsZSBmb3IgSHlwZXJ0eURpc2NvdmVyeS5qcwovLyB2ZXJzaW9uOiAwLjIuMAoKIWZ1bmN0aW9uIChlKSB7CiAgaWYgKCJvYmplY3QiID09ICh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpICYmICJ1bmRlZmluZWQiICE9IHR5cGVvZiBtb2R1bGUpIG1vZHVsZS5leHBvcnRzID0gZSgpO2Vsc2UgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoW10sIGUpO2Vsc2UgewogICAgdmFyIHQ7dCA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgZ2xvYmFsID8gZ2xvYmFsIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIHNlbGYgPyBzZWxmIDogdGhpcywgdC5IeXBlcnR5RGlzY292ZXJ5ID0gZSgpOwogIH0KfShmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIGUodCwgciwgbikgewogICAgZnVuY3Rpb24gbyhjLCBzKSB7CiAgICAgIGlmICghcltjXSkgewogICAgICAgIGlmICghdFtjXSkgewogICAgICAgICAgdmFyIHUgPSAiZnVuY3Rpb24iID09IHR5cGVvZiByZXF1aXJlICYmIHJlcXVpcmU7aWYgKCFzICYmIHUpIHJldHVybiB1KGMsICEwKTtpZiAoaSkgcmV0dXJuIGkoYywgITApO3ZhciBhID0gbmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIgKyBjICsgIiciKTt0aHJvdyBhLmNvZGUgPSAiTU9EVUxFX05PVF9GT1VORCIsIGE7CiAgICAgICAgfXZhciBmID0gcltjXSA9IHsgZXhwb3J0czoge30gfTt0W2NdWzBdLmNhbGwoZi5leHBvcnRzLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIHIgPSB0W2NdWzFdW2VdO3JldHVybiBvKHIgPyByIDogZSk7CiAgICAgICAgfSwgZiwgZi5leHBvcnRzLCBlLCB0LCByLCBuKTsKICAgICAgfXJldHVybiByW2NdLmV4cG9ydHM7CiAgICB9Zm9yICh2YXIgaSA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHJlcXVpcmUgJiYgcmVxdWlyZSwgYyA9IDA7IGMgPCBuLmxlbmd0aDsgYysrKSB7CiAgICAgIG8obltjXSk7CiAgICB9cmV0dXJuIG87CiAgfSh7IDE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL2pzb24vc3RyaW5naWZ5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vanNvbi9zdHJpbmdpZnkiOiA2IH1dLCAyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDcgfV0sIDM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL3Byb21pc2UiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlIjogOCB9XSwgNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgci5fX2VzTW9kdWxlID0gITAsIHJbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfTsKICAgIH0sIHt9XSwgNTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1yLl9fZXNNb2R1bGUgPSAhMDt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksCiAgICAgICAgICBpID0gbihvKTtyWyJkZWZhdWx0Il0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZShlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IHQubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgdmFyIG4gPSB0W3JdO24uZW51bWVyYWJsZSA9IG4uZW51bWVyYWJsZSB8fCAhMSwgbi5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiBuICYmIChuLndyaXRhYmxlID0gITApLCAoMCwgaVsiZGVmYXVsdCJdKShlLCBuLmtleSwgbik7CiAgICAgICAgICB9CiAgICAgICAgfXJldHVybiBmdW5jdGlvbiAodCwgciwgbikgewogICAgICAgICAgcmV0dXJuIHIgJiYgZSh0LnByb3RvdHlwZSwgciksIG4gJiYgZSh0LCBuKSwgdDsKICAgICAgICB9OwogICAgICB9KCk7CiAgICB9LCB7ICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDIgfV0sIDY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKSwKICAgICAgICAgIG8gPSBuLkpTT04gfHwgKG4uSlNPTiA9IHsgc3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeSB9KTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBvLnN0cmluZ2lmeS5hcHBseShvLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy9fY29yZSI6IDE2IH1dLCA3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSIpO3ZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy9fY29yZSIpLk9iamVjdDt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBuLmRlZmluZVByb3BlcnR5KGUsIHQsIHIpOwogICAgICB9OwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy9fY29yZSI6IDE2LCAiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSI6IDcxIH1dLCA4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgZSgiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyIpLCBlKCIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiKSwgZSgiLi4vbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlIiksIGUoIi4uL21vZHVsZXMvZXM2LnByb21pc2UiKSwgdC5leHBvcnRzID0gZSgiLi4vbW9kdWxlcy9fY29yZSIpLlByb21pc2U7CiAgICB9LCB7ICIuLi9tb2R1bGVzL19jb3JlIjogMTYsICIuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIjogNzIsICIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIjogNzMsICIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOiA3NCwgIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSI6IDc1IH1dLCA5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgZSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhIGZ1bmN0aW9uISIpO3JldHVybiBlOwogICAgICB9OwogICAgfSwge31dLCAxMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHt9OwogICAgfSwge31dLCAxMTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBuKSB7CiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIHQpIHx8IHZvaWQgMCAhPT0gbiAmJiBuIGluIGUpIHRocm93IFR5cGVFcnJvcihyICsgIjogaW5jb3JyZWN0IGludm9jYXRpb24hIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDEyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19pcy1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmICghbihlKSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhbiBvYmplY3QhIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7ICIuL19pcy1vYmplY3QiOiAzMyB9XSwgMTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX3RvLWlvYmplY3QiKSwKICAgICAgICAgIG8gPSBlKCIuL190by1sZW5ndGgiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1pbmRleCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0LCByLCBjKSB7CiAgICAgICAgICB2YXIgcywKICAgICAgICAgICAgICB1ID0gbih0KSwKICAgICAgICAgICAgICBhID0gbyh1Lmxlbmd0aCksCiAgICAgICAgICAgICAgZiA9IGkoYywgYSk7aWYgKGUgJiYgciAhPSByKSB7CiAgICAgICAgICAgIGZvciAoOyBhID4gZjspIHsKICAgICAgICAgICAgICBpZiAocyA9IHVbZisrXSwgcyAhPSBzKSByZXR1cm4gITA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBmb3IgKDsgYSA+IGY7IGYrKykgewogICAgICAgICAgICBpZiAoKGUgfHwgZiBpbiB1KSAmJiB1W2ZdID09PSByKSByZXR1cm4gZSB8fCBmIHx8IDA7CiAgICAgICAgICB9cmV0dXJuICFlICYmIC0xOwogICAgICAgIH07CiAgICAgIH07CiAgICB9LCB7ICIuL190by1pbmRleCI6IDYxLCAiLi9fdG8taW9iamVjdCI6IDYzLCAiLi9fdG8tbGVuZ3RoIjogNjQgfV0sIDE0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19jb2YiKSwKICAgICAgICAgIG8gPSBlKCIuL193a3MiKSgidG9TdHJpbmdUYWciKSwKICAgICAgICAgIGkgPSAiQXJndW1lbnRzIiA9PSBuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gYXJndW1lbnRzOwogICAgICB9KCkpLAogICAgICAgICAgYyA9IGZ1bmN0aW9uIGMoZSwgdCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gZVt0XTsKICAgICAgICB9IGNhdGNoIChyKSB7fQogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQsIHIsIHM7cmV0dXJuIHZvaWQgMCA9PT0gZSA/ICJVbmRlZmluZWQiIDogbnVsbCA9PT0gZSA/ICJOdWxsIiA6ICJzdHJpbmciID09IHR5cGVvZiAociA9IGModCA9IE9iamVjdChlKSwgbykpID8gciA6IGkgPyBuKHQpIDogIk9iamVjdCIgPT0gKHMgPSBuKHQpKSAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiB0LmNhbGxlZSA/ICJBcmd1bWVudHMiIDogczsKICAgICAgfTsKICAgIH0sIHsgIi4vX2NvZiI6IDE1LCAiLi9fd2tzIjogNjggfV0sIDE1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS50b1N0cmluZzt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSkuc2xpY2UoOCwgLTEpOwogICAgICB9OwogICAgfSwge31dLCAxNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0geyB2ZXJzaW9uOiAiMi40LjAiIH07Im51bWJlciIgPT0gdHlwZW9mIF9fZSAmJiAoX19lID0gbik7CiAgICB9LCB7fV0sIDE3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19hLWZ1bmN0aW9uIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICBpZiAobihlKSwgdm9pZCAwID09PSB0KSByZXR1cm4gZTtzd2l0Y2ggKHIpIHtjYXNlIDE6CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgIHJldHVybiBlLmNhbGwodCwgcik7CiAgICAgICAgICAgIH07Y2FzZSAyOgogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHIsIG4pIHsKICAgICAgICAgICAgICByZXR1cm4gZS5jYWxsKHQsIHIsIG4pOwogICAgICAgICAgICB9O2Nhc2UgMzoKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChyLCBuLCBvKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGUuY2FsbCh0LCByLCBuLCBvKTsKICAgICAgICAgICAgfTt9cmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBlLmFwcGx5KHQsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2EtZnVuY3Rpb24iOiA5IH1dLCAxODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKHZvaWQgMCA9PSBlKSB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNhbGwgbWV0aG9kIG9uICAiICsgZSk7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDE5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gIWUoIi4vX2ZhaWxzIikoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiA3ICE9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICAgIH0gfSkuYTsKICAgICAgfSk7CiAgICB9LCB7ICIuL19mYWlscyI6IDIzIH1dLCAyMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faXMtb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi9fZ2xvYmFsIikuZG9jdW1lbnQsCiAgICAgICAgICBpID0gbihvKSAmJiBuKG8uY3JlYXRlRWxlbWVudCk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gaSA/IG8uY3JlYXRlRWxlbWVudChlKSA6IHt9OwogICAgICB9OwogICAgfSwgeyAiLi9fZ2xvYmFsIjogMjUsICIuL19pcy1vYmplY3QiOiAzMyB9XSwgMjE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAiY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mIi5zcGxpdCgiLCIpOwogICAgfSwge31dLCAyMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fZ2xvYmFsIiksCiAgICAgICAgICBvID0gZSgiLi9fY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vX2N0eCIpLAogICAgICAgICAgYyA9IGUoIi4vX2hpZGUiKSwKICAgICAgICAgIHMgPSAicHJvdG90eXBlIiwKICAgICAgICAgIHUgPSBmdW5jdGlvbiB1KGUsIHQsIHIpIHsKICAgICAgICB2YXIgYSwKICAgICAgICAgICAgZiwKICAgICAgICAgICAgXywKICAgICAgICAgICAgbCA9IGUgJiB1LkYsCiAgICAgICAgICAgIGQgPSBlICYgdS5HLAogICAgICAgICAgICBwID0gZSAmIHUuUywKICAgICAgICAgICAgdiA9IGUgJiB1LlAsCiAgICAgICAgICAgIHkgPSBlICYgdS5CLAogICAgICAgICAgICBoID0gZSAmIHUuVywKICAgICAgICAgICAgYiA9IGQgPyBvIDogb1t0XSB8fCAob1t0XSA9IHt9KSwKICAgICAgICAgICAgbSA9IGJbc10sCiAgICAgICAgICAgIGcgPSBkID8gbiA6IHAgPyBuW3RdIDogKG5bdF0gfHwge30pW3NdO2QgJiYgKHIgPSB0KTtmb3IgKGEgaW4gcikgewogICAgICAgICAgZiA9ICFsICYmIGcgJiYgdm9pZCAwICE9PSBnW2FdLCBmICYmIGEgaW4gYiB8fCAoXyA9IGYgPyBnW2FdIDogclthXSwgYlthXSA9IGQgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgZ1thXSA/IHJbYV0gOiB5ICYmIGYgPyBpKF8sIG4pIDogaCAmJiBnW2FdID09IF8gPyBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgdCA9IGZ1bmN0aW9uIHQoX3QsIHIsIG4pIHsKICAgICAgICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIGUpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge2Nhc2UgMDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGUoKTtjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBlKF90KTtjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBlKF90LCByKTt9cmV0dXJuIG5ldyBlKF90LCByLCBuKTsKICAgICAgICAgICAgICB9cmV0dXJuIGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgfTtyZXR1cm4gdFtzXSA9IGVbc10sIHQ7CiAgICAgICAgICB9KF8pIDogdiAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBfID8gaShGdW5jdGlvbi5jYWxsLCBfKSA6IF8sIHYgJiYgKChiLnZpcnR1YWwgfHwgKGIudmlydHVhbCA9IHt9KSlbYV0gPSBfLCBlICYgdS5SICYmIG0gJiYgIW1bYV0gJiYgYyhtLCBhLCBfKSkpOwogICAgICAgIH0KICAgICAgfTt1LkYgPSAxLCB1LkcgPSAyLCB1LlMgPSA0LCB1LlAgPSA4LCB1LkIgPSAxNiwgdS5XID0gMzIsIHUuVSA9IDY0LCB1LlIgPSAxMjgsIHQuZXhwb3J0cyA9IHU7CiAgICB9LCB7ICIuL19jb3JlIjogMTYsICIuL19jdHgiOiAxNywgIi4vX2dsb2JhbCI6IDI1LCAiLi9faGlkZSI6IDI3IH1dLCAyMzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiAhIWUoKTsKICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICByZXR1cm4gITA7CiAgICAgICAgfQogICAgICB9OwogICAgfSwge31dLCAyNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fY3R4IiksCiAgICAgICAgICBvID0gZSgiLi9faXRlci1jYWxsIiksCiAgICAgICAgICBpID0gZSgiLi9faXMtYXJyYXktaXRlciIpLAogICAgICAgICAgYyA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgcyA9IGUoIi4vX3RvLWxlbmd0aCIpLAogICAgICAgICAgdSA9IGUoIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIiksCiAgICAgICAgICBhID0ge30sCiAgICAgICAgICBmID0ge30sCiAgICAgICAgICByID0gdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIsIF8sIGwpIHsKICAgICAgICB2YXIgZCwKICAgICAgICAgICAgcCwKICAgICAgICAgICAgdiwKICAgICAgICAgICAgeSwKICAgICAgICAgICAgaCA9IGwgPyBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZTsKICAgICAgICB9IDogdShlKSwKICAgICAgICAgICAgYiA9IG4ociwgXywgdCA/IDIgOiAxKSwKICAgICAgICAgICAgbSA9IDA7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGgpIHRocm93IFR5cGVFcnJvcihlICsgIiBpcyBub3QgaXRlcmFibGUhIik7aWYgKGkoaCkpIHsKICAgICAgICAgIGZvciAoZCA9IHMoZS5sZW5ndGgpOyBkID4gbTsgbSsrKSB7CiAgICAgICAgICAgIGlmICh5ID0gdCA/IGIoYyhwID0gZVttXSlbMF0sIHBbMV0pIDogYihlW21dKSwgeSA9PT0gYSB8fCB5ID09PSBmKSByZXR1cm4geTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgZm9yICh2ID0gaC5jYWxsKGUpOyAhKHAgPSB2Lm5leHQoKSkuZG9uZTspIHsKICAgICAgICAgIGlmICh5ID0gbyh2LCBiLCBwLnZhbHVlLCB0KSwgeSA9PT0gYSB8fCB5ID09PSBmKSByZXR1cm4geTsKICAgICAgICB9CiAgICAgIH07ci5CUkVBSyA9IGEsIHIuUkVUVVJOID0gZjsKICAgIH0sIHsgIi4vX2FuLW9iamVjdCI6IDEyLCAiLi9fY3R4IjogMTcsICIuL19pcy1hcnJheS1pdGVyIjogMzIsICIuL19pdGVyLWNhbGwiOiAzNCwgIi4vX3RvLWxlbmd0aCI6IDY0LCAiLi9jb3JlLmdldC1pdGVyYXRvci1tZXRob2QiOiA2OSB9XSwgMjU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IHQuZXhwb3J0cyA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93Lk1hdGggPT0gTWF0aCA/IHdpbmRvdyA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBzZWxmICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiA6IEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCk7Im51bWJlciIgPT0gdHlwZW9mIF9fZyAmJiAoX19nID0gbik7CiAgICB9LCB7fV0sIDI2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS5oYXNPd25Qcm9wZXJ0eTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7fV0sIDI3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19vYmplY3QtZHAiKSwKICAgICAgICAgIG8gPSBlKCIuL19wcm9wZXJ0eS1kZXNjIik7dC5leHBvcnRzID0gZSgiLi9fZGVzY3JpcHRvcnMiKSA/IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIG4uZihlLCB0LCBvKDEsIHIpKTsKICAgICAgfSA6IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIGVbdF0gPSByLCBlOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVzY3JpcHRvcnMiOiAxOSwgIi4vX29iamVjdC1kcCI6IDQzLCAiLi9fcHJvcGVydHktZGVzYyI6IDUwIH1dLCAyODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vX2dsb2JhbCIpLmRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgIH0sIHsgIi4vX2dsb2JhbCI6IDI1IH1dLCAyOTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9ICFlKCIuL19kZXNjcmlwdG9ycyIpICYmICFlKCIuL19mYWlscyIpKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gNyAhPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSgiLi9fZG9tLWNyZWF0ZSIpKCJkaXYiKSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICAgIH0gfSkuYTsKICAgICAgfSk7CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fZG9tLWNyZWF0ZSI6IDIwLCAiLi9fZmFpbHMiOiAyMyB9XSwgMzA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHZhciBuID0gdm9pZCAwID09PSByO3N3aXRjaCAodC5sZW5ndGgpIHtjYXNlIDA6CiAgICAgICAgICAgIHJldHVybiBuID8gZSgpIDogZS5jYWxsKHIpO2Nhc2UgMToKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0pIDogZS5jYWxsKHIsIHRbMF0pO2Nhc2UgMjoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0pO2Nhc2UgMzoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0sIHRbMl0pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0sIHRbMl0pO2Nhc2UgNDoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0sIHRbMl0sIHRbM10pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0sIHRbMl0sIHRbM10pO31yZXR1cm4gZS5hcHBseShyLCB0KTsKICAgICAgfTsKICAgIH0sIHt9XSwgMzE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2NvZiIpO3QuZXhwb3J0cyA9IE9iamVjdCgieiIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApID8gT2JqZWN0IDogZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIlN0cmluZyIgPT0gbihlKSA/IGUuc3BsaXQoIiIpIDogT2JqZWN0KGUpOwogICAgICB9OwogICAgfSwgeyAiLi9fY29mIjogMTUgfV0sIDMyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19pdGVyYXRvcnMiKSwKICAgICAgICAgIG8gPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIGkgPSBBcnJheS5wcm90b3R5cGU7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBlICYmIChuLkFycmF5ID09PSBlIHx8IGlbb10gPT09IGUpOwogICAgICB9OwogICAgfSwgeyAiLi9faXRlcmF0b3JzIjogMzksICIuL193a3MiOiA2OCB9XSwgMzM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAib2JqZWN0IiA9PSAodHlwZW9mIGUgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGUpKSA/IG51bGwgIT09IGUgOiAiZnVuY3Rpb24iID09IHR5cGVvZiBlOwogICAgICB9OwogICAgfSwge31dLCAzNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fYW4tb2JqZWN0Iik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIsIG8pIHsKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIG8gPyB0KG4ocilbMF0sIHJbMV0pIDogdChyKTsKICAgICAgICB9IGNhdGNoIChpKSB7CiAgICAgICAgICB2YXIgYyA9IGVbInJldHVybiJdO3Rocm93IHZvaWQgMCAhPT0gYyAmJiBuKGMuY2FsbChlKSksIGk7CiAgICAgICAgfQogICAgICB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIgfV0sIDM1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vX29iamVjdC1jcmVhdGUiKSwKICAgICAgICAgIG8gPSBlKCIuL19wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBpID0gZSgiLi9fc2V0LXRvLXN0cmluZy10YWciKSwKICAgICAgICAgIGMgPSB7fTtlKCIuL19oaWRlIikoYywgZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSksIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZS5wcm90b3R5cGUgPSBuKGMsIHsgbmV4dDogbygxLCByKSB9KSwgaShlLCB0ICsgIiBJdGVyYXRvciIpOwogICAgICB9OwogICAgfSwgeyAiLi9faGlkZSI6IDI3LCAiLi9fb2JqZWN0LWNyZWF0ZSI6IDQyLCAiLi9fcHJvcGVydHktZGVzYyI6IDUwLCAiLi9fc2V0LXRvLXN0cmluZy10YWciOiA1NSwgIi4vX3drcyI6IDY4IH1dLCAzNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4gPSBlKCIuL19saWJyYXJ5IiksCiAgICAgICAgICBvID0gZSgiLi9fZXhwb3J0IiksCiAgICAgICAgICBpID0gZSgiLi9fcmVkZWZpbmUiKSwKICAgICAgICAgIGMgPSBlKCIuL19oaWRlIiksCiAgICAgICAgICBzID0gZSgiLi9faGFzIiksCiAgICAgICAgICB1ID0gZSgiLi9faXRlcmF0b3JzIiksCiAgICAgICAgICBhID0gZSgiLi9faXRlci1jcmVhdGUiKSwKICAgICAgICAgIGYgPSBlKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpLAogICAgICAgICAgXyA9IGUoIi4vX29iamVjdC1ncG8iKSwKICAgICAgICAgIGwgPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIGQgPSAhKFtdLmtleXMgJiYgIm5leHQiIGluIFtdLmtleXMoKSksCiAgICAgICAgICBwID0gIkBAaXRlcmF0b3IiLAogICAgICAgICAgdiA9ICJrZXlzIiwKICAgICAgICAgIHkgPSAidmFsdWVzIiwKICAgICAgICAgIGggPSBmdW5jdGlvbiBoKCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBiLCBtLCBnLCBqKSB7CiAgICAgICAgYShyLCB0LCBiKTt2YXIgeCwKICAgICAgICAgICAgdywKICAgICAgICAgICAgaywKICAgICAgICAgICAgTyA9IGZ1bmN0aW9uIE8oZSkgewogICAgICAgICAgaWYgKCFkICYmIGUgaW4gRSkgcmV0dXJuIEVbZV07c3dpdGNoIChlKSB7Y2FzZSB2OgogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICAgICAgfTtjYXNlIHk6CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcih0aGlzLCBlKTsKICAgICAgICAgICAgICB9O31yZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgICAgIE0gPSB0ICsgIiBJdGVyYXRvciIsCiAgICAgICAgICAgIFAgPSBtID09IHksCiAgICAgICAgICAgIFMgPSAhMSwKICAgICAgICAgICAgRSA9IGUucHJvdG90eXBlLAogICAgICAgICAgICBUID0gRVtsXSB8fCBFW3BdIHx8IG0gJiYgRVttXSwKICAgICAgICAgICAgQSA9IFQgfHwgTyhtKSwKICAgICAgICAgICAgVSA9IG0gPyBQID8gTygiZW50cmllcyIpIDogQSA6IHZvaWQgMCwKICAgICAgICAgICAgQyA9ICJBcnJheSIgPT0gdCA/IEUuZW50cmllcyB8fCBUIDogVDtpZiAoQyAmJiAoayA9IF8oQy5jYWxsKG5ldyBlKCkpKSwgayAhPT0gT2JqZWN0LnByb3RvdHlwZSAmJiAoZihrLCBNLCAhMCksIG4gfHwgcyhrLCBsKSB8fCBjKGssIGwsIGgpKSksIFAgJiYgVCAmJiBULm5hbWUgIT09IHkgJiYgKFMgPSAhMCwgQSA9IGZ1bmN0aW9uIEEoKSB7CiAgICAgICAgICByZXR1cm4gVC5jYWxsKHRoaXMpOwogICAgICAgIH0pLCBuICYmICFqIHx8ICFkICYmICFTICYmIEVbbF0gfHwgYyhFLCBsLCBBKSwgdVt0XSA9IEEsIHVbTV0gPSBoLCBtKSBpZiAoeCA9IHsgdmFsdWVzOiBQID8gQSA6IE8oeSksIGtleXM6IGcgPyBBIDogTyh2KSwgZW50cmllczogVSB9LCBqKSBmb3IgKHcgaW4geCkgewogICAgICAgICAgdyBpbiBFIHx8IGkoRSwgdywgeFt3XSk7CiAgICAgICAgfSBlbHNlIG8oby5QICsgby5GICogKGQgfHwgUyksIHQsIHgpO3JldHVybiB4OwogICAgICB9OwogICAgfSwgeyAiLi9fZXhwb3J0IjogMjIsICIuL19oYXMiOiAyNiwgIi4vX2hpZGUiOiAyNywgIi4vX2l0ZXItY3JlYXRlIjogMzUsICIuL19pdGVyYXRvcnMiOiAzOSwgIi4vX2xpYnJhcnkiOiA0MCwgIi4vX29iamVjdC1ncG8iOiA0NiwgIi4vX3JlZGVmaW5lIjogNTIsICIuL19zZXQtdG8tc3RyaW5nLXRhZyI6IDU1LCAiLi9fd2tzIjogNjggfV0sIDM3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIG8gPSAhMTt0cnkgewogICAgICAgIHZhciBpID0gWzddW25dKCk7aVsicmV0dXJuIl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBvID0gITA7CiAgICAgICAgfSwgQXJyYXkuZnJvbShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aHJvdyAyOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChjKSB7fXQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCF0ICYmICFvKSByZXR1cm4gITE7dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgdmFyIGkgPSBbN10sCiAgICAgICAgICAgICAgYyA9IGlbbl0oKTtjLm5leHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB7IGRvbmU6IHIgPSAhMCB9OwogICAgICAgICAgfSwgaVtuXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGM7CiAgICAgICAgICB9LCBlKGkpOwogICAgICAgIH0gY2F0Y2ggKHMpIHt9cmV0dXJuIHI7CiAgICAgIH07CiAgICB9LCB7ICIuL193a3MiOiA2OCB9XSwgMzg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiB7IHZhbHVlOiB0LCBkb25lOiAhIWUgfTsKICAgICAgfTsKICAgIH0sIHt9XSwgMzk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7fTsKICAgIH0sIHt9XSwgNDA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAhMDsKICAgIH0sIHt9XSwgNDE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2dsb2JhbCIpLAogICAgICAgICAgbyA9IGUoIi4vX3Rhc2siKS5zZXQsCiAgICAgICAgICBpID0gbi5NdXRhdGlvbk9ic2VydmVyIHx8IG4uV2ViS2l0TXV0YXRpb25PYnNlcnZlciwKICAgICAgICAgIGMgPSBuLnByb2Nlc3MsCiAgICAgICAgICBzID0gbi5Qcm9taXNlLAogICAgICAgICAgdSA9ICJwcm9jZXNzIiA9PSBlKCIuL19jb2YiKShjKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUsCiAgICAgICAgICAgIHQsCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIGEgPSBmdW5jdGlvbiBhKCkgewogICAgICAgICAgdmFyIG4sIG87Zm9yICh1ICYmIChuID0gYy5kb21haW4pICYmIG4uZXhpdCgpOyBlOykgewogICAgICAgICAgICBvID0gZS5mbiwgZSA9IGUubmV4dDt0cnkgewogICAgICAgICAgICAgIG8oKTsKICAgICAgICAgICAgfSBjYXRjaCAoaSkgewogICAgICAgICAgICAgIHRocm93IGUgPyByKCkgOiB0ID0gdm9pZCAwLCBpOwogICAgICAgICAgICB9CiAgICAgICAgICB9dCA9IHZvaWQgMCwgbiAmJiBuLmVudGVyKCk7CiAgICAgICAgfTtpZiAodSkgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICBjLm5leHRUaWNrKGEpOwogICAgICAgIH07ZWxzZSBpZiAoaSkgewogICAgICAgICAgdmFyIGYgPSAhMCwKICAgICAgICAgICAgICBfID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpO25ldyBpKGEpLm9ic2VydmUoXywgeyBjaGFyYWN0ZXJEYXRhOiAhMCB9KSwgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICAgIF8uZGF0YSA9IGYgPSAhZjsKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIGlmIChzICYmIHMucmVzb2x2ZSkgewogICAgICAgICAgdmFyIGwgPSBzLnJlc29sdmUoKTtyID0gZnVuY3Rpb24gcigpIHsKICAgICAgICAgICAgbC50aGVuKGEpOwogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICBvLmNhbGwobiwgYSk7CiAgICAgICAgfTtyZXR1cm4gZnVuY3Rpb24gKG4pIHsKICAgICAgICAgIHZhciBvID0geyBmbjogbiwgbmV4dDogdm9pZCAwIH07dCAmJiAodC5uZXh0ID0gbyksIGUgfHwgKGUgPSBvLCByKCkpLCB0ID0gbzsKICAgICAgICB9OwogICAgICB9OwogICAgfSwgeyAiLi9fY29mIjogMTUsICIuL19nbG9iYWwiOiAyNSwgIi4vX3Rhc2siOiA2MCB9XSwgNDI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX29iamVjdC1kcHMiKSwKICAgICAgICAgIGkgPSBlKCIuL19lbnVtLWJ1Zy1rZXlzIiksCiAgICAgICAgICBjID0gZSgiLi9fc2hhcmVkLWtleSIpKCJJRV9QUk9UTyIpLAogICAgICAgICAgcyA9IGZ1bmN0aW9uIHMoKSB7fSwKICAgICAgICAgIHUgPSAicHJvdG90eXBlIiwKICAgICAgICAgIF9hID0gZnVuY3Rpb24gYSgpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IGUoIi4vX2RvbS1jcmVhdGUiKSgiaWZyYW1lIiksCiAgICAgICAgICAgIG4gPSBpLmxlbmd0aCwKICAgICAgICAgICAgbyA9ICI+Ijtmb3IgKHIuc3R5bGUuZGlzcGxheSA9ICJub25lIiwgZSgiLi9faHRtbCIpLmFwcGVuZENoaWxkKHIpLCByLnNyYyA9ICJqYXZhc2NyaXB0OiIsIHQgPSByLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQsIHQub3BlbigpLCB0LndyaXRlKCI8c2NyaXB0PmRvY3VtZW50LkY9T2JqZWN0PC9zY3JpcHQiICsgbyksIHQuY2xvc2UoKSwgX2EgPSB0LkY7IG4tLTspIHsKICAgICAgICAgIGRlbGV0ZSBfYVt1XVtpW25dXTsKICAgICAgICB9cmV0dXJuIF9hKCk7CiAgICAgIH07dC5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHZhciByO3JldHVybiBudWxsICE9PSBlID8gKHNbdV0gPSBuKGUpLCByID0gbmV3IHMoKSwgc1t1XSA9IG51bGwsIHJbY10gPSBlKSA6IHIgPSBfYSgpLCB2b2lkIDAgPT09IHQgPyByIDogbyhyLCB0KTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2FuLW9iamVjdCI6IDEyLCAiLi9fZG9tLWNyZWF0ZSI6IDIwLCAiLi9fZW51bS1idWcta2V5cyI6IDIxLCAiLi9faHRtbCI6IDI4LCAiLi9fb2JqZWN0LWRwcyI6IDQ0LCAiLi9fc2hhcmVkLWtleSI6IDU2IH1dLCA0MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fYW4tb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi9faWU4LWRvbS1kZWZpbmUiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1wcmltaXRpdmUiKSwKICAgICAgICAgIGMgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7ci5mID0gZSgiLi9fZGVzY3JpcHRvcnMiKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgaWYgKG4oZSksIHQgPSBpKHQsICEwKSwgbihyKSwgbykgdHJ5IHsKICAgICAgICAgIHJldHVybiBjKGUsIHQsIHIpOwogICAgICAgIH0gY2F0Y2ggKHMpIHt9aWYgKCJnZXQiIGluIHIgfHwgInNldCIgaW4gcikgdGhyb3cgVHlwZUVycm9yKCJBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEiKTtyZXR1cm4gInZhbHVlIiBpbiByICYmIChlW3RdID0gci52YWx1ZSksIGU7CiAgICAgIH07CiAgICB9LCB7ICIuL19hbi1vYmplY3QiOiAxMiwgIi4vX2Rlc2NyaXB0b3JzIjogMTksICIuL19pZTgtZG9tLWRlZmluZSI6IDI5LCAiLi9fdG8tcHJpbWl0aXZlIjogNjYgfV0sIDQ0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19vYmplY3QtZHAiKSwKICAgICAgICAgIG8gPSBlKCIuL19hbi1vYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19vYmplY3Qta2V5cyIpO3QuZXhwb3J0cyA9IGUoIi4vX2Rlc2NyaXB0b3JzIikgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgbyhlKTtmb3IgKHZhciByLCBjID0gaSh0KSwgcyA9IGMubGVuZ3RoLCB1ID0gMDsgcyA+IHU7KSB7CiAgICAgICAgICBuLmYoZSwgciA9IGNbdSsrXSwgdFtyXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIsICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fb2JqZWN0LWRwIjogNDMsICIuL19vYmplY3Qta2V5cyI6IDQ4IH1dLCA0NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fb2JqZWN0LXBpZSIpLAogICAgICAgICAgbyA9IGUoIi4vX3Byb3BlcnR5LWRlc2MiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1pb2JqZWN0IiksCiAgICAgICAgICBjID0gZSgiLi9fdG8tcHJpbWl0aXZlIiksCiAgICAgICAgICBzID0gZSgiLi9faGFzIiksCiAgICAgICAgICB1ID0gZSgiLi9faWU4LWRvbS1kZWZpbmUiKSwKICAgICAgICAgIGEgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO3IuZiA9IGUoIi4vX2Rlc2NyaXB0b3JzIikgPyBhIDogZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoZSA9IGkoZSksIHQgPSBjKHQsICEwKSwgdSkgdHJ5IHsKICAgICAgICAgIHJldHVybiBhKGUsIHQpOwogICAgICAgIH0gY2F0Y2ggKHIpIHt9cmV0dXJuIHMoZSwgdCkgPyBvKCFuLmYuY2FsbChlLCB0KSwgZVt0XSkgOiB2b2lkIDA7CiAgICAgIH07CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9faGFzIjogMjYsICIuL19pZTgtZG9tLWRlZmluZSI6IDI5LCAiLi9fb2JqZWN0LXBpZSI6IDQ5LCAiLi9fcHJvcGVydHktZGVzYyI6IDUwLCAiLi9fdG8taW9iamVjdCI6IDYzLCAiLi9fdG8tcHJpbWl0aXZlIjogNjYgfV0sIDQ2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19oYXMiKSwKICAgICAgICAgIG8gPSBlKCIuL190by1vYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIiksCiAgICAgICAgICBjID0gT2JqZWN0LnByb3RvdHlwZTt0LmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZSA9IG8oZSksIG4oZSwgaSkgPyBlW2ldIDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgZS5jb25zdHJ1Y3RvciAmJiBlIGluc3RhbmNlb2YgZS5jb25zdHJ1Y3RvciA/IGUuY29uc3RydWN0b3IucHJvdG90eXBlIDogZSBpbnN0YW5jZW9mIE9iamVjdCA/IGMgOiBudWxsOwogICAgICB9OwogICAgfSwgeyAiLi9faGFzIjogMjYsICIuL19zaGFyZWQta2V5IjogNTYsICIuL190by1vYmplY3QiOiA2NSB9XSwgNDc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2hhcyIpLAogICAgICAgICAgbyA9IGUoIi4vX3RvLWlvYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19hcnJheS1pbmNsdWRlcyIpKCExKSwKICAgICAgICAgIGMgPSBlKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB2YXIgciwKICAgICAgICAgICAgcyA9IG8oZSksCiAgICAgICAgICAgIHUgPSAwLAogICAgICAgICAgICBhID0gW107Zm9yIChyIGluIHMpIHsKICAgICAgICAgIHIgIT0gYyAmJiBuKHMsIHIpICYmIGEucHVzaChyKTsKICAgICAgICB9Zm9yICg7IHQubGVuZ3RoID4gdTspIHsKICAgICAgICAgIG4ocywgciA9IHRbdSsrXSkgJiYgKH5pKGEsIHIpIHx8IGEucHVzaChyKSk7CiAgICAgICAgfXJldHVybiBhOwogICAgICB9OwogICAgfSwgeyAiLi9fYXJyYXktaW5jbHVkZXMiOiAxMywgIi4vX2hhcyI6IDI2LCAiLi9fc2hhcmVkLWtleSI6IDU2LCAiLi9fdG8taW9iamVjdCI6IDYzIH1dLCA0ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwiKSwKICAgICAgICAgIG8gPSBlKCIuL19lbnVtLWJ1Zy1rZXlzIik7dC5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbihlLCBvKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2VudW0tYnVnLWtleXMiOiAyMSwgIi4vX29iamVjdC1rZXlzLWludGVybmFsIjogNDcgfV0sIDQ5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgci5mID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7CiAgICB9LCB7fV0sIDUwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICByZXR1cm4geyBlbnVtZXJhYmxlOiAhKDEgJiBlKSwgY29uZmlndXJhYmxlOiAhKDIgJiBlKSwgd3JpdGFibGU6ICEoNCAmIGUpLCB2YWx1ZTogdCB9OwogICAgICB9OwogICAgfSwge31dLCA1MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faGlkZSIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZm9yICh2YXIgbyBpbiB0KSB7CiAgICAgICAgICByICYmIGVbb10gPyBlW29dID0gdFtvXSA6IG4oZSwgbywgdFtvXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9OwogICAgfSwgeyAiLi9faGlkZSI6IDI3IH1dLCA1MjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vX2hpZGUiKTsKICAgIH0sIHsgIi4vX2hpZGUiOiAyNyB9XSwgNTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2lzLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgaSA9IGZ1bmN0aW9uIGkoZSwgdCkgewogICAgICAgIGlmIChvKGUpLCAhbih0KSAmJiBudWxsICE9PSB0KSB0aHJvdyBUeXBlRXJyb3IodCArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7CiAgICAgIH07dC5leHBvcnRzID0geyBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoIl9fcHJvdG9fXyIgaW4ge30gPyBmdW5jdGlvbiAodCwgciwgbikgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbiA9IGUoIi4vX2N0eCIpKEZ1bmN0aW9uLmNhbGwsIGUoIi4vX29iamVjdC1nb3BkIikuZihPYmplY3QucHJvdG90eXBlLCAiX19wcm90b19fIikuc2V0LCAyKSwgbih0LCBbXSksIHIgPSAhKHQgaW5zdGFuY2VvZiBBcnJheSk7CiAgICAgICAgICB9IGNhdGNoIChvKSB7CiAgICAgICAgICAgIHIgPSAhMDsKICAgICAgICAgIH1yZXR1cm4gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgcmV0dXJuIGkoZSwgdCksIHIgPyBlLl9fcHJvdG9fXyA9IHQgOiBuKGUsIHQpLCBlOwogICAgICAgICAgfTsKICAgICAgICB9KHt9LCAhMSkgOiB2b2lkIDApLCBjaGVjazogaSB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIsICIuL19jdHgiOiAxNywgIi4vX2lzLW9iamVjdCI6IDMzLCAiLi9fb2JqZWN0LWdvcGQiOiA0NSB9XSwgNTQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi9fZ2xvYmFsIiksCiAgICAgICAgICBvID0gZSgiLi9fY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vX29iamVjdC1kcCIpLAogICAgICAgICAgYyA9IGUoIi4vX2Rlc2NyaXB0b3JzIiksCiAgICAgICAgICBzID0gZSgiLi9fd2tzIikoInNwZWNpZXMiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0gImZ1bmN0aW9uIiA9PSB0eXBlb2Ygb1tlXSA/IG9bZV0gOiBuW2VdO2MgJiYgdCAmJiAhdFtzXSAmJiBpLmYodCwgcywgeyBjb25maWd1cmFibGU6ICEwLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9IH0pOwogICAgICB9OwogICAgfSwgeyAiLi9fY29yZSI6IDE2LCAiLi9fZGVzY3JpcHRvcnMiOiAxOSwgIi4vX2dsb2JhbCI6IDI1LCAiLi9fb2JqZWN0LWRwIjogNDMsICIuL193a3MiOiA2OCB9XSwgNTU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX29iamVjdC1kcCIpLmYsCiAgICAgICAgICBvID0gZSgiLi9faGFzIiksCiAgICAgICAgICBpID0gZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICBlICYmICFvKGUgPSByID8gZSA6IGUucHJvdG90eXBlLCBpKSAmJiBuKGUsIGksIHsgY29uZmlndXJhYmxlOiAhMCwgdmFsdWU6IHQgfSk7CiAgICAgIH07CiAgICB9LCB7ICIuL19oYXMiOiAyNiwgIi4vX29iamVjdC1kcCI6IDQzLCAiLi9fd2tzIjogNjggfV0sIDU2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19zaGFyZWQiKSgia2V5cyIpLAogICAgICAgICAgbyA9IGUoIi4vX3VpZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBvKGUpKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX3NoYXJlZCI6IDU3LCAiLi9fdWlkIjogNjcgfV0sIDU3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19nbG9iYWwiKSwKICAgICAgICAgIG8gPSAiX19jb3JlLWpzX3NoYXJlZF9fIiwKICAgICAgICAgIGkgPSBuW29dIHx8IChuW29dID0ge30pO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGlbZV0gfHwgKGlbZV0gPSB7fSk7CiAgICAgIH07CiAgICB9LCB7ICIuL19nbG9iYWwiOiAyNSB9XSwgNTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2EtZnVuY3Rpb24iKSwKICAgICAgICAgIGkgPSBlKCIuL193a3MiKSgic3BlY2llcyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgdmFyIHIsCiAgICAgICAgICAgIGMgPSBuKGUpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDAgPT09IGMgfHwgdm9pZCAwID09IChyID0gbihjKVtpXSkgPyB0IDogbyhyKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2EtZnVuY3Rpb24iOiA5LCAiLi9fYW4tb2JqZWN0IjogMTIsICIuL193a3MiOiA2OCB9XSwgNTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX3RvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBlKCIuL19kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQsIHIpIHsKICAgICAgICAgIHZhciBpLAogICAgICAgICAgICAgIGMsCiAgICAgICAgICAgICAgcyA9IFN0cmluZyhvKHQpKSwKICAgICAgICAgICAgICB1ID0gbihyKSwKICAgICAgICAgICAgICBhID0gcy5sZW5ndGg7cmV0dXJuIDAgPiB1IHx8IHUgPj0gYSA/IGUgPyAiIiA6IHZvaWQgMCA6IChpID0gcy5jaGFyQ29kZUF0KHUpLCA1NTI5NiA+IGkgfHwgaSA+IDU2MzE5IHx8IHUgKyAxID09PSBhIHx8IChjID0gcy5jaGFyQ29kZUF0KHUgKyAxKSkgPCA1NjMyMCB8fCBjID4gNTczNDMgPyBlID8gcy5jaGFyQXQodSkgOiBpIDogZSA/IHMuc2xpY2UodSwgdSArIDIpIDogKGkgLSA1NTI5NiA8PCAxMCkgKyAoYyAtIDU2MzIwKSArIDY1NTM2KTsKICAgICAgICB9OwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4LCAiLi9fdG8taW50ZWdlciI6IDYyIH1dLCA2MDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBjID0gZSgiLi9fY3R4IiksCiAgICAgICAgICBzID0gZSgiLi9faW52b2tlIiksCiAgICAgICAgICB1ID0gZSgiLi9faHRtbCIpLAogICAgICAgICAgYSA9IGUoIi4vX2RvbS1jcmVhdGUiKSwKICAgICAgICAgIGYgPSBlKCIuL19nbG9iYWwiKSwKICAgICAgICAgIF8gPSBmLnByb2Nlc3MsCiAgICAgICAgICBsID0gZi5zZXRJbW1lZGlhdGUsCiAgICAgICAgICBkID0gZi5jbGVhckltbWVkaWF0ZSwKICAgICAgICAgIHAgPSBmLk1lc3NhZ2VDaGFubmVsLAogICAgICAgICAgdiA9IDAsCiAgICAgICAgICB5ID0ge30sCiAgICAgICAgICBoID0gIm9ucmVhZHlzdGF0ZWNoYW5nZSIsCiAgICAgICAgICBiID0gZnVuY3Rpb24gYigpIHsKICAgICAgICB2YXIgZSA9ICt0aGlzO2lmICh5Lmhhc093blByb3BlcnR5KGUpKSB7CiAgICAgICAgICB2YXIgdCA9IHlbZV07ZGVsZXRlIHlbZV0sIHQoKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBtID0gZnVuY3Rpb24gbShlKSB7CiAgICAgICAgYi5jYWxsKGUuZGF0YSk7CiAgICAgIH07bCAmJiBkIHx8IChsID0gZnVuY3Rpb24gbChlKSB7CiAgICAgICAgZm9yICh2YXIgdCA9IFtdLCByID0gMTsgYXJndW1lbnRzLmxlbmd0aCA+IHI7KSB7CiAgICAgICAgICB0LnB1c2goYXJndW1lbnRzW3IrK10pOwogICAgICAgIH1yZXR1cm4geVsrK3ZdID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcygiZnVuY3Rpb24iID09IHR5cGVvZiBlID8gZSA6IEZ1bmN0aW9uKGUpLCB0KTsKICAgICAgICB9LCBuKHYpLCB2OwogICAgICB9LCBkID0gZnVuY3Rpb24gZChlKSB7CiAgICAgICAgZGVsZXRlIHlbZV07CiAgICAgIH0sICJwcm9jZXNzIiA9PSBlKCIuL19jb2YiKShfKSA/IG4gPSBmdW5jdGlvbiBuKGUpIHsKICAgICAgICBfLm5leHRUaWNrKGMoYiwgZSwgMSkpOwogICAgICB9IDogcCA/IChvID0gbmV3IHAoKSwgaSA9IG8ucG9ydDIsIG8ucG9ydDEub25tZXNzYWdlID0gbSwgbiA9IGMoaS5wb3N0TWVzc2FnZSwgaSwgMSkpIDogZi5hZGRFdmVudExpc3RlbmVyICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHBvc3RNZXNzYWdlICYmICFmLmltcG9ydFNjcmlwdHMgPyAobiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIGYucG9zdE1lc3NhZ2UoZSArICIiLCAiKiIpOwogICAgICB9LCBmLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBtLCAhMSkpIDogbiA9IGggaW4gYSgic2NyaXB0IikgPyBmdW5jdGlvbiAoZSkgewogICAgICAgIHUuYXBwZW5kQ2hpbGQoYSgic2NyaXB0IikpW2hdID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdS5yZW1vdmVDaGlsZCh0aGlzKSwgYi5jYWxsKGUpOwogICAgICAgIH07CiAgICAgIH0gOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHNldFRpbWVvdXQoYyhiLCBlLCAxKSwgMCk7CiAgICAgIH0pLCB0LmV4cG9ydHMgPSB7IHNldDogbCwgY2xlYXI6IGQgfTsKICAgIH0sIHsgIi4vX2NvZiI6IDE1LCAiLi9fY3R4IjogMTcsICIuL19kb20tY3JlYXRlIjogMjAsICIuL19nbG9iYWwiOiAyNSwgIi4vX2h0bWwiOiAyOCwgIi4vX2ludm9rZSI6IDMwIH1dLCA2MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fdG8taW50ZWdlciIpLAogICAgICAgICAgbyA9IE1hdGgubWF4LAogICAgICAgICAgaSA9IE1hdGgubWluO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIGUgPSBuKGUpLCAwID4gZSA/IG8oZSArIHQsIDApIDogaShlLCB0KTsKICAgICAgfTsKICAgIH0sIHsgIi4vX3RvLWludGVnZXIiOiA2MiB9XSwgNjI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IE1hdGguY2VpbCwKICAgICAgICAgIG8gPSBNYXRoLmZsb29yO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGlzTmFOKGUgPSArZSkgPyAwIDogKGUgPiAwID8gbyA6IG4pKGUpOwogICAgICB9OwogICAgfSwge31dLCA2MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2RlZmluZWQiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuKG8oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4LCAiLi9faW9iamVjdCI6IDMxIH1dLCA2NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fdG8taW50ZWdlciIpLAogICAgICAgICAgbyA9IE1hdGgubWluO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUgPiAwID8gbyhuKGUpLCA5MDA3MTk5MjU0NzQwOTkxKSA6IDA7CiAgICAgIH07CiAgICB9LCB7ICIuL190by1pbnRlZ2VyIjogNjIgfV0sIDY1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gT2JqZWN0KG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4IH1dLCA2NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faXMtb2JqZWN0Iik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoIW4oZSkpIHJldHVybiBlO3ZhciByLCBvO2lmICh0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIChyID0gZS50b1N0cmluZykgJiYgIW4obyA9IHIuY2FsbChlKSkpIHJldHVybiBvO2lmICgiZnVuY3Rpb24iID09IHR5cGVvZiAociA9IGUudmFsdWVPZikgJiYgIW4obyA9IHIuY2FsbChlKSkpIHJldHVybiBvO2lmICghdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiAociA9IGUudG9TdHJpbmcpICYmICFuKG8gPSByLmNhbGwoZSkpKSByZXR1cm4gbzt0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwogICAgICB9OwogICAgfSwgeyAiLi9faXMtb2JqZWN0IjogMzMgfV0sIDY3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSAwLAogICAgICAgICAgbyA9IE1hdGgucmFuZG9tKCk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIlN5bWJvbCgiLmNvbmNhdCh2b2lkIDAgPT09IGUgPyAiIiA6IGUsICIpXyIsICgrK24gKyBvKS50b1N0cmluZygzNikpOwogICAgICB9OwogICAgfSwge31dLCA2ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fc2hhcmVkIikoIndrcyIpLAogICAgICAgICAgbyA9IGUoIi4vX3VpZCIpLAogICAgICAgICAgaSA9IGUoIi4vX2dsb2JhbCIpLlN5bWJvbCwKICAgICAgICAgIGMgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBpLAogICAgICAgICAgcyA9IHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBjICYmIGlbZV0gfHwgKGMgPyBpIDogbykoIlN5bWJvbC4iICsgZSkpOwogICAgICB9O3Muc3RvcmUgPSBuOwogICAgfSwgeyAiLi9fZ2xvYmFsIjogMjUsICIuL19zaGFyZWQiOiA1NywgIi4vX3VpZCI6IDY3IH1dLCA2OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fY2xhc3NvZiIpLAogICAgICAgICAgbyA9IGUoIi4vX3drcyIpKCJpdGVyYXRvciIpLAogICAgICAgICAgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpO3QuZXhwb3J0cyA9IGUoIi4vX2NvcmUiKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPSBlID8gZVtvXSB8fCBlWyJAQGl0ZXJhdG9yIl0gfHwgaVtuKGUpXSA6IHZvaWQgMDsKICAgICAgfTsKICAgIH0sIHsgIi4vX2NsYXNzb2YiOiAxNCwgIi4vX2NvcmUiOiAxNiwgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fd2tzIjogNjggfV0sIDcwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vX2FkZC10by11bnNjb3BhYmxlcyIpLAogICAgICAgICAgbyA9IGUoIi4vX2l0ZXItc3RlcCIpLAogICAgICAgICAgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpLAogICAgICAgICAgYyA9IGUoIi4vX3RvLWlvYmplY3QiKTt0LmV4cG9ydHMgPSBlKCIuL19pdGVyLWRlZmluZSIpKEFycmF5LCAiQXJyYXkiLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHRoaXMuX3QgPSBjKGUpLCB0aGlzLl9pID0gMCwgdGhpcy5fayA9IHQ7CiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZSA9IHRoaXMuX3QsCiAgICAgICAgICAgIHQgPSB0aGlzLl9rLAogICAgICAgICAgICByID0gdGhpcy5faSsrO3JldHVybiAhZSB8fCByID49IGUubGVuZ3RoID8gKHRoaXMuX3QgPSB2b2lkIDAsIG8oMSkpIDogImtleXMiID09IHQgPyBvKDAsIHIpIDogInZhbHVlcyIgPT0gdCA/IG8oMCwgZVtyXSkgOiBvKDAsIFtyLCBlW3JdXSk7CiAgICAgIH0sICJ2YWx1ZXMiKSwgaS5Bcmd1bWVudHMgPSBpLkFycmF5LCBuKCJrZXlzIiksIG4oInZhbHVlcyIpLCBuKCJlbnRyaWVzIik7CiAgICB9LCB7ICIuL19hZGQtdG8tdW5zY29wYWJsZXMiOiAxMCwgIi4vX2l0ZXItZGVmaW5lIjogMzYsICIuL19pdGVyLXN0ZXAiOiAzOCwgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fdG8taW9iamVjdCI6IDYzIH1dLCA3MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fZXhwb3J0Iik7bihuLlMgKyBuLkYgKiAhZSgiLi9fZGVzY3JpcHRvcnMiKSwgIk9iamVjdCIsIHsgZGVmaW5lUHJvcGVydHk6IGUoIi4vX29iamVjdC1kcCIpLmYgfSk7CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fZXhwb3J0IjogMjIsICIuL19vYmplY3QtZHAiOiA0MyB9XSwgNzI6IFtmdW5jdGlvbiAoZSwgdCwgcikge30sIHt9XSwgNzM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBjID0gZSgiLi9fbGlicmFyeSIpLAogICAgICAgICAgcyA9IGUoIi4vX2dsb2JhbCIpLAogICAgICAgICAgdSA9IGUoIi4vX2N0eCIpLAogICAgICAgICAgYSA9IGUoIi4vX2NsYXNzb2YiKSwKICAgICAgICAgIGYgPSBlKCIuL19leHBvcnQiKSwKICAgICAgICAgIF8gPSBlKCIuL19pcy1vYmplY3QiKSwKICAgICAgICAgIGwgPSAoZSgiLi9fYW4tb2JqZWN0IiksIGUoIi4vX2EtZnVuY3Rpb24iKSksCiAgICAgICAgICBkID0gZSgiLi9fYW4taW5zdGFuY2UiKSwKICAgICAgICAgIHAgPSBlKCIuL19mb3Itb2YiKSwKICAgICAgICAgIHYgPSAoZSgiLi9fc2V0LXByb3RvIikuc2V0LCBlKCIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIikpLAogICAgICAgICAgeSA9IGUoIi4vX3Rhc2siKS5zZXQsCiAgICAgICAgICBoID0gZSgiLi9fbWljcm90YXNrIikoKSwKICAgICAgICAgIGIgPSAiUHJvbWlzZSIsCiAgICAgICAgICBtID0gcy5UeXBlRXJyb3IsCiAgICAgICAgICBnID0gcy5wcm9jZXNzLAogICAgICAgICAgX2ogPSBzW2JdLAogICAgICAgICAgZyA9IHMucHJvY2VzcywKICAgICAgICAgIHggPSAicHJvY2VzcyIgPT0gYShnKSwKICAgICAgICAgIHcgPSBmdW5jdGlvbiB3KCkge30sCiAgICAgICAgICBrID0gISFmdW5jdGlvbiAoKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhciB0ID0gX2oucmVzb2x2ZSgxKSwKICAgICAgICAgICAgICByID0gKHQuY29uc3RydWN0b3IgPSB7fSlbZSgiLi9fd2tzIikoInNwZWNpZXMiKV0gPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBlKHcsIHcpOwogICAgICAgICAgfTtyZXR1cm4gKHggfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50KSAmJiB0LnRoZW4odykgaW5zdGFuY2VvZiByOwogICAgICAgIH0gY2F0Y2ggKG4pIHt9CiAgICAgIH0oKSwKICAgICAgICAgIE8gPSBmdW5jdGlvbiBPKGUsIHQpIHsKICAgICAgICByZXR1cm4gZSA9PT0gdCB8fCBlID09PSBfaiAmJiB0ID09PSBpOwogICAgICB9LAogICAgICAgICAgTSA9IGZ1bmN0aW9uIE0oZSkgewogICAgICAgIHZhciB0O3JldHVybiBfKGUpICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mICh0ID0gZS50aGVuKSA/IHQgOiAhMTsKICAgICAgfSwKICAgICAgICAgIFAgPSBmdW5jdGlvbiBQKGUpIHsKICAgICAgICByZXR1cm4gTyhfaiwgZSkgPyBuZXcgUyhlKSA6IG5ldyBvKGUpOwogICAgICB9LAogICAgICAgICAgUyA9IG8gPSBmdW5jdGlvbiBvKGUpIHsKICAgICAgICB2YXIgdCwgcjt0aGlzLnByb21pc2UgPSBuZXcgZShmdW5jdGlvbiAoZSwgbikgewogICAgICAgICAgaWYgKHZvaWQgMCAhPT0gdCB8fCB2b2lkIDAgIT09IHIpIHRocm93IG0oIkJhZCBQcm9taXNlIGNvbnN0cnVjdG9yIik7dCA9IGUsIHIgPSBuOwogICAgICAgIH0pLCB0aGlzLnJlc29sdmUgPSBsKHQpLCB0aGlzLnJlamVjdCA9IGwocik7CiAgICAgIH0sCiAgICAgICAgICBFID0gZnVuY3Rpb24gRShlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGUoKTsKICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICByZXR1cm4geyBlcnJvcjogdCB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIFQgPSBmdW5jdGlvbiBUKGUsIHQpIHsKICAgICAgICBpZiAoIWUuX24pIHsKICAgICAgICAgIGUuX24gPSAhMDt2YXIgciA9IGUuX2M7aChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGZvciAodmFyIG4gPSBlLl92LCBvID0gMSA9PSBlLl9zLCBpID0gMCwgYyA9IGZ1bmN0aW9uIGModCkgewogICAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgICBjID0gbyA/IHQub2sgOiB0LmZhaWwsCiAgICAgICAgICAgICAgICAgIHMgPSB0LnJlc29sdmUsCiAgICAgICAgICAgICAgICAgIHUgPSB0LnJlamVjdCwKICAgICAgICAgICAgICAgICAgYSA9IHQuZG9tYWluO3RyeSB7CiAgICAgICAgICAgICAgICBjID8gKG8gfHwgKDIgPT0gZS5faCAmJiBDKGUpLCBlLl9oID0gMSksIGMgPT09ICEwID8gciA9IG4gOiAoYSAmJiBhLmVudGVyKCksIHIgPSBjKG4pLCBhICYmIGEuZXhpdCgpKSwgciA9PT0gdC5wcm9taXNlID8gdShtKCJQcm9taXNlLWNoYWluIGN5Y2xlIikpIDogKGkgPSBNKHIpKSA/IGkuY2FsbChyLCBzLCB1KSA6IHMocikpIDogdShuKTsKICAgICAgICAgICAgICB9IGNhdGNoIChmKSB7CiAgICAgICAgICAgICAgICB1KGYpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsgci5sZW5ndGggPiBpOykgewogICAgICAgICAgICAgIGMocltpKytdKTsKICAgICAgICAgICAgfWUuX2MgPSBbXSwgZS5fbiA9ICExLCB0ICYmICFlLl9oICYmIEEoZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBBID0gZnVuY3Rpb24gQShlKSB7CiAgICAgICAgeS5jYWxsKHMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0LAogICAgICAgICAgICAgIHIsCiAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICBvID0gZS5fdjtpZiAoVShlKSAmJiAodCA9IEUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB4ID8gZy5lbWl0KCJ1bmhhbmRsZWRSZWplY3Rpb24iLCBvLCBlKSA6IChyID0gcy5vbnVuaGFuZGxlZHJlamVjdGlvbikgPyByKHsgcHJvbWlzZTogZSwgcmVhc29uOiBvIH0pIDogKG4gPSBzLmNvbnNvbGUpICYmIG4uZXJyb3IgJiYgbi5lcnJvcigiVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uIiwgbyk7CiAgICAgICAgICB9KSwgZS5faCA9IHggfHwgVShlKSA/IDIgOiAxKSwgZS5fYSA9IHZvaWQgMCwgdCkgdGhyb3cgdC5lcnJvcjsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgICAgIFUgPSBmdW5jdGlvbiBVKGUpIHsKICAgICAgICBpZiAoMSA9PSBlLl9oKSByZXR1cm4gITE7Zm9yICh2YXIgdCwgciA9IGUuX2EgfHwgZS5fYywgbiA9IDA7IHIubGVuZ3RoID4gbjspIHsKICAgICAgICAgIGlmICh0ID0gcltuKytdLCB0LmZhaWwgfHwgIVUodC5wcm9taXNlKSkgcmV0dXJuICExOwogICAgICAgIH1yZXR1cm4gITA7CiAgICAgIH0sCiAgICAgICAgICBDID0gZnVuY3Rpb24gQyhlKSB7CiAgICAgICAgeS5jYWxsKHMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0O3ggPyBnLmVtaXQoInJlamVjdGlvbkhhbmRsZWQiLCBlKSA6ICh0ID0gcy5vbnJlamVjdGlvbmhhbmRsZWQpICYmIHQoeyBwcm9taXNlOiBlLCByZWFzb246IGUuX3YgfSk7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgICAgICBSID0gZnVuY3Rpb24gUihlKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzO3QuX2QgfHwgKHQuX2QgPSAhMCwgdCA9IHQuX3cgfHwgdCwgdC5fdiA9IGUsIHQuX3MgPSAyLCB0Ll9hIHx8ICh0Ll9hID0gdC5fYy5zbGljZSgpKSwgVCh0LCAhMCkpOwogICAgICB9LAogICAgICAgICAgTCA9IGZ1bmN0aW9uIEwoZSkgewogICAgICAgIHZhciB0LAogICAgICAgICAgICByID0gdGhpcztpZiAoIXIuX2QpIHsKICAgICAgICAgIHIuX2QgPSAhMCwgciA9IHIuX3cgfHwgcjt0cnkgewogICAgICAgICAgICBpZiAociA9PT0gZSkgdGhyb3cgbSgiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGYiKTsodCA9IE0oZSkpID8gaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIG4gPSB7IF93OiByLCBfZDogITEgfTt0cnkgewogICAgICAgICAgICAgICAgdC5jYWxsKGUsIHUoTCwgbiwgMSksIHUoUiwgbiwgMSkpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKG8pIHsKICAgICAgICAgICAgICAgIFIuY2FsbChuLCBvKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pIDogKHIuX3YgPSBlLCByLl9zID0gMSwgVChyLCAhMSkpOwogICAgICAgICAgfSBjYXRjaCAobikgewogICAgICAgICAgICBSLmNhbGwoeyBfdzogciwgX2Q6ICExIH0sIG4pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTtrIHx8IChfaiA9IGZ1bmN0aW9uIGooZSkgewogICAgICAgIGQodGhpcywgX2osIGIsICJfaCIpLCBsKGUpLCBuLmNhbGwodGhpcyk7dHJ5IHsKICAgICAgICAgIGUodShMLCB0aGlzLCAxKSwgdShSLCB0aGlzLCAxKSk7CiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgUi5jYWxsKHRoaXMsIHQpOwogICAgICAgIH0KICAgICAgfSwgbiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHRoaXMuX2MgPSBbXSwgdGhpcy5fYSA9IHZvaWQgMCwgdGhpcy5fcyA9IDAsIHRoaXMuX2QgPSAhMSwgdGhpcy5fdiA9IHZvaWQgMCwgdGhpcy5faCA9IDAsIHRoaXMuX24gPSAhMTsKICAgICAgfSwgbi5wcm90b3R5cGUgPSBlKCIuL19yZWRlZmluZS1hbGwiKShfai5wcm90b3R5cGUsIHsgdGhlbjogZnVuY3Rpb24gdGhlbihlLCB0KSB7CiAgICAgICAgICB2YXIgciA9IFAodih0aGlzLCBfaikpO3JldHVybiByLm9rID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSA/IGUgOiAhMCwgci5mYWlsID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdCAmJiB0LCByLmRvbWFpbiA9IHggPyBnLmRvbWFpbiA6IHZvaWQgMCwgdGhpcy5fYy5wdXNoKHIpLCB0aGlzLl9hICYmIHRoaXMuX2EucHVzaChyKSwgdGhpcy5fcyAmJiBUKHRoaXMsICExKSwgci5wcm9taXNlOwogICAgICAgIH0sICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaChlKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgZSk7CiAgICAgICAgfSB9KSwgUyA9IGZ1bmN0aW9uIFMoKSB7CiAgICAgICAgdmFyIGUgPSBuZXcgbigpO3RoaXMucHJvbWlzZSA9IGUsIHRoaXMucmVzb2x2ZSA9IHUoTCwgZSwgMSksIHRoaXMucmVqZWN0ID0gdShSLCBlLCAxKTsKICAgICAgfSksIGYoZi5HICsgZi5XICsgZi5GICogIWssIHsgUHJvbWlzZTogX2ogfSksIGUoIi4vX3NldC10by1zdHJpbmctdGFnIikoX2osIGIpLCBlKCIuL19zZXQtc3BlY2llcyIpKGIpLCBpID0gZSgiLi9fY29yZSIpW2JdLCBmKGYuUyArIGYuRiAqICFrLCBiLCB7IHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KGUpIHsKICAgICAgICAgIHZhciB0ID0gUCh0aGlzKSwKICAgICAgICAgICAgICByID0gdC5yZWplY3Q7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCBmKGYuUyArIGYuRiAqIChjIHx8ICFrKSwgYiwgeyByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKGUpIHsKICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgX2ogJiYgTyhlLmNvbnN0cnVjdG9yLCB0aGlzKSkgcmV0dXJuIGU7dmFyIHQgPSBQKHRoaXMpLAogICAgICAgICAgICAgIHIgPSB0LnJlc29sdmU7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCBmKGYuUyArIGYuRiAqICEoayAmJiBlKCIuL19pdGVyLWRldGVjdCIpKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX2ouYWxsKGUpWyJjYXRjaCJdKHcpOwogICAgICB9KSksIGIsIHsgYWxsOiBmdW5jdGlvbiBhbGwoZSkgewogICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgIHIgPSBQKHQpLAogICAgICAgICAgICAgIG4gPSByLnJlc29sdmUsCiAgICAgICAgICAgICAgbyA9IHIucmVqZWN0LAogICAgICAgICAgICAgIGkgPSBFKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHIgPSBbXSwKICAgICAgICAgICAgICAgIGkgPSAwLAogICAgICAgICAgICAgICAgYyA9IDE7cChlLCAhMSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB2YXIgcyA9IGkrKywKICAgICAgICAgICAgICAgICAgdSA9ICExO3IucHVzaCh2b2lkIDApLCBjKyssIHQucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICB1IHx8ICh1ID0gITAsIHJbc10gPSBlLCAtLWMgfHwgbihyKSk7CiAgICAgICAgICAgICAgfSwgbyk7CiAgICAgICAgICAgIH0pLCAtLWMgfHwgbihyKTsKICAgICAgICAgIH0pO3JldHVybiBpICYmIG8oaS5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9LCByYWNlOiBmdW5jdGlvbiByYWNlKGUpIHsKICAgICAgICAgIHZhciB0ID0gdGhpcywKICAgICAgICAgICAgICByID0gUCh0KSwKICAgICAgICAgICAgICBuID0gci5yZWplY3QsCiAgICAgICAgICAgICAgbyA9IEUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBwKGUsICExLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHQucmVzb2x2ZShlKS50aGVuKHIucmVzb2x2ZSwgbik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7cmV0dXJuIG8gJiYgbihvLmVycm9yKSwgci5wcm9taXNlOwogICAgICAgIH0gfSk7CiAgICB9LCB7ICIuL19hLWZ1bmN0aW9uIjogOSwgIi4vX2FuLWluc3RhbmNlIjogMTEsICIuL19hbi1vYmplY3QiOiAxMiwgIi4vX2NsYXNzb2YiOiAxNCwgIi4vX2NvcmUiOiAxNiwgIi4vX2N0eCI6IDE3LCAiLi9fZXhwb3J0IjogMjIsICIuL19mb3Itb2YiOiAyNCwgIi4vX2dsb2JhbCI6IDI1LCAiLi9faXMtb2JqZWN0IjogMzMsICIuL19pdGVyLWRldGVjdCI6IDM3LCAiLi9fbGlicmFyeSI6IDQwLCAiLi9fbWljcm90YXNrIjogNDEsICIuL19yZWRlZmluZS1hbGwiOiA1MSwgIi4vX3NldC1wcm90byI6IDUzLCAiLi9fc2V0LXNwZWNpZXMiOiA1NCwgIi4vX3NldC10by1zdHJpbmctdGFnIjogNTUsICIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIjogNTgsICIuL190YXNrIjogNjAsICIuL193a3MiOiA2OCB9XSwgNzQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi9fc3RyaW5nLWF0IikoITApO2UoIi4vX2l0ZXItZGVmaW5lIikoU3RyaW5nLCAiU3RyaW5nIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB0aGlzLl90ID0gU3RyaW5nKGUpLCB0aGlzLl9pID0gMDsKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBlLAogICAgICAgICAgICB0ID0gdGhpcy5fdCwKICAgICAgICAgICAgciA9IHRoaXMuX2k7cmV0dXJuIHIgPj0gdC5sZW5ndGggPyB7IHZhbHVlOiB2b2lkIDAsIGRvbmU6ICEwIH0gOiAoZSA9IG4odCwgciksIHRoaXMuX2kgKz0gZS5sZW5ndGgsIHsgdmFsdWU6IGUsIGRvbmU6ICExIH0pOwogICAgICB9KTsKICAgIH0sIHsgIi4vX2l0ZXItZGVmaW5lIjogMzYsICIuL19zdHJpbmctYXQiOiA1OSB9XSwgNzU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuL2VzNi5hcnJheS5pdGVyYXRvciIpO2ZvciAodmFyIG4gPSBlKCIuL19nbG9iYWwiKSwgbyA9IGUoIi4vX2hpZGUiKSwgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpLCBjID0gZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIiksIHMgPSBbIk5vZGVMaXN0IiwgIkRPTVRva2VuTGlzdCIsICJNZWRpYUxpc3QiLCAiU3R5bGVTaGVldExpc3QiLCAiQ1NTUnVsZUxpc3QiXSwgdSA9IDA7IDUgPiB1OyB1KyspIHsKICAgICAgICB2YXIgYSA9IHNbdV0sCiAgICAgICAgICAgIGYgPSBuW2FdLAogICAgICAgICAgICBfID0gZiAmJiBmLnByb3RvdHlwZTtfICYmICFfW2NdICYmIG8oXywgYywgYSksIGlbYV0gPSBpLkFycmF5OwogICAgICB9CiAgICB9LCB7ICIuL19nbG9iYWwiOiAyNSwgIi4vX2hpZGUiOiAyNywgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fd2tzIjogNjgsICIuL2VzNi5hcnJheS5pdGVyYXRvciI6IDcwIH1dLCA3NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoIi4vaHlwZXJ0eS1kaXNjb3ZlcnkvSHlwZXJ0eURpc2NvdmVyeSIpLAogICAgICAgICAgaSA9IG4obyk7clsiZGVmYXVsdCJdID0gaVsiZGVmYXVsdCJdLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuL2h5cGVydHktZGlzY292ZXJ5L0h5cGVydHlEaXNjb3ZlcnkiOiA3NyB9XSwgNzc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBjID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBzID0gbihjKSwKICAgICAgICAgIHUgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGEgPSBuKHUpLAogICAgICAgICAgZiA9IGUoIi4uL3V0aWxzL3V0aWxzIiksCiAgICAgICAgICBfID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCwgcikgewogICAgICAgICAgKDAsIHNbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIG4gPSB0aGlzO24ubWVzc2FnZUJ1cyA9IHIsIG4uZG9tYWluID0gKDAsIGYuZGl2aWRlVVJMKSh0KS5kb21haW4sIG4uZGlzY292ZXJ5VVJMID0gdDsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogImRpc2NvdmVyRGF0YU9iamVjdFBlck5hbWUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiAiZGF0YU9iamVjdDovLyIgKyBlIH0gfTtyZXR1cm4gbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHIubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShvLCBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgdmFyIG4gPSByLmJvZHkudmFsdWUudXJsO24gPyBlKG4pIDogdCgiRGF0YU9iamVjdCBuYW1lIGRvZXMgbm90IGV4aXN0Iik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogImRpc2NvdmVySHlwZXJ0eVBlclVzZXIiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0gInVzZXI6Ly8iICsgZS5zdWJzdHJpbmcoZS5pbmRleE9mKCJAIikgKyAxLCBlLmxlbmd0aCkgKyAiLyIgKyBlLnN1YnN0cmluZygwLCBlLmluZGV4T2YoIkAiKSksCiAgICAgICAgICAgICAgICBjID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiBvIH0gfTtyZXR1cm4gY29uc29sZS5sb2coIk1lc3NhZ2U6ICIsIGMsIG4sIG8pLCBuZXcgaVsiZGVmYXVsdCJdKGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgci5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKGMsIGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygibWVzc2FnZSByZXBseSIsIHIpO3ZhciBvID0gdm9pZCAwLAogICAgICAgICAgICAgICAgICAgIGkgPSB2b2lkIDAsCiAgICAgICAgICAgICAgICAgICAgYyA9IHZvaWQgMCwKICAgICAgICAgICAgICAgICAgICBzID0gci5ib2R5LnZhbHVlO2ZvciAobyBpbiBzKSB7CiAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHNbb10ubGFzdE1vZGlmaWVkKSBpZiAodm9pZCAwID09PSBpKSBpID0gbmV3IERhdGUoc1tvXS5sYXN0TW9kaWZpZWQpLCBjID0gbztlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdSA9IG5ldyBEYXRlKHNbb10ubGFzdE1vZGlmaWVkKTtpLmdldFRpbWUoKSA8IHUuZ2V0VGltZSgpICYmIChpID0gdSwgYyA9IG8pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9Y29uc29sZS5sb2coIkxhc3QgSHlwZXJ0eTogIiwgYywgaSk7dmFyIGEgPSBjO2lmICh2b2lkIDAgPT09IGEpIHJldHVybiBuKCJVc2VyIEh5cGVydHkgbm90IGZvdW5kIik7dmFyIGYgPSB7IGlkOiBlLCBkZXNjcmlwdG9yOiBzW2FdLmRlc2NyaXB0b3IsIGh5cGVydHlVUkw6IGEgfTtjb25zb2xlLmxvZygiPT09PiBoeXBlcnR5RGlzY292ZXJ5IG1lc3NhZ2VCdW5kbGU6ICIsIGYpLCB0KGYpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkaXNjb3Zlckh5cGVydGllc1BlclVzZXIiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0gInVzZXI6Ly8iICsgZS5zdWJzdHJpbmcoZS5pbmRleE9mKCJAIikgKyAxLCBlLmxlbmd0aCkgKyAiLyIgKyBlLnN1YnN0cmluZygwLCBlLmluZGV4T2YoIkAiKSksCiAgICAgICAgICAgICAgICBjID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiBvIH0gfTtyZXR1cm4gY29uc29sZS5sb2coIk1lc3NhZ2UgZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyOiAiLCBjLCBuLCBvKSwgbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHIubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShjLCBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coImRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlciByZXBseSIsIHIpO3ZhciBuID0gci5ib2R5LnZhbHVlO3JldHVybiBuID8gdm9pZCBlKG4pIDogdCgiVXNlciBIeXBlcnR5IG5vdCBmb3VuZCIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gXywgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi4vdXRpbHMvdXRpbHMiOiA3OCwgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIjogMywgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDQsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiA1IH1dLCA3ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1mdW5jdGlvbiBvKGUpIHsKICAgICAgICB2YXIgdCA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpLAogICAgICAgICAgICByID0gIiQxLCQyLCQzIiwKICAgICAgICAgICAgbiA9IGUucmVwbGFjZSh0LCByKS5zcGxpdCgiLCIpO25bMF0gPT09IGUgJiYgKG5bMF0gPSAiaHR0cHMiLCBuWzFdID0gZSk7dmFyIG8gPSB7IHR5cGU6IG5bMF0sIGRvbWFpbjogblsxXSwgaWRlbnRpdHk6IG5bMl0gfTtyZXR1cm4gbzsKICAgICAgfWZ1bmN0aW9uIGkoZSkgewogICAgICAgIHJldHVybiBlID8gSlNPTi5wYXJzZSgoMCwgc1siZGVmYXVsdCJdKShlKSkgOiB2b2lkIDA7CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgYyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSIpLAogICAgICAgICAgcyA9IG4oYyk7ci5kaXZpZGVVUkwgPSBvLCByLmRlZXBDbG9uZSA9IGk7CiAgICB9LCB7ICJiYWJlbC1ydW50aW1lL2NvcmUtanMvanNvbi9zdHJpbmdpZnkiOiAxIH1dIH0sIHt9LCBbNzZdKSg3Nik7Cn0pOwoKfSkuY2FsbCh0aGlzLHR5cGVvZiBnbG9iYWwgIT09ICJ1bmRlZmluZWQiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDoge30pCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewooZnVuY3Rpb24gKGdsb2JhbCl7CiJ1c2Ugc3RyaWN0IjsKCnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsKCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKLy8gRGlzdHJpYnV0aW9uIGZpbGUgZm9yIFN5bmNoZXIuanMKLy8gdmVyc2lvbjogMC4yLjAKCiFmdW5jdGlvbiAoZSkgewogIGlmICgib2JqZWN0IiA9PSAodHlwZW9mIGV4cG9ydHMgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGV4cG9ydHMpKSAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgbW9kdWxlKSBtb2R1bGUuZXhwb3J0cyA9IGUoKTtlbHNlIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiBkZWZpbmUgJiYgZGVmaW5lLmFtZCkgZGVmaW5lKFtdLCBlKTtlbHNlIHsKICAgIHZhciB0O3QgPSAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIGdsb2JhbCA/IGdsb2JhbCA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBzZWxmID8gc2VsZiA6IHRoaXMsIHQuU3luY2hlciA9IGUoKTsKICB9Cn0oZnVuY3Rpb24gKCkgewogIHJldHVybiBmdW5jdGlvbiBlKHQsIHIsIG4pIHsKICAgIGZ1bmN0aW9uIG8ocywgYSkgewogICAgICBpZiAoIXJbc10pIHsKICAgICAgICBpZiAoIXRbc10pIHsKICAgICAgICAgIHZhciBjID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgcmVxdWlyZSAmJiByZXF1aXJlO2lmICghYSAmJiBjKSByZXR1cm4gYyhzLCAhMCk7aWYgKGkpIHJldHVybiBpKHMsICEwKTt2YXIgdSA9IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciICsgcyArICInIik7dGhyb3cgdS5jb2RlID0gIk1PRFVMRV9OT1RfRk9VTkQiLCB1OwogICAgICAgIH12YXIgbCA9IHJbc10gPSB7IGV4cG9ydHM6IHt9IH07dFtzXVswXS5jYWxsKGwuZXhwb3J0cywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciByID0gdFtzXVsxXVtlXTtyZXR1cm4gbyhyID8gciA6IGUpOwogICAgICAgIH0sIGwsIGwuZXhwb3J0cywgZSwgdCwgciwgbik7CiAgICAgIH1yZXR1cm4gcltzXS5leHBvcnRzOwogICAgfWZvciAodmFyIGkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiByZXF1aXJlICYmIHJlcXVpcmUsIHMgPSAwOyBzIDwgbi5sZW5ndGg7IHMrKykgewogICAgICBvKG5bc10pOwogICAgfXJldHVybiBvOwogIH0oeyAxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgT2JqZWN0Lm9ic2VydmUgJiYgIUFycmF5Lm9ic2VydmUgJiYgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgdmFyIHIgPSBlLmdldE5vdGlmaWVyLAogICAgICAgICAgICBuID0gInBlcmZvcm1DaGFuZ2UiLAogICAgICAgICAgICBvID0gIl9vcmlnaW5hbCIsCiAgICAgICAgICAgIGkgPSAic3BsaWNlIiwKICAgICAgICAgICAgcyA9IHsgcHVzaDogZnVuY3Rpb24gYyhlKSB7CiAgICAgICAgICAgIHZhciB0ID0gYXJndW1lbnRzLAogICAgICAgICAgICAgICAgcyA9IGNbb10uYXBwbHkodGhpcywgdCk7cmV0dXJuIHIodGhpcylbbl0oaSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiB7IGluZGV4OiBzIC0gdC5sZW5ndGgsIGFkZGVkQ291bnQ6IHQubGVuZ3RoLCByZW1vdmVkOiBbXSB9OwogICAgICAgICAgICB9KSwgczsKICAgICAgICAgIH0sIHVuc2hpZnQ6IGZ1bmN0aW9uIHUoZSkgewogICAgICAgICAgICB2YXIgdCA9IGFyZ3VtZW50cywKICAgICAgICAgICAgICAgIHMgPSB1W29dLmFwcGx5KHRoaXMsIHQpO3JldHVybiByKHRoaXMpW25dKGksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4geyBpbmRleDogMCwgYWRkZWRDb3VudDogdC5sZW5ndGgsIHJlbW92ZWQ6IFtdIH07CiAgICAgICAgICAgIH0pLCBzOwogICAgICAgICAgfSwgcG9wOiBmdW5jdGlvbiBsKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMubGVuZ3RoLAogICAgICAgICAgICAgICAgdCA9IGxbb10uY2FsbCh0aGlzKTtyZXR1cm4gdGhpcy5sZW5ndGggIT09IGUgJiYgcih0aGlzKVtuXShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHsgaW5kZXg6IHRoaXMubGVuZ3RoLCBhZGRlZENvdW50OiAwLCByZW1vdmVkOiBbdF0gfTsKICAgICAgICAgICAgfSwgdGhpcyksIHQ7CiAgICAgICAgICB9LCBzaGlmdDogZnVuY3Rpb24gZigpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmxlbmd0aCwKICAgICAgICAgICAgICAgIHQgPSBmW29dLmNhbGwodGhpcyk7cmV0dXJuIHRoaXMubGVuZ3RoICE9PSBlICYmIHIodGhpcylbbl0oaSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiB7IGluZGV4OiAwLCBhZGRlZENvdW50OiAwLCByZW1vdmVkOiBbdF0gfTsKICAgICAgICAgICAgfSwgdGhpcyksIHQ7CiAgICAgICAgICB9LCBzcGxpY2U6IGZ1bmN0aW9uIGQoZSwgdCkgewogICAgICAgICAgICB2YXIgcyA9IGFyZ3VtZW50cywKICAgICAgICAgICAgICAgIGEgPSBkW29dLmFwcGx5KHRoaXMsIHMpO3JldHVybiAoYS5sZW5ndGggfHwgcy5sZW5ndGggPiAyKSAmJiByKHRoaXMpW25dKGksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4geyBpbmRleDogZSwgYWRkZWRDb3VudDogcy5sZW5ndGggLSAyLCByZW1vdmVkOiBhIH07CiAgICAgICAgICAgIH0sIHRoaXMpLCBhOwogICAgICAgICAgfSB9O2ZvciAodmFyIGEgaW4gcykgewogICAgICAgICAgc1thXVtvXSA9IHQucHJvdG90eXBlW2FdLCB0LnByb3RvdHlwZVthXSA9IHNbYV07CiAgICAgICAgfXQub2JzZXJ2ZSA9IGZ1bmN0aW9uICh0LCByKSB7CiAgICAgICAgICByZXR1cm4gZS5vYnNlcnZlKHQsIHIsIFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCBpXSk7CiAgICAgICAgfSwgdC51bm9ic2VydmUgPSBlLnVub2JzZXJ2ZTsKICAgICAgfShPYmplY3QsIEFycmF5KTsKICAgIH0sIHt9XSwgMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vanNvbi9zdHJpbmdpZnkiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSI6IDE3IH1dLCAzOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvY3JlYXRlIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZSI6IDE4IH1dLCA0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDE5IH1dLCA1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI6IDIwIH1dLCA2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiIpLCBfX2VzTW9kdWxlOiAhMCB9OwogICAgfSwgeyAiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjogMjEgfV0sIDc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9rZXlzIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2tleXMiOiAyMiB9XSwgODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L3NldC1wcm90b3R5cGUtb2YiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiI6IDIzIH1dLCA5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vcHJvbWlzZSI6IDI0IH1dLCAxMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIjogMjUgfV0sIDExOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICByLl9fZXNNb2R1bGUgPSAhMCwgclsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgdCkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgICB9OwogICAgfSwge31dLCAxMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1yLl9fZXNNb2R1bGUgPSAhMDt2YXIgbyA9IGUoIi4uL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSIpLAogICAgICAgICAgaSA9IG4obyk7clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUoZSwgdCkgewogICAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgIHZhciBuID0gdFtyXTtuLmVudW1lcmFibGUgPSBuLmVudW1lcmFibGUgfHwgITEsIG4uY29uZmlndXJhYmxlID0gITAsICJ2YWx1ZSIgaW4gbiAmJiAobi53cml0YWJsZSA9ICEwKSwgKDAsIGlbImRlZmF1bHQiXSkoZSwgbi5rZXksIG4pOwogICAgICAgICAgfQogICAgICAgIH1yZXR1cm4gZnVuY3Rpb24gKHQsIHIsIG4pIHsKICAgICAgICAgIHJldHVybiByICYmIGUodC5wcm90b3R5cGUsIHIpLCBuICYmIGUodCwgbiksIHQ7CiAgICAgICAgfTsKICAgICAgfSgpOwogICAgfSwgeyAiLi4vY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5IjogNCB9XSwgMTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiKVsiZGVmYXVsdCJdO3JbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZm9yICh2YXIgbyA9ICEwOyBvOykgewogICAgICAgICAgdmFyIGkgPSBlLAogICAgICAgICAgICAgIHMgPSB0LAogICAgICAgICAgICAgIGEgPSByO28gPSAhMSwgbnVsbCA9PT0gaSAmJiAoaSA9IEZ1bmN0aW9uLnByb3RvdHlwZSk7dmFyIGMgPSBuKGksIHMpO2lmICh2b2lkIDAgIT09IGMpIHsKICAgICAgICAgICAgaWYgKCJ2YWx1ZSIgaW4gYykgcmV0dXJuIGMudmFsdWU7dmFyIHUgPSBjLmdldDtpZiAodm9pZCAwID09PSB1KSByZXR1cm47cmV0dXJuIHUuY2FsbChhKTsKICAgICAgICAgIH12YXIgbCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihpKTtpZiAobnVsbCA9PT0gbCkgcmV0dXJuO2UgPSBsLCB0ID0gcywgciA9IGEsIG8gPSAhMCwgYyA9IGwgPSB2b2lkIDA7CiAgICAgICAgfQogICAgICB9LCByLl9fZXNNb2R1bGUgPSAhMDsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjogNSB9XSwgMTQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9jcmVhdGUiKVsiZGVmYXVsdCJdLAogICAgICAgICAgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiIpWyJkZWZhdWx0Il07clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgdCAmJiBudWxsICE9PSB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHQgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKHQpKSk7ZS5wcm90b3R5cGUgPSBuKHQgJiYgdC5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IGUsIGVudW1lcmFibGU6ICExLCB3cml0YWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAgfSB9KSwgdCAmJiAobyA/IG8oZSwgdCkgOiBlLl9fcHJvdG9fXyA9IHQpOwogICAgICB9LCByLl9fZXNNb2R1bGUgPSAhMDsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvY3JlYXRlIjogMywgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiI6IDggfV0sIDE1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfXIuX19lc01vZHVsZSA9ICEwO3ZhciBvID0gZSgiLi4vaGVscGVycy90eXBlb2YiKSwKICAgICAgICAgIGkgPSBuKG8pO3JbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCFlKSB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiAhdCB8fCAib2JqZWN0IiAhPT0gKCJ1bmRlZmluZWQiID09IHR5cGVvZiB0ID8gInVuZGVmaW5lZCIgOiAoMCwgaVsiZGVmYXVsdCJdKSh0KSkgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgdCA/IGUgOiB0OwogICAgICB9OwogICAgfSwgeyAiLi4vaGVscGVycy90eXBlb2YiOiAxNiB9XSwgMTY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbCIpWyJkZWZhdWx0Il07clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLmNvbnN0cnVjdG9yID09PSBuID8gInN5bWJvbCIgOiB0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSk7CiAgICAgIH0sIHIuX19lc01vZHVsZSA9ICEwOwogICAgfSwgeyAiYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbCI6IDEwIH1dLCAxNzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kLmNvcmUiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAobi5KU09OICYmIG4uSlNPTi5zdHJpbmdpZnkgfHwgSlNPTi5zdHJpbmdpZnkpLmFwcGx5KEpTT04sIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQuY29yZSI6IDMxIH1dLCAxODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICByZXR1cm4gbi5jcmVhdGUoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQiOiA1NiB9XSwgMTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4uLy4uL21vZHVsZXMvJCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIG4uc2V0RGVzYyhlLCB0LCByKTsKICAgICAgfTsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJCI6IDU2IH1dLCAyMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kIik7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpLCB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBuLmdldERlc2MoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQiOiA1NiwgIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOiA4MSB9XSwgMjE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZiIpLCB0LmV4cG9ydHMgPSBlKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZiI6IDgyIH1dLCAyMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5rZXlzIiksIHQuZXhwb3J0cyA9IGUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuT2JqZWN0LmtleXM7CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQuY29yZSI6IDMxLCAiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmtleXMiOiA4MyB9XSwgMjM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZiIpLCB0LmV4cG9ydHMgPSBlKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5zZXRQcm90b3R5cGVPZjsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZiI6IDg0IH1dLCAyNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmciKSwgZSgiLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yIiksIGUoIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSIpLCBlKCIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIiksIHQuZXhwb3J0cyA9IGUoIi4uL21vZHVsZXMvJC5jb3JlIikuUHJvbWlzZTsKICAgIH0sIHsgIi4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIjogODUsICIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIjogODYsICIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOiA4NywgIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSI6IDg5IH1dLCAyNTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCIpLCBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIiksIHQuZXhwb3J0cyA9IGUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuU3ltYm9sOwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy8kLmNvcmUiOiAzMSwgIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmciOiA4NSwgIi4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCI6IDg4IH1dLCAyNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGUpIHRocm93IFR5cGVFcnJvcihlICsgIiBpcyBub3QgYSBmdW5jdGlvbiEiKTtyZXR1cm4gZTsKICAgICAgfTsKICAgIH0sIHt9XSwgMjc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7fTsKICAgIH0sIHt9XSwgMjg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5pcy1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmICghbihlKSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhbiBvYmplY3QhIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuaXMtb2JqZWN0IjogNDkgfV0sIDI5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIiksCiAgICAgICAgICBvID0gZSgiLi8kLndrcyIpKCJ0b1N0cmluZ1RhZyIpLAogICAgICAgICAgaSA9ICJBcmd1bWVudHMiID09IG4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBhcmd1bWVudHM7CiAgICAgIH0oKSk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgdCwgciwgcztyZXR1cm4gdm9pZCAwID09PSBlID8gIlVuZGVmaW5lZCIgOiBudWxsID09PSBlID8gIk51bGwiIDogInN0cmluZyIgPT0gdHlwZW9mIChyID0gKHQgPSBPYmplY3QoZSkpW29dKSA/IHIgOiBpID8gbih0KSA6ICJPYmplY3QiID09IChzID0gbih0KSkgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdC5jYWxsZWUgPyAiQXJndW1lbnRzIiA6IHM7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAsICIuLyQud2tzIjogNzggfV0sIDMwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS50b1N0cmluZzt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSkuc2xpY2UoOCwgLTEpOwogICAgICB9OwogICAgfSwge31dLCAzMTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0geyB2ZXJzaW9uOiAiMS4yLjYiIH07Im51bWJlciIgPT0gdHlwZW9mIF9fZSAmJiAoX19lID0gbik7CiAgICB9LCB7fV0sIDMyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuYS1mdW5jdGlvbiIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgaWYgKG4oZSksIHZvaWQgMCA9PT0gdCkgcmV0dXJuIGU7c3dpdGNoIChyKSB7Y2FzZSAxOgogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICByZXR1cm4gZS5jYWxsKHQsIHIpOwogICAgICAgICAgICB9O2Nhc2UgMjoKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChyLCBuKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGUuY2FsbCh0LCByLCBuKTsKICAgICAgICAgICAgfTtjYXNlIDM6CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAociwgbiwgbykgewogICAgICAgICAgICAgIHJldHVybiBlLmNhbGwodCwgciwgbiwgbyk7CiAgICAgICAgICAgIH07fXJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZS5hcHBseSh0LCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH07CiAgICB9LCB7ICIuLyQuYS1mdW5jdGlvbiI6IDI2IH1dLCAzMzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKHZvaWQgMCA9PSBlKSB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNhbGwgbWV0aG9kIG9uICAiICsgZSk7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDM0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gIWUoIi4vJC5mYWlscyIpKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gNyAhPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICJhIiwgeyBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIDc7CiAgICAgICAgICB9IH0pLmE7CiAgICAgIH0pOwogICAgfSwgeyAiLi8kLmZhaWxzIjogMzggfV0sIDM1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaXMtb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi8kLmdsb2JhbCIpLmRvY3VtZW50LAogICAgICAgICAgaSA9IG4obykgJiYgbihvLmNyZWF0ZUVsZW1lbnQpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGkgPyBvLmNyZWF0ZUVsZW1lbnQoZSkgOiB7fTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5nbG9iYWwiOiA0MSwgIi4vJC5pcy1vYmplY3QiOiA0OSB9XSwgMzY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQgPSBuLmdldEtleXMoZSksCiAgICAgICAgICAgIHIgPSBuLmdldFN5bWJvbHM7aWYgKHIpIGZvciAodmFyIG8sIGkgPSByKGUpLCBzID0gbi5pc0VudW0sIGEgPSAwOyBpLmxlbmd0aCA+IGE7KSB7CiAgICAgICAgICBzLmNhbGwoZSwgbyA9IGlbYSsrXSkgJiYgdC5wdXNoKG8pOwogICAgICAgIH1yZXR1cm4gdDsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2IH1dLCAzNzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmdsb2JhbCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5jb3JlIiksCiAgICAgICAgICBpID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgcyA9ICJwcm90b3R5cGUiLAogICAgICAgICAgYSA9IGZ1bmN0aW9uIGEoZSwgdCwgcikgewogICAgICAgIHZhciBjLAogICAgICAgICAgICB1LAogICAgICAgICAgICBsLAogICAgICAgICAgICBmID0gZSAmIGEuRiwKICAgICAgICAgICAgZCA9IGUgJiBhLkcsCiAgICAgICAgICAgIHAgPSBlICYgYS5TLAogICAgICAgICAgICBiID0gZSAmIGEuUCwKICAgICAgICAgICAgaCA9IGUgJiBhLkIsCiAgICAgICAgICAgIHYgPSBlICYgYS5XLAogICAgICAgICAgICB5ID0gZCA/IG8gOiBvW3RdIHx8IChvW3RdID0ge30pLAogICAgICAgICAgICBfID0gZCA/IG4gOiBwID8gblt0XSA6IChuW3RdIHx8IHt9KVtzXTtkICYmIChyID0gdCk7Zm9yIChjIGluIHIpIHsKICAgICAgICAgIHUgPSAhZiAmJiBfICYmIGMgaW4gXywgdSAmJiBjIGluIHkgfHwgKGwgPSB1ID8gX1tjXSA6IHJbY10sIHlbY10gPSBkICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIF9bY10gPyByW2NdIDogaCAmJiB1ID8gaShsLCBuKSA6IHYgJiYgX1tjXSA9PSBsID8gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSBmdW5jdGlvbiB0KF90KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBlID8gbmV3IGUoX3QpIDogZShfdCk7CiAgICAgICAgICAgIH07cmV0dXJuIHRbc10gPSBlW3NdLCB0OwogICAgICAgICAgfShsKSA6IGIgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgbCA/IGkoRnVuY3Rpb24uY2FsbCwgbCkgOiBsLCBiICYmICgoeVtzXSB8fCAoeVtzXSA9IHt9KSlbY10gPSBsKSk7CiAgICAgICAgfQogICAgICB9O2EuRiA9IDEsIGEuRyA9IDIsIGEuUyA9IDQsIGEuUCA9IDgsIGEuQiA9IDE2LCBhLlcgPSAzMiwgdC5leHBvcnRzID0gYTsKICAgIH0sIHsgIi4vJC5jb3JlIjogMzEsICIuLyQuY3R4IjogMzIsICIuLyQuZ2xvYmFsIjogNDEgfV0sIDM4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuICEhZSgpOwogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgIHJldHVybiAhMDsKICAgICAgICB9CiAgICAgIH07CiAgICB9LCB7fV0sIDM5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY3R4IiksCiAgICAgICAgICBvID0gZSgiLi8kLml0ZXItY2FsbCIpLAogICAgICAgICAgaSA9IGUoIi4vJC5pcy1hcnJheS1pdGVyIiksCiAgICAgICAgICBzID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgYSA9IGUoIi4vJC50by1sZW5ndGgiKSwKICAgICAgICAgIGMgPSBlKCIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCB1KSB7CiAgICAgICAgdmFyIGwsCiAgICAgICAgICAgIGYsCiAgICAgICAgICAgIGQsCiAgICAgICAgICAgIHAgPSBjKGUpLAogICAgICAgICAgICBiID0gbihyLCB1LCB0ID8gMiA6IDEpLAogICAgICAgICAgICBoID0gMDtpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgcCkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBpdGVyYWJsZSEiKTtpZiAoaShwKSkgZm9yIChsID0gYShlLmxlbmd0aCk7IGwgPiBoOyBoKyspIHsKICAgICAgICAgIHQgPyBiKHMoZiA9IGVbaF0pWzBdLCBmWzFdKSA6IGIoZVtoXSk7CiAgICAgICAgfSBlbHNlIGZvciAoZCA9IHAuY2FsbChlKTsgIShmID0gZC5uZXh0KCkpLmRvbmU7KSB7CiAgICAgICAgICBvKGQsIGIsIGYudmFsdWUsIHQpOwogICAgICAgIH0KICAgICAgfTsKICAgIH0sIHsgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5pcy1hcnJheS1pdGVyIjogNDcsICIuLyQuaXRlci1jYWxsIjogNTAsICIuLyQudG8tbGVuZ3RoIjogNzUsICIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCI6IDc5IH1dLCA0MDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWlvYmplY3QiKSwKICAgICAgICAgIG8gPSBlKCIuLyQiKS5nZXROYW1lcywKICAgICAgICAgIGkgPSB7fS50b1N0cmluZywKICAgICAgICAgIHMgPSAib2JqZWN0IiA9PSAodHlwZW9mIHdpbmRvdyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yod2luZG93KSkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW10sCiAgICAgICAgICBhID0gZnVuY3Rpb24gYShlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBvKGUpOwogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgIHJldHVybiBzLnNsaWNlKCk7CiAgICAgICAgfQogICAgICB9O3QuZXhwb3J0cy5nZXQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBzICYmICJbb2JqZWN0IFdpbmRvd10iID09IGkuY2FsbChlKSA/IGEoZSkgOiBvKG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQudG8taW9iamVjdCI6IDc0IH1dLCA0MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoID8gd2luZG93IDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIHNlbGYgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oInJldHVybiB0aGlzIikoKTsibnVtYmVyIiA9PSB0eXBlb2YgX19nICYmIChfX2cgPSBuKTsKICAgIH0sIHt9XSwgNDI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IHt9Lmhhc093blByb3BlcnR5O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIG4uY2FsbChlLCB0KTsKICAgICAgfTsKICAgIH0sIHt9XSwgNDM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIik7dC5leHBvcnRzID0gZSgiLi8kLmRlc2NyaXB0b3JzIikgPyBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBuLnNldERlc2MoZSwgdCwgbygxLCByKSk7CiAgICAgIH0gOiBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBlW3RdID0gciwgZTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmRlc2NyaXB0b3JzIjogMzQsICIuLyQucHJvcGVydHktZGVzYyI6IDYxIH1dLCA0NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vJC5nbG9iYWwiKS5kb2N1bWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CiAgICB9LCB7ICIuLyQuZ2xvYmFsIjogNDEgfV0sIDQ1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICB2YXIgbiA9IHZvaWQgMCA9PT0gcjtzd2l0Y2ggKHQubGVuZ3RoKSB7Y2FzZSAwOgogICAgICAgICAgICByZXR1cm4gbiA/IGUoKSA6IGUuY2FsbChyKTtjYXNlIDE6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdKSA6IGUuY2FsbChyLCB0WzBdKTtjYXNlIDI6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdKTtjYXNlIDM6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdLCB0WzJdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdLCB0WzJdKTtjYXNlIDQ6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdLCB0WzJdLCB0WzNdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdLCB0WzJdLCB0WzNdKTt9cmV0dXJuIGUuYXBwbHkociwgdCk7CiAgICAgIH07CiAgICB9LCB7fV0sIDQ2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIik7dC5leHBvcnRzID0gT2JqZWN0KCJ6IikucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiU3RyaW5nIiA9PSBuKGUpID8gZS5zcGxpdCgiIikgOiBPYmplY3QoZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAgfV0sIDQ3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaXRlcmF0b3JzIiksCiAgICAgICAgICBvID0gZSgiLi8kLndrcyIpKCJpdGVyYXRvciIpLAogICAgICAgICAgaSA9IEFycmF5LnByb3RvdHlwZTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUgJiYgKG4uQXJyYXkgPT09IGUgfHwgaVtvXSA9PT0gZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQud2tzIjogNzggfV0sIDQ4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIik7dC5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiQXJyYXkiID09IG4oZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAgfV0sIDQ5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIm9iamVjdCIgPT0gKHR5cGVvZiBlID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihlKSkgPyBudWxsICE9PSBlIDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgZTsKICAgICAgfTsKICAgIH0sIHt9XSwgNTA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5hbi1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgciwgbykgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gbyA/IHQobihyKVswXSwgclsxXSkgOiB0KHIpOwogICAgICAgIH0gY2F0Y2ggKGkpIHsKICAgICAgICAgIHZhciBzID0gZVsicmV0dXJuIl07dGhyb3cgdm9pZCAwICE9PSBzICYmIG4ocy5jYWxsKGUpKSwgaTsKICAgICAgICB9CiAgICAgIH07CiAgICB9LCB7ICIuLyQuYW4tb2JqZWN0IjogMjggfV0sIDUxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vJCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBpID0gZSgiLi8kLnNldC10by1zdHJpbmctdGFnIiksCiAgICAgICAgICBzID0ge307ZSgiLi8kLmhpZGUiKShzLCBlKCIuLyQud2tzIikoIml0ZXJhdG9yIiksIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSksIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZS5wcm90b3R5cGUgPSBuLmNyZWF0ZShzLCB7IG5leHQ6IG8oMSwgcikgfSksIGkoZSwgdCArICIgSXRlcmF0b3IiKTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmhpZGUiOiA0MywgIi4vJC5wcm9wZXJ0eS1kZXNjIjogNjEsICIuLyQuc2V0LXRvLXN0cmluZy10YWciOiA2NywgIi4vJC53a3MiOiA3OCB9XSwgNTI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmxpYnJhcnkiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZXhwb3J0IiksCiAgICAgICAgICBpID0gZSgiLi8kLnJlZGVmaW5lIiksCiAgICAgICAgICBzID0gZSgiLi8kLmhpZGUiKSwKICAgICAgICAgIGEgPSBlKCIuLyQuaGFzIiksCiAgICAgICAgICBjID0gZSgiLi8kLml0ZXJhdG9ycyIpLAogICAgICAgICAgdSA9IGUoIi4vJC5pdGVyLWNyZWF0ZSIpLAogICAgICAgICAgbCA9IGUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpLAogICAgICAgICAgZiA9IGUoIi4vJCIpLmdldFByb3RvLAogICAgICAgICAgZCA9IGUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIHAgPSAhKFtdLmtleXMgJiYgIm5leHQiIGluIFtdLmtleXMoKSksCiAgICAgICAgICBiID0gIkBAaXRlcmF0b3IiLAogICAgICAgICAgaCA9ICJrZXlzIiwKICAgICAgICAgIHYgPSAidmFsdWVzIiwKICAgICAgICAgIHkgPSBmdW5jdGlvbiB5KCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBfLCBnLCBtLCBqKSB7CiAgICAgICAgdShyLCB0LCBfKTt2YXIgJCwKICAgICAgICAgICAgTywKICAgICAgICAgICAgdyA9IGZ1bmN0aW9uIHcoZSkgewogICAgICAgICAgaWYgKCFwICYmIGUgaW4gRSkgcmV0dXJuIEVbZV07c3dpdGNoIChlKSB7Y2FzZSBoOgogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICAgICAgfTtjYXNlIHY6CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcih0aGlzLCBlKTsKICAgICAgICAgICAgICB9O31yZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgICAgIGsgPSB0ICsgIiBJdGVyYXRvciIsCiAgICAgICAgICAgIHggPSBnID09IHYsCiAgICAgICAgICAgIEMgPSAhMSwKICAgICAgICAgICAgRSA9IGUucHJvdG90eXBlLAogICAgICAgICAgICBTID0gRVtkXSB8fCBFW2JdIHx8IGcgJiYgRVtnXSwKICAgICAgICAgICAgVCA9IFMgfHwgdyhnKTtpZiAoUykgewogICAgICAgICAgdmFyIE0gPSBmKFQuY2FsbChuZXcgZSgpKSk7bChNLCBrLCAhMCksICFuICYmIGEoRSwgYikgJiYgcyhNLCBkLCB5KSwgeCAmJiBTLm5hbWUgIT09IHYgJiYgKEMgPSAhMCwgVCA9IGZ1bmN0aW9uIFQoKSB7CiAgICAgICAgICAgIHJldHVybiBTLmNhbGwodGhpcyk7CiAgICAgICAgICB9KTsKICAgICAgICB9aWYgKG4gJiYgIWogfHwgIXAgJiYgIUMgJiYgRVtkXSB8fCBzKEUsIGQsIFQpLCBjW3RdID0gVCwgY1trXSA9IHksIGcpIGlmICgkID0geyB2YWx1ZXM6IHggPyBUIDogdyh2KSwga2V5czogbSA/IFQgOiB3KGgpLCBlbnRyaWVzOiB4ID8gdygiZW50cmllcyIpIDogVCB9LCBqKSBmb3IgKE8gaW4gJCkgewogICAgICAgICAgTyBpbiBFIHx8IGkoRSwgTywgJFtPXSk7CiAgICAgICAgfSBlbHNlIG8oby5QICsgby5GICogKHAgfHwgQyksIHQsICQpO3JldHVybiAkOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuZXhwb3J0IjogMzcsICIuLyQuaGFzIjogNDIsICIuLyQuaGlkZSI6IDQzLCAiLi8kLml0ZXItY3JlYXRlIjogNTEsICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQubGlicmFyeSI6IDU4LCAiLi8kLnJlZGVmaW5lIjogNjMsICIuLyQuc2V0LXRvLXN0cmluZy10YWciOiA2NywgIi4vJC53a3MiOiA3OCB9XSwgNTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIG8gPSAhMTt0cnkgewogICAgICAgIHZhciBpID0gWzddW25dKCk7aVsicmV0dXJuIl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBvID0gITA7CiAgICAgICAgfSwgQXJyYXkuZnJvbShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aHJvdyAyOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChzKSB7fXQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCF0ICYmICFvKSByZXR1cm4gITE7dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgdmFyIGkgPSBbN10sCiAgICAgICAgICAgICAgcyA9IGlbbl0oKTtzLm5leHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHIgPSAhMDsKICAgICAgICAgIH0sIGlbbl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBzOwogICAgICAgICAgfSwgZShpKTsKICAgICAgICB9IGNhdGNoIChhKSB7fXJldHVybiByOwogICAgICB9OwogICAgfSwgeyAiLi8kLndrcyI6IDc4IH1dLCA1NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHQsIGRvbmU6ICEhZSB9OwogICAgICB9OwogICAgfSwge31dLCA1NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHt9OwogICAgfSwge31dLCA1NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gT2JqZWN0O3QuZXhwb3J0cyA9IHsgY3JlYXRlOiBuLmNyZWF0ZSwgZ2V0UHJvdG86IG4uZ2V0UHJvdG90eXBlT2YsIGlzRW51bToge30ucHJvcGVydHlJc0VudW1lcmFibGUsIGdldERlc2M6IG4uZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLCBzZXREZXNjOiBuLmRlZmluZVByb3BlcnR5LCBzZXREZXNjczogbi5kZWZpbmVQcm9wZXJ0aWVzLCBnZXRLZXlzOiBuLmtleXMsIGdldE5hbWVzOiBuLmdldE93blByb3BlcnR5TmFtZXMsIGdldFN5bWJvbHM6IG4uZ2V0T3duUHJvcGVydHlTeW1ib2xzLCBlYWNoOiBbXS5mb3JFYWNoIH07CiAgICB9LCB7fV0sIDU3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQudG8taW9iamVjdCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgZm9yICh2YXIgciwgaSA9IG8oZSksIHMgPSBuLmdldEtleXMoaSksIGEgPSBzLmxlbmd0aCwgYyA9IDA7IGEgPiBjOykgewogICAgICAgICAgaWYgKGlbciA9IHNbYysrXV0gPT09IHQpIHJldHVybiByOwogICAgICAgIH0KICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLnRvLWlvYmplY3QiOiA3NCB9XSwgNTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAhMDsKICAgIH0sIHt9XSwgNTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiwKICAgICAgICAgIG8sCiAgICAgICAgICBpLAogICAgICAgICAgcyA9IGUoIi4vJC5nbG9iYWwiKSwKICAgICAgICAgIGEgPSBlKCIuLyQudGFzayIpLnNldCwKICAgICAgICAgIGMgPSBzLk11dGF0aW9uT2JzZXJ2ZXIgfHwgcy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyLAogICAgICAgICAgdSA9IHMucHJvY2VzcywKICAgICAgICAgIGwgPSBzLlByb21pc2UsCiAgICAgICAgICBmID0gInByb2Nlc3MiID09IGUoIi4vJC5jb2YiKSh1KSwKICAgICAgICAgIGQgPSBmdW5jdGlvbiBkKCkgewogICAgICAgIHZhciBlLCB0LCByO2ZvciAoZiAmJiAoZSA9IHUuZG9tYWluKSAmJiAodS5kb21haW4gPSBudWxsLCBlLmV4aXQoKSk7IG47KSB7CiAgICAgICAgICB0ID0gbi5kb21haW4sIHIgPSBuLmZuLCB0ICYmIHQuZW50ZXIoKSwgcigpLCB0ICYmIHQuZXhpdCgpLCBuID0gbi5uZXh0OwogICAgICAgIH1vID0gdm9pZCAwLCBlICYmIGUuZW50ZXIoKTsKICAgICAgfTtpZiAoZikgaSA9IGZ1bmN0aW9uIGkoKSB7CiAgICAgICAgdS5uZXh0VGljayhkKTsKICAgICAgfTtlbHNlIGlmIChjKSB7CiAgICAgICAgdmFyIHAgPSAxLAogICAgICAgICAgICBiID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpO25ldyBjKGQpLm9ic2VydmUoYiwgeyBjaGFyYWN0ZXJEYXRhOiAhMCB9KSwgaSA9IGZ1bmN0aW9uIGkoKSB7CiAgICAgICAgICBiLmRhdGEgPSBwID0gLXA7CiAgICAgICAgfTsKICAgICAgfSBlbHNlIGkgPSBsICYmIGwucmVzb2x2ZSA/IGZ1bmN0aW9uICgpIHsKICAgICAgICBsLnJlc29sdmUoKS50aGVuKGQpOwogICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgIGEuY2FsbChzLCBkKTsKICAgICAgfTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0geyBmbjogZSwgbmV4dDogdm9pZCAwLCBkb21haW46IGYgJiYgdS5kb21haW4gfTtvICYmIChvLm5leHQgPSB0KSwgbiB8fCAobiA9IHQsIGkoKSksIG8gPSB0OwogICAgICB9OwogICAgfSwgeyAiLi8kLmNvZiI6IDMwLCAiLi8kLmdsb2JhbCI6IDQxLCAiLi8kLnRhc2siOiA3MiB9XSwgNjA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5leHBvcnQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vJC5mYWlscyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgdmFyIHIgPSAoby5PYmplY3QgfHwge30pW2VdIHx8IE9iamVjdFtlXSwKICAgICAgICAgICAgcyA9IHt9O3NbZV0gPSB0KHIpLCBuKG4uUyArIG4uRiAqIGkoZnVuY3Rpb24gKCkgewogICAgICAgICAgcigxKTsKICAgICAgICB9KSwgIk9iamVjdCIsIHMpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmNvcmUiOiAzMSwgIi4vJC5leHBvcnQiOiAzNywgIi4vJC5mYWlscyI6IDM4IH1dLCA2MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIHsgZW51bWVyYWJsZTogISgxICYgZSksIGNvbmZpZ3VyYWJsZTogISgyICYgZSksIHdyaXRhYmxlOiAhKDQgJiBlKSwgdmFsdWU6IHQgfTsKICAgICAgfTsKICAgIH0sIHt9XSwgNjI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5yZWRlZmluZSIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgZm9yICh2YXIgciBpbiB0KSB7CiAgICAgICAgICBuKGUsIHIsIHRbcl0pOwogICAgICAgIH1yZXR1cm4gZTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5yZWRlZmluZSI6IDYzIH1dLCA2MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vJC5oaWRlIik7CiAgICB9LCB7ICIuLyQuaGlkZSI6IDQzIH1dLCA2NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IE9iamVjdC5pcyB8fCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBlID09PSB0ID8gMCAhPT0gZSB8fCAxIC8gZSA9PT0gMSAvIHQgOiBlICE9IGUgJiYgdCAhPSB0OwogICAgICB9OwogICAgfSwge31dLCA2NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kIikuZ2V0RGVzYywKICAgICAgICAgIG8gPSBlKCIuLyQuaXMtb2JqZWN0IiksCiAgICAgICAgICBpID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgcyA9IGZ1bmN0aW9uIHMoZSwgdCkgewogICAgICAgIGlmIChpKGUpLCAhbyh0KSAmJiBudWxsICE9PSB0KSB0aHJvdyBUeXBlRXJyb3IodCArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7CiAgICAgIH07dC5leHBvcnRzID0geyBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoIl9fcHJvdG9fXyIgaW4ge30gPyBmdW5jdGlvbiAodCwgciwgbykgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbyA9IGUoIi4vJC5jdHgiKShGdW5jdGlvbi5jYWxsLCBuKE9iamVjdC5wcm90b3R5cGUsICJfX3Byb3RvX18iKS5zZXQsIDIpLCBvKHQsIFtdKSwgciA9ICEodCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgICAgIH0gY2F0Y2ggKGkpIHsKICAgICAgICAgICAgciA9ICEwOwogICAgICAgICAgfXJldHVybiBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICByZXR1cm4gcyhlLCB0KSwgciA/IGUuX19wcm90b19fID0gdCA6IG8oZSwgdCksIGU7CiAgICAgICAgICB9OwogICAgICAgIH0oe30sICExKSA6IHZvaWQgMCksIGNoZWNrOiBzIH07CiAgICB9LCB7ICIuLyQiOiA1NiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5pcy1vYmplY3QiOiA0OSB9XSwgNjY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmNvcmUiKSwKICAgICAgICAgIG8gPSBlKCIuLyQiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuZGVzY3JpcHRvcnMiKSwKICAgICAgICAgIHMgPSBlKCIuLyQud2tzIikoInNwZWNpZXMiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0gbltlXTtpICYmIHQgJiYgIXRbc10gJiYgby5zZXREZXNjKHQsIHMsIHsgY29uZmlndXJhYmxlOiAhMCwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgfSB9KTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmNvcmUiOiAzMSwgIi4vJC5kZXNjcmlwdG9ycyI6IDM0LCAiLi8kLndrcyI6IDc4IH1dLCA2NzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kIikuc2V0RGVzYywKICAgICAgICAgIG8gPSBlKCIuLyQuaGFzIiksCiAgICAgICAgICBpID0gZSgiLi8kLndrcyIpKCJ0b1N0cmluZ1RhZyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZSAmJiAhbyhlID0gciA/IGUgOiBlLnByb3RvdHlwZSwgaSkgJiYgbihlLCBpLCB7IGNvbmZpZ3VyYWJsZTogITAsIHZhbHVlOiB0IH0pOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuaGFzIjogNDIsICIuLyQud2tzIjogNzggfV0sIDY4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBvID0gIl9fY29yZS1qc19zaGFyZWRfXyIsCiAgICAgICAgICBpID0gbltvXSB8fCAobltvXSA9IHt9KTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBpW2VdIHx8IChpW2VdID0ge30pOwogICAgICB9OwogICAgfSwgeyAiLi8kLmdsb2JhbCI6IDQxIH1dLCA2OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5hLWZ1bmN0aW9uIiksCiAgICAgICAgICBpID0gZSgiLi8kLndrcyIpKCJzcGVjaWVzIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB2YXIgciwKICAgICAgICAgICAgcyA9IG4oZSkuY29uc3RydWN0b3I7cmV0dXJuIHZvaWQgMCA9PT0gcyB8fCB2b2lkIDAgPT0gKHIgPSBuKHMpW2ldKSA/IHQgOiBvKHIpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmEtZnVuY3Rpb24iOiAyNiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC53a3MiOiA3OCB9XSwgNzA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiB0KSkgdGhyb3cgVHlwZUVycm9yKHIgKyAiOiB1c2UgdGhlICduZXcnIG9wZXJhdG9yISIpO3JldHVybiBlOwogICAgICB9OwogICAgfSwge31dLCA3MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZGVmaW5lZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0LCByKSB7CiAgICAgICAgICB2YXIgaSwKICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgIGEgPSBTdHJpbmcobyh0KSksCiAgICAgICAgICAgICAgYyA9IG4ociksCiAgICAgICAgICAgICAgdSA9IGEubGVuZ3RoO3JldHVybiAwID4gYyB8fCBjID49IHUgPyBlID8gIiIgOiB2b2lkIDAgOiAoaSA9IGEuY2hhckNvZGVBdChjKSwgNTUyOTYgPiBpIHx8IGkgPiA1NjMxOSB8fCBjICsgMSA9PT0gdSB8fCAocyA9IGEuY2hhckNvZGVBdChjICsgMSkpIDwgNTYzMjAgfHwgcyA+IDU3MzQzID8gZSA/IGEuY2hhckF0KGMpIDogaSA6IGUgPyBhLnNsaWNlKGMsIGMgKyAyKSA6IChpIC0gNTUyOTYgPDwgMTApICsgKHMgLSA1NjMyMCkgKyA2NTUzNik7CiAgICAgICAgfTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5kZWZpbmVkIjogMzMsICIuLyQudG8taW50ZWdlciI6IDczIH1dLCA3MjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBzID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgYSA9IGUoIi4vJC5pbnZva2UiKSwKICAgICAgICAgIGMgPSBlKCIuLyQuaHRtbCIpLAogICAgICAgICAgdSA9IGUoIi4vJC5kb20tY3JlYXRlIiksCiAgICAgICAgICBsID0gZSgiLi8kLmdsb2JhbCIpLAogICAgICAgICAgZiA9IGwucHJvY2VzcywKICAgICAgICAgIGQgPSBsLnNldEltbWVkaWF0ZSwKICAgICAgICAgIHAgPSBsLmNsZWFySW1tZWRpYXRlLAogICAgICAgICAgYiA9IGwuTWVzc2FnZUNoYW5uZWwsCiAgICAgICAgICBoID0gMCwKICAgICAgICAgIHYgPSB7fSwKICAgICAgICAgIHkgPSAib25yZWFkeXN0YXRlY2hhbmdlIiwKICAgICAgICAgIF8gPSBmdW5jdGlvbiBfKCkgewogICAgICAgIHZhciBlID0gK3RoaXM7aWYgKHYuaGFzT3duUHJvcGVydHkoZSkpIHsKICAgICAgICAgIHZhciB0ID0gdltlXTtkZWxldGUgdltlXSwgdCgpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIGcgPSBmdW5jdGlvbiBnKGUpIHsKICAgICAgICBfLmNhbGwoZS5kYXRhKTsKICAgICAgfTtkICYmIHAgfHwgKGQgPSBmdW5jdGlvbiBkKGUpIHsKICAgICAgICBmb3IgKHZhciB0ID0gW10sIHIgPSAxOyBhcmd1bWVudHMubGVuZ3RoID4gcjspIHsKICAgICAgICAgIHQucHVzaChhcmd1bWVudHNbcisrXSk7CiAgICAgICAgfXJldHVybiB2WysraF0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBhKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgPyBlIDogRnVuY3Rpb24oZSksIHQpOwogICAgICAgIH0sIG4oaCksIGg7CiAgICAgIH0sIHAgPSBmdW5jdGlvbiBwKGUpIHsKICAgICAgICBkZWxldGUgdltlXTsKICAgICAgfSwgInByb2Nlc3MiID09IGUoIi4vJC5jb2YiKShmKSA/IG4gPSBmdW5jdGlvbiBuKGUpIHsKICAgICAgICBmLm5leHRUaWNrKHMoXywgZSwgMSkpOwogICAgICB9IDogYiA/IChvID0gbmV3IGIoKSwgaSA9IG8ucG9ydDIsIG8ucG9ydDEub25tZXNzYWdlID0gZywgbiA9IHMoaS5wb3N0TWVzc2FnZSwgaSwgMSkpIDogbC5hZGRFdmVudExpc3RlbmVyICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHBvc3RNZXNzYWdlICYmICFsLmltcG9ydFNjcmlwdHMgPyAobiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIGwucG9zdE1lc3NhZ2UoZSArICIiLCAiKiIpOwogICAgICB9LCBsLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBnLCAhMSkpIDogbiA9IHkgaW4gdSgic2NyaXB0IikgPyBmdW5jdGlvbiAoZSkgewogICAgICAgIGMuYXBwZW5kQ2hpbGQodSgic2NyaXB0IikpW3ldID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgYy5yZW1vdmVDaGlsZCh0aGlzKSwgXy5jYWxsKGUpOwogICAgICAgIH07CiAgICAgIH0gOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHNldFRpbWVvdXQocyhfLCBlLCAxKSwgMCk7CiAgICAgIH0pLCB0LmV4cG9ydHMgPSB7IHNldDogZCwgY2xlYXI6IHAgfTsKICAgIH0sIHsgIi4vJC5jb2YiOiAzMCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5kb20tY3JlYXRlIjogMzUsICIuLyQuZ2xvYmFsIjogNDEsICIuLyQuaHRtbCI6IDQ0LCAiLi8kLmludm9rZSI6IDQ1IH1dLCA3MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gTWF0aC5jZWlsLAogICAgICAgICAgbyA9IE1hdGguZmxvb3I7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gaXNOYU4oZSA9ICtlKSA/IDAgOiAoZSA+IDAgPyBvIDogbikoZSk7CiAgICAgIH07CiAgICB9LCB7fV0sIDc0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbihvKGUpKTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5kZWZpbmVkIjogMzMsICIuLyQuaW9iamVjdCI6IDQ2IH1dLCA3NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBNYXRoLm1pbjt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlID4gMCA/IG8obihlKSwgOTAwNzE5OTI1NDc0MDk5MSkgOiAwOwogICAgICB9OwogICAgfSwgeyAiLi8kLnRvLWludGVnZXIiOiA3MyB9XSwgNzY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gT2JqZWN0KG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmRlZmluZWQiOiAzMyB9XSwgNzc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IDAsCiAgICAgICAgICBvID0gTWF0aC5yYW5kb20oKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiU3ltYm9sKCIuY29uY2F0KHZvaWQgMCA9PT0gZSA/ICIiIDogZSwgIilfIiwgKCsrbiArIG8pLnRvU3RyaW5nKDM2KSk7CiAgICAgIH07CiAgICB9LCB7fV0sIDc4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuc2hhcmVkIikoIndrcyIpLAogICAgICAgICAgbyA9IGUoIi4vJC51aWQiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuZ2xvYmFsIikuU3ltYm9sO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBpICYmIGlbZV0gfHwgKGkgfHwgbykoIlN5bWJvbC4iICsgZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmdsb2JhbCI6IDQxLCAiLi8kLnNoYXJlZCI6IDY4LCAiLi8kLnVpZCI6IDc3IH1dLCA3OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmNsYXNzb2YiKSwKICAgICAgICAgIG8gPSBlKCIuLyQud2tzIikoIml0ZXJhdG9yIiksCiAgICAgICAgICBpID0gZSgiLi8kLml0ZXJhdG9ycyIpO3QuZXhwb3J0cyA9IGUoIi4vJC5jb3JlIikuZ2V0SXRlcmF0b3JNZXRob2QgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiB2b2lkIDAgIT0gZSA/IGVbb10gfHwgZVsiQEBpdGVyYXRvciJdIHx8IGlbbihlKV0gOiB2b2lkIDA7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY2xhc3NvZiI6IDI5LCAiLi8kLmNvcmUiOiAzMSwgIi4vJC5pdGVyYXRvcnMiOiA1NSwgIi4vJC53a3MiOiA3OCB9XSwgODA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmFkZC10by11bnNjb3BhYmxlcyIpLAogICAgICAgICAgbyA9IGUoIi4vJC5pdGVyLXN0ZXAiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuaXRlcmF0b3JzIiksCiAgICAgICAgICBzID0gZSgiLi8kLnRvLWlvYmplY3QiKTt0LmV4cG9ydHMgPSBlKCIuLyQuaXRlci1kZWZpbmUiKShBcnJheSwgIkFycmF5IiwgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB0aGlzLl90ID0gcyhlKSwgdGhpcy5faSA9IDAsIHRoaXMuX2sgPSB0OwogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUgPSB0aGlzLl90LAogICAgICAgICAgICB0ID0gdGhpcy5faywKICAgICAgICAgICAgciA9IHRoaXMuX2krKztyZXR1cm4gIWUgfHwgciA+PSBlLmxlbmd0aCA/ICh0aGlzLl90ID0gdm9pZCAwLCBvKDEpKSA6ICJrZXlzIiA9PSB0ID8gbygwLCByKSA6ICJ2YWx1ZXMiID09IHQgPyBvKDAsIGVbcl0pIDogbygwLCBbciwgZVtyXV0pOwogICAgICB9LCAidmFsdWVzIiksIGkuQXJndW1lbnRzID0gaS5BcnJheSwgbigia2V5cyIpLCBuKCJ2YWx1ZXMiKSwgbigiZW50cmllcyIpOwogICAgfSwgeyAiLi8kLmFkZC10by11bnNjb3BhYmxlcyI6IDI3LCAiLi8kLml0ZXItZGVmaW5lIjogNTIsICIuLyQuaXRlci1zdGVwIjogNTQsICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQudG8taW9iamVjdCI6IDc0IH1dLCA4MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWlvYmplY3QiKTtlKCIuLyQub2JqZWN0LXNhcCIpKCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBmdW5jdGlvbiAodCwgcikgewogICAgICAgICAgcmV0dXJuIGUobih0KSwgcik7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9LCB7ICIuLyQub2JqZWN0LXNhcCI6IDYwLCAiLi8kLnRvLWlvYmplY3QiOiA3NCB9XSwgODI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC50by1vYmplY3QiKTtlKCIuLyQub2JqZWN0LXNhcCIpKCJnZXRQcm90b3R5cGVPZiIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICByZXR1cm4gZShuKHQpKTsKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5vYmplY3Qtc2FwIjogNjAsICIuLyQudG8tb2JqZWN0IjogNzYgfV0sIDgzOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQudG8tb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgia2V5cyIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICByZXR1cm4gZShuKHQpKTsKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5vYmplY3Qtc2FwIjogNjAsICIuLyQudG8tb2JqZWN0IjogNzYgfV0sIDg0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuZXhwb3J0Iik7bihuLlMsICJPYmplY3QiLCB7IHNldFByb3RvdHlwZU9mOiBlKCIuLyQuc2V0LXByb3RvIikuc2V0IH0pOwogICAgfSwgeyAiLi8kLmV4cG9ydCI6IDM3LCAiLi8kLnNldC1wcm90byI6IDY1IH1dLCA4NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7fSwge31dLCA4NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4sCiAgICAgICAgICBvID0gZSgiLi8kIiksCiAgICAgICAgICBpID0gZSgiLi8kLmxpYnJhcnkiKSwKICAgICAgICAgIHMgPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBhID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgYyA9IGUoIi4vJC5jbGFzc29mIiksCiAgICAgICAgICB1ID0gZSgiLi8kLmV4cG9ydCIpLAogICAgICAgICAgbCA9IGUoIi4vJC5pcy1vYmplY3QiKSwKICAgICAgICAgIGYgPSBlKCIuLyQuYW4tb2JqZWN0IiksCiAgICAgICAgICBkID0gZSgiLi8kLmEtZnVuY3Rpb24iKSwKICAgICAgICAgIHAgPSBlKCIuLyQuc3RyaWN0LW5ldyIpLAogICAgICAgICAgYiA9IGUoIi4vJC5mb3Itb2YiKSwKICAgICAgICAgIGggPSBlKCIuLyQuc2V0LXByb3RvIikuc2V0LAogICAgICAgICAgdiA9IGUoIi4vJC5zYW1lLXZhbHVlIiksCiAgICAgICAgICB5ID0gZSgiLi8kLndrcyIpKCJzcGVjaWVzIiksCiAgICAgICAgICBfID0gZSgiLi8kLnNwZWNpZXMtY29uc3RydWN0b3IiKSwKICAgICAgICAgIGcgPSBlKCIuLyQubWljcm90YXNrIiksCiAgICAgICAgICBtID0gIlByb21pc2UiLAogICAgICAgICAgaiA9IHMucHJvY2VzcywKICAgICAgICAgICQgPSAicHJvY2VzcyIgPT0gYyhqKSwKICAgICAgICAgIF9PID0gc1ttXSwKICAgICAgICAgIHcgPSBmdW5jdGlvbiB3KGUpIHsKICAgICAgICB2YXIgdCA9IG5ldyBfTyhmdW5jdGlvbiAoKSB7fSk7cmV0dXJuIGUgJiYgKHQuY29uc3RydWN0b3IgPSBPYmplY3QpLCBfTy5yZXNvbHZlKHQpID09PSB0OwogICAgICB9LAogICAgICAgICAgayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiB0KGUpIHsKICAgICAgICAgIHZhciByID0gbmV3IF9PKGUpO3JldHVybiBoKHIsIHQucHJvdG90eXBlKSwgcjsKICAgICAgICB9dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgaWYgKHIgPSBfTyAmJiBfTy5yZXNvbHZlICYmIHcoKSwgaCh0LCBfTyksIHQucHJvdG90eXBlID0gby5jcmVhdGUoX08ucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiB0IH0gfSksIHQucmVzb2x2ZSg1KS50aGVuKGZ1bmN0aW9uICgpIHt9KSBpbnN0YW5jZW9mIHQgfHwgKHIgPSAhMSksIHIgJiYgZSgiLi8kLmRlc2NyaXB0b3JzIikpIHsKICAgICAgICAgICAgdmFyIG4gPSAhMTtfTy5yZXNvbHZlKG8uc2V0RGVzYyh7fSwgInRoZW4iLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICAgICAgbiA9ICEwOwogICAgICAgICAgICAgIH0gfSkpLCByID0gbjsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChpKSB7CiAgICAgICAgICByID0gITE7CiAgICAgICAgfXJldHVybiByOwogICAgICB9KCksCiAgICAgICAgICB4ID0gZnVuY3Rpb24geChlLCB0KSB7CiAgICAgICAgcmV0dXJuIGkgJiYgZSA9PT0gX08gJiYgdCA9PT0gbiA/ICEwIDogdihlLCB0KTsKICAgICAgfSwKICAgICAgICAgIEMgPSBmdW5jdGlvbiBDKGUpIHsKICAgICAgICB2YXIgdCA9IGYoZSlbeV07cmV0dXJuIHZvaWQgMCAhPSB0ID8gdCA6IGU7CiAgICAgIH0sCiAgICAgICAgICBFID0gZnVuY3Rpb24gRShlKSB7CiAgICAgICAgdmFyIHQ7cmV0dXJuIGwoZSkgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgKHQgPSBlLnRoZW4pID8gdCA6ICExOwogICAgICB9LAogICAgICAgICAgUyA9IGZ1bmN0aW9uIFMoZSkgewogICAgICAgIHZhciB0LCByO3RoaXMucHJvbWlzZSA9IG5ldyBlKGZ1bmN0aW9uIChlLCBuKSB7CiAgICAgICAgICBpZiAodm9pZCAwICE9PSB0IHx8IHZvaWQgMCAhPT0gcikgdGhyb3cgVHlwZUVycm9yKCJCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvciIpO3QgPSBlLCByID0gbjsKICAgICAgICB9KSwgdGhpcy5yZXNvbHZlID0gZCh0KSwgdGhpcy5yZWplY3QgPSBkKHIpOwogICAgICB9LAogICAgICAgICAgVCA9IGZ1bmN0aW9uIFQoZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBlKCk7CiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgcmV0dXJuIHsgZXJyb3I6IHQgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBNID0gZnVuY3Rpb24gTShlLCB0KSB7CiAgICAgICAgaWYgKCFlLm4pIHsKICAgICAgICAgIGUubiA9ICEwO3ZhciByID0gZS5jO2coZnVuY3Rpb24gKCkgewogICAgICAgICAgICBmb3IgKHZhciBuID0gZS52LCBvID0gMSA9PSBlLnMsIGkgPSAwLCBhID0gZnVuY3Rpb24gYSh0KSB7CiAgICAgICAgICAgICAgdmFyIHIsCiAgICAgICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgICAgIHMgPSBvID8gdC5vayA6IHQuZmFpbCwKICAgICAgICAgICAgICAgICAgYSA9IHQucmVzb2x2ZSwKICAgICAgICAgICAgICAgICAgYyA9IHQucmVqZWN0O3RyeSB7CiAgICAgICAgICAgICAgICBzID8gKG8gfHwgKGUuaCA9ICEwKSwgciA9IHMgPT09ICEwID8gbiA6IHMobiksIHIgPT09IHQucHJvbWlzZSA/IGMoVHlwZUVycm9yKCJQcm9taXNlLWNoYWluIGN5Y2xlIikpIDogKGkgPSBFKHIpKSA/IGkuY2FsbChyLCBhLCBjKSA6IGEocikpIDogYyhuKTsKICAgICAgICAgICAgICB9IGNhdGNoICh1KSB7CiAgICAgICAgICAgICAgICBjKHUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsgci5sZW5ndGggPiBpOykgewogICAgICAgICAgICAgIGEocltpKytdKTsKICAgICAgICAgICAgfXIubGVuZ3RoID0gMCwgZS5uID0gITEsIHQgJiYgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIHQsCiAgICAgICAgICAgICAgICAgIHIsCiAgICAgICAgICAgICAgICAgIG8gPSBlLnA7TihvKSAmJiAoJCA/IGouZW1pdCgidW5oYW5kbGVkUmVqZWN0aW9uIiwgbiwgbykgOiAodCA9IHMub251bmhhbmRsZWRyZWplY3Rpb24pID8gdCh7IHByb21pc2U6IG8sIHJlYXNvbjogbiB9KSA6IChyID0gcy5jb25zb2xlKSAmJiByLmVycm9yICYmIHIuZXJyb3IoIlVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbiIsIG4pKSwgZS5hID0gdm9pZCAwOwogICAgICAgICAgICB9LCAxKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIE4gPSBmdW5jdGlvbiBOKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IGUuX2QsCiAgICAgICAgICAgIG4gPSByLmEgfHwgci5jLAogICAgICAgICAgICBvID0gMDtpZiAoci5oKSByZXR1cm4gITE7Zm9yICg7IG4ubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGlmICh0ID0gbltvKytdLCB0LmZhaWwgfHwgIU4odC5wcm9taXNlKSkgcmV0dXJuICExOwogICAgICAgIH1yZXR1cm4gITA7CiAgICAgIH0sCiAgICAgICAgICBSID0gZnVuY3Rpb24gUihlKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzO3QuZCB8fCAodC5kID0gITAsIHQgPSB0LnIgfHwgdCwgdC52ID0gZSwgdC5zID0gMiwgdC5hID0gdC5jLnNsaWNlKCksIE0odCwgITApKTsKICAgICAgfSwKICAgICAgICAgIEQgPSBmdW5jdGlvbiBEKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IHRoaXM7aWYgKCFyLmQpIHsKICAgICAgICAgIHIuZCA9ICEwLCByID0gci5yIHx8IHI7dHJ5IHsKICAgICAgICAgICAgaWYgKHIucCA9PT0gZSkgdGhyb3cgVHlwZUVycm9yKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOyh0ID0gRShlKSkgPyBnKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHsgcjogciwgZDogITEgfTt0cnkgewogICAgICAgICAgICAgICAgdC5jYWxsKGUsIGEoRCwgbiwgMSksIGEoUiwgbiwgMSkpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKG8pIHsKICAgICAgICAgICAgICAgIFIuY2FsbChuLCBvKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pIDogKHIudiA9IGUsIHIucyA9IDEsIE0ociwgITEpKTsKICAgICAgICAgIH0gY2F0Y2ggKG4pIHsKICAgICAgICAgICAgUi5jYWxsKHsgcjogciwgZDogITEgfSwgbik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9O2sgfHwgKF9PID0gZnVuY3Rpb24gTyhlKSB7CiAgICAgICAgZChlKTt2YXIgdCA9IHRoaXMuX2QgPSB7IHA6IHAodGhpcywgX08sIG0pLCBjOiBbXSwgYTogdm9pZCAwLCBzOiAwLCBkOiAhMSwgdjogdm9pZCAwLCBoOiAhMSwgbjogITEgfTt0cnkgewogICAgICAgICAgZShhKEQsIHQsIDEpLCBhKFIsIHQsIDEpKTsKICAgICAgICB9IGNhdGNoIChyKSB7CiAgICAgICAgICBSLmNhbGwodCwgcik7CiAgICAgICAgfQogICAgICB9LCBlKCIuLyQucmVkZWZpbmUtYWxsIikoX08ucHJvdG90eXBlLCB7IHRoZW46IGZ1bmN0aW9uIHRoZW4oZSwgdCkgewogICAgICAgICAgdmFyIHIgPSBuZXcgUyhfKHRoaXMsIF9PKSksCiAgICAgICAgICAgICAgbiA9IHIucHJvbWlzZSwKICAgICAgICAgICAgICBvID0gdGhpcy5fZDtyZXR1cm4gci5vayA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgPyBlIDogITAsIHIuZmFpbCA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgJiYgdCwgby5jLnB1c2gociksIG8uYSAmJiBvLmEucHVzaChyKSwgby5zICYmIE0obywgITEpLCBuOwogICAgICAgIH0sICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaChlKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgZSk7CiAgICAgICAgfSB9KSksIHUodS5HICsgdS5XICsgdS5GICogIWssIHsgUHJvbWlzZTogX08gfSksIGUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpKF9PLCBtKSwgZSgiLi8kLnNldC1zcGVjaWVzIikobSksIG4gPSBlKCIuLyQuY29yZSIpW21dLCB1KHUuUyArIHUuRiAqICFrLCBtLCB7IHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KGUpIHsKICAgICAgICAgIHZhciB0ID0gbmV3IFModGhpcyksCiAgICAgICAgICAgICAgciA9IHQucmVqZWN0O3JldHVybiByKGUpLCB0LnByb21pc2U7CiAgICAgICAgfSB9KSwgdSh1LlMgKyB1LkYgKiAoIWsgfHwgdyghMCkpLCBtLCB7IHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoZSkgewogICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBfTyAmJiB4KGUuY29uc3RydWN0b3IsIHRoaXMpKSByZXR1cm4gZTt2YXIgdCA9IG5ldyBTKHRoaXMpLAogICAgICAgICAgICAgIHIgPSB0LnJlc29sdmU7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCB1KHUuUyArIHUuRiAqICEoayAmJiBlKCIuLyQuaXRlci1kZXRlY3QiKShmdW5jdGlvbiAoZSkgewogICAgICAgIF9PLmFsbChlKVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7fSk7CiAgICAgIH0pKSwgbSwgeyBhbGw6IGZ1bmN0aW9uIGFsbChlKSB7CiAgICAgICAgICB2YXIgdCA9IEModGhpcyksCiAgICAgICAgICAgICAgciA9IG5ldyBTKHQpLAogICAgICAgICAgICAgIG4gPSByLnJlc29sdmUsCiAgICAgICAgICAgICAgaSA9IHIucmVqZWN0LAogICAgICAgICAgICAgIHMgPSBbXSwKICAgICAgICAgICAgICBhID0gVChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGIoZSwgITEsIHMucHVzaCwgcyk7dmFyIHIgPSBzLmxlbmd0aCwKICAgICAgICAgICAgICAgIGEgPSBBcnJheShyKTtyID8gby5lYWNoLmNhbGwocywgZnVuY3Rpb24gKGUsIG8pIHsKICAgICAgICAgICAgICB2YXIgcyA9ICExO3QucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBzIHx8IChzID0gITAsIGFbb10gPSBlLCAtLXIgfHwgbihhKSk7CiAgICAgICAgICAgICAgfSwgaSk7CiAgICAgICAgICAgIH0pIDogbihhKTsKICAgICAgICAgIH0pO3JldHVybiBhICYmIGkoYS5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9LCByYWNlOiBmdW5jdGlvbiByYWNlKGUpIHsKICAgICAgICAgIHZhciB0ID0gQyh0aGlzKSwKICAgICAgICAgICAgICByID0gbmV3IFModCksCiAgICAgICAgICAgICAgbiA9IHIucmVqZWN0LAogICAgICAgICAgICAgIG8gPSBUKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgYihlLCAhMSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB0LnJlc29sdmUoZSkudGhlbihyLnJlc29sdmUsIG4pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pO3JldHVybiBvICYmIG4oby5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9IH0pOwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuYS1mdW5jdGlvbiI6IDI2LCAiLi8kLmFuLW9iamVjdCI6IDI4LCAiLi8kLmNsYXNzb2YiOiAyOSwgIi4vJC5jb3JlIjogMzEsICIuLyQuY3R4IjogMzIsICIuLyQuZGVzY3JpcHRvcnMiOiAzNCwgIi4vJC5leHBvcnQiOiAzNywgIi4vJC5mb3Itb2YiOiAzOSwgIi4vJC5nbG9iYWwiOiA0MSwgIi4vJC5pcy1vYmplY3QiOiA0OSwgIi4vJC5pdGVyLWRldGVjdCI6IDUzLCAiLi8kLmxpYnJhcnkiOiA1OCwgIi4vJC5taWNyb3Rhc2siOiA1OSwgIi4vJC5yZWRlZmluZS1hbGwiOiA2MiwgIi4vJC5zYW1lLXZhbHVlIjogNjQsICIuLyQuc2V0LXByb3RvIjogNjUsICIuLyQuc2V0LXNwZWNpZXMiOiA2NiwgIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6IDY3LCAiLi8kLnNwZWNpZXMtY29uc3RydWN0b3IiOiA2OSwgIi4vJC5zdHJpY3QtbmV3IjogNzAsICIuLyQud2tzIjogNzggfV0sIDg3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vJC5zdHJpbmctYXQiKSghMCk7ZSgiLi8kLml0ZXItZGVmaW5lIikoU3RyaW5nLCAiU3RyaW5nIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB0aGlzLl90ID0gU3RyaW5nKGUpLCB0aGlzLl9pID0gMDsKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBlLAogICAgICAgICAgICB0ID0gdGhpcy5fdCwKICAgICAgICAgICAgciA9IHRoaXMuX2k7cmV0dXJuIHIgPj0gdC5sZW5ndGggPyB7IHZhbHVlOiB2b2lkIDAsIGRvbmU6ICEwIH0gOiAoZSA9IG4odCwgciksIHRoaXMuX2kgKz0gZS5sZW5ndGgsIHsgdmFsdWU6IGUsIGRvbmU6ICExIH0pOwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5pdGVyLWRlZmluZSI6IDUyLCAiLi8kLnN0cmluZy1hdCI6IDcxIH1dLCA4ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4gPSBlKCIuLyQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBpID0gZSgiLi8kLmhhcyIpLAogICAgICAgICAgcyA9IGUoIi4vJC5kZXNjcmlwdG9ycyIpLAogICAgICAgICAgYSA9IGUoIi4vJC5leHBvcnQiKSwKICAgICAgICAgIGMgPSBlKCIuLyQucmVkZWZpbmUiKSwKICAgICAgICAgIHUgPSBlKCIuLyQuZmFpbHMiKSwKICAgICAgICAgIGwgPSBlKCIuLyQuc2hhcmVkIiksCiAgICAgICAgICBmID0gZSgiLi8kLnNldC10by1zdHJpbmctdGFnIiksCiAgICAgICAgICBkID0gZSgiLi8kLnVpZCIpLAogICAgICAgICAgcCA9IGUoIi4vJC53a3MiKSwKICAgICAgICAgIGIgPSBlKCIuLyQua2V5b2YiKSwKICAgICAgICAgIGggPSBlKCIuLyQuZ2V0LW5hbWVzIiksCiAgICAgICAgICB2ID0gZSgiLi8kLmVudW0ta2V5cyIpLAogICAgICAgICAgeSA9IGUoIi4vJC5pcy1hcnJheSIpLAogICAgICAgICAgXyA9IGUoIi4vJC5hbi1vYmplY3QiKSwKICAgICAgICAgIGcgPSBlKCIuLyQudG8taW9iamVjdCIpLAogICAgICAgICAgbSA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBqID0gbi5nZXREZXNjLAogICAgICAgICAgJCA9IG4uc2V0RGVzYywKICAgICAgICAgIE8gPSBuLmNyZWF0ZSwKICAgICAgICAgIHcgPSBoLmdldCwKICAgICAgICAgIGsgPSBvLlN5bWJvbCwKICAgICAgICAgIHggPSBvLkpTT04sCiAgICAgICAgICBDID0geCAmJiB4LnN0cmluZ2lmeSwKICAgICAgICAgIEUgPSAhMSwKICAgICAgICAgIFMgPSBwKCJfaGlkZGVuIiksCiAgICAgICAgICBUID0gbi5pc0VudW0sCiAgICAgICAgICBNID0gbCgic3ltYm9sLXJlZ2lzdHJ5IiksCiAgICAgICAgICBOID0gbCgic3ltYm9scyIpLAogICAgICAgICAgUiA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGssCiAgICAgICAgICBEID0gT2JqZWN0LnByb3RvdHlwZSwKICAgICAgICAgIFAgPSBzICYmIHUoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiA3ICE9IE8oJCh7fSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gJCh0aGlzLCAiYSIsIHsgdmFsdWU6IDcgfSkuYTsKICAgICAgICAgIH0gfSkpLmE7CiAgICAgIH0pID8gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICB2YXIgbiA9IGooRCwgdCk7biAmJiBkZWxldGUgRFt0XSwgJChlLCB0LCByKSwgbiAmJiBlICE9PSBEICYmICQoRCwgdCwgbik7CiAgICAgIH0gOiAkLAogICAgICAgICAgQSA9IGZ1bmN0aW9uIEEoZSkgewogICAgICAgIHZhciB0ID0gTltlXSA9IE8oay5wcm90b3R5cGUpO3JldHVybiB0Ll9rID0gZSwgcyAmJiBFICYmIFAoRCwgZSwgeyBjb25maWd1cmFibGU6ICEwLCBzZXQ6IGZ1bmN0aW9uIHNldCh0KSB7CiAgICAgICAgICAgIGkodGhpcywgUykgJiYgaSh0aGlzW1NdLCBlKSAmJiAodGhpc1tTXVtlXSA9ICExKSwgUCh0aGlzLCBlLCBtKDEsIHQpKTsKICAgICAgICAgIH0gfSksIHQ7CiAgICAgIH0sCiAgICAgICAgICBMID0gZnVuY3Rpb24gTChlKSB7CiAgICAgICAgcmV0dXJuICJzeW1ib2wiID09ICh0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSkpOwogICAgICB9LAogICAgICAgICAgSSA9IGZ1bmN0aW9uIEkoZSwgdCwgcikgewogICAgICAgIHJldHVybiByICYmIGkoTiwgdCkgPyAoci5lbnVtZXJhYmxlID8gKGkoZSwgUykgJiYgZVtTXVt0XSAmJiAoZVtTXVt0XSA9ICExKSwgciA9IE8ociwgeyBlbnVtZXJhYmxlOiBtKDAsICExKSB9KSkgOiAoaShlLCBTKSB8fCAkKGUsIFMsIG0oMSwge30pKSwgZVtTXVt0XSA9ICEwKSwgUChlLCB0LCByKSkgOiAkKGUsIHQsIHIpOwogICAgICB9LAogICAgICAgICAgRiA9IGZ1bmN0aW9uIEYoZSwgdCkgewogICAgICAgIF8oZSk7Zm9yICh2YXIgciwgbiA9IHYodCA9IGcodCkpLCBvID0gMCwgaSA9IG4ubGVuZ3RoOyBpID4gbzspIHsKICAgICAgICAgIEkoZSwgciA9IG5bbysrXSwgdFtyXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9LAogICAgICAgICAgViA9IGZ1bmN0aW9uIFYoZSwgdCkgewogICAgICAgIHJldHVybiB2b2lkIDAgPT09IHQgPyBPKGUpIDogRihPKGUpLCB0KTsKICAgICAgfSwKICAgICAgICAgIHogPSBmdW5jdGlvbiB6KGUpIHsKICAgICAgICB2YXIgdCA9IFQuY2FsbCh0aGlzLCBlKTtyZXR1cm4gdCB8fCAhaSh0aGlzLCBlKSB8fCAhaShOLCBlKSB8fCBpKHRoaXMsIFMpICYmIHRoaXNbU11bZV0gPyB0IDogITA7CiAgICAgIH0sCiAgICAgICAgICBVID0gZnVuY3Rpb24gVShlLCB0KSB7CiAgICAgICAgdmFyIHIgPSBqKGUgPSBnKGUpLCB0KTtyZXR1cm4gIXIgfHwgIWkoTiwgdCkgfHwgaShlLCBTKSAmJiBlW1NdW3RdIHx8IChyLmVudW1lcmFibGUgPSAhMCksIHI7CiAgICAgIH0sCiAgICAgICAgICBIID0gZnVuY3Rpb24gSChlKSB7CiAgICAgICAgZm9yICh2YXIgdCwgciA9IHcoZyhlKSksIG4gPSBbXSwgbyA9IDA7IHIubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGkoTiwgdCA9IHJbbysrXSkgfHwgdCA9PSBTIHx8IG4ucHVzaCh0KTsKICAgICAgICB9cmV0dXJuIG47CiAgICAgIH0sCiAgICAgICAgICBCID0gZnVuY3Rpb24gQihlKSB7CiAgICAgICAgZm9yICh2YXIgdCwgciA9IHcoZyhlKSksIG4gPSBbXSwgbyA9IDA7IHIubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGkoTiwgdCA9IHJbbysrXSkgJiYgbi5wdXNoKE5bdF0pOwogICAgICAgIH1yZXR1cm4gbjsKICAgICAgfSwKICAgICAgICAgIEogPSBmdW5jdGlvbiBKKGUpIHsKICAgICAgICBpZiAodm9pZCAwICE9PSBlICYmICFMKGUpKSB7CiAgICAgICAgICBmb3IgKHZhciB0LCByLCBuID0gW2VdLCBvID0gMSwgaSA9IGFyZ3VtZW50czsgaS5sZW5ndGggPiBvOykgewogICAgICAgICAgICBuLnB1c2goaVtvKytdKTsKICAgICAgICAgIH1yZXR1cm4gdCA9IG5bMV0sICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgJiYgKHIgPSB0KSwgIXIgJiYgeSh0KSB8fCAodCA9IGZ1bmN0aW9uIHQoZSwgX3QyKSB7CiAgICAgICAgICAgIHJldHVybiByICYmIChfdDIgPSByLmNhbGwodGhpcywgZSwgX3QyKSksIEwoX3QyKSA/IHZvaWQgMCA6IF90MjsKICAgICAgICAgIH0pLCBuWzFdID0gdCwgQy5hcHBseSh4LCBuKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBXID0gdShmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUgPSBrKCk7cmV0dXJuICJbbnVsbF0iICE9IEMoW2VdKSB8fCAie30iICE9IEMoeyBhOiBlIH0pIHx8ICJ7fSIgIT0gQyhPYmplY3QoZSkpOwogICAgICB9KTtSIHx8IChrID0gZnVuY3Rpb24gaygpIHsKICAgICAgICBpZiAoTCh0aGlzKSkgdGhyb3cgVHlwZUVycm9yKCJTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IiKTtyZXR1cm4gQShkKGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdm9pZCAwKSk7CiAgICAgIH0sIGMoay5wcm90b3R5cGUsICJ0b1N0cmluZyIsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcy5fazsKICAgICAgfSksIEwgPSBmdW5jdGlvbiBMKGUpIHsKICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIGs7CiAgICAgIH0sIG4uY3JlYXRlID0gViwgbi5pc0VudW0gPSB6LCBuLmdldERlc2MgPSBVLCBuLnNldERlc2MgPSBJLCBuLnNldERlc2NzID0gRiwgbi5nZXROYW1lcyA9IGguZ2V0ID0gSCwgbi5nZXRTeW1ib2xzID0gQiwgcyAmJiAhZSgiLi8kLmxpYnJhcnkiKSAmJiBjKEQsICJwcm9wZXJ0eUlzRW51bWVyYWJsZSIsIHosICEwKSk7dmFyIFkgPSB7ICJmb3IiOiBmdW5jdGlvbiBfZm9yKGUpIHsKICAgICAgICAgIHJldHVybiBpKE0sIGUgKz0gIiIpID8gTVtlXSA6IE1bZV0gPSBrKGUpOwogICAgICAgIH0sIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKGUpIHsKICAgICAgICAgIHJldHVybiBiKE0sIGUpOwogICAgICAgIH0sIHVzZVNldHRlcjogZnVuY3Rpb24gdXNlU2V0dGVyKCkgewogICAgICAgICAgRSA9ICEwOwogICAgICAgIH0sIHVzZVNpbXBsZTogZnVuY3Rpb24gdXNlU2ltcGxlKCkgewogICAgICAgICAgRSA9ICExOwogICAgICAgIH0gfTtuLmVhY2guY2FsbCgiaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMiLnNwbGl0KCIsIiksIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQgPSBwKGUpO1lbZV0gPSBSID8gdCA6IEEodCk7CiAgICAgIH0pLCBFID0gITAsIGEoYS5HICsgYS5XLCB7IFN5bWJvbDogayB9KSwgYShhLlMsICJTeW1ib2wiLCBZKSwgYShhLlMgKyBhLkYgKiAhUiwgIk9iamVjdCIsIHsgY3JlYXRlOiBWLCBkZWZpbmVQcm9wZXJ0eTogSSwgZGVmaW5lUHJvcGVydGllczogRiwgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiBVLCBnZXRPd25Qcm9wZXJ0eU5hbWVzOiBILCBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6IEIgfSksIHggJiYgYShhLlMgKyBhLkYgKiAoIVIgfHwgVyksICJKU09OIiwgeyBzdHJpbmdpZnk6IEogfSksIGYoaywgIlN5bWJvbCIpLCBmKE1hdGgsICJNYXRoIiwgITApLCBmKG8uSlNPTiwgIkpTT04iLCAhMCk7CiAgICB9LCB7ICIuLyQiOiA1NiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5kZXNjcmlwdG9ycyI6IDM0LCAiLi8kLmVudW0ta2V5cyI6IDM2LCAiLi8kLmV4cG9ydCI6IDM3LCAiLi8kLmZhaWxzIjogMzgsICIuLyQuZ2V0LW5hbWVzIjogNDAsICIuLyQuZ2xvYmFsIjogNDEsICIuLyQuaGFzIjogNDIsICIuLyQuaXMtYXJyYXkiOiA0OCwgIi4vJC5rZXlvZiI6IDU3LCAiLi8kLmxpYnJhcnkiOiA1OCwgIi4vJC5wcm9wZXJ0eS1kZXNjIjogNjEsICIuLyQucmVkZWZpbmUiOiA2MywgIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6IDY3LCAiLi8kLnNoYXJlZCI6IDY4LCAiLi8kLnRvLWlvYmplY3QiOiA3NCwgIi4vJC51aWQiOiA3NywgIi4vJC53a3MiOiA3OCB9XSwgODk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuL2VzNi5hcnJheS5pdGVyYXRvciIpO3ZhciBuID0gZSgiLi8kLml0ZXJhdG9ycyIpO24uTm9kZUxpc3QgPSBuLkhUTUxDb2xsZWN0aW9uID0gbi5BcnJheTsKICAgIH0sIHsgIi4vJC5pdGVyYXRvcnMiOiA1NSwgIi4vZXM2LmFycmF5Lml0ZXJhdG9yIjogODAgfV0sIDkwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCBmdW5jdGlvbiAoZSkgewogICAgICAgIGZ1bmN0aW9uIHQoZSkgewogICAgICAgICAgdGhpcy5nID0gW10sIHRoaXMuayA9IGU7CiAgICAgICAgfWZ1bmN0aW9uIHIoZSkgewogICAgICAgICAgIWZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICAgIHZhciBuID0gZS50YWtlUmVjb3JkcygpO24ubGVuZ3RoICYmIGUuayhuLCBlKSwgZS5mID0gc2V0VGltZW91dChyLCB0Ll9wZXJpb2QpOwogICAgICAgICAgfSgpOwogICAgICAgIH1mdW5jdGlvbiBuKHQpIHsKICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIG4gPSB7IHR5cGU6IG51bGwsIHRhcmdldDogbnVsbCwgYWRkZWROb2RlczogW10sIHJlbW92ZWROb2RlczogW10sIHByZXZpb3VzU2libGluZzogbnVsbCwgbmV4dFNpYmxpbmc6IG51bGwsIGF0dHJpYnV0ZU5hbWU6IG51bGwsIGF0dHJpYnV0ZU5hbWVzcGFjZTogbnVsbCwgb2xkVmFsdWU6IG51bGwgfTtmb3IgKHIgaW4gdCkgewogICAgICAgICAgICBuW3JdICE9PSBlICYmIHRbcl0gIT09IGUgJiYgKG5bcl0gPSB0W3JdKTsKICAgICAgICAgIH1yZXR1cm4gbjsKICAgICAgICB9ZnVuY3Rpb24gbyhlLCB0KSB7CiAgICAgICAgICB2YXIgciA9IGEoZSwgdCk7cmV0dXJuIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICAgIHZhciBvLAogICAgICAgICAgICAgICAgYyA9IG4ubGVuZ3RoO3QuYSAmJiByLmEgJiYgaShuLCBlLCByLmEsIHQuZCksICh0LmIgfHwgdC5lKSAmJiAobyA9IHMobiwgZSwgciwgdCkpLCAobyB8fCBuLmxlbmd0aCAhPT0gYykgJiYgKHIgPSBhKGUsIHQpKTsKICAgICAgICAgIH07CiAgICAgICAgfWZ1bmN0aW9uIGkodCwgciwgbywgaSkgewogICAgICAgICAgZm9yICh2YXIgcywgYSwgYyA9IHt9LCB1ID0gci5hdHRyaWJ1dGVzLCBsID0gdS5sZW5ndGg7IGwtLTspIHsKICAgICAgICAgICAgcyA9IHVbbF0sIGEgPSBzLm5hbWUsIGkgJiYgaVthXSA9PT0gZSB8fCAocy52YWx1ZSAhPT0gb1thXSAmJiB0LnB1c2gobih7IHR5cGU6ICJhdHRyaWJ1dGVzIiwgdGFyZ2V0OiByLCBhdHRyaWJ1dGVOYW1lOiBhLCBvbGRWYWx1ZTogb1thXSwgYXR0cmlidXRlTmFtZXNwYWNlOiBzLm5hbWVzcGFjZVVSSSB9KSksIGNbYV0gPSAhMCk7CiAgICAgICAgICB9Zm9yIChhIGluIG8pIHsKICAgICAgICAgICAgY1thXSB8fCB0LnB1c2gobih7IHRhcmdldDogciwgdHlwZTogImF0dHJpYnV0ZXMiLCBhdHRyaWJ1dGVOYW1lOiBhLCBvbGRWYWx1ZTogb1thXSB9KSk7CiAgICAgICAgICB9CiAgICAgICAgfWZ1bmN0aW9uIHModCwgciwgbywgcykgewogICAgICAgICAgZnVuY3Rpb24gYShlLCByLCBvLCBhLCBjKSB7CiAgICAgICAgICAgIHZhciBsID0gZS5sZW5ndGggLSAxO2MgPSAtIH4oKGwgLSBjKSAvIDIpO2ZvciAodmFyIGYsIGQsIHA7IHAgPSBlLnBvcCgpOykgewogICAgICAgICAgICAgIGYgPSBvW3AuaF0sIGQgPSBhW3AuaV0sIHMuYiAmJiBjICYmIE1hdGguYWJzKHAuaCAtIHAuaSkgPj0gbCAmJiAodC5wdXNoKG4oeyB0eXBlOiAiY2hpbGRMaXN0IiwgdGFyZ2V0OiByLCBhZGRlZE5vZGVzOiBbZl0sIHJlbW92ZWROb2RlczogW2ZdLCBuZXh0U2libGluZzogZi5uZXh0U2libGluZywgcHJldmlvdXNTaWJsaW5nOiBmLnByZXZpb3VzU2libGluZyB9KSksIGMtLSksIHMuYSAmJiBkLmEgJiYgaSh0LCBmLCBkLmEsIHMuZCksIHMuYyAmJiAzID09PSBmLm5vZGVUeXBlICYmIGYubm9kZVZhbHVlICE9PSBkLmMgJiYgdC5wdXNoKG4oeyB0eXBlOiAiY2hhcmFjdGVyRGF0YSIsIHRhcmdldDogZiB9KSksIHMuZSAmJiB1KGYsIGQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9ZnVuY3Rpb24gdShyLCBvKSB7CiAgICAgICAgICAgIGZvciAodmFyIGQsIHAsIGIsIGgsIHYsIHkgPSByLmNoaWxkTm9kZXMsIF8gPSBvLmIsIGcgPSB5Lmxlbmd0aCwgbSA9IF8gPyBfLmxlbmd0aCA6IDAsIGogPSAwLCAkID0gMCwgTyA9IDA7IGcgPiAkIHx8IG0gPiBPOykgewogICAgICAgICAgICAgIGggPSB5WyRdLCB2ID0gKGIgPSBfW09dKSAmJiBiLmosIGggPT09IHYgPyAocy5hICYmIGIuYSAmJiBpKHQsIGgsIGIuYSwgcy5kKSwgcy5jICYmIGIuYyAhPT0gZSAmJiBoLm5vZGVWYWx1ZSAhPT0gYi5jICYmIHQucHVzaChuKHsgdHlwZTogImNoYXJhY3RlckRhdGEiLCB0YXJnZXQ6IGggfSkpLCBwICYmIGEocCwgciwgeSwgXywgaiksIHMuZSAmJiAoaC5jaGlsZE5vZGVzLmxlbmd0aCB8fCBiLmIgJiYgYi5iLmxlbmd0aCkgJiYgdShoLCBiKSwgJCsrLCBPKyspIDogKGwgPSAhMCwgZCB8fCAoZCA9IHt9LCBwID0gW10pLCBoICYmIChkW2IgPSBjKGgpXSB8fCAoZFtiXSA9ICEwLCAtMSA9PT0gKGIgPSBmKF8sIGgsIE8sICJqIikpID8gcy5iICYmICh0LnB1c2gobih7IHR5cGU6ICJjaGlsZExpc3QiLCB0YXJnZXQ6IHIsIGFkZGVkTm9kZXM6IFtoXSwgbmV4dFNpYmxpbmc6IGgubmV4dFNpYmxpbmcsIHByZXZpb3VzU2libGluZzogaC5wcmV2aW91c1NpYmxpbmcgfSkpLCBqKyspIDogcC5wdXNoKHsgaDogJCwgaTogYiB9KSksICQrKyksIHYgJiYgdiAhPT0geVskXSAmJiAoZFtiID0gYyh2KV0gfHwgKGRbYl0gPSAhMCwgLTEgPT09IChiID0gZih5LCB2LCAkKSkgPyBzLmIgJiYgKHQucHVzaChuKHsgdHlwZTogImNoaWxkTGlzdCIsIHRhcmdldDogby5qLCByZW1vdmVkTm9kZXM6IFt2XSwgbmV4dFNpYmxpbmc6IF9bTyArIDFdLCBwcmV2aW91c1NpYmxpbmc6IF9bTyAtIDFdIH0pKSwgai0tKSA6IHAucHVzaCh7IGg6IGIsIGk6IE8gfSkpLCBPKyspKTsKICAgICAgICAgICAgfXAgJiYgYShwLCByLCB5LCBfLCBqKTsKICAgICAgICAgIH12YXIgbDtyZXR1cm4gdShyLCBvKSwgbDsKICAgICAgICB9ZnVuY3Rpb24gYShlLCB0KSB7CiAgICAgICAgICB2YXIgciA9ICEwO3JldHVybiBmdW5jdGlvbiBuKGUpIHsKICAgICAgICAgICAgdmFyIG8gPSB7IGo6IGUgfTtyZXR1cm4gIXQuYyB8fCAzICE9PSBlLm5vZGVUeXBlICYmIDggIT09IGUubm9kZVR5cGUgPyAodC5hICYmIHIgJiYgMSA9PT0gZS5ub2RlVHlwZSAmJiAoby5hID0gbChlLmF0dHJpYnV0ZXMsIGZ1bmN0aW9uIChlLCByKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQuZCAmJiAhdC5kW3IubmFtZV0gfHwgKGVbci5uYW1lXSA9IHIudmFsdWUpLCBlOwogICAgICAgICAgICB9KSksIHIgJiYgKHQuYiB8fCB0LmMgfHwgdC5hICYmIHQuZSkgJiYgKG8uYiA9IHUoZS5jaGlsZE5vZGVzLCBuKSksIHIgPSB0LmUpIDogby5jID0gZS5ub2RlVmFsdWUsIG87CiAgICAgICAgICB9KGUpOwogICAgICAgIH1mdW5jdGlvbiBjKGUpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBlLmlkIHx8IChlLm1vX2lkID0gZS5tb19pZCB8fCBkKyspOwogICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJldHVybiBlLm5vZGVWYWx1ZTsKICAgICAgICAgICAgfSBjYXRjaCAocikgewogICAgICAgICAgICAgIHJldHVybiBkKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9ZnVuY3Rpb24gdShlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0gW10sIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICAgICAgICByW25dID0gdChlW25dLCBuLCBlKTsKICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICB9ZnVuY3Rpb24gbChlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0ge30sIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICAgICAgICByID0gdChyLCBlW25dLCBuLCBlKTsKICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICB9ZnVuY3Rpb24gZihlLCB0LCByLCBuKSB7CiAgICAgICAgICBmb3IgKDsgciA8IGUubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgaWYgKChuID8gZVtyXVtuXSA6IGVbcl0pID09PSB0KSByZXR1cm4gcjsKICAgICAgICAgIH1yZXR1cm4gLTE7CiAgICAgICAgfXQuX3BlcmlvZCA9IDMwLCB0LnByb3RvdHlwZSA9IHsgb2JzZXJ2ZTogZnVuY3Rpb24gb2JzZXJ2ZShlLCB0KSB7CiAgICAgICAgICAgIGZvciAodmFyIG4gPSB7IGE6ICEhKHQuYXR0cmlidXRlcyB8fCB0LmF0dHJpYnV0ZUZpbHRlciB8fCB0LmF0dHJpYnV0ZU9sZFZhbHVlKSwgYjogISF0LmNoaWxkTGlzdCwgZTogISF0LnN1YnRyZWUsIGM6ICEoIXQuY2hhcmFjdGVyRGF0YSAmJiAhdC5jaGFyYWN0ZXJEYXRhT2xkVmFsdWUpIH0sIGkgPSB0aGlzLmcsIHMgPSAwOyBzIDwgaS5sZW5ndGg7IHMrKykgewogICAgICAgICAgICAgIGlbc10ubSA9PT0gZSAmJiBpLnNwbGljZShzLCAxKTsKICAgICAgICAgICAgfXQuYXR0cmlidXRlRmlsdGVyICYmIChuLmQgPSBsKHQuYXR0cmlidXRlRmlsdGVyLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHJldHVybiBlW3RdID0gITAsIGU7CiAgICAgICAgICAgIH0pKSwgaS5wdXNoKHsgbTogZSwgbDogbyhlLCBuKSB9KSwgdGhpcy5mIHx8IHIodGhpcyk7CiAgICAgICAgICB9LCB0YWtlUmVjb3JkczogZnVuY3Rpb24gdGFrZVJlY29yZHMoKSB7CiAgICAgICAgICAgIGZvciAodmFyIGUgPSBbXSwgdCA9IHRoaXMuZywgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgICAgdFtyXS5sKGUpOwogICAgICAgICAgICB9cmV0dXJuIGU7CiAgICAgICAgICB9LCBkaXNjb25uZWN0OiBmdW5jdGlvbiBkaXNjb25uZWN0KCkgewogICAgICAgICAgICB0aGlzLmcgPSBbXSwgY2xlYXJUaW1lb3V0KHRoaXMuZiksIHRoaXMuZiA9IG51bGw7CiAgICAgICAgICB9IH07dmFyIGQgPSAxO3JldHVybiB0OwogICAgICB9KHZvaWQgMCk7CiAgICB9LCB7fV0sIDkxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgT2JqZWN0Lm9ic2VydmUgfHwgZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgdmFyIG8sCiAgICAgICAgICAgIGksCiAgICAgICAgICAgIHMgPSBbImFkZCIsICJ1cGRhdGUiLCAiZGVsZXRlIiwgInJlY29uZmlndXJlIiwgInNldFByb3RvdHlwZSIsICJwcmV2ZW50RXh0ZW5zaW9ucyJdLAogICAgICAgICAgICBhID0gdC5pc0FycmF5IHx8IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgcmV0dXJuICJbb2JqZWN0IEFycmF5XSIgPT09IGUuY2FsbCh0KTsKICAgICAgICAgIH07CiAgICAgICAgfShlLnByb3RvdHlwZS50b1N0cmluZyksCiAgICAgICAgICAgIGMgPSB0LnByb3RvdHlwZS5pbmRleE9mID8gdC5pbmRleE9mIHx8IGZ1bmN0aW9uIChlLCByLCBuKSB7CiAgICAgICAgICByZXR1cm4gdC5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGUsIHIsIG4pOwogICAgICAgIH0gOiBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgICAgZm9yICh2YXIgbiA9IHIgfHwgMDsgbiA8IGUubGVuZ3RoOyBuKyspIHsKICAgICAgICAgICAgaWYgKGVbbl0gPT09IHQpIHJldHVybiBuOwogICAgICAgICAgfXJldHVybiAtMTsKICAgICAgICB9LAogICAgICAgICAgICB1ID0gci5NYXAgIT09IG4gJiYgTWFwLnByb3RvdHlwZS5mb3JFYWNoID8gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIG5ldyBNYXAoKTsKICAgICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGUgPSBbXSwKICAgICAgICAgICAgICB0ID0gW107cmV0dXJuIHsgc2l6ZTogMCwgaGFzOiBmdW5jdGlvbiBoYXModCkgewogICAgICAgICAgICAgIHJldHVybiBjKGUsIHQpID4gLTE7CiAgICAgICAgICAgIH0sIGdldDogZnVuY3Rpb24gZ2V0KHIpIHsKICAgICAgICAgICAgICByZXR1cm4gdFtjKGUsIHIpXTsKICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiBzZXQociwgbikgewogICAgICAgICAgICAgIHZhciBvID0gYyhlLCByKTstMSA9PT0gbyA/IChlLnB1c2gociksIHQucHVzaChuKSwgdGhpcy5zaXplKyspIDogdFtvXSA9IG47CiAgICAgICAgICAgIH0sICJkZWxldGUiOiBmdW5jdGlvbiBfZGVsZXRlKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IGMoZSwgcik7biA+IC0xICYmIChlLnNwbGljZShuLCAxKSwgdC5zcGxpY2UobiwgMSksIHRoaXMuc2l6ZS0tKTsKICAgICAgICAgICAgfSwgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChyKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7CiAgICAgICAgICAgICAgICByLmNhbGwoYXJndW1lbnRzWzFdLCB0W25dLCBlW25dLCB0aGlzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gfTsKICAgICAgICB9LAogICAgICAgICAgICBsID0gZS5nZXRPd25Qcm9wZXJ0eU5hbWVzID8gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHQgPSBlLmdldE93blByb3BlcnR5TmFtZXM7dHJ5IHsKICAgICAgICAgICAgYXJndW1lbnRzLmNhbGxlZTsKICAgICAgICAgIH0gY2F0Y2ggKHIpIHsKICAgICAgICAgICAgdmFyIG4gPSAodChjKS5qb2luKCIgIikgKyAiICIpLnJlcGxhY2UoL3Byb3RvdHlwZSB8bGVuZ3RoIHxuYW1lIC9nLCAiIikuc2xpY2UoMCwgLTEpLnNwbGl0KCIgIik7bi5sZW5ndGggJiYgKHQgPSBmdW5jdGlvbiB0KF90MykgewogICAgICAgICAgICAgIHZhciByID0gZS5nZXRPd25Qcm9wZXJ0eU5hbWVzKF90Myk7aWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIF90MykgZm9yICh2YXIgbywgaSA9IDA7IGkgPCBuLmxlbmd0aDspIHsKICAgICAgICAgICAgICAgIChvID0gYyhyLCBuW2krK10pKSA+IC0xICYmIHIuc3BsaWNlKG8sIDEpOwogICAgICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9cmV0dXJuIHQ7CiAgICAgICAgfSgpIDogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgbyA9IFtdO2lmICgiaGFzT3duUHJvcGVydHkiIGluIHQpIGZvciAociBpbiB0KSB7CiAgICAgICAgICAgIHQuaGFzT3duUHJvcGVydHkocikgJiYgby5wdXNoKHIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbiA9IGUuaGFzT3duUHJvcGVydHk7Zm9yIChyIGluIHQpIHsKICAgICAgICAgICAgICBuLmNhbGwodCwgcikgJiYgby5wdXNoKHIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9cmV0dXJuIGEodCkgJiYgby5wdXNoKCJsZW5ndGgiKSwgbzsKICAgICAgICB9LAogICAgICAgICAgICBmID0gZS5nZXRQcm90b3R5cGVPZiwKICAgICAgICAgICAgZCA9IGUuZGVmaW5lUHJvcGVydGllcyAmJiBlLmdldE93blByb3BlcnR5RGVzY3JpcHRvciwKICAgICAgICAgICAgcCA9IHIucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHIud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlID0gK25ldyBEYXRlKCksCiAgICAgICAgICAgICAgdCA9IGU7cmV0dXJuIGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByKCh0ID0gK25ldyBEYXRlKCkpIC0gZSk7CiAgICAgICAgICAgIH0sIDE3KTsKICAgICAgICAgIH07CiAgICAgICAgfSgpLAogICAgICAgICAgICBiID0gZnVuY3Rpb24gYihlLCB0LCByKSB7CiAgICAgICAgICB2YXIgbiA9IG8uZ2V0KGUpO24gPyAodihuLCBlKSwgbShlLCBuLCB0LCByKSkgOiAobiA9IGgoZSksIG0oZSwgbiwgdCwgciksIDEgPT09IG8uc2l6ZSAmJiBwKHkpKTsKICAgICAgICB9LAogICAgICAgICAgICBoID0gZnVuY3Rpb24gaCh0LCByKSB7CiAgICAgICAgICB2YXIgbiwKICAgICAgICAgICAgICBpID0gbCh0KSwKICAgICAgICAgICAgICBzID0gW10sCiAgICAgICAgICAgICAgYSA9IDAsCiAgICAgICAgICAgICAgciA9IHsgaGFuZGxlcnM6IHUoKSwgZnJvemVuOiBlLmlzRnJvemVuID8gZS5pc0Zyb3plbih0KSA6ICExLCBleHRlbnNpYmxlOiBlLmlzRXh0ZW5zaWJsZSA/IGUuaXNFeHRlbnNpYmxlKHQpIDogITAsIHByb3RvOiBmICYmIGYodCksIHByb3BlcnRpZXM6IGksIHZhbHVlczogcywgbm90aWZpZXI6IGcodCwgcikgfTtpZiAoZCkgZm9yIChuID0gci5kZXNjcmlwdG9ycyA9IFtdOyBhIDwgaS5sZW5ndGg7KSB7CiAgICAgICAgICAgIG5bYV0gPSBkKHQsIGlbYV0pLCBzW2FdID0gdFtpW2ErK11dOwogICAgICAgICAgfSBlbHNlIGZvciAoOyBhIDwgaS5sZW5ndGg7KSB7CiAgICAgICAgICAgIHNbYV0gPSB0W2lbYSsrXV07CiAgICAgICAgICB9cmV0dXJuIG8uc2V0KHQsIHIpLCByOwogICAgICAgIH0sCiAgICAgICAgICAgIHYgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgdCA9IGQgPyBmdW5jdGlvbiAoZSwgdCwgciwgbiwgbykgewogICAgICAgICAgICB2YXIgaSA9IHQucHJvcGVydGllc1tyXSwKICAgICAgICAgICAgICAgIHMgPSBlW2ldLAogICAgICAgICAgICAgICAgYSA9IHQudmFsdWVzW3JdLAogICAgICAgICAgICAgICAgYyA9IHQuZGVzY3JpcHRvcnNbcl07InZhbHVlIiBpbiBvICYmIChhID09PSBzID8gMCA9PT0gYSAmJiAxIC8gYSAhPT0gMSAvIHMgOiBhID09PSBhIHx8IHMgPT09IHMpICYmIChqKGUsIHQsIHsgbmFtZTogaSwgdHlwZTogInVwZGF0ZSIsIG9iamVjdDogZSwgb2xkVmFsdWU6IGEgfSwgbiksIHQudmFsdWVzW3JdID0gcyksICFjLmNvbmZpZ3VyYWJsZSB8fCBvLmNvbmZpZ3VyYWJsZSAmJiBvLndyaXRhYmxlID09PSBjLndyaXRhYmxlICYmIG8uZW51bWVyYWJsZSA9PT0gYy5lbnVtZXJhYmxlICYmIG8uZ2V0ID09PSBjLmdldCAmJiBvLnNldCA9PT0gYy5zZXQgfHwgKGooZSwgdCwgeyBuYW1lOiBpLCB0eXBlOiAicmVjb25maWd1cmUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBhIH0sIG4pLCB0LmRlc2NyaXB0b3JzW3JdID0gbyk7CiAgICAgICAgICB9IDogZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKICAgICAgICAgICAgdmFyIG8gPSB0LnByb3BlcnRpZXNbcl0sCiAgICAgICAgICAgICAgICBpID0gZVtvXSwKICAgICAgICAgICAgICAgIHMgPSB0LnZhbHVlc1tyXTsocyA9PT0gaSA/IDAgPT09IHMgJiYgMSAvIHMgIT09IDEgLyBpIDogcyA9PT0gcyB8fCBpID09PSBpKSAmJiAoaihlLCB0LCB7IG5hbWU6IG8sIHR5cGU6ICJ1cGRhdGUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBzIH0sIG4pLCB0LnZhbHVlc1tyXSA9IGkpOwogICAgICAgICAgfSwKICAgICAgICAgICAgICByID0gZCA/IGZ1bmN0aW9uIChlLCByLCBuLCBvLCBpKSB7CiAgICAgICAgICAgIGZvciAodmFyIHMsIGEgPSByLmxlbmd0aDsgbiAmJiBhLS07KSB7CiAgICAgICAgICAgICAgbnVsbCAhPT0gclthXSAmJiAocyA9IGQoZSwgclthXSksIG4tLSwgcyA/IHQoZSwgbywgYSwgaSwgcykgOiAoaihlLCBvLCB7IG5hbWU6IHJbYV0sIHR5cGU6ICJkZWxldGUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBvLnZhbHVlc1thXSB9LCBpKSwgby5wcm9wZXJ0aWVzLnNwbGljZShhLCAxKSwgby52YWx1ZXMuc3BsaWNlKGEsIDEpLCBvLmRlc2NyaXB0b3JzLnNwbGljZShhLCAxKSkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IDogZnVuY3Rpb24gKGUsIHQsIHIsIG4sIG8pIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IHQubGVuZ3RoOyByICYmIGktLTspIHsKICAgICAgICAgICAgICBudWxsICE9PSB0W2ldICYmIChqKGUsIG4sIHsgbmFtZTogdFtpXSwgdHlwZTogImRlbGV0ZSIsIG9iamVjdDogZSwgb2xkVmFsdWU6IG4udmFsdWVzW2ldIH0sIG8pLCBuLnByb3BlcnRpZXMuc3BsaWNlKGksIDEpLCBuLnZhbHVlcy5zcGxpY2UoaSwgMSksIHItLSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07cmV0dXJuIGZ1bmN0aW9uIChuLCBvLCBpKSB7CiAgICAgICAgICAgIGlmIChuLmhhbmRsZXJzLnNpemUgJiYgIW4uZnJvemVuKSB7CiAgICAgICAgICAgICAgdmFyIHMsCiAgICAgICAgICAgICAgICAgIGEsCiAgICAgICAgICAgICAgICAgIHUsCiAgICAgICAgICAgICAgICAgIHAsCiAgICAgICAgICAgICAgICAgIGIsCiAgICAgICAgICAgICAgICAgIGgsCiAgICAgICAgICAgICAgICAgIHYsCiAgICAgICAgICAgICAgICAgIHksCiAgICAgICAgICAgICAgICAgIF8gPSBuLnZhbHVlcywKICAgICAgICAgICAgICAgICAgZyA9IG4uZGVzY3JpcHRvcnMsCiAgICAgICAgICAgICAgICAgIG0gPSAwO2lmIChuLmV4dGVuc2libGUpIHsKICAgICAgICAgICAgICAgIGlmIChzID0gbi5wcm9wZXJ0aWVzLnNsaWNlKCksIGEgPSBzLmxlbmd0aCwgdSA9IGwobyksIGcpIHsKICAgICAgICAgICAgICAgICAgZm9yICg7IG0gPCB1Lmxlbmd0aDspIHsKICAgICAgICAgICAgICAgICAgICBiID0gdVttKytdLCBwID0gYyhzLCBiKSwgeSA9IGQobywgYiksIC0xID09PSBwID8gKGoobywgbiwgeyBuYW1lOiBiLCB0eXBlOiAiYWRkIiwgb2JqZWN0OiBvIH0sIGkpLCBuLnByb3BlcnRpZXMucHVzaChiKSwgXy5wdXNoKG9bYl0pLCBnLnB1c2goeSkpIDogKHNbcF0gPSBudWxsLCBhLS0sIHQobywgbiwgcCwgaSwgeSkpOwogICAgICAgICAgICAgICAgICB9cihvLCBzLCBhLCBuLCBpKSwgZS5pc0V4dGVuc2libGUobykgfHwgKG4uZXh0ZW5zaWJsZSA9ICExLCBqKG8sIG4sIHsgdHlwZTogInByZXZlbnRFeHRlbnNpb25zIiwgb2JqZWN0OiBvIH0sIGkpLCBuLmZyb3plbiA9IGUuaXNGcm96ZW4obykpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZm9yICg7IG0gPCB1Lmxlbmd0aDspIHsKICAgICAgICAgICAgICAgICAgICBiID0gdVttKytdLCBwID0gYyhzLCBiKSwgaCA9IG9bYl0sIC0xID09PSBwID8gKGoobywgbiwgeyBuYW1lOiBiLCB0eXBlOiAiYWRkIiwgb2JqZWN0OiBvIH0sIGkpLCBuLnByb3BlcnRpZXMucHVzaChiKSwgXy5wdXNoKGgpKSA6IChzW3BdID0gbnVsbCwgYS0tLCB0KG8sIG4sIHAsIGkpKTsKICAgICAgICAgICAgICAgICAgfXIobywgcywgYSwgbiwgaSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmICghbi5mcm96ZW4pIHsKICAgICAgICAgICAgICAgIGZvciAoOyBtIDwgcy5sZW5ndGg7IG0rKykgewogICAgICAgICAgICAgICAgICBiID0gc1ttXSwgdChvLCBuLCBtLCBpLCBkKG8sIGIpKTsKICAgICAgICAgICAgICAgIH1lLmlzRnJvemVuKG8pICYmIChuLmZyb3plbiA9ICEwKTsKICAgICAgICAgICAgICB9ZiAmJiAodiA9IGYobyksIHYgIT09IG4ucHJvdG8gJiYgKGoobywgbiwgeyB0eXBlOiAic2V0UHJvdG90eXBlIiwgbmFtZTogIl9fcHJvdG9fXyIsIG9iamVjdDogbywgb2xkVmFsdWU6IG4ucHJvdG8gfSksIG4ucHJvdG8gPSB2KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfSgpLAogICAgICAgICAgICB5ID0gZnVuY3Rpb24geSgpIHsKICAgICAgICAgIG8uc2l6ZSAmJiAoby5mb3JFYWNoKHYpLCBpLmZvckVhY2goXyksIHAoeSkpOwogICAgICAgIH0sCiAgICAgICAgICAgIF8gPSBmdW5jdGlvbiBfKGUsIHQpIHsKICAgICAgICAgIHZhciByID0gZS5jaGFuZ2VSZWNvcmRzO3IubGVuZ3RoICYmIChlLmNoYW5nZVJlY29yZHMgPSBbXSwgdChyKSk7CiAgICAgICAgfSwKICAgICAgICAgICAgZyA9IGZ1bmN0aW9uIGcoZSwgdCkgewogICAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyICYmICh0ID0gby5nZXQoZSkpLCB0ICYmIHQubm90aWZpZXIgfHwgeyBub3RpZnk6IGZ1bmN0aW9uIG5vdGlmeSh0KSB7CiAgICAgICAgICAgICAgdC50eXBlO3ZhciByID0gby5nZXQoZSk7aWYgKHIpIHsKICAgICAgICAgICAgICAgIHZhciBuLAogICAgICAgICAgICAgICAgICAgIGkgPSB7IG9iamVjdDogZSB9O2ZvciAobiBpbiB0KSB7CiAgICAgICAgICAgICAgICAgICJvYmplY3QiICE9PSBuICYmIChpW25dID0gdFtuXSk7CiAgICAgICAgICAgICAgICB9aihlLCByLCBpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHBlcmZvcm1DaGFuZ2U6IGZ1bmN0aW9uIHBlcmZvcm1DaGFuZ2UodCwgcikgewogICAgICAgICAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgdCkgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBub24tc3RyaW5nIGNoYW5nZVR5cGUiKTtpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgcikgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IHBlcmZvcm0gbm9uLWZ1bmN0aW9uIik7dmFyIGksCiAgICAgICAgICAgICAgICAgIHMsCiAgICAgICAgICAgICAgICAgIGEgPSBvLmdldChlKSwKICAgICAgICAgICAgICAgICAgYyA9IGFyZ3VtZW50c1syXSwKICAgICAgICAgICAgICAgICAgdSA9IGMgPT09IG4gPyByKCkgOiByLmNhbGwoYyk7aWYgKGEgJiYgdihhLCBlLCB0KSwgYSAmJiB1ICYmICJvYmplY3QiID09ICh0eXBlb2YgdSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YodSkpKSB7CiAgICAgICAgICAgICAgICBzID0geyBvYmplY3Q6IGUsIHR5cGU6IHQgfTtmb3IgKGkgaW4gdSkgewogICAgICAgICAgICAgICAgICAib2JqZWN0IiAhPT0gaSAmJiAidHlwZSIgIT09IGkgJiYgKHNbaV0gPSB1W2ldKTsKICAgICAgICAgICAgICAgIH1qKGUsIGEsIHMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSB9OwogICAgICAgIH0sCiAgICAgICAgICAgIG0gPSBmdW5jdGlvbiBtKGUsIHQsIHIsIG4pIHsKICAgICAgICAgIHZhciBvID0gaS5nZXQocik7byB8fCBpLnNldChyLCBvID0geyBvYnNlcnZlZDogdSgpLCBjaGFuZ2VSZWNvcmRzOiBbXSB9KSwgby5vYnNlcnZlZC5zZXQoZSwgeyBhY2NlcHRMaXN0OiBuLnNsaWNlKCksIGRhdGE6IHQgfSksIHQuaGFuZGxlcnMuc2V0KHIsIG8pOwogICAgICAgIH0sCiAgICAgICAgICAgIGogPSBmdW5jdGlvbiBqKGUsIHQsIHIsIG4pIHsKICAgICAgICAgIHQuaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgICB2YXIgbyA9IHQub2JzZXJ2ZWQuZ2V0KGUpLmFjY2VwdExpc3Q7KCJzdHJpbmciICE9IHR5cGVvZiBuIHx8IC0xID09PSBjKG8sIG4pKSAmJiBjKG8sIHIudHlwZSkgPiAtMSAmJiB0LmNoYW5nZVJlY29yZHMucHVzaChyKTsKICAgICAgICAgIH0pOwogICAgICAgIH07byA9IHUoKSwgaSA9IHUoKSwgZS5vYnNlcnZlID0gZnVuY3Rpb24gKHQsIHIsIG8pIHsKICAgICAgICAgIGlmICghdCB8fCAib2JqZWN0IiAhPSAodHlwZW9mIHQgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKHQpKSAmJiAiZnVuY3Rpb24iICE9IHR5cGVvZiB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3Qub2JzZXJ2ZSBjYW5ub3Qgb2JzZXJ2ZSBub24tb2JqZWN0Iik7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIHIpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBkZWxpdmVyIHRvIG5vbi1mdW5jdGlvbiIpO2lmIChlLmlzRnJvemVuICYmIGUuaXNGcm96ZW4ocikpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBkZWxpdmVyIHRvIGEgZnJvemVuIGZ1bmN0aW9uIG9iamVjdCIpO2lmIChvID09PSBuKSBvID0gcztlbHNlIGlmICghbyB8fCAib2JqZWN0IiAhPSAodHlwZW9mIG8gPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG8pKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhpcmQgYXJndW1lbnQgdG8gT2JqZWN0Lm9ic2VydmUgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzLiIpO3JldHVybiBiKHQsIHIsIG8pLCB0OwogICAgICAgIH0sIGUudW5vYnNlcnZlID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIGlmIChudWxsID09PSBlIHx8ICJvYmplY3QiICE9ICh0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSkpICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC51bm9ic2VydmUgY2Fubm90IHVub2JzZXJ2ZSBub24tb2JqZWN0Iik7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIHQpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC51bm9ic2VydmUgY2Fubm90IGRlbGl2ZXIgdG8gbm9uLWZ1bmN0aW9uIik7dmFyIHIsCiAgICAgICAgICAgICAgbiA9IGkuZ2V0KHQpO3JldHVybiBuICYmIChyID0gbi5vYnNlcnZlZC5nZXQoZSkpICYmIChuLm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgdihlLmRhdGEsIHQpOwogICAgICAgICAgfSksIHAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfKG4sIHQpOwogICAgICAgICAgfSksIDEgPT09IG4ub2JzZXJ2ZWQuc2l6ZSAmJiBuLm9ic2VydmVkLmhhcyhlKSA/IGlbImRlbGV0ZSJdKHQpIDogbi5vYnNlcnZlZFsiZGVsZXRlIl0oZSksIDEgPT09IHIuZGF0YS5oYW5kbGVycy5zaXplID8gb1siZGVsZXRlIl0oZSkgOiByLmRhdGEuaGFuZGxlcnNbImRlbGV0ZSJdKHQpKSwgZTsKICAgICAgICB9LCBlLmdldE5vdGlmaWVyID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIGlmIChudWxsID09PSB0IHx8ICJvYmplY3QiICE9ICh0eXBlb2YgdCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YodCkpICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIHQpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5nZXROb3RpZmllciBjYW5ub3QgZ2V0Tm90aWZpZXIgbm9uLW9iamVjdCIpO3JldHVybiBlLmlzRnJvemVuICYmIGUuaXNGcm96ZW4odCkgPyBudWxsIDogZyh0KTsKICAgICAgICB9LCBlLmRlbGl2ZXJDaGFuZ2VSZWNvcmRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3QuZGVsaXZlckNoYW5nZVJlY29yZHMgY2Fubm90IGRlbGl2ZXIgdG8gbm9uLWZ1bmN0aW9uIik7dmFyIHQgPSBpLmdldChlKTt0ICYmICh0Lm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgdihlLmRhdGEsIHQpOwogICAgICAgICAgfSksIF8odCwgZSkpOwogICAgICAgIH07CiAgICAgIH0oT2JqZWN0LCBBcnJheSwgdGhpcyk7CiAgICB9LCB7fV0sIDkyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pLCByLkRhdGFPYmplY3RPYnNlcnZlciA9IHIuRGF0YU9iamVjdFJlcG9ydGVyID0gci5TeW5jaGVyID0gdm9pZCAwLCBlKCJtdXRhdGlvbm9ic2VydmVyLXNoaW0iKSwgZSgib2JqZWN0Lm9ic2VydmUiKSwgZSgiYXJyYXkub2JzZXJ2ZSIpO3ZhciBvID0gZSgiLi9zeW5jaGVyL1N5bmNoZXIiKSwKICAgICAgICAgIGkgPSBuKG8pLAogICAgICAgICAgcyA9IGUoIi4vc3luY2hlci9EYXRhT2JqZWN0UmVwb3J0ZXIiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoIi4vc3luY2hlci9EYXRhT2JqZWN0T2JzZXJ2ZXIiKSwKICAgICAgICAgIHUgPSBuKGMpO3IuU3luY2hlciA9IGlbImRlZmF1bHQiXSwgci5EYXRhT2JqZWN0UmVwb3J0ZXIgPSBhWyJkZWZhdWx0Il0sIHIuRGF0YU9iamVjdE9ic2VydmVyID0gdVsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi9zeW5jaGVyL0RhdGFPYmplY3RPYnNlcnZlciI6IDk1LCAiLi9zeW5jaGVyL0RhdGFPYmplY3RSZXBvcnRlciI6IDk2LCAiLi9zeW5jaGVyL1N5bmNoZXIiOiA5OSwgImFycmF5Lm9ic2VydmUiOiAxLCAibXV0YXRpb25vYnNlcnZlci1zaGltIjogOTAsICJvYmplY3Qub2JzZXJ2ZSI6IDkxIH1dLCA5MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCIuL1N5bmNPYmplY3QiKSwKICAgICAgICAgIHAgPSBuKGQpLAogICAgICAgICAgYiA9IGUoIi4vRGF0YU9iamVjdENoaWxkIiksCiAgICAgICAgICBoID0gbihiKSwKICAgICAgICAgIHYgPSBlKCIuLi91dGlscy91dGlscy5qcyIpLAogICAgICAgICAgeSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiBlKHQsIHIsIG4sIG8sIGksIHMpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIGUpO3ZhciBhID0gdGhpczthLl9zeW5jaGVyID0gdCwgYS5fdXJsID0gciwgYS5fc2NoZW1hID0gbiwgYS5fc3RhdHVzID0gbywgYS5fc3luY09iaiA9IG5ldyBwWyJkZWZhdWx0Il0oaSksIGEuX2NoaWxkcmVucyA9IHMsIGEuX3ZlcnNpb24gPSAwLCBhLl9jaGlsZElkID0gMCwgYS5fY2hpbGRyZW5PYmplY3RzID0ge30sIGEuX2NoaWxkcmVuTGlzdGVuZXJzID0gW10sIGEuX293bmVyID0gdC5fb3duZXIsIGEuX2J1cyA9IHQuX2J1czsKICAgICAgICB9cmV0dXJuICgwLCBmWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzLAogICAgICAgICAgICAgICAgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gdC5fdXJsICsgIi9jaGlsZHJlbi8iO3QuX2NoaWxkcmVucyAmJiB0Ll9jaGlsZHJlbnMuZm9yRWFjaChmdW5jdGlvbiAobikgewogICAgICAgICAgICAgIHZhciBvID0gciArIG4sCiAgICAgICAgICAgICAgICAgIGkgPSB0Ll9idXMuYWRkTGlzdGVuZXIobywgZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICAgIGlmIChyLmZyb20gIT09IGUuX293bmVyKSBzd2l0Y2ggKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0LUNoaWxkcmVuLVJDVjogIiwgciksIHIudHlwZSkge2Nhc2UgImNyZWF0ZSI6CiAgICAgICAgICAgICAgICAgICAgdC5fb25DaGlsZENyZWF0ZShyKTticmVhaztjYXNlICJkZWxldGUiOgogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHIpO2JyZWFrO2RlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgdC5fY2hhbmdlQ2hpbGRyZW4ocik7fQogICAgICAgICAgICAgIH0pO3QuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2goaSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXM7ZS5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGUucmVtb3ZlKCk7CiAgICAgICAgICAgIH0pLCAoMCwgYVsiZGVmYXVsdCJdKShlLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlLl9jaGlsZHJlbk9iamVjdHNbdF0uX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAicGF1c2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHRocm93ICJOb3QgaW1wbGVtZW50ZWQiOwogICAgICAgICAgfSB9LCB7IGtleTogInJlc3VtZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdGhyb3cgIk5vdCBpbXBsZW1lbnRlZCI7CiAgICAgICAgICB9IH0sIHsga2V5OiAic3RvcCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdGhyb3cgIk5vdCBpbXBsZW1lbnRlZCI7CiAgICAgICAgICB9IH0sIHsga2V5OiAiYWRkQ2hpbGQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7ci5fY2hpbGRJZCsrO3ZhciBuID0gci5fb3duZXIgKyAiIyIgKyByLl9jaGlsZElkLAogICAgICAgICAgICAgICAgbyA9IHIuX3VybCArICIvY2hpbGRyZW4vIiArIGUsCiAgICAgICAgICAgICAgICBzID0geyB0eXBlOiAiY3JlYXRlIiwgZnJvbTogci5fb3duZXIsIHRvOiBvLCBib2R5OiB7IHJlc291cmNlOiBuLCB2YWx1ZTogdCB9IH07cmV0dXJuIG5ldyBpWyJkZWZhdWx0Il0oZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB2YXIgaSA9IHIuX2J1cy5wb3N0TWVzc2FnZShzKTtjb25zb2xlLmxvZygiY3JlYXRlLXJlcG9ydGVyLWNoaWxkKCAiICsgci5fb3duZXIgKyAiICk6ICIsIHMpO3ZhciBhID0gbmV3IGhbImRlZmF1bHQiXShyLCBuLCB0LCByLl9vd25lciwgaSk7YS5vbkNoYW5nZShmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgci5fb25DaGFuZ2UoZSwgeyBwYXRoOiBvLCBjaGlsZElkOiBuIH0pOwogICAgICAgICAgICAgIH0pLCByLl9jaGlsZHJlbk9iamVjdHNbbl0gPSBhLCBlKGEpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvbkFkZENoaWxkIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoaWxkQ3JlYXRlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IGUuYm9keS5yZXNvdXJjZTtjb25zb2xlLmxvZygiY3JlYXRlLW9ic2VydmVyLWNoaWxkKCAiICsgdC5fb3duZXIgKyAiICk6ICIsIGUpO3ZhciBuID0gbmV3IGhbImRlZmF1bHQiXSh0LCByLCBlLmJvZHkudmFsdWUpO3QuX2NoaWxkcmVuT2JqZWN0c1tyXSA9IG4sIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IDIwMCwgc291cmNlOiB0Ll9vd25lciB9IH0pOwogICAgICAgICAgICB9KTt2YXIgbyA9IHsgdHlwZTogZS50eXBlLCBmcm9tOiBlLmZyb20sIHVybDogZS50bywgdmFsdWU6IGUuYm9keS52YWx1ZSwgY2hpbGRJZDogciwgaWRlbnRpdHk6IGUuYm9keS5pZGVudGl0eSB9O3QuX29uQWRkQ2hpbGRyZW5IYW5kbGVyICYmIChjb25zb2xlLmxvZygiQURELUNISUxEUkVOLUVWRU5UOiAiLCBvKSwgdC5fb25BZGRDaGlsZHJlbkhhbmRsZXIobykpOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoYW5nZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gdGhpcztpZiAoci5fdmVyc2lvbisrLCAib24iID09PSByLl9zdGF0dXMpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHsgdHlwZTogInVwZGF0ZSIsIGZyb206IHIuX3VybCwgdG86IHIuX3VybCArICIvY2hhbmdlcyIsIGJvZHk6IHsgdmVyc2lvbjogci5fdmVyc2lvbiwgc291cmNlOiByLl9vd25lciwgYXR0cmlidXRlOiBlLmZpZWxkIH0gfTtlLm9UeXBlID09PSBkLk9iamVjdFR5cGUuT0JKRUNUID8gZS5jVHlwZSAhPT0gZC5DaGFuZ2VUeXBlLlJFTU9WRSAmJiAobi5ib2R5LnZhbHVlID0gZS5kYXRhKSA6IChuLmJvZHkuYXR0cmlidXRlVHlwZSA9IGUub1R5cGUsIG4uYm9keS52YWx1ZSA9IGUuZGF0YSwgZS5jVHlwZSAhPT0gZC5DaGFuZ2VUeXBlLlVQREFURSAmJiAobi5ib2R5Lm9wZXJhdGlvbiA9IGUuY1R5cGUpKSwgdCAmJiAobi50byA9IHQucGF0aCwgbi5ib2R5LnJlc291cmNlID0gdC5jaGlsZElkKSwgci5fYnVzLnBvc3RNZXNzYWdlKG4pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IH0sIHsga2V5OiAiX2NoYW5nZU9iamVjdCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gdGhpcztpZiAoci5fdmVyc2lvbiArIDEgPT09IHQuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgICAgICAgci5fdmVyc2lvbisrO3ZhciBuID0gdC5ib2R5LmF0dHJpYnV0ZSwKICAgICAgICAgICAgICAgICAgbyA9ICgwLCB2LmRlZXBDbG9uZSkodC5ib2R5LnZhbHVlKSwKICAgICAgICAgICAgICAgICAgaSA9IGUuZmluZEJlZm9yZShuKTtpZiAodC5ib2R5LmF0dHJpYnV0ZVR5cGUgPT09IGQuT2JqZWN0VHlwZS5BUlJBWSkgewogICAgICAgICAgICAgICAgaWYgKHQuYm9keS5vcGVyYXRpb24gPT09IGQuQ2hhbmdlVHlwZS5BREQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHMgPSBpLm9iaiwKICAgICAgICAgICAgICAgICAgICAgIGEgPSBpLmxhc3Q7QXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShzLCBbYSwgMF0uY29uY2F0KG8pKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5ib2R5Lm9wZXJhdGlvbiA9PT0gZC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICAgICAgICB2YXIgYyA9IGkub2JqLAogICAgICAgICAgICAgICAgICAgICAgdSA9IGkubGFzdDtjLnNwbGljZSh1LCBvKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpLm9ialtpLmxhc3RdID0gbzsKICAgICAgICAgICAgICB9IGVsc2UgdC5ib2R5LnZhbHVlID8gaS5vYmpbaS5sYXN0XSA9IG8gOiBkZWxldGUgaS5vYmpbaS5sYXN0XTsKICAgICAgICAgICAgfSBlbHNlIGNvbnNvbGUubG9nKCJVTlNZTkNIUk9OSVpFRCBWRVJTSU9OOiAoZGF0YSA9PiAiICsgci5fdmVyc2lvbiArICIsIG1zZyA9PiAiICsgdC5ib2R5LnZlcnNpb24gKyAiKSIpOwogICAgICAgICAgfSB9LCB7IGtleTogIl9jaGFuZ2VDaGlsZHJlbiIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcztjb25zb2xlLmxvZygiQ2hhbmdlIGNoaWxkcmVuOiAiLCB0Ll9vd25lciwgZSk7dmFyIHIgPSBlLmJvZHkucmVzb3VyY2UsCiAgICAgICAgICAgICAgICBuID0gdC5fY2hpbGRyZW5PYmplY3RzW3JdO24gPyB0Ll9jaGFuZ2VPYmplY3Qobi5fc3luY09iaiwgZSkgOiBjb25zb2xlLmxvZygiTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAiLCByKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJ1cmwiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzY2hlbWEiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtYTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzdGF0dXMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1czsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkYXRhIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICAgICAgICB9IH0sIHsga2V5OiAiY2hpbGRyZW5zIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpO3JbImRlZmF1bHQiXSA9IHksIHQuZXhwb3J0cyA9IHJbImRlZmF1bHQiXTsKICAgIH0sIHsgIi4uL3V0aWxzL3V0aWxzLmpzIjogMTAwLCAiLi9EYXRhT2JqZWN0Q2hpbGQiOiA5NCwgIi4vU3luY09iamVjdCI6IDk4LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjogNywgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIjogOSwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDExLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjogMTIgfV0sIDk0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBvID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoIi4vU3luY09iamVjdCIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCwgciwgbiwgbywgcykgewogICAgICAgICAgKDAsIGlbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIGEgPSB0aGlzO2EuX3BhcmVudCA9IHQsIGEuX2NoaWxkSWQgPSByLCBhLl9vd25lciA9IG8sIGEuX21zZ0lkID0gcywgYS5fc3luY09iaiA9IG5ldyB1WyJkZWZhdWx0Il0obiksIGEuX2J1cyA9IHQuX2J1cywgYS5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX293bmVyICYmIChlLl9saXN0ZW5lciA9IGUuX2J1cy5hZGRMaXN0ZW5lcihlLl9vd25lciwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAicmVzcG9uc2UiID09PSB0LnR5cGUgJiYgdC5pZCA9PT0gZS5fbXNnSWQgJiYgKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZToiLCB0KSwgZS5fb25SZXNwb25zZSh0KSk7CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfcmVsZWFzZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX2xpc3RlbmVyICYmIGUuX2xpc3RlbmVyLnJlbW92ZSgpOwogICAgICAgICAgfSB9LCB7IGtleTogImRlbGV0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2RlbGV0ZSBlLl9wYXJlbnQuX2NoaWxkcmVuW2UuX2NoaWxkSWRdLCBlLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICB9IH0sIHsga2V5OiAib25DaGFuZ2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlKHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvblJlc3BvbnNlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vblJlc3BvbnNlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHsgdHlwZTogZS50eXBlLCB1cmw6IGUuYm9keS5zb3VyY2UsIGNvZGU6IGUuYm9keS5jb2RlIH07dC5fb25SZXNwb25zZUhhbmRsZXIgJiYgdC5fb25SZXNwb25zZUhhbmRsZXIocik7CiAgICAgICAgICB9IH0sIHsga2V5OiAiY2hpbGRJZCIsIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkYXRhIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpO3JbImRlZmF1bHQiXSA9IGwsIHQuZXhwb3J0cyA9IHJbImRlZmF1bHQiXTsKICAgIH0sIHsgIi4vU3luY09iamVjdCI6IDk4LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiKSwKICAgICAgICAgIGkgPSBuKG8pLAogICAgICAgICAgcyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiIpLAogICAgICAgICAgYSA9IG4ocyksCiAgICAgICAgICBjID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICB1ID0gbihjKSwKICAgICAgICAgIGwgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGYgPSBuKGwpLAogICAgICAgICAgZCA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiksCiAgICAgICAgICBwID0gbihkKSwKICAgICAgICAgIGIgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IiksCiAgICAgICAgICBoID0gbihiKSwKICAgICAgICAgIHYgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiKSwKICAgICAgICAgIHkgPSBuKHYpLAogICAgICAgICAgXyA9IGUoIi4vRGF0YU9iamVjdCIpLAogICAgICAgICAgZyA9IG4oXyksCiAgICAgICAgICBtID0gZSgiLi9EYXRhT2JqZWN0Q2hpbGQiKSwKICAgICAgICAgIGogPSBuKG0pLAogICAgICAgICAgJCA9IHsgQU5ZOiAiYW55IiwgU1RBUlQ6ICJzdGFydCIsIEVYQUNUOiAiZXhhY3QiIH0sCiAgICAgICAgICBPID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBmdW5jdGlvbiB0KGUsIHIsIG4sIG8sIHMsIGMsIGwpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIHQpO3ZhciBmID0gKDAsIHBbImRlZmF1bHQiXSkodGhpcywgKDAsIGFbImRlZmF1bHQiXSkodCkuY2FsbCh0aGlzLCBlLCByLCBuLCBvLCBzLmRhdGEsIGMpKSwKICAgICAgICAgICAgICBkID0gZjtyZXR1cm4gZC5fdmVyc2lvbiA9IGwsIGQuX2ZpbHRlcnMgPSB7fSwgZC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGQuX29uRmlsdGVyKGUpOwogICAgICAgICAgfSksICgwLCBpWyJkZWZhdWx0Il0pKHMuY2hpbGRyZW5zKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHZhciB0ID0gcy5jaGlsZHJlbnNbZV07ZC5fY2hpbGRyZW5PYmplY3RzW2VdID0gbmV3IGpbImRlZmF1bHQiXShkLCBlLCB0KTsKICAgICAgICAgIH0pLCBkLl9hbGxvY2F0ZUxpc3RlbmVycygpLCBmOwogICAgICAgIH1yZXR1cm4gKDAsIHlbImRlZmF1bHQiXSkodCwgZSksICgwLCBmWyJkZWZhdWx0Il0pKHQsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgKDAsIGhbImRlZmF1bHQiXSkoKDAsIGFbImRlZmF1bHQiXSkodC5wcm90b3R5cGUpLCAiX2FsbG9jYXRlTGlzdGVuZXJzIiwgdGhpcykuY2FsbCh0aGlzKTt2YXIgZSA9IHRoaXM7ZS5fY2hhbmdlTGlzdGVuZXIgPSBlLl9idXMuYWRkTGlzdGVuZXIoZS5fdXJsICsgIi9jaGFuZ2VzIiwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAidXBkYXRlIiA9PT0gdC50eXBlICYmIChjb25zb2xlLmxvZygiRGF0YU9iamVjdE9ic2VydmVyLSIgKyBlLl91cmwgKyAiLVJDVjogIiwgdCksIGUuX2NoYW5nZU9iamVjdChlLl9zeW5jT2JqLCB0KSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICAoMCwgaFsiZGVmYXVsdCJdKSgoMCwgYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksICJfcmVsZWFzZUxpc3RlbmVycyIsIHRoaXMpLmNhbGwodGhpcyk7dmFyIGUgPSB0aGlzO2UuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgICAgICAgfSB9LCB7IGtleTogImRlbGV0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX3JlbGVhc2VMaXN0ZW5lcnMoKSwgZGVsZXRlIGUuX3N5bmNoZXIuX29ic2VydmVyc1tlLl91cmxdOwogICAgICAgICAgfSB9LCB7IGtleTogInVuc3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMsCiAgICAgICAgICAgICAgICB0ID0geyB0eXBlOiAidW5zdWJzY3JpYmUiLCBmcm9tOiBlLl9vd25lciwgdG86IGUuX3N5bmNoZXIuX3N1YlVSTCwgYm9keTogeyByZXNvdXJjZTogZS5fdXJsIH0gfTtlLl9idXMucG9zdE1lc3NhZ2UodCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAiLCB0KSwgMjAwID09PSB0LmJvZHkuY29kZSAmJiAoZS5fcmVsZWFzZUxpc3RlbmVycygpLCBkZWxldGUgZS5fc3luY2hlci5fb2JzZXJ2ZXJzW2UuX3VybF0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvbkNoYW5nZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gZSwKICAgICAgICAgICAgICAgIG4gPSB7IHR5cGU6ICQuRVhBQ1QsIGNhbGxiYWNrOiB0IH0sCiAgICAgICAgICAgICAgICBvID0gZS5pbmRleE9mKCIqIik7byA9PT0gZS5sZW5ndGggLSAxICYmICgwID09PSBvID8gbi50eXBlID0gJC5BTlkgOiAobi50eXBlID0gJC5TVEFSVCwgciA9IGUuc3Vic3RyKDAsIGUubGVuZ3RoIC0gMSkpKSwgdGhpcy5fZmlsdGVyc1tyXSA9IG47CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uRmlsdGVyIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzOygwLCBpWyJkZWZhdWx0Il0pKHQuX2ZpbHRlcnMpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHQuX2ZpbHRlcnNbcl07bi50eXBlID09PSAkLkFOWSA/IG4uY2FsbGJhY2soZSkgOiBuLnR5cGUgPT09ICQuU1RBUlQgPyAwID09PSBlLmZpZWxkLmluZGV4T2YocikgJiYgbi5jYWxsYmFjayhlKSA6IG4udHlwZSA9PT0gJC5FWEFDVCAmJiBlLmZpZWxkID09PSByICYmIG4uY2FsbGJhY2soZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9XSksIHQ7CiAgICAgIH0oZ1siZGVmYXVsdCJdKTtyWyJkZWZhdWx0Il0gPSBPLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuL0RhdGFPYmplY3QiOiA5MywgIi4vRGF0YU9iamVjdENoaWxkIjogOTQsICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiOiA2LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjogNywgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDExLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjogMTIsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IjogMTMsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiOiAxNCwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjogMTUgfV0sIDk2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBvID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIpLAogICAgICAgICAgcCA9IG4oZCksCiAgICAgICAgICBiID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2dldCIpLAogICAgICAgICAgaCA9IG4oYiksCiAgICAgICAgICB2ID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIiksCiAgICAgICAgICB5ID0gbih2KSwKICAgICAgICAgIF8gPSBlKCIuL0RhdGFPYmplY3QiKSwKICAgICAgICAgIGcgPSBuKF8pLAogICAgICAgICAgbSA9IGUoIi4uL3V0aWxzL3V0aWxzLmpzIiksCiAgICAgICAgICBqID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBmdW5jdGlvbiB0KGUsIHIsIG4sIG8sIGksIHMpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIHQpO3ZhciBjID0gKDAsIHBbImRlZmF1bHQiXSkodGhpcywgKDAsIGFbImRlZmF1bHQiXSkodCkuY2FsbCh0aGlzLCBlLCByLCBuLCBvLCBpLCBzKSksCiAgICAgICAgICAgICAgbCA9IGM7cmV0dXJuIGwuX3N1YnNjcmlwdGlvbnMgPSB7fSwgbC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItIiArIHIgKyAiLVNFTkQ6ICIsIGUpLCBsLl9vbkNoYW5nZShlKTsKICAgICAgICAgIH0pLCBsLl9hbGxvY2F0ZUxpc3RlbmVycygpLCBjOwogICAgICAgIH1yZXR1cm4gKDAsIHlbImRlZmF1bHQiXSkodCwgZSksICgwLCBmWyJkZWZhdWx0Il0pKHQsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgKDAsIGhbImRlZmF1bHQiXSkoKDAsIGFbImRlZmF1bHQiXSkodC5wcm90b3R5cGUpLCAiX2FsbG9jYXRlTGlzdGVuZXJzIiwgdGhpcykuY2FsbCh0aGlzKTt2YXIgZSA9IHRoaXM7ZS5fcmVzcG9uc2VMaXN0ZW5lciA9IGUuX2J1cy5hZGRMaXN0ZW5lcihlLl91cmwsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgInJlc3BvbnNlIiA9PT0gdC50eXBlICYmIGUuX29uUmVzcG9uc2UodCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICAoMCwgaFsiZGVmYXVsdCJdKSgoMCwgYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksICJfcmVsZWFzZUxpc3RlbmVycyIsIHRoaXMpLmNhbGwodGhpcyk7dmFyIGUgPSB0aGlzO2UuX3Jlc3BvbnNlTGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiaW52aXRlT2JzZXJ2ZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHsgdHlwZTogImNyZWF0ZSIsIGZyb206IHQuX3N5bmNoZXIuX293bmVyLCB0bzogdC5fc3luY2hlci5fc3ViVVJMLCBib2R5OiB7IHJlc291cmNlOiB0Ll91cmwsIHNjaGVtYTogdC5fc2NoZW1hLCB2YWx1ZTogdC5fc3luY09iai5kYXRhLCBhdXRob3Jpc2U6IGUgfSB9O3QuX2J1cy5wb3N0TWVzc2FnZShyKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkZWxldGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpcywKICAgICAgICAgICAgICAgIHQgPSB7IHR5cGU6ICJkZWxldGUiLCBmcm9tOiBlLl9vd25lciwgdG86IGUuX3N5bmNoZXIuX3N1YlVSTCwgYm9keTogeyByZXNvdXJjZTogZS5fdXJsIH0gfTtlLl9idXMucG9zdE1lc3NhZ2UodCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YU9iamVjdFJlcG9ydGVyLURFTEVURTogIiwgdCksIDIwMCA9PT0gdC5ib2R5LmNvZGUgJiYgKGUuX3JlbGVhc2VMaXN0ZW5lcnMoKSwgZGVsZXRlIGUuX3N5bmNoZXIuX3JlcG9ydGVyc1tlLl91cmxdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAib25TdWJzY3JpcHRpb24iLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIm9uUmVzcG9uc2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGU7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uRm9yd2FyZCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcztzd2l0Y2ggKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItUkNWOiAiLCBlKSwgZS5ib2R5LnR5cGUpIHtjYXNlICJzdWJzY3JpYmUiOgogICAgICAgICAgICAgICAgdC5fb25TdWJzY3JpYmUoZSk7YnJlYWs7Y2FzZSAidW5zdWJzY3JpYmUiOgogICAgICAgICAgICAgICAgdC5fb25VblN1YnNjcmliZShlKTt9CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uU3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IGUuYm9keS5mcm9tLAogICAgICAgICAgICAgICAgbiA9IHsgdHlwZTogZS5ib2R5LnR5cGUsIHVybDogciwgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHsgdXJsOiByLCBzdGF0dXM6ICJvbiIgfTt0Ll9zdWJzY3JpcHRpb25zW3JdID0gbjt2YXIgbyA9IHt9O3JldHVybiAoMCwgaVsiZGVmYXVsdCJdKSh0Ll9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgdmFyIHIgPSB0Ll9jaGlsZHJlbk9iamVjdHNbZV0uZGF0YTtvW2VdID0gKDAsIG0uZGVlcENsb25lKShyKTsKICAgICAgICAgICAgICAgIH0pLCB0Ll9idXMucG9zdE1lc3NhZ2UoeyBpZDogZS5pZCwgdHlwZTogInJlc3BvbnNlIiwgZnJvbTogZS50bywgdG86IGUuZnJvbSwgYm9keTogeyBjb2RlOiAyMDAsIHNjaGVtYTogdC5fc2NoZW1hLCB2ZXJzaW9uOiB0Ll92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgbS5kZWVwQ2xvbmUpKHQuZGF0YSksIGNoaWxkcmVuczogbyB9IH0gfSksIG47CiAgICAgICAgICAgICAgfSwgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocikgewogICAgICAgICAgICAgICAgdC5fYnVzLnBvc3RNZXNzYWdlKHsgaWQ6IGUuaWQsIHR5cGU6ICJyZXNwb25zZSIsIGZyb206IGUudG8sIHRvOiBlLmZyb20sIGJvZHk6IHsgY29kZTogNDAzLCBkZXNjOiByIH0gfSk7CiAgICAgICAgICAgICAgfSB9O3QuX29uU3Vic2NyaXB0aW9uSGFuZGxlciAmJiAoY29uc29sZS5sb2coIlNVQlNDUklQVElPTi1FVkVOVDogIiwgbiksIHQuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihuKSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uVW5TdWJzY3JpYmUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5ib2R5LmZyb20sCiAgICAgICAgICAgICAgICBuID0gdC5fc3Vic2NyaXB0aW9uc1tyXTtkZWxldGUgdC5fc3Vic2NyaXB0aW9uc1tyXTt2YXIgbyA9IHsgdHlwZTogZS5ib2R5LnR5cGUsIHVybDogciwgb2JqZWN0OiBuIH07dC5fb25TdWJzY3JpcHRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAiLCBvKSwgdC5fb25TdWJzY3JpcHRpb25IYW5kbGVyKG8pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZXNwb25zZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcywKICAgICAgICAgICAgICAgIHIgPSB7IHR5cGU6IGUudHlwZSwgdXJsOiBlLmZyb20sIGNvZGU6IGUuYm9keS5jb2RlIH07dC5fb25SZXNwb25zZUhhbmRsZXIgJiYgKGNvbnNvbGUubG9nKCJSRVNQT05TRS1FVkVOVDogIiwgciksIHQuX29uUmVzcG9uc2VIYW5kbGVyKHIpKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzdWJzY3JpcHRpb25zIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgICAgICAgfSB9XSksIHQ7CiAgICAgIH0oZ1siZGVmYXVsdCJdKTtyWyJkZWZhdWx0Il0gPSBqLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuLi91dGlscy91dGlscy5qcyI6IDEwMCwgIi4vRGF0YU9iamVjdCI6IDkzLCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjogNiwgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cyI6IDcsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOiAxMSwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI6IDEyLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2dldCI6IDEzLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIjogMTQsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI6IDE1IH1dLCA5NzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZSh0LCByLCBuLCBvKSB7CiAgICAgICAgICAoMCwgaVsiZGVmYXVsdCJdKSh0aGlzLCBlKTt2YXIgcyA9IHRoaXM7cy5fb3duZXIgPSB0LCBzLl91cmwgPSByLCBzLl9idXMgPSBuLCBzLl9jaGlsZHJlbiA9IG8sIHMuX2NoYW5nZXMgPSBbXSwgcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX2xpc3RlbmVyID0gZS5fYnVzLmFkZExpc3RlbmVyKGUuX3VybCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YVByb3Zpc2lvbmFsLSIgKyBlLl91cmwgKyAiLVJDVjogIiwgdCksIGUuX2NoYW5nZXMucHVzaCh0KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX3JlbGVhc2VMaXN0ZW5lcnMiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpcztlLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJhcHBseSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpczt0Ll9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlLl9jaGFuZ2VPYmplY3QoZS5fc3luY09iaiwgdCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogImNoaWxkcmVuIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gYywgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSksIHIuT2JqZWN0VHlwZSA9IHIuQ2hhbmdlVHlwZSA9IHZvaWQgMDt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cyIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIHUgPSBuKGMpLAogICAgICAgICAgbCA9IGUoIi4uL3V0aWxzL3V0aWxzLmpzIiksCiAgICAgICAgICBmID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCkgewogICAgICAgICAgKDAsIGFbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIHIgPSB0aGlzO3IuX29ic2VydmVycyA9IFtdLCByLl9maWx0ZXJzID0ge30sIHQgPyByLl9kYXRhID0gKDAsIGwuZGVlcENsb25lKSh0KSA6IHIuX2RhdGEgPSB7fSwgci5faW50ZXJuYWxPYnNlcnZlKG5ldyBkKCksIHIuX2RhdGEpOwogICAgICAgIH1yZXR1cm4gKDAsIHVbImRlZmF1bHQiXSkoZSwgW3sga2V5OiAib2JzZXJ2ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHRoaXMuX29ic2VydmVycy5wdXNoKGUpOwogICAgICAgICAgfSB9LCB7IGtleTogImZpbmQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IGUuc3BsaXQoIi4iKTtyZXR1cm4gdGhpcy5fZmluZFdpdGhTcGxpdCh0KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJmaW5kQmVmb3JlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB7fSwKICAgICAgICAgICAgICAgIHIgPSBlLnNwbGl0KCIuIik7cmV0dXJuIHQubGFzdCA9IHIucG9wKCksIHQub2JqID0gdGhpcy5fZmluZFdpdGhTcGxpdChyKSwgdDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfZmluZFdpdGhTcGxpdCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcy5fZGF0YTtyZXR1cm4gZS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgdCA9IHRbZV07CiAgICAgICAgICAgIH0pLCB0OwogICAgICAgICAgfSB9LCB7IGtleTogIl9maXJlRXZlbnQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vYnNlcnZlcnMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHQoZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9pc09ic2VydmFibGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICByZXR1cm4gZS5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0IHx8IGUuY29uc3RydWN0b3IgPT09IEFycmF5OwogICAgICAgICAgfSB9LCB7IGtleTogIl9pbnRlcm5hbE9ic2VydmUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7aWYgKHIuX2lzT2JzZXJ2YWJsZSh0KSkgewogICAgICAgICAgICAgIHZhciBuID0gZnVuY3Rpb24gbih0KSB7CiAgICAgICAgICAgICAgICByLl9vbkNoYW5nZXMoZSwgdCk7CiAgICAgICAgICAgICAgfTtpZiAodC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgICAgICAgICBPYmplY3Qub2JzZXJ2ZSh0LCBuKTtmb3IgKHZhciBvIGluIHQpIHsKICAgICAgICAgICAgICAgICAgci5faXNPYnNlcnZhYmxlKHRbb10pICYmIHIuX2ludGVybmFsT2JzZXJ2ZShlWyJuZXciXShvKSwgdFtvXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgICAgICAgICAgQXJyYXkub2JzZXJ2ZSh0LCBuKTtmb3IgKHZhciBpIGluIHQpIHsKICAgICAgICAgICAgICAgICAgaWYgKHIuX2lzT2JzZXJ2YWJsZSh0W2ldKSkgewogICAgICAgICAgICAgICAgICAgIHZhciBzID0gZVsibmV3Il0obmV3IHAodFtpXSwgaSkpO3IuX2ludGVybmFsT2JzZXJ2ZShzLCB0W2ldKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoYW5nZXMiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7Zm9yICh2YXIgbiBpbiB0KSB7CiAgICAgICAgICAgICAgdmFyIG8gPSB0W25dLm9iamVjdCwKICAgICAgICAgICAgICAgICAgaSA9IHZvaWQgMDtpZiAoby5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0ICYmIChpID0gaC5PQkpFQ1QpLCBvLmNvbnN0cnVjdG9yID09PSBBcnJheSAmJiAoaSA9IGguQVJSQVkpLCAic3BsaWNlIiA9PT0gdFtuXS50eXBlKSAhZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIHMgPSB0W25dLmluZGV4LAogICAgICAgICAgICAgICAgICAgIGEgPSBlWyJuZXciXSgiIiArIHMpLAogICAgICAgICAgICAgICAgICAgIGMgPSBhLnRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICAgICAgdSA9IHRbbl0ucmVtb3ZlZC5sZW5ndGg7aWYgKDAgIT09IHUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGYgPSB0W25dLnJlbW92ZWQ7Zi5mb3JFYWNoKGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgICAgICAgci5faXNPYnNlcnZhYmxlKHQpICYmIGUucmVtb3ZlSW5kZXgocyArIG4pOwogICAgICAgICAgICAgICAgICB9KSwgci5fZmlyZUV2ZW50KHsgY1R5cGU6IGIuUkVNT1ZFLCBvVHlwZTogaSwgZmllbGQ6IGMsIGRhdGE6IHUgfSk7CiAgICAgICAgICAgICAgICB9dmFyIGQgPSB0W25dLmFkZGVkQ291bnQ7aWYgKDAgIT09IGQpIHsKICAgICAgICAgICAgICAgICAgdmFyIGggPSBvLnNsaWNlKHMsIHMgKyBkKTtoLmZvckVhY2goZnVuY3Rpb24gKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoci5faXNPYnNlcnZhYmxlKHQpKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IGVbIm5ldyJdKG5ldyBwKHQsIHMgKyBuKSk7ci5faW50ZXJuYWxPYnNlcnZlKG8sIHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSksIHIuX2ZpcmVFdmVudCh7IGNUeXBlOiBiLkFERCwgb1R5cGU6IGksIGZpZWxkOiBjLCBkYXRhOiAoMCwgbC5kZWVwQ2xvbmUpKGgpIH0pOwogICAgICAgICAgICAgICAgfXMgIT09IG8ubGVuZ3RoIC0gMSAmJiBlLnJlSW5kZXhGcm9tKG8pOwogICAgICAgICAgICAgIH0oKTtlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBzID0gZVsibmV3Il0odFtuXS5uYW1lKSwKICAgICAgICAgICAgICAgICAgICBhID0gcy50b1N0cmluZygpO2lmICgtMSAhPT0gYS5pbmRleE9mKCJTeW1ib2wiKSkgY29udGludWU7dmFyIGMgPSBvW3Rbbl0ubmFtZV07InVwZGF0ZSIgPT09IHRbbl0udHlwZSAmJiB0aGlzLl9maXJlRXZlbnQoeyBjVHlwZTogYi5VUERBVEUsIG9UeXBlOiBpLCBmaWVsZDogYSwgZGF0YTogKDAsIGwuZGVlcENsb25lKShjKSB9KSwgImFkZCIgPT09IHRbbl0udHlwZSAmJiAodGhpcy5faW50ZXJuYWxPYnNlcnZlKHMsIGMpLCB0aGlzLl9maXJlRXZlbnQoeyBjVHlwZTogYi5BREQsIG9UeXBlOiBpLCBmaWVsZDogYSwgZGF0YTogKDAsIGwuZGVlcENsb25lKShjKSB9KSksICJkZWxldGUiID09PSB0W25dLnR5cGUgJiYgdGhpcy5fZmlyZUV2ZW50KHsgY1R5cGU6IGIuUkVNT1ZFLCBvVHlwZTogaSwgZmllbGQ6IGEgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IH0sIHsga2V5OiAiZGF0YSIsIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCksCiAgICAgICAgICBkID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUoKSB7CiAgICAgICAgICAoMCwgYVsiZGVmYXVsdCJdKSh0aGlzLCBlKSwgdGhpcy5fcGF0aCA9IFtdLCB0aGlzLl9vYnNlcnZhYmxlcyA9IHt9OwogICAgICAgIH1yZXR1cm4gKDAsIHVbImRlZmF1bHQiXSkoZSwgW3sga2V5OiAicmVtb3ZlSW5kZXgiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICBkZWxldGUgdGhpcy5fb2JzZXJ2YWJsZXNbZV07CiAgICAgICAgICB9IH0sIHsga2V5OiAicmVJbmRleEZyb20iLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXM7KDAsIGlbImRlZmF1bHQiXSkodGhpcy5fb2JzZXJ2YWJsZXMpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHQuX29ic2VydmFibGVzW3JdLAogICAgICAgICAgICAgICAgICBvID0gZS5pbmRleE9mKG4ub2JqKTtuLmlkeCAhPSBvICYmIChuLmlkeCA9IG8sIGRlbGV0ZSB0Ll9vYnNlcnZhYmxlc1tyXSwgdC5fb2JzZXJ2YWJsZXNbb10gPSBuKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAibmV3IiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgZS5jb25zdHJ1Y3RvciA9PSBwICYmICh0aGlzLl9vYnNlcnZhYmxlc1tlLmlkeF0gPSBlKTt2YXIgdCA9IHRoaXMuY2xvbmUoKTtyZXR1cm4gdC5fcGF0aC5wdXNoKGUpLCB0OwogICAgICAgICAgfSB9LCB7IGtleTogImNsb25lIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgdCA9IG5ldyBlKCk7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHQuX3BhdGgucHVzaChlKTsKICAgICAgICAgICAgfSksIHQ7CiAgICAgICAgICB9IH0sIHsga2V5OiAidG9TdHJpbmciLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gIiI7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbiAodCwgcikgewogICAgICAgICAgICAgIDAgPT09IHIgPyBlID0gdC50b1N0cmluZygpIDogZSArPSAiLiIgKyB0LnRvU3RyaW5nKCk7CiAgICAgICAgICAgIH0pLCBlOwogICAgICAgICAgfSB9XSksIGU7CiAgICAgIH0oKSwKICAgICAgICAgIHAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZSh0LCByKSB7CiAgICAgICAgICAoMCwgYVsiZGVmYXVsdCJdKSh0aGlzLCBlKSwgdGhpcy5vYmogPSB0LCB0aGlzLmlkeCA9IHI7CiAgICAgICAgfXJldHVybiAoMCwgdVsiZGVmYXVsdCJdKShlLCBbeyBrZXk6ICJ0b1N0cmluZyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuaWR4LnRvU3RyaW5nKCk7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpLAogICAgICAgICAgYiA9IHIuQ2hhbmdlVHlwZSA9IHsgVVBEQVRFOiAidXBkYXRlIiwgQUREOiAiYWRkIiwgUkVNT1ZFOiAicmVtb3ZlIiB9LAogICAgICAgICAgaCA9IHIuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAib2JqZWN0IiwgQVJSQVk6ICJhcnJheSIgfTtyWyJkZWZhdWx0Il0gPSBmOwogICAgfSwgeyAiLi4vdXRpbHMvdXRpbHMuanMiOiAxMDAsICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiOiA3LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIHUgPSBuKGMpLAogICAgICAgICAgbCA9IGUoIi4vRGF0YU9iamVjdFJlcG9ydGVyIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCIuL0RhdGFPYmplY3RPYnNlcnZlciIpLAogICAgICAgICAgcCA9IG4oZCksCiAgICAgICAgICBiID0gZSgiLi9EYXRhUHJvdmlzaW9uYWwiKSwKICAgICAgICAgIGggPSBuKGIpLAogICAgICAgICAgdiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiBlKHQsIHIsIG4pIHsKICAgICAgICAgICgwLCBhWyJkZWZhdWx0Il0pKHRoaXMsIGUpO3ZhciBvID0gdGhpcztvLl9vd25lciA9IHQsIG8uX2J1cyA9IHIsIG8uX3N1YlVSTCA9IG4ucnVudGltZVVSTCArICIvc20iLCBvLl9yZXBvcnRlcnMgPSB7fSwgby5fb2JzZXJ2ZXJzID0ge30sIG8uX3Byb3Zpc2lvbmFscyA9IHt9LCByLmFkZExpc3RlbmVyKHQsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmIChlLmZyb20gIT09IHQpIHN3aXRjaCAoY29uc29sZS5sb2coIlN5bmNoZXItUkNWOiAiLCBlKSwgZS50eXBlKSB7Y2FzZSAiZm9yd2FyZCI6CiAgICAgICAgICAgICAgICBvLl9vbkZvcndhcmQoZSk7YnJlYWs7Y2FzZSAiY3JlYXRlIjoKICAgICAgICAgICAgICAgIG8uX29uUmVtb3RlQ3JlYXRlKGUpO2JyZWFrO2Nhc2UgImRlbGV0ZSI6CiAgICAgICAgICAgICAgICBvLl9vblJlbW90ZURlbGV0ZShlKTt9CiAgICAgICAgICB9KTsKICAgICAgICB9cmV0dXJuICgwLCB1WyJkZWZhdWx0Il0pKGUsIFt7IGtleTogImNyZWF0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0LCByKSB7CiAgICAgICAgICAgIHZhciBuID0gdGhpcztyLnJlcG9ydGVyID0gbi5fb3duZXIsIHIuc2NoZW1hID0gZTt2YXIgbyA9IHsgdHlwZTogImNyZWF0ZSIsIGZyb206IG4uX293bmVyLCB0bzogbi5fc3ViVVJMLCBib2R5OiB7IHNjaGVtYTogZSwgdmFsdWU6IHIsIGF1dGhvcmlzZTogdCB9IH07cmV0dXJuIG5ldyBpWyJkZWZhdWx0Il0oZnVuY3Rpb24gKHQsIGkpIHsKICAgICAgICAgICAgICBuLl9idXMucG9zdE1lc3NhZ2UobywgZnVuY3Rpb24gKG8pIHsKICAgICAgICAgICAgICAgIGlmIChjb25zb2xlLmxvZygiY3JlYXRlLXJlc3BvbnNlOiAiLCBvKSwgMjAwID09PSBvLmJvZHkuY29kZSkgewogICAgICAgICAgICAgICAgICB2YXIgcyA9IG8uYm9keS5yZXNvdXJjZSwKICAgICAgICAgICAgICAgICAgICAgIGEgPSBuZXcgZlsiZGVmYXVsdCJdKG4sIHMsIGUsICJvbiIsIHIsIG8uYm9keS5jaGlsZHJlblJlc291cmNlcyk7bi5fcmVwb3J0ZXJzW3NdID0gYSwgdChhKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpKG8uYm9keS5kZXNjKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAic3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUsIHQpIHsKICAgICAgICAgICAgdmFyIHIgPSB0aGlzLAogICAgICAgICAgICAgICAgbiA9IHsgdHlwZTogInN1YnNjcmliZSIsIGZyb206IHIuX293bmVyLCB0bzogci5fc3ViVVJMLCBib2R5OiB7IHNjaGVtYTogZSwgcmVzb3VyY2U6IHQgfSB9O3JldHVybiBuZXcgaVsiZGVmYXVsdCJdKGZ1bmN0aW9uIChvLCBpKSB7CiAgICAgICAgICAgICAgci5fYnVzLnBvc3RNZXNzYWdlKG4sIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygic3Vic2NyaWJlLXJlc3BvbnNlOiAiLCBuKTt2YXIgcyA9IHIuX3Byb3Zpc2lvbmFsc1t0XTtpZiAoZGVsZXRlIHIuX3Byb3Zpc2lvbmFsc1t0XSwgcyAmJiBzLl9yZWxlYXNlTGlzdGVuZXJzKCksIG4uYm9keS5jb2RlIDwgMjAwKSBzID0gbmV3IGhbImRlZmF1bHQiXShyLl9vd25lciwgdCwgci5fYnVzLCBuLmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMpLCByLl9wcm92aXNpb25hbHNbdF0gPSBzO2Vsc2UgaWYgKDIwMCA9PT0gbi5ib2R5LmNvZGUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGEgPSBuZXcgcFsiZGVmYXVsdCJdKHIsIHQsIGUsICJvbiIsIG4uYm9keS52YWx1ZSwgcy5jaGlsZHJlbiwgbi5ib2R5LnZlcnNpb24pO3IuX29ic2VydmVyc1t0XSA9IGEsIG8oYSksIHMuYXBwbHkoYSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaShuLmJvZHkuZGVzYyk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIm9uTm90aWZpY2F0aW9uIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gZTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25Gb3J3YXJkIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHQuX3JlcG9ydGVyc1tlLmJvZHkudG9dO3IuX29uRm9yd2FyZChlKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZW1vdGVDcmVhdGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5mcm9tLnNsaWNlKDAsIC0xMyksCiAgICAgICAgICAgICAgICBuID0geyB0eXBlOiBlLnR5cGUsIGZyb206IGUuYm9keS5zb3VyY2UsIHVybDogciwgc2NoZW1hOiBlLmJvZHkuc2NoZW1hLCB2YWx1ZTogZS5ib2R5LnZhbHVlLCBpZGVudGl0eTogZS5ib2R5LmlkZW50aXR5LCBhY2s6IGZ1bmN0aW9uIGFjayhyKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IDIwMDtyICYmIChuID0gciksIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IG4gfSB9KTsKICAgICAgICAgICAgICB9IH07dC5fb25Ob3RpZmljYXRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLCBuKSwgdC5fb25Ob3RpZmljYXRpb25IYW5kbGVyKG4pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZW1vdGVEZWxldGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5ib2R5LnJlc291cmNlLAogICAgICAgICAgICAgICAgbiA9IHQuX29ic2VydmVyc1tyXTtpZiAobikgewogICAgICAgICAgICAgIHZhciBvID0geyB0eXBlOiBlLnR5cGUsIHVybDogciwgaWRlbnRpdHk6IGUuYm9keS5pZGVudGl0eSwgYWNrOiBmdW5jdGlvbiBhY2socikgewogICAgICAgICAgICAgICAgICB2YXIgbyA9IDIwMDtyICYmIChvID0gciksIDIwMCA9PT0gbyAmJiBuWyJkZWxldGUiXSgpLCB0Ll9idXMucG9zdE1lc3NhZ2UoeyBpZDogZS5pZCwgdHlwZTogInJlc3BvbnNlIiwgZnJvbTogZS50bywgdG86IGUuZnJvbSwgYm9keTogeyBjb2RlOiBvLCBzb3VyY2U6IHQuX293bmVyIH0gfSk7CiAgICAgICAgICAgICAgICB9IH07dC5fb25Ob3RpZmljYXRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLCBvKSwgdC5fb25Ob3RpZmljYXRpb25IYW5kbGVyKG8pKTsKICAgICAgICAgICAgfSBlbHNlIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiB0Ll9vd25lciB9IH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIm93bmVyIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJyZXBvcnRlcnMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlcG9ydGVyczsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvYnNlcnZlcnMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29ic2VydmVyczsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gdiwgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi9EYXRhT2JqZWN0T2JzZXJ2ZXIiOiA5NSwgIi4vRGF0YU9iamVjdFJlcG9ydGVyIjogOTYsICIuL0RhdGFQcm92aXNpb25hbCI6IDk3LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UiOiA5LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgMTAwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfWZ1bmN0aW9uIG8oZSkgewogICAgICAgIHZhciB0ID0gLyhbYS16QS1aLV0qKTpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fSkoWy1hLXpBLVowLTlAOiUuX1wrfiM9XC9dKikvZ2ksCiAgICAgICAgICAgIHIgPSAiJDEsJDIsJDMiLAogICAgICAgICAgICBuID0gZS5yZXBsYWNlKHQsIHIpLnNwbGl0KCIsIik7blswXSA9PT0gZSAmJiAoblswXSA9ICJodHRwcyIsIG5bMV0gPSBlKTt2YXIgbyA9IHsgdHlwZTogblswXSwgZG9tYWluOiBuWzFdLCBpZGVudGl0eTogblsyXSB9O3JldHVybiBvOwogICAgICB9ZnVuY3Rpb24gaShlKSB7CiAgICAgICAgcmV0dXJuIGUgPyBKU09OLnBhcnNlKCgwLCBhWyJkZWZhdWx0Il0pKGUpKSA6IHZvaWQgMDsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBzID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL2pzb24vc3RyaW5naWZ5IiksCiAgICAgICAgICBhID0gbihzKTtyLmRpdmlkZVVSTCA9IG8sIHIuZGVlcENsb25lID0gaTsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSI6IDIgfV0gfSwge30sIFs5Ml0pKDkyKTsKfSk7Cgp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKfSx7fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gYWN0aXZhdGU7Cgp2YXIgX0h5cGVydHlEaXNjb3ZlcnkgPSByZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9kaXN0L0h5cGVydHlEaXNjb3ZlcnknKTsKCnZhciBfSHlwZXJ0eURpc2NvdmVyeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9IeXBlcnR5RGlzY292ZXJ5KTsKCnZhciBfU3luY2hlciA9IHJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlcicpOwoKdmFyIF9FdmVudEVtaXR0ZXIyID0gcmVxdWlyZSgnLi91dGlscy9FdmVudEVtaXR0ZXIuanMnKTsKCnZhciBfRXZlbnRFbWl0dGVyMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0V2ZW50RW1pdHRlcjIpOwoKdmFyIF91dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMvdXRpbHMuanMnKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikgPyBjYWxsIDogc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgovLyBTZXJ2aWNlIEZyYW1ld29yawoKCi8vIFV0aWxzCgoKdmFyIHN0YXR1cyA9IHsKICBuYW1lOiAnc3RhdHVzJywKICBzdGF0dXM6ICdkaXNjb25uZWN0ZWQnCn07CgovKioKKiBIeXBlcnR5IFByZXNlbmNlOwoqIEBhdXRob3IgQXBpemVlIFtkZXZAYXBpemVlLmNvbV0KKiBAdmVyc2lvbiAwLjEuMAoqLwoKdmFyIFVzZXJTdGF0dXMgPSBmdW5jdGlvbiAoX0V2ZW50RW1pdHRlcikgewogIF9pbmhlcml0cyhVc2VyU3RhdHVzLCBfRXZlbnRFbWl0dGVyKTsKCiAgZnVuY3Rpb24gVXNlclN0YXR1cyhoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBVc2VyU3RhdHVzKTsKCiAgICBpZiAoIWh5cGVydHlVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIGh5cGVydHlVUkwgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgTWluaUJ1cyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghY29uZmlndXJhdGlvbikgdGhyb3cgbmV3IEVycm9yKCdUaGUgY29uZmlndXJhdGlvbiBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCiAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVXNlclN0YXR1cykuY2FsbCh0aGlzLCBoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pKTsKCiAgICB2YXIgZG9tYWluID0gKDAsIF91dGlscy5kaXZpZGVVUkwpKGh5cGVydHlVUkwpLmRvbWFpbjsKCiAgICBfdGhpcy5fc3luY2hlciA9IG5ldyBfU3luY2hlci5TeW5jaGVyKGh5cGVydHlVUkwsIGJ1cywgY29uZmlndXJhdGlvbik7CgogICAgX3RoaXMuX2h5cGVydHlEaXNjb3ZlcnkgPSBuZXcgX0h5cGVydHlEaXNjb3ZlcnkyLmRlZmF1bHQoaHlwZXJ0eVVSTCwgYnVzKTsKCiAgICBfdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovLycgKyBkb21haW4gKyAnLy53ZWxsLWtub3duL2RhdGFzY2hlbWFzL1VzZXJTdGF0dXNEYXRhU2NoZW1hJzsKCiAgICBfdGhpcy5faHlwZXJ0eVVSTCA9IGh5cGVydHlVUkw7CiAgICBfdGhpcy5fZG9tYWluID0gZG9tYWluOwoKICAgIF90aGlzLl9oZWFydGJlYXQgPSBbXTsKCiAgICBfdGhpcy5fc3luY2hlci5vbk5vdGlmaWNhdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uKGV2ZW50KTsKICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhVc2VyU3RhdHVzLCBbewogICAga2V5OiAnX29uTm90aWZpY2F0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Ob3RpZmljYXRpb24oZXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBjb25zb2xlLmluZm8oJ0V2ZW50IFJlY2VpdmVkOiAnLCBldmVudCk7CgogICAgICB0aGlzLnRyaWdnZXIoJ2ludml0YXRpb24nLCBldmVudC5pZGVudGl0eSk7CgogICAgICBldmVudC5hY2soKTsKCiAgICAgIC8vIFN1YnNjcmliZSBIZWxsbyBXb3JsZCBPYmplY3QKICAgICAgdGhpcy5fc3luY2hlci5zdWJzY3JpYmUodGhpcy5fb2JqZWN0RGVzY1VSTCwgZXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uIChzdGF0dXNPYmplY3RPYnNlcnZlcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0gU3RhdHVzIE9ic2VydmVyIHJlY2VpdmVkIC0tLS0tLS0tLScsIHN0YXR1c09iamVjdE9ic2VydmVyKTsKCiAgICAgICAgX3RoaXMyLnRyaWdnZXIoJ3N0YXR1c0NoYW5nZScsIHsKICAgICAgICAgIGlkZW50aXR5OiBldmVudC5pZGVudGl0eSwKICAgICAgICAgIHN0YXR1czogc3RhdHVzT2JqZWN0T2JzZXJ2ZXIuZGF0YS5zdGF0dXMKICAgICAgICB9KTsKCiAgICAgICAgc3RhdHVzT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjb25zb2xlLmluZm8oJ21lc3NhZ2UgcmVjZWl2ZWQ6JywgZXZlbnQpOwogICAgICAgICAgX3RoaXMyLnRyaWdnZXIoJ3N0YXR1c0NoYW5nZScsIHsKICAgICAgICAgICAgaWRlbnRpdHk6IGV2ZW50LmlkZW50aXR5LAogICAgICAgICAgICBzdGF0dXM6IHN0YXR1c09iamVjdE9ic2VydmVyLmRhdGEuc3RhdHVzCiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChzdGF0dXNPYmplY3RPYnNlcnZlci5kYXRhLnN0YXR1cyAhPT0gJ2Rpc2Nvbm5lY3RlZCcpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ2FkZCBoZWFydGJlYXQgY29udHJvbCBvbicsIGV2ZW50LmlkZW50aXR5KTsKICAgICAgICAgICAgaWYgKGV2ZW50LmlkZW50aXR5IGluIF90aGlzMi5faGVhcnRiZWF0KSB7CiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KF90aGlzMi5faGVhcnRiZWF0W2V2ZW50LmlkZW50aXR5XSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3RoaXMyLl9oZWFydGJlYXRbZXZlbnQuaWRlbnRpdHldID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXZlbnQuaWRlbnRpdHksICdoYXMgZGlzY29ubmVjdCcpOwogICAgICAgICAgICAgIF90aGlzMi50cmlnZ2VyKCdzdGF0dXNDaGFuZ2UnLCB7CiAgICAgICAgICAgICAgICBpZGVudGl0eTogZXZlbnQuaWRlbnRpdHksCiAgICAgICAgICAgICAgICBzdGF0dXM6ICdkaXNjb25uZWN0ZWQnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sIDEwMDAwKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgY29uc29sZS5sb2coZXZlbnQuaWRlbnRpdHkuZW1haWwsICdoYXMgc3Vic2NyaWJlIHRvIG15IHN0YXR1cyBkYXRhIG9iamVjdCwgc2VuZCBpbnZpdGUgdG8gbGlzdGVuIG1pbmUnKTsKICAgICAgICBfdGhpczIuX3N0YXR1c09iamVjdFJlcG9ydGVyLmludml0ZU9ic2VydmVycyhbZXZlbnQuZnJvbV0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihyZWFzb24pOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBjcmVhdGUgYSBuZXcgc3RhdHVzIG9iamVjdCBzeW5jaGVyCiAgICAgKiBAcGFyYW0gIHtVUkwuVXNlclVSTH0gcGFydGljaXBhbnRzIExpc3Qgb2YgVXNlciBhbGxvd2VkCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2NyZWF0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHBhcnRpY2lwYW50cykgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIHN0YXR1cy5zdGF0dXMgPSAnY29ubmVjdGVkJzsKICAgICAgICBzdGF0dXMub3duZXIgPSBfdGhpczMuX2h5cGVydHlVUkw7CiAgICAgICAgc3RhdHVzLm5hbWUgPSAncHJlc2VuY2UnOwoKICAgICAgICBjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIE1hcHBpbmcgUGFydGljcGFudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTsKICAgICAgICBfdGhpczMuX21hcHBpbmdVc2VyKHBhcnRpY2lwYW50cykudGhlbihmdW5jdGlvbiAoaHlwZXJ0aWVzKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMzLmNyZWF0ZVN5bmNoZXIoaHlwZXJ0aWVzLCBzdGF0dXMpOwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHN0YXR1c09iamVjdFJlcG9ydGVyKSB7CiAgICAgICAgICBfdGhpczMuX3N0YXR1c09iamVjdFJlcG9ydGVyID0gc3RhdHVzT2JqZWN0UmVwb3J0ZXI7CiAgICAgICAgICBzdGF0dXNPYmplY3RSZXBvcnRlci5vblN1YnNjcmlwdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLSBTdGF0dXMgUmVwb3J0ZXIgcmVjZWl2ZWQgc3Vic2NyaXB0aW9uIHJlcXVlc3QgLS0tLS0tLS0tJywgZXZlbnQpOwogICAgICAgICAgICBldmVudC5hY2NlcHQoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdjcmVhdGVTeW5jaGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVTeW5jaGVyKGh5cGVydGllcywgc3RhdHVzKSB7CiAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFN5bmNoZXIgQ3JlYXRlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nLCBoeXBlcnRpZXMsIHN0YXR1cyk7CiAgICAgIHJldHVybiB0aGlzLl9zeW5jaGVyLmNyZWF0ZSh0aGlzLl9vYmplY3REZXNjVVJMLCBoeXBlcnRpZXMsIHN0YXR1cyk7CiAgICB9CiAgfSwgewogICAga2V5OiAnam9pbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gam9pbihyZXNvdXJjZSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFN5bmNoZXIgc3Vic2NyaWJlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTsKCiAgICAgICAgX3RoaXM0Ll9zeW5jaGVyLnN1YnNjcmliZShfdGhpczQuX29iamVjdERlc2NVUkwsIHJlc291cmNlKS50aGVuKGZ1bmN0aW9uIChkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIGRhdGFPYmplY3RPYnNlcnZlcik7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgcmVqZWN0KHJlYXNvbik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ3NldFN0YXR1cycsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U3RhdHVzKG5ld1N0YXR1cykgewogICAgICBjb25zb2xlLmxvZygnY2hhbmdlIHN0YXR1cyB0bycsIG5ld1N0YXR1cyk7CiAgICAgIHRoaXMuX3N0YXR1c09iamVjdFJlcG9ydGVyLmRhdGEuc3RhdHVzID0gbmV3U3RhdHVzOwogICAgfQogIH0sIHsKICAgIGtleTogJ19tYXBwaW5nVXNlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX21hcHBpbmdVc2VyKHVzZXJMaXN0KSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gX21hcHBpbmdVc2VyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nLCB1c2VyTGlzdCk7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciBoeXBlcnRpZXMgPSBbXTsKICAgICAgICB2YXIgY291bnQgPSAwOwoKICAgICAgICBpZiAodXNlckxpc3QubGVuZ3RoID09PSAwKSByZWplY3QoaHlwZXJ0aWVzKTsKCiAgICAgICAgdmFyIHJlc3VsdFVzZXJzID0gZnVuY3Rpb24gcmVzdWx0VXNlcnMoKSB7CiAgICAgICAgICBpZiAoY291bnQgPT09IHVzZXJMaXN0Lmxlbmd0aCkgewogICAgICAgICAgICBjb25zb2xlLmluZm8oJ0hhdmUgJyArIGh5cGVydGllcy5sZW5ndGggKyAndXNlcnMgZm91bmQ7Jyk7CiAgICAgICAgICAgIHJlc29sdmUoaHlwZXJ0aWVzKTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB2YXIgYWN0aXZlVXNlcnMgPSBmdW5jdGlvbiBhY3RpdmVVc2Vycyh1c2VyKSB7CiAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgaHlwZXJ0aWVzLnB1c2godXNlci5oeXBlcnR5VVJMKTsKICAgICAgICAgIHJlc3VsdFVzZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIGluYWN0aXZlVXNlcnMgPSBmdW5jdGlvbiBpbmFjdGl2ZVVzZXJzKCkgewogICAgICAgICAgY291bnQrKzsKICAgICAgICAgIHJlc3VsdFVzZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgdXNlckxpc3QuZm9yRWFjaChmdW5jdGlvbiAodXNlcikgewogICAgICAgICAgY29uc29sZS5sb2codXNlcik7CiAgICAgICAgICBpZiAodXNlci5lbWFpbC5sZW5ndGgpIHsKICAgICAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gX21hcHBpbmdVc2VyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nLCB1c2VyTGlzdCk7CiAgICAgICAgICAgIHJldHVybiBfdGhpczUuX2h5cGVydHlEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5UGVyVXNlcih1c2VyLmVtYWlsLCB1c2VyLmRvbWFpbikudGhlbihhY3RpdmVVc2VycykuY2F0Y2goaW5hY3RpdmVVc2Vycyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFVzZXJTdGF0dXM7Cn0oX0V2ZW50RW1pdHRlcjMuZGVmYXVsdCk7CgpmdW5jdGlvbiBhY3RpdmF0ZShoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pIHsKCiAgcmV0dXJuIHsKICAgIG5hbWU6ICdVc2VyU3RhdHVzJywKICAgIGluc3RhbmNlOiBuZXcgVXNlclN0YXR1cyhoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pCiAgfTsKfQoKfSx7Ii4vdXRpbHMvRXZlbnRFbWl0dGVyLmpzIjo1LCIuL3V0aWxzL3V0aWxzLmpzIjo2LCJzZXJ2aWNlLWZyYW1ld29yay9kaXN0L0h5cGVydHlEaXNjb3ZlcnkiOjIsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlciI6M31dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovKioKICogRXZlbnRFbWl0dGVyCiAqIEFsbCBjbGFzc2VzIHdoaWNoIGV4dGVuZHMgdGhpcywgY2FuIGhhdmUgYWRkRXZlbnRMaXN0ZW5lciBhbmQgdHJpZ2dlciBldmVudHM7CiAqLwoKdmFyIEV2ZW50RW1pdHRlciA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRFbWl0dGVyKTsKICB9CgogIF9jcmVhdGVDbGFzcyhFdmVudEVtaXR0ZXIsIFt7CiAgICBrZXk6ICJhZGRFdmVudExpc3RlbmVyIiwKCgogICAgLyoqCiAgICAgKiBhZGRFdmVudExpc3RlbmVyIGxpc3RlbiBmb3IgYW4gZXZlbnRUeXBlCiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9ICAgICAgICAgZXZlbnRUeXBlIC0gbGlzdGVuaW5nIGZvciB0aGlzIHR5cGUgb2YgZXZlbnQKICAgICAqIEBwYXJhbSAge0Z1bmN0aW9ufSAgICAgICBjYiAgICAgICAgLSBjYWxsYmFjayBmdW5jdGlvbiB3aWxsIGJlIGV4ZWN1dGVkIHdoZW4gdGhlIGV2ZW50IGl0IGlzIGludm9rZWQKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBjYikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBfdGhpc1tldmVudFR5cGVdID0gY2I7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgdGhlIGV2ZW50VHlwZQogICAgICogQHBhcmFtICB7c3RyaW5nfSBldmVudFR5cGUgLSBldmVudCB3aWxsIGJlIGludm9rZWQKICAgICAqIEBwYXJhbSAge29iamVjdH0gcGFyYW1zIC0gcGFyYW1ldGVycyB3aWxsIGJlIHBhc3NlZCB0byB0aGUgYWRkRXZlbnRMaXN0ZW5lcgogICAgICovCgogIH0sIHsKICAgIGtleTogInRyaWdnZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRyaWdnZXIoZXZlbnRUeXBlLCBwYXJhbXMpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGlmIChfdGhpc1tldmVudFR5cGVdKSB7CiAgICAgICAgX3RoaXNbZXZlbnRUeXBlXShwYXJhbXMpOwogICAgICB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRXZlbnRFbWl0dGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBFdmVudEVtaXR0ZXI7Cgp9LHt9XSw2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChwcm9jZXNzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kZWVwQ2xvbmUgPSBkZWVwQ2xvbmU7CmV4cG9ydHMuZ2V0Q29uZmlnID0gZ2V0Q29uZmlnOwpleHBvcnRzLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYTsKZXhwb3J0cy5zZXJpYWxpemUgPSBzZXJpYWxpemU7CmV4cG9ydHMuZ2V0VGVtcGxhdGUgPSBnZXRUZW1wbGF0ZTsKLyoqCiAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKiovCgovLyBqc2hpbnQgYnJvd3Nlcjp0cnVlLCBqcXVlcnk6IHRydWUKLy8ganNoaW50IHZhcnN0bXQ6IHRydWUKLyogZ2xvYmFsIEhhbmRsZWJhcnMgKi8KCi8qKgogKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsCiAqIEBtb2R1bGUgdXRpbHMKICovCgovKioKICogQHR5cGVkZWYgZGl2aWRlVVJMCiAqIEB0eXBlIE9iamVjdAogKiBAcHJvcGVydHkge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG9mIFVSTAogKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTAogKi8KCi8qKgogKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICogQHBhcmFtICB7VVJMLlVSTH0gdXJsIC0gdXJsIGFkZHJlc3MKICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTAogKi8KZnVuY3Rpb24gZGl2aWRlVVJMKHVybCkgewoKICAvLyBsZXQgcmUgPSAvKFthLXpBLVotXSopPzpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKSooXC9bXC9cZFx3XC4tXSopKig/OltcP10pKiguKykqL2dpOwogIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogIHZhciBzdWJzdCA9ICckMSwkMiwkMyc7CiAgdmFyIHBhcnRzID0gdXJsLnJlcGxhY2UocmUsIHN1YnN0KS5zcGxpdCgnLCcpOwoKICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgaWYgKHBhcnRzWzBdID09PSB1cmwpIHsKICAgIHBhcnRzWzBdID0gJ2h0dHBzJzsKICAgIHBhcnRzWzFdID0gdXJsOwogIH0KCiAgdmFyIHJlc3VsdCA9IHsKICAgIHR5cGU6IHBhcnRzWzBdLAogICAgZG9tYWluOiBwYXJ0c1sxXSwKICAgIGlkZW50aXR5OiBwYXJ0c1syXQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQogKiBAcGFyYW0gIHtPYmplY3R9ICBvYmogLSBvYmplY3QgdG8gYmUgY2xvbmVkCiAqIEByZXR1cm4ge09iamVjdH0KICovCmZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHsKICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uCiAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7Cn0KCi8qKgogKiBHZXQgdGhlIGNvbmZpZ3VyYXRpb24gZnJvbSBhbiBqc29uIGZpbGU7CiAqIEBwYXJhbSAge0pTT05PYmplY3R9IGpzb25GaWxlCiAqIEByZXR1cm4ge29iamVjdH0KICovCmZ1bmN0aW9uIGdldENvbmZpZyhKU09OT2JqZWN0KSB7CiAgY29uc29sZS5sb2cocHJvY2Vzcy5lbnYuZW52aXJvbm1lbnQpOwogIHJldHVybiBKU09OT2JqZWN0W3Byb2Nlc3MuZW52LmVudmlyb25tZW50XTsKfQoKLyoqCiAqIEdldCBXZWJSVEMgQVBJIHJlc291cmNlcwogKiBAcGFyYW0gIHtPYmplY3R9ICAgICBvcHRpb25zIE9iamVjdCBjb250YWluaW5nIHRoZSBpbmZvcm1hdGlvbiB0aGF0IHJlc291cmNlcyB3aWxsIGJlIHVzZWQgKGNhbWVyYSwgbWljLCByZXNvbHV0aW9uLCBldGMpOwogKiBAcmV0dXJuIHtQcm9taXNlfQogKi8KZnVuY3Rpb24gZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKSB7CgogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24gKG1lZGlhU3RyZWFtKSB7CiAgICAgIHJlc29sdmUobWVkaWFTdHJlYW0pOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICByZWplY3QocmVhc29uKTsKICAgIH0pOwogIH0pOwp9CgpmdW5jdGlvbiBzZXJpYWxpemUoKSB7CgogICQuZm4uc2VyaWFsaXplT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIG8gPSB7fTsKICAgIHZhciBhID0gdGhpcy5zZXJpYWxpemVBcnJheSgpOwogICAgJC5lYWNoKGEsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKG9bdGhpcy5uYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKCFvW3RoaXMubmFtZV0ucHVzaCkgewogICAgICAgICAgb1t0aGlzLm5hbWVdID0gW29bdGhpcy5uYW1lXV07CiAgICAgICAgfQoKICAgICAgICBvW3RoaXMubmFtZV0ucHVzaCh0aGlzLnZhbHVlIHx8ICcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvW3RoaXMubmFtZV0gPSB0aGlzLnZhbHVlIHx8ICcnOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gbzsKICB9OwoKICAkLmZuLnNlcmlhbGl6ZU9iamVjdEFycmF5ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIG8gPSB7fTsKICAgIHZhciBhID0gdGhpcy5zZXJpYWxpemVBcnJheSgpOwogICAgJC5lYWNoKGEsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKG9bdGhpcy5uYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKCFvW3RoaXMubmFtZV0ucHVzaCkgewogICAgICAgICAgb1t0aGlzLm5hbWVdID0gW29bdGhpcy5uYW1lXV07CiAgICAgICAgfQoKICAgICAgICBvW3RoaXMubmFtZV0ucHVzaCh0aGlzLnZhbHVlIHx8ICcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIW9bdGhpcy5uYW1lXSkgb1t0aGlzLm5hbWVdID0gW107CiAgICAgICAgb1t0aGlzLm5hbWVdLnB1c2godGhpcy52YWx1ZSB8fCAnJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBvOwogIH07Cn0KCmZ1bmN0aW9uIGdldFRlbXBsYXRlKHBhdGgsIHNjcmlwdCkgewoKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgIGlmIChIYW5kbGViYXJzLnRlbXBsYXRlcyA9PT0gdW5kZWZpbmVkIHx8IEhhbmRsZWJhcnMudGVtcGxhdGVzW25hbWVdID09PSB1bmRlZmluZWQpIHsKICAgICAgSGFuZGxlYmFycy50ZW1wbGF0ZXMgPSB7fTsKICAgIH0gZWxzZSB7CiAgICAgIHJlc29sdmUoSGFuZGxlYmFycy50ZW1wbGF0ZXNbbmFtZV0pOwogICAgfQoKICAgIHZhciB0ZW1wbGF0ZUZpbGUgPSAkLmFqYXgoewogICAgICB1cmw6IHBhdGggKyAnLmhicycsCiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSkgewogICAgICAgIEhhbmRsZWJhcnMudGVtcGxhdGVzW25hbWVdID0gSGFuZGxlYmFycy5jb21waWxlKGRhdGEpOwogICAgICB9LAoKICAgICAgZmFpbDogZnVuY3Rpb24gZmFpbChyZWFzb24pIHsKICAgICAgICByZXR1cm4gcmVhc29uOwogICAgICB9CiAgICB9KTsKCiAgICB2YXIgc2NyaXB0RmlsZSA9ICQuZ2V0U2NyaXB0KHNjcmlwdCk7CgogICAgdmFyIHJlcXVlc3RzID0gW107CiAgICBpZiAocGF0aCkgcmVxdWVzdHMucHVzaCh0ZW1wbGF0ZUZpbGUpOwogICAgaWYgKHNjcmlwdCkgcmVxdWVzdHMucHVzaChzY3JpcHRGaWxlKTsKCiAgICBQcm9taXNlLmFsbChyZXF1ZXN0cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgIHJlc29sdmUoSGFuZGxlYmFycy50ZW1wbGF0ZXNbbmFtZV0pOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICByZWplY3QocmVhc29uKTsKICAgIH0pOwogIH0pOwp9Cgp9KS5jYWxsKHRoaXMscmVxdWlyZSgnX3Byb2Nlc3MnKSkKfSx7Il9wcm9jZXNzIjoxfV19LHt9LFs0XSkoNCkKfSk7",
      "sourceCodeClassname": "UserStatusHyperty",
      "encoding": "base64",
      "signature": ""
    },
    "cguid": 1,
    "type": "Hyperties",
    "version": "0.1",
    "description": "Description of UserStatusHyperty",
    "objectName": "UserStatusHyperty",
    "configuration": {
      "url": "wss://msg-node.localhost:9090/ws"
    },
    "sourcePackageURL": "/sourcePackage",
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "dataObjects": [],
    "accessControlPolicy": "somePolicy"
  },
  "UserStatusHyperty": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCkuZGVmYXVsdH19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciK28rIiciKTt0aHJvdyBmLmNvZGU9Ik1PRFVMRV9OT1RfRk9VTkQiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09ImZ1bmN0aW9uIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgovLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXIKCnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTsKdmFyIHF1ZXVlID0gW107CnZhciBkcmFpbmluZyA9IGZhbHNlOwp2YXIgY3VycmVudFF1ZXVlOwp2YXIgcXVldWVJbmRleCA9IC0xOwoKZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkgewogICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgZHJhaW5pbmcgPSBmYWxzZTsKICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7CiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcXVldWVJbmRleCA9IC0xOwogICAgfQogICAgaWYgKHF1ZXVlLmxlbmd0aCkgewogICAgICAgIGRyYWluUXVldWUoKTsKICAgIH0KfQoKZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHsKICAgIGlmIChkcmFpbmluZykgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChjbGVhblVwTmV4dFRpY2spOwogICAgZHJhaW5pbmcgPSB0cnVlOwoKICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7CiAgICB3aGlsZSAobGVuKSB7CiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7CiAgICAgICAgcXVldWUgPSBbXTsKICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBxdWV1ZUluZGV4ID0gLTE7CiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoOwogICAgfQogICAgY3VycmVudFF1ZXVlID0gbnVsbDsKICAgIGRyYWluaW5nID0gZmFsc2U7CiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7Cn0KCnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7CiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHsKICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTsKICAgICAgICB9CiAgICB9CiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpOwogICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHsKICAgICAgICBzZXRUaW1lb3V0KGRyYWluUXVldWUsIDApOwogICAgfQp9OwoKLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0cwpmdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHsKICAgIHRoaXMuZnVuID0gZnVuOwogICAgdGhpcy5hcnJheSA9IGFycmF5Owp9Ckl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpOwp9Owpwcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInOwpwcm9jZXNzLmJyb3dzZXIgPSB0cnVlOwpwcm9jZXNzLmVudiA9IHt9Owpwcm9jZXNzLmFyZ3YgPSBbXTsKcHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzCnByb2Nlc3MudmVyc2lvbnMgPSB7fTsKCmZ1bmN0aW9uIG5vb3AoKSB7fQoKcHJvY2Vzcy5vbiA9IG5vb3A7CnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wOwpwcm9jZXNzLm9uY2UgPSBub29wOwpwcm9jZXNzLm9mZiA9IG5vb3A7CnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wOwpwcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7CnByb2Nlc3MuZW1pdCA9IG5vb3A7Cgpwcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkgewogICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpOwp9OwoKcHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gJy8nOwp9Owpwcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikgewogICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTsKfTsKcHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAwOwp9OwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CihmdW5jdGlvbiAoZ2xvYmFsKXsKInVzZSBzdHJpY3QiOwoKdmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovLyBEaXN0cmlidXRpb24gZmlsZSBmb3IgSHlwZXJ0eURpc2NvdmVyeS5qcwovLyB2ZXJzaW9uOiAwLjIuMAoKIWZ1bmN0aW9uIChlKSB7CiAgaWYgKCJvYmplY3QiID09ICh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpICYmICJ1bmRlZmluZWQiICE9IHR5cGVvZiBtb2R1bGUpIG1vZHVsZS5leHBvcnRzID0gZSgpO2Vsc2UgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoW10sIGUpO2Vsc2UgewogICAgdmFyIHQ7dCA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgZ2xvYmFsID8gZ2xvYmFsIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIHNlbGYgPyBzZWxmIDogdGhpcywgdC5IeXBlcnR5RGlzY292ZXJ5ID0gZSgpOwogIH0KfShmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIGUodCwgciwgbikgewogICAgZnVuY3Rpb24gbyhjLCBzKSB7CiAgICAgIGlmICghcltjXSkgewogICAgICAgIGlmICghdFtjXSkgewogICAgICAgICAgdmFyIHUgPSAiZnVuY3Rpb24iID09IHR5cGVvZiByZXF1aXJlICYmIHJlcXVpcmU7aWYgKCFzICYmIHUpIHJldHVybiB1KGMsICEwKTtpZiAoaSkgcmV0dXJuIGkoYywgITApO3ZhciBhID0gbmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIgKyBjICsgIiciKTt0aHJvdyBhLmNvZGUgPSAiTU9EVUxFX05PVF9GT1VORCIsIGE7CiAgICAgICAgfXZhciBmID0gcltjXSA9IHsgZXhwb3J0czoge30gfTt0W2NdWzBdLmNhbGwoZi5leHBvcnRzLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIHIgPSB0W2NdWzFdW2VdO3JldHVybiBvKHIgPyByIDogZSk7CiAgICAgICAgfSwgZiwgZi5leHBvcnRzLCBlLCB0LCByLCBuKTsKICAgICAgfXJldHVybiByW2NdLmV4cG9ydHM7CiAgICB9Zm9yICh2YXIgaSA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHJlcXVpcmUgJiYgcmVxdWlyZSwgYyA9IDA7IGMgPCBuLmxlbmd0aDsgYysrKSB7CiAgICAgIG8obltjXSk7CiAgICB9cmV0dXJuIG87CiAgfSh7IDE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL2pzb24vc3RyaW5naWZ5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vanNvbi9zdHJpbmdpZnkiOiA2IH1dLCAyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDcgfV0sIDM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL3Byb21pc2UiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlIjogOCB9XSwgNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgci5fX2VzTW9kdWxlID0gITAsIHJbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfTsKICAgIH0sIHt9XSwgNTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1yLl9fZXNNb2R1bGUgPSAhMDt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksCiAgICAgICAgICBpID0gbihvKTtyWyJkZWZhdWx0Il0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZShlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IHQubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgdmFyIG4gPSB0W3JdO24uZW51bWVyYWJsZSA9IG4uZW51bWVyYWJsZSB8fCAhMSwgbi5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiBuICYmIChuLndyaXRhYmxlID0gITApLCAoMCwgaVsiZGVmYXVsdCJdKShlLCBuLmtleSwgbik7CiAgICAgICAgICB9CiAgICAgICAgfXJldHVybiBmdW5jdGlvbiAodCwgciwgbikgewogICAgICAgICAgcmV0dXJuIHIgJiYgZSh0LnByb3RvdHlwZSwgciksIG4gJiYgZSh0LCBuKSwgdDsKICAgICAgICB9OwogICAgICB9KCk7CiAgICB9LCB7ICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDIgfV0sIDY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKSwKICAgICAgICAgIG8gPSBuLkpTT04gfHwgKG4uSlNPTiA9IHsgc3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeSB9KTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBvLnN0cmluZ2lmeS5hcHBseShvLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy9fY29yZSI6IDE2IH1dLCA3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSIpO3ZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy9fY29yZSIpLk9iamVjdDt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBuLmRlZmluZVByb3BlcnR5KGUsIHQsIHIpOwogICAgICB9OwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy9fY29yZSI6IDE2LCAiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSI6IDcxIH1dLCA4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgZSgiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyIpLCBlKCIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiKSwgZSgiLi4vbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlIiksIGUoIi4uL21vZHVsZXMvZXM2LnByb21pc2UiKSwgdC5leHBvcnRzID0gZSgiLi4vbW9kdWxlcy9fY29yZSIpLlByb21pc2U7CiAgICB9LCB7ICIuLi9tb2R1bGVzL19jb3JlIjogMTYsICIuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIjogNzIsICIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIjogNzMsICIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOiA3NCwgIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSI6IDc1IH1dLCA5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgZSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhIGZ1bmN0aW9uISIpO3JldHVybiBlOwogICAgICB9OwogICAgfSwge31dLCAxMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHt9OwogICAgfSwge31dLCAxMTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBuKSB7CiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIHQpIHx8IHZvaWQgMCAhPT0gbiAmJiBuIGluIGUpIHRocm93IFR5cGVFcnJvcihyICsgIjogaW5jb3JyZWN0IGludm9jYXRpb24hIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDEyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19pcy1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmICghbihlKSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhbiBvYmplY3QhIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7ICIuL19pcy1vYmplY3QiOiAzMyB9XSwgMTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX3RvLWlvYmplY3QiKSwKICAgICAgICAgIG8gPSBlKCIuL190by1sZW5ndGgiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1pbmRleCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0LCByLCBjKSB7CiAgICAgICAgICB2YXIgcywKICAgICAgICAgICAgICB1ID0gbih0KSwKICAgICAgICAgICAgICBhID0gbyh1Lmxlbmd0aCksCiAgICAgICAgICAgICAgZiA9IGkoYywgYSk7aWYgKGUgJiYgciAhPSByKSB7CiAgICAgICAgICAgIGZvciAoOyBhID4gZjspIHsKICAgICAgICAgICAgICBpZiAocyA9IHVbZisrXSwgcyAhPSBzKSByZXR1cm4gITA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBmb3IgKDsgYSA+IGY7IGYrKykgewogICAgICAgICAgICBpZiAoKGUgfHwgZiBpbiB1KSAmJiB1W2ZdID09PSByKSByZXR1cm4gZSB8fCBmIHx8IDA7CiAgICAgICAgICB9cmV0dXJuICFlICYmIC0xOwogICAgICAgIH07CiAgICAgIH07CiAgICB9LCB7ICIuL190by1pbmRleCI6IDYxLCAiLi9fdG8taW9iamVjdCI6IDYzLCAiLi9fdG8tbGVuZ3RoIjogNjQgfV0sIDE0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19jb2YiKSwKICAgICAgICAgIG8gPSBlKCIuL193a3MiKSgidG9TdHJpbmdUYWciKSwKICAgICAgICAgIGkgPSAiQXJndW1lbnRzIiA9PSBuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gYXJndW1lbnRzOwogICAgICB9KCkpLAogICAgICAgICAgYyA9IGZ1bmN0aW9uIGMoZSwgdCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gZVt0XTsKICAgICAgICB9IGNhdGNoIChyKSB7fQogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQsIHIsIHM7cmV0dXJuIHZvaWQgMCA9PT0gZSA/ICJVbmRlZmluZWQiIDogbnVsbCA9PT0gZSA/ICJOdWxsIiA6ICJzdHJpbmciID09IHR5cGVvZiAociA9IGModCA9IE9iamVjdChlKSwgbykpID8gciA6IGkgPyBuKHQpIDogIk9iamVjdCIgPT0gKHMgPSBuKHQpKSAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiB0LmNhbGxlZSA/ICJBcmd1bWVudHMiIDogczsKICAgICAgfTsKICAgIH0sIHsgIi4vX2NvZiI6IDE1LCAiLi9fd2tzIjogNjggfV0sIDE1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS50b1N0cmluZzt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSkuc2xpY2UoOCwgLTEpOwogICAgICB9OwogICAgfSwge31dLCAxNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0geyB2ZXJzaW9uOiAiMi40LjAiIH07Im51bWJlciIgPT0gdHlwZW9mIF9fZSAmJiAoX19lID0gbik7CiAgICB9LCB7fV0sIDE3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19hLWZ1bmN0aW9uIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICBpZiAobihlKSwgdm9pZCAwID09PSB0KSByZXR1cm4gZTtzd2l0Y2ggKHIpIHtjYXNlIDE6CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgIHJldHVybiBlLmNhbGwodCwgcik7CiAgICAgICAgICAgIH07Y2FzZSAyOgogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHIsIG4pIHsKICAgICAgICAgICAgICByZXR1cm4gZS5jYWxsKHQsIHIsIG4pOwogICAgICAgICAgICB9O2Nhc2UgMzoKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChyLCBuLCBvKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGUuY2FsbCh0LCByLCBuLCBvKTsKICAgICAgICAgICAgfTt9cmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBlLmFwcGx5KHQsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2EtZnVuY3Rpb24iOiA5IH1dLCAxODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKHZvaWQgMCA9PSBlKSB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNhbGwgbWV0aG9kIG9uICAiICsgZSk7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDE5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gIWUoIi4vX2ZhaWxzIikoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiA3ICE9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICAgIH0gfSkuYTsKICAgICAgfSk7CiAgICB9LCB7ICIuL19mYWlscyI6IDIzIH1dLCAyMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faXMtb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi9fZ2xvYmFsIikuZG9jdW1lbnQsCiAgICAgICAgICBpID0gbihvKSAmJiBuKG8uY3JlYXRlRWxlbWVudCk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gaSA/IG8uY3JlYXRlRWxlbWVudChlKSA6IHt9OwogICAgICB9OwogICAgfSwgeyAiLi9fZ2xvYmFsIjogMjUsICIuL19pcy1vYmplY3QiOiAzMyB9XSwgMjE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAiY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mIi5zcGxpdCgiLCIpOwogICAgfSwge31dLCAyMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fZ2xvYmFsIiksCiAgICAgICAgICBvID0gZSgiLi9fY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vX2N0eCIpLAogICAgICAgICAgYyA9IGUoIi4vX2hpZGUiKSwKICAgICAgICAgIHMgPSAicHJvdG90eXBlIiwKICAgICAgICAgIHUgPSBmdW5jdGlvbiB1KGUsIHQsIHIpIHsKICAgICAgICB2YXIgYSwKICAgICAgICAgICAgZiwKICAgICAgICAgICAgXywKICAgICAgICAgICAgbCA9IGUgJiB1LkYsCiAgICAgICAgICAgIGQgPSBlICYgdS5HLAogICAgICAgICAgICBwID0gZSAmIHUuUywKICAgICAgICAgICAgdiA9IGUgJiB1LlAsCiAgICAgICAgICAgIHkgPSBlICYgdS5CLAogICAgICAgICAgICBoID0gZSAmIHUuVywKICAgICAgICAgICAgYiA9IGQgPyBvIDogb1t0XSB8fCAob1t0XSA9IHt9KSwKICAgICAgICAgICAgbSA9IGJbc10sCiAgICAgICAgICAgIGcgPSBkID8gbiA6IHAgPyBuW3RdIDogKG5bdF0gfHwge30pW3NdO2QgJiYgKHIgPSB0KTtmb3IgKGEgaW4gcikgewogICAgICAgICAgZiA9ICFsICYmIGcgJiYgdm9pZCAwICE9PSBnW2FdLCBmICYmIGEgaW4gYiB8fCAoXyA9IGYgPyBnW2FdIDogclthXSwgYlthXSA9IGQgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgZ1thXSA/IHJbYV0gOiB5ICYmIGYgPyBpKF8sIG4pIDogaCAmJiBnW2FdID09IF8gPyBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgdCA9IGZ1bmN0aW9uIHQoX3QsIHIsIG4pIHsKICAgICAgICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIGUpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge2Nhc2UgMDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGUoKTtjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBlKF90KTtjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBlKF90LCByKTt9cmV0dXJuIG5ldyBlKF90LCByLCBuKTsKICAgICAgICAgICAgICB9cmV0dXJuIGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgfTtyZXR1cm4gdFtzXSA9IGVbc10sIHQ7CiAgICAgICAgICB9KF8pIDogdiAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBfID8gaShGdW5jdGlvbi5jYWxsLCBfKSA6IF8sIHYgJiYgKChiLnZpcnR1YWwgfHwgKGIudmlydHVhbCA9IHt9KSlbYV0gPSBfLCBlICYgdS5SICYmIG0gJiYgIW1bYV0gJiYgYyhtLCBhLCBfKSkpOwogICAgICAgIH0KICAgICAgfTt1LkYgPSAxLCB1LkcgPSAyLCB1LlMgPSA0LCB1LlAgPSA4LCB1LkIgPSAxNiwgdS5XID0gMzIsIHUuVSA9IDY0LCB1LlIgPSAxMjgsIHQuZXhwb3J0cyA9IHU7CiAgICB9LCB7ICIuL19jb3JlIjogMTYsICIuL19jdHgiOiAxNywgIi4vX2dsb2JhbCI6IDI1LCAiLi9faGlkZSI6IDI3IH1dLCAyMzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiAhIWUoKTsKICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICByZXR1cm4gITA7CiAgICAgICAgfQogICAgICB9OwogICAgfSwge31dLCAyNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fY3R4IiksCiAgICAgICAgICBvID0gZSgiLi9faXRlci1jYWxsIiksCiAgICAgICAgICBpID0gZSgiLi9faXMtYXJyYXktaXRlciIpLAogICAgICAgICAgYyA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgcyA9IGUoIi4vX3RvLWxlbmd0aCIpLAogICAgICAgICAgdSA9IGUoIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIiksCiAgICAgICAgICBhID0ge30sCiAgICAgICAgICBmID0ge30sCiAgICAgICAgICByID0gdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIsIF8sIGwpIHsKICAgICAgICB2YXIgZCwKICAgICAgICAgICAgcCwKICAgICAgICAgICAgdiwKICAgICAgICAgICAgeSwKICAgICAgICAgICAgaCA9IGwgPyBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZTsKICAgICAgICB9IDogdShlKSwKICAgICAgICAgICAgYiA9IG4ociwgXywgdCA/IDIgOiAxKSwKICAgICAgICAgICAgbSA9IDA7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGgpIHRocm93IFR5cGVFcnJvcihlICsgIiBpcyBub3QgaXRlcmFibGUhIik7aWYgKGkoaCkpIHsKICAgICAgICAgIGZvciAoZCA9IHMoZS5sZW5ndGgpOyBkID4gbTsgbSsrKSB7CiAgICAgICAgICAgIGlmICh5ID0gdCA/IGIoYyhwID0gZVttXSlbMF0sIHBbMV0pIDogYihlW21dKSwgeSA9PT0gYSB8fCB5ID09PSBmKSByZXR1cm4geTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgZm9yICh2ID0gaC5jYWxsKGUpOyAhKHAgPSB2Lm5leHQoKSkuZG9uZTspIHsKICAgICAgICAgIGlmICh5ID0gbyh2LCBiLCBwLnZhbHVlLCB0KSwgeSA9PT0gYSB8fCB5ID09PSBmKSByZXR1cm4geTsKICAgICAgICB9CiAgICAgIH07ci5CUkVBSyA9IGEsIHIuUkVUVVJOID0gZjsKICAgIH0sIHsgIi4vX2FuLW9iamVjdCI6IDEyLCAiLi9fY3R4IjogMTcsICIuL19pcy1hcnJheS1pdGVyIjogMzIsICIuL19pdGVyLWNhbGwiOiAzNCwgIi4vX3RvLWxlbmd0aCI6IDY0LCAiLi9jb3JlLmdldC1pdGVyYXRvci1tZXRob2QiOiA2OSB9XSwgMjU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IHQuZXhwb3J0cyA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93Lk1hdGggPT0gTWF0aCA/IHdpbmRvdyA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBzZWxmICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiA6IEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCk7Im51bWJlciIgPT0gdHlwZW9mIF9fZyAmJiAoX19nID0gbik7CiAgICB9LCB7fV0sIDI2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS5oYXNPd25Qcm9wZXJ0eTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7fV0sIDI3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19vYmplY3QtZHAiKSwKICAgICAgICAgIG8gPSBlKCIuL19wcm9wZXJ0eS1kZXNjIik7dC5leHBvcnRzID0gZSgiLi9fZGVzY3JpcHRvcnMiKSA/IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIG4uZihlLCB0LCBvKDEsIHIpKTsKICAgICAgfSA6IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIGVbdF0gPSByLCBlOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVzY3JpcHRvcnMiOiAxOSwgIi4vX29iamVjdC1kcCI6IDQzLCAiLi9fcHJvcGVydHktZGVzYyI6IDUwIH1dLCAyODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vX2dsb2JhbCIpLmRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgIH0sIHsgIi4vX2dsb2JhbCI6IDI1IH1dLCAyOTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9ICFlKCIuL19kZXNjcmlwdG9ycyIpICYmICFlKCIuL19mYWlscyIpKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gNyAhPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSgiLi9fZG9tLWNyZWF0ZSIpKCJkaXYiKSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICAgIH0gfSkuYTsKICAgICAgfSk7CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fZG9tLWNyZWF0ZSI6IDIwLCAiLi9fZmFpbHMiOiAyMyB9XSwgMzA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHZhciBuID0gdm9pZCAwID09PSByO3N3aXRjaCAodC5sZW5ndGgpIHtjYXNlIDA6CiAgICAgICAgICAgIHJldHVybiBuID8gZSgpIDogZS5jYWxsKHIpO2Nhc2UgMToKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0pIDogZS5jYWxsKHIsIHRbMF0pO2Nhc2UgMjoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0pO2Nhc2UgMzoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0sIHRbMl0pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0sIHRbMl0pO2Nhc2UgNDoKICAgICAgICAgICAgcmV0dXJuIG4gPyBlKHRbMF0sIHRbMV0sIHRbMl0sIHRbM10pIDogZS5jYWxsKHIsIHRbMF0sIHRbMV0sIHRbMl0sIHRbM10pO31yZXR1cm4gZS5hcHBseShyLCB0KTsKICAgICAgfTsKICAgIH0sIHt9XSwgMzE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2NvZiIpO3QuZXhwb3J0cyA9IE9iamVjdCgieiIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApID8gT2JqZWN0IDogZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIlN0cmluZyIgPT0gbihlKSA/IGUuc3BsaXQoIiIpIDogT2JqZWN0KGUpOwogICAgICB9OwogICAgfSwgeyAiLi9fY29mIjogMTUgfV0sIDMyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19pdGVyYXRvcnMiKSwKICAgICAgICAgIG8gPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIGkgPSBBcnJheS5wcm90b3R5cGU7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBlICYmIChuLkFycmF5ID09PSBlIHx8IGlbb10gPT09IGUpOwogICAgICB9OwogICAgfSwgeyAiLi9faXRlcmF0b3JzIjogMzksICIuL193a3MiOiA2OCB9XSwgMzM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAib2JqZWN0IiA9PSAodHlwZW9mIGUgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGUpKSA/IG51bGwgIT09IGUgOiAiZnVuY3Rpb24iID09IHR5cGVvZiBlOwogICAgICB9OwogICAgfSwge31dLCAzNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fYW4tb2JqZWN0Iik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIsIG8pIHsKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIG8gPyB0KG4ocilbMF0sIHJbMV0pIDogdChyKTsKICAgICAgICB9IGNhdGNoIChpKSB7CiAgICAgICAgICB2YXIgYyA9IGVbInJldHVybiJdO3Rocm93IHZvaWQgMCAhPT0gYyAmJiBuKGMuY2FsbChlKSksIGk7CiAgICAgICAgfQogICAgICB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIgfV0sIDM1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vX29iamVjdC1jcmVhdGUiKSwKICAgICAgICAgIG8gPSBlKCIuL19wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBpID0gZSgiLi9fc2V0LXRvLXN0cmluZy10YWciKSwKICAgICAgICAgIGMgPSB7fTtlKCIuL19oaWRlIikoYywgZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSksIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZS5wcm90b3R5cGUgPSBuKGMsIHsgbmV4dDogbygxLCByKSB9KSwgaShlLCB0ICsgIiBJdGVyYXRvciIpOwogICAgICB9OwogICAgfSwgeyAiLi9faGlkZSI6IDI3LCAiLi9fb2JqZWN0LWNyZWF0ZSI6IDQyLCAiLi9fcHJvcGVydHktZGVzYyI6IDUwLCAiLi9fc2V0LXRvLXN0cmluZy10YWciOiA1NSwgIi4vX3drcyI6IDY4IH1dLCAzNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4gPSBlKCIuL19saWJyYXJ5IiksCiAgICAgICAgICBvID0gZSgiLi9fZXhwb3J0IiksCiAgICAgICAgICBpID0gZSgiLi9fcmVkZWZpbmUiKSwKICAgICAgICAgIGMgPSBlKCIuL19oaWRlIiksCiAgICAgICAgICBzID0gZSgiLi9faGFzIiksCiAgICAgICAgICB1ID0gZSgiLi9faXRlcmF0b3JzIiksCiAgICAgICAgICBhID0gZSgiLi9faXRlci1jcmVhdGUiKSwKICAgICAgICAgIGYgPSBlKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpLAogICAgICAgICAgXyA9IGUoIi4vX29iamVjdC1ncG8iKSwKICAgICAgICAgIGwgPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIGQgPSAhKFtdLmtleXMgJiYgIm5leHQiIGluIFtdLmtleXMoKSksCiAgICAgICAgICBwID0gIkBAaXRlcmF0b3IiLAogICAgICAgICAgdiA9ICJrZXlzIiwKICAgICAgICAgIHkgPSAidmFsdWVzIiwKICAgICAgICAgIGggPSBmdW5jdGlvbiBoKCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBiLCBtLCBnLCBqKSB7CiAgICAgICAgYShyLCB0LCBiKTt2YXIgeCwKICAgICAgICAgICAgdywKICAgICAgICAgICAgaywKICAgICAgICAgICAgTyA9IGZ1bmN0aW9uIE8oZSkgewogICAgICAgICAgaWYgKCFkICYmIGUgaW4gRSkgcmV0dXJuIEVbZV07c3dpdGNoIChlKSB7Y2FzZSB2OgogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICAgICAgfTtjYXNlIHk6CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcih0aGlzLCBlKTsKICAgICAgICAgICAgICB9O31yZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgICAgIE0gPSB0ICsgIiBJdGVyYXRvciIsCiAgICAgICAgICAgIFAgPSBtID09IHksCiAgICAgICAgICAgIFMgPSAhMSwKICAgICAgICAgICAgRSA9IGUucHJvdG90eXBlLAogICAgICAgICAgICBUID0gRVtsXSB8fCBFW3BdIHx8IG0gJiYgRVttXSwKICAgICAgICAgICAgQSA9IFQgfHwgTyhtKSwKICAgICAgICAgICAgVSA9IG0gPyBQID8gTygiZW50cmllcyIpIDogQSA6IHZvaWQgMCwKICAgICAgICAgICAgQyA9ICJBcnJheSIgPT0gdCA/IEUuZW50cmllcyB8fCBUIDogVDtpZiAoQyAmJiAoayA9IF8oQy5jYWxsKG5ldyBlKCkpKSwgayAhPT0gT2JqZWN0LnByb3RvdHlwZSAmJiAoZihrLCBNLCAhMCksIG4gfHwgcyhrLCBsKSB8fCBjKGssIGwsIGgpKSksIFAgJiYgVCAmJiBULm5hbWUgIT09IHkgJiYgKFMgPSAhMCwgQSA9IGZ1bmN0aW9uIEEoKSB7CiAgICAgICAgICByZXR1cm4gVC5jYWxsKHRoaXMpOwogICAgICAgIH0pLCBuICYmICFqIHx8ICFkICYmICFTICYmIEVbbF0gfHwgYyhFLCBsLCBBKSwgdVt0XSA9IEEsIHVbTV0gPSBoLCBtKSBpZiAoeCA9IHsgdmFsdWVzOiBQID8gQSA6IE8oeSksIGtleXM6IGcgPyBBIDogTyh2KSwgZW50cmllczogVSB9LCBqKSBmb3IgKHcgaW4geCkgewogICAgICAgICAgdyBpbiBFIHx8IGkoRSwgdywgeFt3XSk7CiAgICAgICAgfSBlbHNlIG8oby5QICsgby5GICogKGQgfHwgUyksIHQsIHgpO3JldHVybiB4OwogICAgICB9OwogICAgfSwgeyAiLi9fZXhwb3J0IjogMjIsICIuL19oYXMiOiAyNiwgIi4vX2hpZGUiOiAyNywgIi4vX2l0ZXItY3JlYXRlIjogMzUsICIuL19pdGVyYXRvcnMiOiAzOSwgIi4vX2xpYnJhcnkiOiA0MCwgIi4vX29iamVjdC1ncG8iOiA0NiwgIi4vX3JlZGVmaW5lIjogNTIsICIuL19zZXQtdG8tc3RyaW5nLXRhZyI6IDU1LCAiLi9fd2tzIjogNjggfV0sIDM3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL193a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIG8gPSAhMTt0cnkgewogICAgICAgIHZhciBpID0gWzddW25dKCk7aVsicmV0dXJuIl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBvID0gITA7CiAgICAgICAgfSwgQXJyYXkuZnJvbShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aHJvdyAyOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChjKSB7fXQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCF0ICYmICFvKSByZXR1cm4gITE7dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgdmFyIGkgPSBbN10sCiAgICAgICAgICAgICAgYyA9IGlbbl0oKTtjLm5leHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB7IGRvbmU6IHIgPSAhMCB9OwogICAgICAgICAgfSwgaVtuXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGM7CiAgICAgICAgICB9LCBlKGkpOwogICAgICAgIH0gY2F0Y2ggKHMpIHt9cmV0dXJuIHI7CiAgICAgIH07CiAgICB9LCB7ICIuL193a3MiOiA2OCB9XSwgMzg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiB7IHZhbHVlOiB0LCBkb25lOiAhIWUgfTsKICAgICAgfTsKICAgIH0sIHt9XSwgMzk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7fTsKICAgIH0sIHt9XSwgNDA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAhMDsKICAgIH0sIHt9XSwgNDE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2dsb2JhbCIpLAogICAgICAgICAgbyA9IGUoIi4vX3Rhc2siKS5zZXQsCiAgICAgICAgICBpID0gbi5NdXRhdGlvbk9ic2VydmVyIHx8IG4uV2ViS2l0TXV0YXRpb25PYnNlcnZlciwKICAgICAgICAgIGMgPSBuLnByb2Nlc3MsCiAgICAgICAgICBzID0gbi5Qcm9taXNlLAogICAgICAgICAgdSA9ICJwcm9jZXNzIiA9PSBlKCIuL19jb2YiKShjKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUsCiAgICAgICAgICAgIHQsCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIGEgPSBmdW5jdGlvbiBhKCkgewogICAgICAgICAgdmFyIG4sIG87Zm9yICh1ICYmIChuID0gYy5kb21haW4pICYmIG4uZXhpdCgpOyBlOykgewogICAgICAgICAgICBvID0gZS5mbiwgZSA9IGUubmV4dDt0cnkgewogICAgICAgICAgICAgIG8oKTsKICAgICAgICAgICAgfSBjYXRjaCAoaSkgewogICAgICAgICAgICAgIHRocm93IGUgPyByKCkgOiB0ID0gdm9pZCAwLCBpOwogICAgICAgICAgICB9CiAgICAgICAgICB9dCA9IHZvaWQgMCwgbiAmJiBuLmVudGVyKCk7CiAgICAgICAgfTtpZiAodSkgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICBjLm5leHRUaWNrKGEpOwogICAgICAgIH07ZWxzZSBpZiAoaSkgewogICAgICAgICAgdmFyIGYgPSAhMCwKICAgICAgICAgICAgICBfID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpO25ldyBpKGEpLm9ic2VydmUoXywgeyBjaGFyYWN0ZXJEYXRhOiAhMCB9KSwgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICAgIF8uZGF0YSA9IGYgPSAhZjsKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIGlmIChzICYmIHMucmVzb2x2ZSkgewogICAgICAgICAgdmFyIGwgPSBzLnJlc29sdmUoKTtyID0gZnVuY3Rpb24gcigpIHsKICAgICAgICAgICAgbC50aGVuKGEpOwogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgciA9IGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICBvLmNhbGwobiwgYSk7CiAgICAgICAgfTtyZXR1cm4gZnVuY3Rpb24gKG4pIHsKICAgICAgICAgIHZhciBvID0geyBmbjogbiwgbmV4dDogdm9pZCAwIH07dCAmJiAodC5uZXh0ID0gbyksIGUgfHwgKGUgPSBvLCByKCkpLCB0ID0gbzsKICAgICAgICB9OwogICAgICB9OwogICAgfSwgeyAiLi9fY29mIjogMTUsICIuL19nbG9iYWwiOiAyNSwgIi4vX3Rhc2siOiA2MCB9XSwgNDI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX29iamVjdC1kcHMiKSwKICAgICAgICAgIGkgPSBlKCIuL19lbnVtLWJ1Zy1rZXlzIiksCiAgICAgICAgICBjID0gZSgiLi9fc2hhcmVkLWtleSIpKCJJRV9QUk9UTyIpLAogICAgICAgICAgcyA9IGZ1bmN0aW9uIHMoKSB7fSwKICAgICAgICAgIHUgPSAicHJvdG90eXBlIiwKICAgICAgICAgIF9hID0gZnVuY3Rpb24gYSgpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IGUoIi4vX2RvbS1jcmVhdGUiKSgiaWZyYW1lIiksCiAgICAgICAgICAgIG4gPSBpLmxlbmd0aCwKICAgICAgICAgICAgbyA9ICI+Ijtmb3IgKHIuc3R5bGUuZGlzcGxheSA9ICJub25lIiwgZSgiLi9faHRtbCIpLmFwcGVuZENoaWxkKHIpLCByLnNyYyA9ICJqYXZhc2NyaXB0OiIsIHQgPSByLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQsIHQub3BlbigpLCB0LndyaXRlKCI8c2NyaXB0PmRvY3VtZW50LkY9T2JqZWN0PC9zY3JpcHQiICsgbyksIHQuY2xvc2UoKSwgX2EgPSB0LkY7IG4tLTspIHsKICAgICAgICAgIGRlbGV0ZSBfYVt1XVtpW25dXTsKICAgICAgICB9cmV0dXJuIF9hKCk7CiAgICAgIH07dC5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHZhciByO3JldHVybiBudWxsICE9PSBlID8gKHNbdV0gPSBuKGUpLCByID0gbmV3IHMoKSwgc1t1XSA9IG51bGwsIHJbY10gPSBlKSA6IHIgPSBfYSgpLCB2b2lkIDAgPT09IHQgPyByIDogbyhyLCB0KTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2FuLW9iamVjdCI6IDEyLCAiLi9fZG9tLWNyZWF0ZSI6IDIwLCAiLi9fZW51bS1idWcta2V5cyI6IDIxLCAiLi9faHRtbCI6IDI4LCAiLi9fb2JqZWN0LWRwcyI6IDQ0LCAiLi9fc2hhcmVkLWtleSI6IDU2IH1dLCA0MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fYW4tb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi9faWU4LWRvbS1kZWZpbmUiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1wcmltaXRpdmUiKSwKICAgICAgICAgIGMgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7ci5mID0gZSgiLi9fZGVzY3JpcHRvcnMiKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgaWYgKG4oZSksIHQgPSBpKHQsICEwKSwgbihyKSwgbykgdHJ5IHsKICAgICAgICAgIHJldHVybiBjKGUsIHQsIHIpOwogICAgICAgIH0gY2F0Y2ggKHMpIHt9aWYgKCJnZXQiIGluIHIgfHwgInNldCIgaW4gcikgdGhyb3cgVHlwZUVycm9yKCJBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEiKTtyZXR1cm4gInZhbHVlIiBpbiByICYmIChlW3RdID0gci52YWx1ZSksIGU7CiAgICAgIH07CiAgICB9LCB7ICIuL19hbi1vYmplY3QiOiAxMiwgIi4vX2Rlc2NyaXB0b3JzIjogMTksICIuL19pZTgtZG9tLWRlZmluZSI6IDI5LCAiLi9fdG8tcHJpbWl0aXZlIjogNjYgfV0sIDQ0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19vYmplY3QtZHAiKSwKICAgICAgICAgIG8gPSBlKCIuL19hbi1vYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19vYmplY3Qta2V5cyIpO3QuZXhwb3J0cyA9IGUoIi4vX2Rlc2NyaXB0b3JzIikgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgbyhlKTtmb3IgKHZhciByLCBjID0gaSh0KSwgcyA9IGMubGVuZ3RoLCB1ID0gMDsgcyA+IHU7KSB7CiAgICAgICAgICBuLmYoZSwgciA9IGNbdSsrXSwgdFtyXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIsICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fb2JqZWN0LWRwIjogNDMsICIuL19vYmplY3Qta2V5cyI6IDQ4IH1dLCA0NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fb2JqZWN0LXBpZSIpLAogICAgICAgICAgbyA9IGUoIi4vX3Byb3BlcnR5LWRlc2MiKSwKICAgICAgICAgIGkgPSBlKCIuL190by1pb2JqZWN0IiksCiAgICAgICAgICBjID0gZSgiLi9fdG8tcHJpbWl0aXZlIiksCiAgICAgICAgICBzID0gZSgiLi9faGFzIiksCiAgICAgICAgICB1ID0gZSgiLi9faWU4LWRvbS1kZWZpbmUiKSwKICAgICAgICAgIGEgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO3IuZiA9IGUoIi4vX2Rlc2NyaXB0b3JzIikgPyBhIDogZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoZSA9IGkoZSksIHQgPSBjKHQsICEwKSwgdSkgdHJ5IHsKICAgICAgICAgIHJldHVybiBhKGUsIHQpOwogICAgICAgIH0gY2F0Y2ggKHIpIHt9cmV0dXJuIHMoZSwgdCkgPyBvKCFuLmYuY2FsbChlLCB0KSwgZVt0XSkgOiB2b2lkIDA7CiAgICAgIH07CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9faGFzIjogMjYsICIuL19pZTgtZG9tLWRlZmluZSI6IDI5LCAiLi9fb2JqZWN0LXBpZSI6IDQ5LCAiLi9fcHJvcGVydHktZGVzYyI6IDUwLCAiLi9fdG8taW9iamVjdCI6IDYzLCAiLi9fdG8tcHJpbWl0aXZlIjogNjYgfV0sIDQ2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19oYXMiKSwKICAgICAgICAgIG8gPSBlKCIuL190by1vYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIiksCiAgICAgICAgICBjID0gT2JqZWN0LnByb3RvdHlwZTt0LmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZSA9IG8oZSksIG4oZSwgaSkgPyBlW2ldIDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgZS5jb25zdHJ1Y3RvciAmJiBlIGluc3RhbmNlb2YgZS5jb25zdHJ1Y3RvciA/IGUuY29uc3RydWN0b3IucHJvdG90eXBlIDogZSBpbnN0YW5jZW9mIE9iamVjdCA/IGMgOiBudWxsOwogICAgICB9OwogICAgfSwgeyAiLi9faGFzIjogMjYsICIuL19zaGFyZWQta2V5IjogNTYsICIuL190by1vYmplY3QiOiA2NSB9XSwgNDc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2hhcyIpLAogICAgICAgICAgbyA9IGUoIi4vX3RvLWlvYmplY3QiKSwKICAgICAgICAgIGkgPSBlKCIuL19hcnJheS1pbmNsdWRlcyIpKCExKSwKICAgICAgICAgIGMgPSBlKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB2YXIgciwKICAgICAgICAgICAgcyA9IG8oZSksCiAgICAgICAgICAgIHUgPSAwLAogICAgICAgICAgICBhID0gW107Zm9yIChyIGluIHMpIHsKICAgICAgICAgIHIgIT0gYyAmJiBuKHMsIHIpICYmIGEucHVzaChyKTsKICAgICAgICB9Zm9yICg7IHQubGVuZ3RoID4gdTspIHsKICAgICAgICAgIG4ocywgciA9IHRbdSsrXSkgJiYgKH5pKGEsIHIpIHx8IGEucHVzaChyKSk7CiAgICAgICAgfXJldHVybiBhOwogICAgICB9OwogICAgfSwgeyAiLi9fYXJyYXktaW5jbHVkZXMiOiAxMywgIi4vX2hhcyI6IDI2LCAiLi9fc2hhcmVkLWtleSI6IDU2LCAiLi9fdG8taW9iamVjdCI6IDYzIH1dLCA0ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwiKSwKICAgICAgICAgIG8gPSBlKCIuL19lbnVtLWJ1Zy1rZXlzIik7dC5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbihlLCBvKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2VudW0tYnVnLWtleXMiOiAyMSwgIi4vX29iamVjdC1rZXlzLWludGVybmFsIjogNDcgfV0sIDQ5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgci5mID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7CiAgICB9LCB7fV0sIDUwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICByZXR1cm4geyBlbnVtZXJhYmxlOiAhKDEgJiBlKSwgY29uZmlndXJhYmxlOiAhKDIgJiBlKSwgd3JpdGFibGU6ICEoNCAmIGUpLCB2YWx1ZTogdCB9OwogICAgICB9OwogICAgfSwge31dLCA1MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faGlkZSIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZm9yICh2YXIgbyBpbiB0KSB7CiAgICAgICAgICByICYmIGVbb10gPyBlW29dID0gdFtvXSA6IG4oZSwgbywgdFtvXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9OwogICAgfSwgeyAiLi9faGlkZSI6IDI3IH1dLCA1MjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vX2hpZGUiKTsKICAgIH0sIHsgIi4vX2hpZGUiOiAyNyB9XSwgNTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2lzLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgaSA9IGZ1bmN0aW9uIGkoZSwgdCkgewogICAgICAgIGlmIChvKGUpLCAhbih0KSAmJiBudWxsICE9PSB0KSB0aHJvdyBUeXBlRXJyb3IodCArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7CiAgICAgIH07dC5leHBvcnRzID0geyBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoIl9fcHJvdG9fXyIgaW4ge30gPyBmdW5jdGlvbiAodCwgciwgbikgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbiA9IGUoIi4vX2N0eCIpKEZ1bmN0aW9uLmNhbGwsIGUoIi4vX29iamVjdC1nb3BkIikuZihPYmplY3QucHJvdG90eXBlLCAiX19wcm90b19fIikuc2V0LCAyKSwgbih0LCBbXSksIHIgPSAhKHQgaW5zdGFuY2VvZiBBcnJheSk7CiAgICAgICAgICB9IGNhdGNoIChvKSB7CiAgICAgICAgICAgIHIgPSAhMDsKICAgICAgICAgIH1yZXR1cm4gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgcmV0dXJuIGkoZSwgdCksIHIgPyBlLl9fcHJvdG9fXyA9IHQgOiBuKGUsIHQpLCBlOwogICAgICAgICAgfTsKICAgICAgICB9KHt9LCAhMSkgOiB2b2lkIDApLCBjaGVjazogaSB9OwogICAgfSwgeyAiLi9fYW4tb2JqZWN0IjogMTIsICIuL19jdHgiOiAxNywgIi4vX2lzLW9iamVjdCI6IDMzLCAiLi9fb2JqZWN0LWdvcGQiOiA0NSB9XSwgNTQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi9fZ2xvYmFsIiksCiAgICAgICAgICBvID0gZSgiLi9fY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vX29iamVjdC1kcCIpLAogICAgICAgICAgYyA9IGUoIi4vX2Rlc2NyaXB0b3JzIiksCiAgICAgICAgICBzID0gZSgiLi9fd2tzIikoInNwZWNpZXMiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0gImZ1bmN0aW9uIiA9PSB0eXBlb2Ygb1tlXSA/IG9bZV0gOiBuW2VdO2MgJiYgdCAmJiAhdFtzXSAmJiBpLmYodCwgcywgeyBjb25maWd1cmFibGU6ICEwLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9IH0pOwogICAgICB9OwogICAgfSwgeyAiLi9fY29yZSI6IDE2LCAiLi9fZGVzY3JpcHRvcnMiOiAxOSwgIi4vX2dsb2JhbCI6IDI1LCAiLi9fb2JqZWN0LWRwIjogNDMsICIuL193a3MiOiA2OCB9XSwgNTU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX29iamVjdC1kcCIpLmYsCiAgICAgICAgICBvID0gZSgiLi9faGFzIiksCiAgICAgICAgICBpID0gZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICBlICYmICFvKGUgPSByID8gZSA6IGUucHJvdG90eXBlLCBpKSAmJiBuKGUsIGksIHsgY29uZmlndXJhYmxlOiAhMCwgdmFsdWU6IHQgfSk7CiAgICAgIH07CiAgICB9LCB7ICIuL19oYXMiOiAyNiwgIi4vX29iamVjdC1kcCI6IDQzLCAiLi9fd2tzIjogNjggfV0sIDU2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19zaGFyZWQiKSgia2V5cyIpLAogICAgICAgICAgbyA9IGUoIi4vX3VpZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBvKGUpKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX3NoYXJlZCI6IDU3LCAiLi9fdWlkIjogNjcgfV0sIDU3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19nbG9iYWwiKSwKICAgICAgICAgIG8gPSAiX19jb3JlLWpzX3NoYXJlZF9fIiwKICAgICAgICAgIGkgPSBuW29dIHx8IChuW29dID0ge30pO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGlbZV0gfHwgKGlbZV0gPSB7fSk7CiAgICAgIH07CiAgICB9LCB7ICIuL19nbG9iYWwiOiAyNSB9XSwgNTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX2FuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2EtZnVuY3Rpb24iKSwKICAgICAgICAgIGkgPSBlKCIuL193a3MiKSgic3BlY2llcyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgdmFyIHIsCiAgICAgICAgICAgIGMgPSBuKGUpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDAgPT09IGMgfHwgdm9pZCAwID09IChyID0gbihjKVtpXSkgPyB0IDogbyhyKTsKICAgICAgfTsKICAgIH0sIHsgIi4vX2EtZnVuY3Rpb24iOiA5LCAiLi9fYW4tb2JqZWN0IjogMTIsICIuL193a3MiOiA2OCB9XSwgNTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vX3RvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBlKCIuL19kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQsIHIpIHsKICAgICAgICAgIHZhciBpLAogICAgICAgICAgICAgIGMsCiAgICAgICAgICAgICAgcyA9IFN0cmluZyhvKHQpKSwKICAgICAgICAgICAgICB1ID0gbihyKSwKICAgICAgICAgICAgICBhID0gcy5sZW5ndGg7cmV0dXJuIDAgPiB1IHx8IHUgPj0gYSA/IGUgPyAiIiA6IHZvaWQgMCA6IChpID0gcy5jaGFyQ29kZUF0KHUpLCA1NTI5NiA+IGkgfHwgaSA+IDU2MzE5IHx8IHUgKyAxID09PSBhIHx8IChjID0gcy5jaGFyQ29kZUF0KHUgKyAxKSkgPCA1NjMyMCB8fCBjID4gNTczNDMgPyBlID8gcy5jaGFyQXQodSkgOiBpIDogZSA/IHMuc2xpY2UodSwgdSArIDIpIDogKGkgLSA1NTI5NiA8PCAxMCkgKyAoYyAtIDU2MzIwKSArIDY1NTM2KTsKICAgICAgICB9OwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4LCAiLi9fdG8taW50ZWdlciI6IDYyIH1dLCA2MDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBjID0gZSgiLi9fY3R4IiksCiAgICAgICAgICBzID0gZSgiLi9faW52b2tlIiksCiAgICAgICAgICB1ID0gZSgiLi9faHRtbCIpLAogICAgICAgICAgYSA9IGUoIi4vX2RvbS1jcmVhdGUiKSwKICAgICAgICAgIGYgPSBlKCIuL19nbG9iYWwiKSwKICAgICAgICAgIF8gPSBmLnByb2Nlc3MsCiAgICAgICAgICBsID0gZi5zZXRJbW1lZGlhdGUsCiAgICAgICAgICBkID0gZi5jbGVhckltbWVkaWF0ZSwKICAgICAgICAgIHAgPSBmLk1lc3NhZ2VDaGFubmVsLAogICAgICAgICAgdiA9IDAsCiAgICAgICAgICB5ID0ge30sCiAgICAgICAgICBoID0gIm9ucmVhZHlzdGF0ZWNoYW5nZSIsCiAgICAgICAgICBiID0gZnVuY3Rpb24gYigpIHsKICAgICAgICB2YXIgZSA9ICt0aGlzO2lmICh5Lmhhc093blByb3BlcnR5KGUpKSB7CiAgICAgICAgICB2YXIgdCA9IHlbZV07ZGVsZXRlIHlbZV0sIHQoKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBtID0gZnVuY3Rpb24gbShlKSB7CiAgICAgICAgYi5jYWxsKGUuZGF0YSk7CiAgICAgIH07bCAmJiBkIHx8IChsID0gZnVuY3Rpb24gbChlKSB7CiAgICAgICAgZm9yICh2YXIgdCA9IFtdLCByID0gMTsgYXJndW1lbnRzLmxlbmd0aCA+IHI7KSB7CiAgICAgICAgICB0LnB1c2goYXJndW1lbnRzW3IrK10pOwogICAgICAgIH1yZXR1cm4geVsrK3ZdID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcygiZnVuY3Rpb24iID09IHR5cGVvZiBlID8gZSA6IEZ1bmN0aW9uKGUpLCB0KTsKICAgICAgICB9LCBuKHYpLCB2OwogICAgICB9LCBkID0gZnVuY3Rpb24gZChlKSB7CiAgICAgICAgZGVsZXRlIHlbZV07CiAgICAgIH0sICJwcm9jZXNzIiA9PSBlKCIuL19jb2YiKShfKSA/IG4gPSBmdW5jdGlvbiBuKGUpIHsKICAgICAgICBfLm5leHRUaWNrKGMoYiwgZSwgMSkpOwogICAgICB9IDogcCA/IChvID0gbmV3IHAoKSwgaSA9IG8ucG9ydDIsIG8ucG9ydDEub25tZXNzYWdlID0gbSwgbiA9IGMoaS5wb3N0TWVzc2FnZSwgaSwgMSkpIDogZi5hZGRFdmVudExpc3RlbmVyICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHBvc3RNZXNzYWdlICYmICFmLmltcG9ydFNjcmlwdHMgPyAobiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIGYucG9zdE1lc3NhZ2UoZSArICIiLCAiKiIpOwogICAgICB9LCBmLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBtLCAhMSkpIDogbiA9IGggaW4gYSgic2NyaXB0IikgPyBmdW5jdGlvbiAoZSkgewogICAgICAgIHUuYXBwZW5kQ2hpbGQoYSgic2NyaXB0IikpW2hdID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdS5yZW1vdmVDaGlsZCh0aGlzKSwgYi5jYWxsKGUpOwogICAgICAgIH07CiAgICAgIH0gOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHNldFRpbWVvdXQoYyhiLCBlLCAxKSwgMCk7CiAgICAgIH0pLCB0LmV4cG9ydHMgPSB7IHNldDogbCwgY2xlYXI6IGQgfTsKICAgIH0sIHsgIi4vX2NvZiI6IDE1LCAiLi9fY3R4IjogMTcsICIuL19kb20tY3JlYXRlIjogMjAsICIuL19nbG9iYWwiOiAyNSwgIi4vX2h0bWwiOiAyOCwgIi4vX2ludm9rZSI6IDMwIH1dLCA2MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fdG8taW50ZWdlciIpLAogICAgICAgICAgbyA9IE1hdGgubWF4LAogICAgICAgICAgaSA9IE1hdGgubWluO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIGUgPSBuKGUpLCAwID4gZSA/IG8oZSArIHQsIDApIDogaShlLCB0KTsKICAgICAgfTsKICAgIH0sIHsgIi4vX3RvLWludGVnZXIiOiA2MiB9XSwgNjI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IE1hdGguY2VpbCwKICAgICAgICAgIG8gPSBNYXRoLmZsb29yO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGlzTmFOKGUgPSArZSkgPyAwIDogKGUgPiAwID8gbyA6IG4pKGUpOwogICAgICB9OwogICAgfSwge31dLCA2MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vX2RlZmluZWQiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuKG8oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4LCAiLi9faW9iamVjdCI6IDMxIH1dLCA2NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fdG8taW50ZWdlciIpLAogICAgICAgICAgbyA9IE1hdGgubWluO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUgPiAwID8gbyhuKGUpLCA5MDA3MTk5MjU0NzQwOTkxKSA6IDA7CiAgICAgIH07CiAgICB9LCB7ICIuL190by1pbnRlZ2VyIjogNjIgfV0sIDY1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuL19kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gT2JqZWN0KG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi9fZGVmaW5lZCI6IDE4IH1dLCA2NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9faXMtb2JqZWN0Iik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoIW4oZSkpIHJldHVybiBlO3ZhciByLCBvO2lmICh0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIChyID0gZS50b1N0cmluZykgJiYgIW4obyA9IHIuY2FsbChlKSkpIHJldHVybiBvO2lmICgiZnVuY3Rpb24iID09IHR5cGVvZiAociA9IGUudmFsdWVPZikgJiYgIW4obyA9IHIuY2FsbChlKSkpIHJldHVybiBvO2lmICghdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiAociA9IGUudG9TdHJpbmcpICYmICFuKG8gPSByLmNhbGwoZSkpKSByZXR1cm4gbzt0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwogICAgICB9OwogICAgfSwgeyAiLi9faXMtb2JqZWN0IjogMzMgfV0sIDY3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSAwLAogICAgICAgICAgbyA9IE1hdGgucmFuZG9tKCk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIlN5bWJvbCgiLmNvbmNhdCh2b2lkIDAgPT09IGUgPyAiIiA6IGUsICIpXyIsICgrK24gKyBvKS50b1N0cmluZygzNikpOwogICAgICB9OwogICAgfSwge31dLCA2ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fc2hhcmVkIikoIndrcyIpLAogICAgICAgICAgbyA9IGUoIi4vX3VpZCIpLAogICAgICAgICAgaSA9IGUoIi4vX2dsb2JhbCIpLlN5bWJvbCwKICAgICAgICAgIGMgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBpLAogICAgICAgICAgcyA9IHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBjICYmIGlbZV0gfHwgKGMgPyBpIDogbykoIlN5bWJvbC4iICsgZSkpOwogICAgICB9O3Muc3RvcmUgPSBuOwogICAgfSwgeyAiLi9fZ2xvYmFsIjogMjUsICIuL19zaGFyZWQiOiA1NywgIi4vX3VpZCI6IDY3IH1dLCA2OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fY2xhc3NvZiIpLAogICAgICAgICAgbyA9IGUoIi4vX3drcyIpKCJpdGVyYXRvciIpLAogICAgICAgICAgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpO3QuZXhwb3J0cyA9IGUoIi4vX2NvcmUiKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPSBlID8gZVtvXSB8fCBlWyJAQGl0ZXJhdG9yIl0gfHwgaVtuKGUpXSA6IHZvaWQgMDsKICAgICAgfTsKICAgIH0sIHsgIi4vX2NsYXNzb2YiOiAxNCwgIi4vX2NvcmUiOiAxNiwgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fd2tzIjogNjggfV0sIDcwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vX2FkZC10by11bnNjb3BhYmxlcyIpLAogICAgICAgICAgbyA9IGUoIi4vX2l0ZXItc3RlcCIpLAogICAgICAgICAgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpLAogICAgICAgICAgYyA9IGUoIi4vX3RvLWlvYmplY3QiKTt0LmV4cG9ydHMgPSBlKCIuL19pdGVyLWRlZmluZSIpKEFycmF5LCAiQXJyYXkiLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHRoaXMuX3QgPSBjKGUpLCB0aGlzLl9pID0gMCwgdGhpcy5fayA9IHQ7CiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZSA9IHRoaXMuX3QsCiAgICAgICAgICAgIHQgPSB0aGlzLl9rLAogICAgICAgICAgICByID0gdGhpcy5faSsrO3JldHVybiAhZSB8fCByID49IGUubGVuZ3RoID8gKHRoaXMuX3QgPSB2b2lkIDAsIG8oMSkpIDogImtleXMiID09IHQgPyBvKDAsIHIpIDogInZhbHVlcyIgPT0gdCA/IG8oMCwgZVtyXSkgOiBvKDAsIFtyLCBlW3JdXSk7CiAgICAgIH0sICJ2YWx1ZXMiKSwgaS5Bcmd1bWVudHMgPSBpLkFycmF5LCBuKCJrZXlzIiksIG4oInZhbHVlcyIpLCBuKCJlbnRyaWVzIik7CiAgICB9LCB7ICIuL19hZGQtdG8tdW5zY29wYWJsZXMiOiAxMCwgIi4vX2l0ZXItZGVmaW5lIjogMzYsICIuL19pdGVyLXN0ZXAiOiAzOCwgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fdG8taW9iamVjdCI6IDYzIH1dLCA3MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi9fZXhwb3J0Iik7bihuLlMgKyBuLkYgKiAhZSgiLi9fZGVzY3JpcHRvcnMiKSwgIk9iamVjdCIsIHsgZGVmaW5lUHJvcGVydHk6IGUoIi4vX29iamVjdC1kcCIpLmYgfSk7CiAgICB9LCB7ICIuL19kZXNjcmlwdG9ycyI6IDE5LCAiLi9fZXhwb3J0IjogMjIsICIuL19vYmplY3QtZHAiOiA0MyB9XSwgNzI6IFtmdW5jdGlvbiAoZSwgdCwgcikge30sIHt9XSwgNzM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBjID0gZSgiLi9fbGlicmFyeSIpLAogICAgICAgICAgcyA9IGUoIi4vX2dsb2JhbCIpLAogICAgICAgICAgdSA9IGUoIi4vX2N0eCIpLAogICAgICAgICAgYSA9IGUoIi4vX2NsYXNzb2YiKSwKICAgICAgICAgIGYgPSBlKCIuL19leHBvcnQiKSwKICAgICAgICAgIF8gPSBlKCIuL19pcy1vYmplY3QiKSwKICAgICAgICAgIGwgPSAoZSgiLi9fYW4tb2JqZWN0IiksIGUoIi4vX2EtZnVuY3Rpb24iKSksCiAgICAgICAgICBkID0gZSgiLi9fYW4taW5zdGFuY2UiKSwKICAgICAgICAgIHAgPSBlKCIuL19mb3Itb2YiKSwKICAgICAgICAgIHYgPSAoZSgiLi9fc2V0LXByb3RvIikuc2V0LCBlKCIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIikpLAogICAgICAgICAgeSA9IGUoIi4vX3Rhc2siKS5zZXQsCiAgICAgICAgICBoID0gZSgiLi9fbWljcm90YXNrIikoKSwKICAgICAgICAgIGIgPSAiUHJvbWlzZSIsCiAgICAgICAgICBtID0gcy5UeXBlRXJyb3IsCiAgICAgICAgICBnID0gcy5wcm9jZXNzLAogICAgICAgICAgX2ogPSBzW2JdLAogICAgICAgICAgZyA9IHMucHJvY2VzcywKICAgICAgICAgIHggPSAicHJvY2VzcyIgPT0gYShnKSwKICAgICAgICAgIHcgPSBmdW5jdGlvbiB3KCkge30sCiAgICAgICAgICBrID0gISFmdW5jdGlvbiAoKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhciB0ID0gX2oucmVzb2x2ZSgxKSwKICAgICAgICAgICAgICByID0gKHQuY29uc3RydWN0b3IgPSB7fSlbZSgiLi9fd2tzIikoInNwZWNpZXMiKV0gPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBlKHcsIHcpOwogICAgICAgICAgfTtyZXR1cm4gKHggfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50KSAmJiB0LnRoZW4odykgaW5zdGFuY2VvZiByOwogICAgICAgIH0gY2F0Y2ggKG4pIHt9CiAgICAgIH0oKSwKICAgICAgICAgIE8gPSBmdW5jdGlvbiBPKGUsIHQpIHsKICAgICAgICByZXR1cm4gZSA9PT0gdCB8fCBlID09PSBfaiAmJiB0ID09PSBpOwogICAgICB9LAogICAgICAgICAgTSA9IGZ1bmN0aW9uIE0oZSkgewogICAgICAgIHZhciB0O3JldHVybiBfKGUpICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mICh0ID0gZS50aGVuKSA/IHQgOiAhMTsKICAgICAgfSwKICAgICAgICAgIFAgPSBmdW5jdGlvbiBQKGUpIHsKICAgICAgICByZXR1cm4gTyhfaiwgZSkgPyBuZXcgUyhlKSA6IG5ldyBvKGUpOwogICAgICB9LAogICAgICAgICAgUyA9IG8gPSBmdW5jdGlvbiBvKGUpIHsKICAgICAgICB2YXIgdCwgcjt0aGlzLnByb21pc2UgPSBuZXcgZShmdW5jdGlvbiAoZSwgbikgewogICAgICAgICAgaWYgKHZvaWQgMCAhPT0gdCB8fCB2b2lkIDAgIT09IHIpIHRocm93IG0oIkJhZCBQcm9taXNlIGNvbnN0cnVjdG9yIik7dCA9IGUsIHIgPSBuOwogICAgICAgIH0pLCB0aGlzLnJlc29sdmUgPSBsKHQpLCB0aGlzLnJlamVjdCA9IGwocik7CiAgICAgIH0sCiAgICAgICAgICBFID0gZnVuY3Rpb24gRShlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGUoKTsKICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICByZXR1cm4geyBlcnJvcjogdCB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIFQgPSBmdW5jdGlvbiBUKGUsIHQpIHsKICAgICAgICBpZiAoIWUuX24pIHsKICAgICAgICAgIGUuX24gPSAhMDt2YXIgciA9IGUuX2M7aChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGZvciAodmFyIG4gPSBlLl92LCBvID0gMSA9PSBlLl9zLCBpID0gMCwgYyA9IGZ1bmN0aW9uIGModCkgewogICAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgICBjID0gbyA/IHQub2sgOiB0LmZhaWwsCiAgICAgICAgICAgICAgICAgIHMgPSB0LnJlc29sdmUsCiAgICAgICAgICAgICAgICAgIHUgPSB0LnJlamVjdCwKICAgICAgICAgICAgICAgICAgYSA9IHQuZG9tYWluO3RyeSB7CiAgICAgICAgICAgICAgICBjID8gKG8gfHwgKDIgPT0gZS5faCAmJiBDKGUpLCBlLl9oID0gMSksIGMgPT09ICEwID8gciA9IG4gOiAoYSAmJiBhLmVudGVyKCksIHIgPSBjKG4pLCBhICYmIGEuZXhpdCgpKSwgciA9PT0gdC5wcm9taXNlID8gdShtKCJQcm9taXNlLWNoYWluIGN5Y2xlIikpIDogKGkgPSBNKHIpKSA/IGkuY2FsbChyLCBzLCB1KSA6IHMocikpIDogdShuKTsKICAgICAgICAgICAgICB9IGNhdGNoIChmKSB7CiAgICAgICAgICAgICAgICB1KGYpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsgci5sZW5ndGggPiBpOykgewogICAgICAgICAgICAgIGMocltpKytdKTsKICAgICAgICAgICAgfWUuX2MgPSBbXSwgZS5fbiA9ICExLCB0ICYmICFlLl9oICYmIEEoZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBBID0gZnVuY3Rpb24gQShlKSB7CiAgICAgICAgeS5jYWxsKHMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0LAogICAgICAgICAgICAgIHIsCiAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICBvID0gZS5fdjtpZiAoVShlKSAmJiAodCA9IEUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB4ID8gZy5lbWl0KCJ1bmhhbmRsZWRSZWplY3Rpb24iLCBvLCBlKSA6IChyID0gcy5vbnVuaGFuZGxlZHJlamVjdGlvbikgPyByKHsgcHJvbWlzZTogZSwgcmVhc29uOiBvIH0pIDogKG4gPSBzLmNvbnNvbGUpICYmIG4uZXJyb3IgJiYgbi5lcnJvcigiVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uIiwgbyk7CiAgICAgICAgICB9KSwgZS5faCA9IHggfHwgVShlKSA/IDIgOiAxKSwgZS5fYSA9IHZvaWQgMCwgdCkgdGhyb3cgdC5lcnJvcjsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgICAgIFUgPSBmdW5jdGlvbiBVKGUpIHsKICAgICAgICBpZiAoMSA9PSBlLl9oKSByZXR1cm4gITE7Zm9yICh2YXIgdCwgciA9IGUuX2EgfHwgZS5fYywgbiA9IDA7IHIubGVuZ3RoID4gbjspIHsKICAgICAgICAgIGlmICh0ID0gcltuKytdLCB0LmZhaWwgfHwgIVUodC5wcm9taXNlKSkgcmV0dXJuICExOwogICAgICAgIH1yZXR1cm4gITA7CiAgICAgIH0sCiAgICAgICAgICBDID0gZnVuY3Rpb24gQyhlKSB7CiAgICAgICAgeS5jYWxsKHMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0O3ggPyBnLmVtaXQoInJlamVjdGlvbkhhbmRsZWQiLCBlKSA6ICh0ID0gcy5vbnJlamVjdGlvbmhhbmRsZWQpICYmIHQoeyBwcm9taXNlOiBlLCByZWFzb246IGUuX3YgfSk7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgICAgICBSID0gZnVuY3Rpb24gUihlKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzO3QuX2QgfHwgKHQuX2QgPSAhMCwgdCA9IHQuX3cgfHwgdCwgdC5fdiA9IGUsIHQuX3MgPSAyLCB0Ll9hIHx8ICh0Ll9hID0gdC5fYy5zbGljZSgpKSwgVCh0LCAhMCkpOwogICAgICB9LAogICAgICAgICAgTCA9IGZ1bmN0aW9uIEwoZSkgewogICAgICAgIHZhciB0LAogICAgICAgICAgICByID0gdGhpcztpZiAoIXIuX2QpIHsKICAgICAgICAgIHIuX2QgPSAhMCwgciA9IHIuX3cgfHwgcjt0cnkgewogICAgICAgICAgICBpZiAociA9PT0gZSkgdGhyb3cgbSgiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGYiKTsodCA9IE0oZSkpID8gaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIG4gPSB7IF93OiByLCBfZDogITEgfTt0cnkgewogICAgICAgICAgICAgICAgdC5jYWxsKGUsIHUoTCwgbiwgMSksIHUoUiwgbiwgMSkpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKG8pIHsKICAgICAgICAgICAgICAgIFIuY2FsbChuLCBvKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pIDogKHIuX3YgPSBlLCByLl9zID0gMSwgVChyLCAhMSkpOwogICAgICAgICAgfSBjYXRjaCAobikgewogICAgICAgICAgICBSLmNhbGwoeyBfdzogciwgX2Q6ICExIH0sIG4pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTtrIHx8IChfaiA9IGZ1bmN0aW9uIGooZSkgewogICAgICAgIGQodGhpcywgX2osIGIsICJfaCIpLCBsKGUpLCBuLmNhbGwodGhpcyk7dHJ5IHsKICAgICAgICAgIGUodShMLCB0aGlzLCAxKSwgdShSLCB0aGlzLCAxKSk7CiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgUi5jYWxsKHRoaXMsIHQpOwogICAgICAgIH0KICAgICAgfSwgbiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHRoaXMuX2MgPSBbXSwgdGhpcy5fYSA9IHZvaWQgMCwgdGhpcy5fcyA9IDAsIHRoaXMuX2QgPSAhMSwgdGhpcy5fdiA9IHZvaWQgMCwgdGhpcy5faCA9IDAsIHRoaXMuX24gPSAhMTsKICAgICAgfSwgbi5wcm90b3R5cGUgPSBlKCIuL19yZWRlZmluZS1hbGwiKShfai5wcm90b3R5cGUsIHsgdGhlbjogZnVuY3Rpb24gdGhlbihlLCB0KSB7CiAgICAgICAgICB2YXIgciA9IFAodih0aGlzLCBfaikpO3JldHVybiByLm9rID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSA/IGUgOiAhMCwgci5mYWlsID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdCAmJiB0LCByLmRvbWFpbiA9IHggPyBnLmRvbWFpbiA6IHZvaWQgMCwgdGhpcy5fYy5wdXNoKHIpLCB0aGlzLl9hICYmIHRoaXMuX2EucHVzaChyKSwgdGhpcy5fcyAmJiBUKHRoaXMsICExKSwgci5wcm9taXNlOwogICAgICAgIH0sICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaChlKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgZSk7CiAgICAgICAgfSB9KSwgUyA9IGZ1bmN0aW9uIFMoKSB7CiAgICAgICAgdmFyIGUgPSBuZXcgbigpO3RoaXMucHJvbWlzZSA9IGUsIHRoaXMucmVzb2x2ZSA9IHUoTCwgZSwgMSksIHRoaXMucmVqZWN0ID0gdShSLCBlLCAxKTsKICAgICAgfSksIGYoZi5HICsgZi5XICsgZi5GICogIWssIHsgUHJvbWlzZTogX2ogfSksIGUoIi4vX3NldC10by1zdHJpbmctdGFnIikoX2osIGIpLCBlKCIuL19zZXQtc3BlY2llcyIpKGIpLCBpID0gZSgiLi9fY29yZSIpW2JdLCBmKGYuUyArIGYuRiAqICFrLCBiLCB7IHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KGUpIHsKICAgICAgICAgIHZhciB0ID0gUCh0aGlzKSwKICAgICAgICAgICAgICByID0gdC5yZWplY3Q7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCBmKGYuUyArIGYuRiAqIChjIHx8ICFrKSwgYiwgeyByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKGUpIHsKICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgX2ogJiYgTyhlLmNvbnN0cnVjdG9yLCB0aGlzKSkgcmV0dXJuIGU7dmFyIHQgPSBQKHRoaXMpLAogICAgICAgICAgICAgIHIgPSB0LnJlc29sdmU7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCBmKGYuUyArIGYuRiAqICEoayAmJiBlKCIuL19pdGVyLWRldGVjdCIpKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX2ouYWxsKGUpWyJjYXRjaCJdKHcpOwogICAgICB9KSksIGIsIHsgYWxsOiBmdW5jdGlvbiBhbGwoZSkgewogICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgIHIgPSBQKHQpLAogICAgICAgICAgICAgIG4gPSByLnJlc29sdmUsCiAgICAgICAgICAgICAgbyA9IHIucmVqZWN0LAogICAgICAgICAgICAgIGkgPSBFKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHIgPSBbXSwKICAgICAgICAgICAgICAgIGkgPSAwLAogICAgICAgICAgICAgICAgYyA9IDE7cChlLCAhMSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB2YXIgcyA9IGkrKywKICAgICAgICAgICAgICAgICAgdSA9ICExO3IucHVzaCh2b2lkIDApLCBjKyssIHQucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICB1IHx8ICh1ID0gITAsIHJbc10gPSBlLCAtLWMgfHwgbihyKSk7CiAgICAgICAgICAgICAgfSwgbyk7CiAgICAgICAgICAgIH0pLCAtLWMgfHwgbihyKTsKICAgICAgICAgIH0pO3JldHVybiBpICYmIG8oaS5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9LCByYWNlOiBmdW5jdGlvbiByYWNlKGUpIHsKICAgICAgICAgIHZhciB0ID0gdGhpcywKICAgICAgICAgICAgICByID0gUCh0KSwKICAgICAgICAgICAgICBuID0gci5yZWplY3QsCiAgICAgICAgICAgICAgbyA9IEUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBwKGUsICExLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHQucmVzb2x2ZShlKS50aGVuKHIucmVzb2x2ZSwgbik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7cmV0dXJuIG8gJiYgbihvLmVycm9yKSwgci5wcm9taXNlOwogICAgICAgIH0gfSk7CiAgICB9LCB7ICIuL19hLWZ1bmN0aW9uIjogOSwgIi4vX2FuLWluc3RhbmNlIjogMTEsICIuL19hbi1vYmplY3QiOiAxMiwgIi4vX2NsYXNzb2YiOiAxNCwgIi4vX2NvcmUiOiAxNiwgIi4vX2N0eCI6IDE3LCAiLi9fZXhwb3J0IjogMjIsICIuL19mb3Itb2YiOiAyNCwgIi4vX2dsb2JhbCI6IDI1LCAiLi9faXMtb2JqZWN0IjogMzMsICIuL19pdGVyLWRldGVjdCI6IDM3LCAiLi9fbGlicmFyeSI6IDQwLCAiLi9fbWljcm90YXNrIjogNDEsICIuL19yZWRlZmluZS1hbGwiOiA1MSwgIi4vX3NldC1wcm90byI6IDUzLCAiLi9fc2V0LXNwZWNpZXMiOiA1NCwgIi4vX3NldC10by1zdHJpbmctdGFnIjogNTUsICIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIjogNTgsICIuL190YXNrIjogNjAsICIuL193a3MiOiA2OCB9XSwgNzQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi9fc3RyaW5nLWF0IikoITApO2UoIi4vX2l0ZXItZGVmaW5lIikoU3RyaW5nLCAiU3RyaW5nIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB0aGlzLl90ID0gU3RyaW5nKGUpLCB0aGlzLl9pID0gMDsKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBlLAogICAgICAgICAgICB0ID0gdGhpcy5fdCwKICAgICAgICAgICAgciA9IHRoaXMuX2k7cmV0dXJuIHIgPj0gdC5sZW5ndGggPyB7IHZhbHVlOiB2b2lkIDAsIGRvbmU6ICEwIH0gOiAoZSA9IG4odCwgciksIHRoaXMuX2kgKz0gZS5sZW5ndGgsIHsgdmFsdWU6IGUsIGRvbmU6ICExIH0pOwogICAgICB9KTsKICAgIH0sIHsgIi4vX2l0ZXItZGVmaW5lIjogMzYsICIuL19zdHJpbmctYXQiOiA1OSB9XSwgNzU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuL2VzNi5hcnJheS5pdGVyYXRvciIpO2ZvciAodmFyIG4gPSBlKCIuL19nbG9iYWwiKSwgbyA9IGUoIi4vX2hpZGUiKSwgaSA9IGUoIi4vX2l0ZXJhdG9ycyIpLCBjID0gZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIiksIHMgPSBbIk5vZGVMaXN0IiwgIkRPTVRva2VuTGlzdCIsICJNZWRpYUxpc3QiLCAiU3R5bGVTaGVldExpc3QiLCAiQ1NTUnVsZUxpc3QiXSwgdSA9IDA7IDUgPiB1OyB1KyspIHsKICAgICAgICB2YXIgYSA9IHNbdV0sCiAgICAgICAgICAgIGYgPSBuW2FdLAogICAgICAgICAgICBfID0gZiAmJiBmLnByb3RvdHlwZTtfICYmICFfW2NdICYmIG8oXywgYywgYSksIGlbYV0gPSBpLkFycmF5OwogICAgICB9CiAgICB9LCB7ICIuL19nbG9iYWwiOiAyNSwgIi4vX2hpZGUiOiAyNywgIi4vX2l0ZXJhdG9ycyI6IDM5LCAiLi9fd2tzIjogNjgsICIuL2VzNi5hcnJheS5pdGVyYXRvciI6IDcwIH1dLCA3NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoIi4vaHlwZXJ0eS1kaXNjb3ZlcnkvSHlwZXJ0eURpc2NvdmVyeSIpLAogICAgICAgICAgaSA9IG4obyk7clsiZGVmYXVsdCJdID0gaVsiZGVmYXVsdCJdLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuL2h5cGVydHktZGlzY292ZXJ5L0h5cGVydHlEaXNjb3ZlcnkiOiA3NyB9XSwgNzc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBjID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBzID0gbihjKSwKICAgICAgICAgIHUgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGEgPSBuKHUpLAogICAgICAgICAgZiA9IGUoIi4uL3V0aWxzL3V0aWxzIiksCiAgICAgICAgICBfID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCwgcikgewogICAgICAgICAgKDAsIHNbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIG4gPSB0aGlzO24ubWVzc2FnZUJ1cyA9IHIsIG4uZG9tYWluID0gKDAsIGYuZGl2aWRlVVJMKSh0KS5kb21haW4sIG4uZGlzY292ZXJ5VVJMID0gdDsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogImRpc2NvdmVyRGF0YU9iamVjdFBlck5hbWUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiAiZGF0YU9iamVjdDovLyIgKyBlIH0gfTtyZXR1cm4gbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHIubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShvLCBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgdmFyIG4gPSByLmJvZHkudmFsdWUudXJsO24gPyBlKG4pIDogdCgiRGF0YU9iamVjdCBuYW1lIGRvZXMgbm90IGV4aXN0Iik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogImRpc2NvdmVySHlwZXJ0eVBlclVzZXIiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0gInVzZXI6Ly8iICsgZS5zdWJzdHJpbmcoZS5pbmRleE9mKCJAIikgKyAxLCBlLmxlbmd0aCkgKyAiLyIgKyBlLnN1YnN0cmluZygwLCBlLmluZGV4T2YoIkAiKSksCiAgICAgICAgICAgICAgICBjID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiBvIH0gfTtyZXR1cm4gY29uc29sZS5sb2coIk1lc3NhZ2U6ICIsIGMsIG4sIG8pLCBuZXcgaVsiZGVmYXVsdCJdKGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgci5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKGMsIGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygibWVzc2FnZSByZXBseSIsIHIpO3ZhciBvID0gdm9pZCAwLAogICAgICAgICAgICAgICAgICAgIGkgPSB2b2lkIDAsCiAgICAgICAgICAgICAgICAgICAgYyA9IHZvaWQgMCwKICAgICAgICAgICAgICAgICAgICBzID0gci5ib2R5LnZhbHVlO2ZvciAobyBpbiBzKSB7CiAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHNbb10ubGFzdE1vZGlmaWVkKSBpZiAodm9pZCAwID09PSBpKSBpID0gbmV3IERhdGUoc1tvXS5sYXN0TW9kaWZpZWQpLCBjID0gbztlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdSA9IG5ldyBEYXRlKHNbb10ubGFzdE1vZGlmaWVkKTtpLmdldFRpbWUoKSA8IHUuZ2V0VGltZSgpICYmIChpID0gdSwgYyA9IG8pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9Y29uc29sZS5sb2coIkxhc3QgSHlwZXJ0eTogIiwgYywgaSk7dmFyIGEgPSBjO2lmICh2b2lkIDAgPT09IGEpIHJldHVybiBuKCJVc2VyIEh5cGVydHkgbm90IGZvdW5kIik7dmFyIGYgPSB7IGlkOiBlLCBkZXNjcmlwdG9yOiBzW2FdLmRlc2NyaXB0b3IsIGh5cGVydHlVUkw6IGEgfTtjb25zb2xlLmxvZygiPT09PiBoeXBlcnR5RGlzY292ZXJ5IG1lc3NhZ2VCdW5kbGU6ICIsIGYpLCB0KGYpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkaXNjb3Zlckh5cGVydGllc1BlclVzZXIiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMsCiAgICAgICAgICAgICAgICBuID0gdm9pZCAwO24gPSB0ID8gdCA6IHIuZG9tYWluO3ZhciBvID0gInVzZXI6Ly8iICsgZS5zdWJzdHJpbmcoZS5pbmRleE9mKCJAIikgKyAxLCBlLmxlbmd0aCkgKyAiLyIgKyBlLnN1YnN0cmluZygwLCBlLmluZGV4T2YoIkAiKSksCiAgICAgICAgICAgICAgICBjID0geyB0eXBlOiAicmVhZCIsIGZyb206IHIuZGlzY292ZXJ5VVJMLCB0bzogImRvbWFpbjovL3JlZ2lzdHJ5LiIgKyBuICsgIi8iLCBib2R5OiB7IHJlc291cmNlOiBvIH0gfTtyZXR1cm4gY29uc29sZS5sb2coIk1lc3NhZ2UgZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyOiAiLCBjLCBuLCBvKSwgbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHIubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShjLCBmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coImRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlciByZXBseSIsIHIpO3ZhciBuID0gci5ib2R5LnZhbHVlO3JldHVybiBuID8gdm9pZCBlKG4pIDogdCgiVXNlciBIeXBlcnR5IG5vdCBmb3VuZCIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gXywgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi4vdXRpbHMvdXRpbHMiOiA3OCwgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIjogMywgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDQsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiA1IH1dLCA3ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1mdW5jdGlvbiBvKGUpIHsKICAgICAgICB2YXIgdCA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpLAogICAgICAgICAgICByID0gIiQxLCQyLCQzIiwKICAgICAgICAgICAgbiA9IGUucmVwbGFjZSh0LCByKS5zcGxpdCgiLCIpO25bMF0gPT09IGUgJiYgKG5bMF0gPSAiaHR0cHMiLCBuWzFdID0gZSk7dmFyIG8gPSB7IHR5cGU6IG5bMF0sIGRvbWFpbjogblsxXSwgaWRlbnRpdHk6IG5bMl0gfTtyZXR1cm4gbzsKICAgICAgfWZ1bmN0aW9uIGkoZSkgewogICAgICAgIHJldHVybiBlID8gSlNPTi5wYXJzZSgoMCwgc1siZGVmYXVsdCJdKShlKSkgOiB2b2lkIDA7CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgYyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSIpLAogICAgICAgICAgcyA9IG4oYyk7ci5kaXZpZGVVUkwgPSBvLCByLmRlZXBDbG9uZSA9IGk7CiAgICB9LCB7ICJiYWJlbC1ydW50aW1lL2NvcmUtanMvanNvbi9zdHJpbmdpZnkiOiAxIH1dIH0sIHt9LCBbNzZdKSg3Nik7Cn0pOwoKfSkuY2FsbCh0aGlzLHR5cGVvZiBnbG9iYWwgIT09ICJ1bmRlZmluZWQiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDoge30pCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewooZnVuY3Rpb24gKGdsb2JhbCl7CiJ1c2Ugc3RyaWN0IjsKCnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsKCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKLy8gRGlzdHJpYnV0aW9uIGZpbGUgZm9yIFN5bmNoZXIuanMKLy8gdmVyc2lvbjogMC4yLjAKCiFmdW5jdGlvbiAoZSkgewogIGlmICgib2JqZWN0IiA9PSAodHlwZW9mIGV4cG9ydHMgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGV4cG9ydHMpKSAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgbW9kdWxlKSBtb2R1bGUuZXhwb3J0cyA9IGUoKTtlbHNlIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiBkZWZpbmUgJiYgZGVmaW5lLmFtZCkgZGVmaW5lKFtdLCBlKTtlbHNlIHsKICAgIHZhciB0O3QgPSAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIGdsb2JhbCA/IGdsb2JhbCA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBzZWxmID8gc2VsZiA6IHRoaXMsIHQuU3luY2hlciA9IGUoKTsKICB9Cn0oZnVuY3Rpb24gKCkgewogIHJldHVybiBmdW5jdGlvbiBlKHQsIHIsIG4pIHsKICAgIGZ1bmN0aW9uIG8ocywgYSkgewogICAgICBpZiAoIXJbc10pIHsKICAgICAgICBpZiAoIXRbc10pIHsKICAgICAgICAgIHZhciBjID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgcmVxdWlyZSAmJiByZXF1aXJlO2lmICghYSAmJiBjKSByZXR1cm4gYyhzLCAhMCk7aWYgKGkpIHJldHVybiBpKHMsICEwKTt2YXIgdSA9IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciICsgcyArICInIik7dGhyb3cgdS5jb2RlID0gIk1PRFVMRV9OT1RfRk9VTkQiLCB1OwogICAgICAgIH12YXIgbCA9IHJbc10gPSB7IGV4cG9ydHM6IHt9IH07dFtzXVswXS5jYWxsKGwuZXhwb3J0cywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciByID0gdFtzXVsxXVtlXTtyZXR1cm4gbyhyID8gciA6IGUpOwogICAgICAgIH0sIGwsIGwuZXhwb3J0cywgZSwgdCwgciwgbik7CiAgICAgIH1yZXR1cm4gcltzXS5leHBvcnRzOwogICAgfWZvciAodmFyIGkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiByZXF1aXJlICYmIHJlcXVpcmUsIHMgPSAwOyBzIDwgbi5sZW5ndGg7IHMrKykgewogICAgICBvKG5bc10pOwogICAgfXJldHVybiBvOwogIH0oeyAxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgT2JqZWN0Lm9ic2VydmUgJiYgIUFycmF5Lm9ic2VydmUgJiYgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgdmFyIHIgPSBlLmdldE5vdGlmaWVyLAogICAgICAgICAgICBuID0gInBlcmZvcm1DaGFuZ2UiLAogICAgICAgICAgICBvID0gIl9vcmlnaW5hbCIsCiAgICAgICAgICAgIGkgPSAic3BsaWNlIiwKICAgICAgICAgICAgcyA9IHsgcHVzaDogZnVuY3Rpb24gYyhlKSB7CiAgICAgICAgICAgIHZhciB0ID0gYXJndW1lbnRzLAogICAgICAgICAgICAgICAgcyA9IGNbb10uYXBwbHkodGhpcywgdCk7cmV0dXJuIHIodGhpcylbbl0oaSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiB7IGluZGV4OiBzIC0gdC5sZW5ndGgsIGFkZGVkQ291bnQ6IHQubGVuZ3RoLCByZW1vdmVkOiBbXSB9OwogICAgICAgICAgICB9KSwgczsKICAgICAgICAgIH0sIHVuc2hpZnQ6IGZ1bmN0aW9uIHUoZSkgewogICAgICAgICAgICB2YXIgdCA9IGFyZ3VtZW50cywKICAgICAgICAgICAgICAgIHMgPSB1W29dLmFwcGx5KHRoaXMsIHQpO3JldHVybiByKHRoaXMpW25dKGksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4geyBpbmRleDogMCwgYWRkZWRDb3VudDogdC5sZW5ndGgsIHJlbW92ZWQ6IFtdIH07CiAgICAgICAgICAgIH0pLCBzOwogICAgICAgICAgfSwgcG9wOiBmdW5jdGlvbiBsKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMubGVuZ3RoLAogICAgICAgICAgICAgICAgdCA9IGxbb10uY2FsbCh0aGlzKTtyZXR1cm4gdGhpcy5sZW5ndGggIT09IGUgJiYgcih0aGlzKVtuXShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHsgaW5kZXg6IHRoaXMubGVuZ3RoLCBhZGRlZENvdW50OiAwLCByZW1vdmVkOiBbdF0gfTsKICAgICAgICAgICAgfSwgdGhpcyksIHQ7CiAgICAgICAgICB9LCBzaGlmdDogZnVuY3Rpb24gZigpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmxlbmd0aCwKICAgICAgICAgICAgICAgIHQgPSBmW29dLmNhbGwodGhpcyk7cmV0dXJuIHRoaXMubGVuZ3RoICE9PSBlICYmIHIodGhpcylbbl0oaSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiB7IGluZGV4OiAwLCBhZGRlZENvdW50OiAwLCByZW1vdmVkOiBbdF0gfTsKICAgICAgICAgICAgfSwgdGhpcyksIHQ7CiAgICAgICAgICB9LCBzcGxpY2U6IGZ1bmN0aW9uIGQoZSwgdCkgewogICAgICAgICAgICB2YXIgcyA9IGFyZ3VtZW50cywKICAgICAgICAgICAgICAgIGEgPSBkW29dLmFwcGx5KHRoaXMsIHMpO3JldHVybiAoYS5sZW5ndGggfHwgcy5sZW5ndGggPiAyKSAmJiByKHRoaXMpW25dKGksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4geyBpbmRleDogZSwgYWRkZWRDb3VudDogcy5sZW5ndGggLSAyLCByZW1vdmVkOiBhIH07CiAgICAgICAgICAgIH0sIHRoaXMpLCBhOwogICAgICAgICAgfSB9O2ZvciAodmFyIGEgaW4gcykgewogICAgICAgICAgc1thXVtvXSA9IHQucHJvdG90eXBlW2FdLCB0LnByb3RvdHlwZVthXSA9IHNbYV07CiAgICAgICAgfXQub2JzZXJ2ZSA9IGZ1bmN0aW9uICh0LCByKSB7CiAgICAgICAgICByZXR1cm4gZS5vYnNlcnZlKHQsIHIsIFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCBpXSk7CiAgICAgICAgfSwgdC51bm9ic2VydmUgPSBlLnVub2JzZXJ2ZTsKICAgICAgfShPYmplY3QsIEFycmF5KTsKICAgIH0sIHt9XSwgMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vanNvbi9zdHJpbmdpZnkiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSI6IDE3IH1dLCAzOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvY3JlYXRlIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZSI6IDE4IH1dLCA0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6IDE5IH1dLCA1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI6IDIwIH1dLCA2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiIpLCBfX2VzTW9kdWxlOiAhMCB9OwogICAgfSwgeyAiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjogMjEgfV0sIDc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9rZXlzIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2tleXMiOiAyMiB9XSwgODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L3NldC1wcm90b3R5cGUtb2YiKSwgX19lc01vZHVsZTogITAgfTsKICAgIH0sIHsgImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiI6IDIzIH1dLCA5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0geyAiZGVmYXVsdCI6IGUoImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vcHJvbWlzZSI6IDI0IH1dLCAxMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBlKCJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIiksIF9fZXNNb2R1bGU6ICEwIH07CiAgICB9LCB7ICJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIjogMjUgfV0sIDExOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICByLl9fZXNNb2R1bGUgPSAhMCwgclsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgdCkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgICB9OwogICAgfSwge31dLCAxMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1yLl9fZXNNb2R1bGUgPSAhMDt2YXIgbyA9IGUoIi4uL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSIpLAogICAgICAgICAgaSA9IG4obyk7clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUoZSwgdCkgewogICAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgIHZhciBuID0gdFtyXTtuLmVudW1lcmFibGUgPSBuLmVudW1lcmFibGUgfHwgITEsIG4uY29uZmlndXJhYmxlID0gITAsICJ2YWx1ZSIgaW4gbiAmJiAobi53cml0YWJsZSA9ICEwKSwgKDAsIGlbImRlZmF1bHQiXSkoZSwgbi5rZXksIG4pOwogICAgICAgICAgfQogICAgICAgIH1yZXR1cm4gZnVuY3Rpb24gKHQsIHIsIG4pIHsKICAgICAgICAgIHJldHVybiByICYmIGUodC5wcm90b3R5cGUsIHIpLCBuICYmIGUodCwgbiksIHQ7CiAgICAgICAgfTsKICAgICAgfSgpOwogICAgfSwgeyAiLi4vY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5IjogNCB9XSwgMTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiKVsiZGVmYXVsdCJdO3JbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZm9yICh2YXIgbyA9ICEwOyBvOykgewogICAgICAgICAgdmFyIGkgPSBlLAogICAgICAgICAgICAgIHMgPSB0LAogICAgICAgICAgICAgIGEgPSByO28gPSAhMSwgbnVsbCA9PT0gaSAmJiAoaSA9IEZ1bmN0aW9uLnByb3RvdHlwZSk7dmFyIGMgPSBuKGksIHMpO2lmICh2b2lkIDAgIT09IGMpIHsKICAgICAgICAgICAgaWYgKCJ2YWx1ZSIgaW4gYykgcmV0dXJuIGMudmFsdWU7dmFyIHUgPSBjLmdldDtpZiAodm9pZCAwID09PSB1KSByZXR1cm47cmV0dXJuIHUuY2FsbChhKTsKICAgICAgICAgIH12YXIgbCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihpKTtpZiAobnVsbCA9PT0gbCkgcmV0dXJuO2UgPSBsLCB0ID0gcywgciA9IGEsIG8gPSAhMCwgYyA9IGwgPSB2b2lkIDA7CiAgICAgICAgfQogICAgICB9LCByLl9fZXNNb2R1bGUgPSAhMDsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjogNSB9XSwgMTQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9jcmVhdGUiKVsiZGVmYXVsdCJdLAogICAgICAgICAgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiIpWyJkZWZhdWx0Il07clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgdCAmJiBudWxsICE9PSB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHQgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKHQpKSk7ZS5wcm90b3R5cGUgPSBuKHQgJiYgdC5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IGUsIGVudW1lcmFibGU6ICExLCB3cml0YWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAgfSB9KSwgdCAmJiAobyA/IG8oZSwgdCkgOiBlLl9fcHJvdG9fXyA9IHQpOwogICAgICB9LCByLl9fZXNNb2R1bGUgPSAhMDsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvY3JlYXRlIjogMywgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiI6IDggfV0sIDE1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfXIuX19lc01vZHVsZSA9ICEwO3ZhciBvID0gZSgiLi4vaGVscGVycy90eXBlb2YiKSwKICAgICAgICAgIGkgPSBuKG8pO3JbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCFlKSB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiAhdCB8fCAib2JqZWN0IiAhPT0gKCJ1bmRlZmluZWQiID09IHR5cGVvZiB0ID8gInVuZGVmaW5lZCIgOiAoMCwgaVsiZGVmYXVsdCJdKSh0KSkgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgdCA/IGUgOiB0OwogICAgICB9OwogICAgfSwgeyAiLi4vaGVscGVycy90eXBlb2YiOiAxNiB9XSwgMTY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbCIpWyJkZWZhdWx0Il07clsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLmNvbnN0cnVjdG9yID09PSBuID8gInN5bWJvbCIgOiB0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSk7CiAgICAgIH0sIHIuX19lc01vZHVsZSA9ICEwOwogICAgfSwgeyAiYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbCI6IDEwIH1dLCAxNzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kLmNvcmUiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAobi5KU09OICYmIG4uSlNPTi5zdHJpbmdpZnkgfHwgSlNPTi5zdHJpbmdpZnkpLmFwcGx5KEpTT04sIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQuY29yZSI6IDMxIH1dLCAxODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICByZXR1cm4gbi5jcmVhdGUoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQiOiA1NiB9XSwgMTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4uLy4uL21vZHVsZXMvJCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgcmV0dXJuIG4uc2V0RGVzYyhlLCB0LCByKTsKICAgICAgfTsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJCI6IDU2IH1dLCAyMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi4vLi4vbW9kdWxlcy8kIik7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpLCB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBuLmdldERlc2MoZSwgdCk7CiAgICAgIH07CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQiOiA1NiwgIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOiA4MSB9XSwgMjE6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZiIpLCB0LmV4cG9ydHMgPSBlKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZiI6IDgyIH1dLCAyMjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5rZXlzIiksIHQuZXhwb3J0cyA9IGUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuT2JqZWN0LmtleXM7CiAgICB9LCB7ICIuLi8uLi9tb2R1bGVzLyQuY29yZSI6IDMxLCAiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmtleXMiOiA4MyB9XSwgMjM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZiIpLCB0LmV4cG9ydHMgPSBlKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5zZXRQcm90b3R5cGVPZjsKICAgIH0sIHsgIi4uLy4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZiI6IDg0IH1dLCAyNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmciKSwgZSgiLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yIiksIGUoIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSIpLCBlKCIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIiksIHQuZXhwb3J0cyA9IGUoIi4uL21vZHVsZXMvJC5jb3JlIikuUHJvbWlzZTsKICAgIH0sIHsgIi4uL21vZHVsZXMvJC5jb3JlIjogMzEsICIuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIjogODUsICIuLi9tb2R1bGVzL2VzNi5wcm9taXNlIjogODYsICIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOiA4NywgIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSI6IDg5IH1dLCAyNTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIGUoIi4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCIpLCBlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIiksIHQuZXhwb3J0cyA9IGUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuU3ltYm9sOwogICAgfSwgeyAiLi4vLi4vbW9kdWxlcy8kLmNvcmUiOiAzMSwgIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmciOiA4NSwgIi4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCI6IDg4IH1dLCAyNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGUpIHRocm93IFR5cGVFcnJvcihlICsgIiBpcyBub3QgYSBmdW5jdGlvbiEiKTtyZXR1cm4gZTsKICAgICAgfTsKICAgIH0sIHt9XSwgMjc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7fTsKICAgIH0sIHt9XSwgMjg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5pcy1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmICghbihlKSkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBhbiBvYmplY3QhIik7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuaXMtb2JqZWN0IjogNDkgfV0sIDI5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIiksCiAgICAgICAgICBvID0gZSgiLi8kLndrcyIpKCJ0b1N0cmluZ1RhZyIpLAogICAgICAgICAgaSA9ICJBcmd1bWVudHMiID09IG4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBhcmd1bWVudHM7CiAgICAgIH0oKSk7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgdCwgciwgcztyZXR1cm4gdm9pZCAwID09PSBlID8gIlVuZGVmaW5lZCIgOiBudWxsID09PSBlID8gIk51bGwiIDogInN0cmluZyIgPT0gdHlwZW9mIChyID0gKHQgPSBPYmplY3QoZSkpW29dKSA/IHIgOiBpID8gbih0KSA6ICJPYmplY3QiID09IChzID0gbih0KSkgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdC5jYWxsZWUgPyAiQXJndW1lbnRzIiA6IHM7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAsICIuLyQud2tzIjogNzggfV0sIDMwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSB7fS50b1N0cmluZzt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBuLmNhbGwoZSkuc2xpY2UoOCwgLTEpOwogICAgICB9OwogICAgfSwge31dLCAzMTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0geyB2ZXJzaW9uOiAiMS4yLjYiIH07Im51bWJlciIgPT0gdHlwZW9mIF9fZSAmJiAoX19lID0gbik7CiAgICB9LCB7fV0sIDMyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuYS1mdW5jdGlvbiIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgaWYgKG4oZSksIHZvaWQgMCA9PT0gdCkgcmV0dXJuIGU7c3dpdGNoIChyKSB7Y2FzZSAxOgogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICByZXR1cm4gZS5jYWxsKHQsIHIpOwogICAgICAgICAgICB9O2Nhc2UgMjoKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChyLCBuKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGUuY2FsbCh0LCByLCBuKTsKICAgICAgICAgICAgfTtjYXNlIDM6CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAociwgbiwgbykgewogICAgICAgICAgICAgIHJldHVybiBlLmNhbGwodCwgciwgbiwgbyk7CiAgICAgICAgICAgIH07fXJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZS5hcHBseSh0LCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH07CiAgICB9LCB7ICIuLyQuYS1mdW5jdGlvbiI6IDI2IH1dLCAzMzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKHZvaWQgMCA9PSBlKSB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNhbGwgbWV0aG9kIG9uICAiICsgZSk7cmV0dXJuIGU7CiAgICAgIH07CiAgICB9LCB7fV0sIDM0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gIWUoIi4vJC5mYWlscyIpKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gNyAhPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICJhIiwgeyBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIDc7CiAgICAgICAgICB9IH0pLmE7CiAgICAgIH0pOwogICAgfSwgeyAiLi8kLmZhaWxzIjogMzggfV0sIDM1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaXMtb2JqZWN0IiksCiAgICAgICAgICBvID0gZSgiLi8kLmdsb2JhbCIpLmRvY3VtZW50LAogICAgICAgICAgaSA9IG4obykgJiYgbihvLmNyZWF0ZUVsZW1lbnQpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGkgPyBvLmNyZWF0ZUVsZW1lbnQoZSkgOiB7fTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5nbG9iYWwiOiA0MSwgIi4vJC5pcy1vYmplY3QiOiA0OSB9XSwgMzY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQgPSBuLmdldEtleXMoZSksCiAgICAgICAgICAgIHIgPSBuLmdldFN5bWJvbHM7aWYgKHIpIGZvciAodmFyIG8sIGkgPSByKGUpLCBzID0gbi5pc0VudW0sIGEgPSAwOyBpLmxlbmd0aCA+IGE7KSB7CiAgICAgICAgICBzLmNhbGwoZSwgbyA9IGlbYSsrXSkgJiYgdC5wdXNoKG8pOwogICAgICAgIH1yZXR1cm4gdDsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2IH1dLCAzNzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmdsb2JhbCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5jb3JlIiksCiAgICAgICAgICBpID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgcyA9ICJwcm90b3R5cGUiLAogICAgICAgICAgYSA9IGZ1bmN0aW9uIGEoZSwgdCwgcikgewogICAgICAgIHZhciBjLAogICAgICAgICAgICB1LAogICAgICAgICAgICBsLAogICAgICAgICAgICBmID0gZSAmIGEuRiwKICAgICAgICAgICAgZCA9IGUgJiBhLkcsCiAgICAgICAgICAgIHAgPSBlICYgYS5TLAogICAgICAgICAgICBiID0gZSAmIGEuUCwKICAgICAgICAgICAgaCA9IGUgJiBhLkIsCiAgICAgICAgICAgIHYgPSBlICYgYS5XLAogICAgICAgICAgICB5ID0gZCA/IG8gOiBvW3RdIHx8IChvW3RdID0ge30pLAogICAgICAgICAgICBfID0gZCA/IG4gOiBwID8gblt0XSA6IChuW3RdIHx8IHt9KVtzXTtkICYmIChyID0gdCk7Zm9yIChjIGluIHIpIHsKICAgICAgICAgIHUgPSAhZiAmJiBfICYmIGMgaW4gXywgdSAmJiBjIGluIHkgfHwgKGwgPSB1ID8gX1tjXSA6IHJbY10sIHlbY10gPSBkICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIF9bY10gPyByW2NdIDogaCAmJiB1ID8gaShsLCBuKSA6IHYgJiYgX1tjXSA9PSBsID8gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSBmdW5jdGlvbiB0KF90KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBlID8gbmV3IGUoX3QpIDogZShfdCk7CiAgICAgICAgICAgIH07cmV0dXJuIHRbc10gPSBlW3NdLCB0OwogICAgICAgICAgfShsKSA6IGIgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgbCA/IGkoRnVuY3Rpb24uY2FsbCwgbCkgOiBsLCBiICYmICgoeVtzXSB8fCAoeVtzXSA9IHt9KSlbY10gPSBsKSk7CiAgICAgICAgfQogICAgICB9O2EuRiA9IDEsIGEuRyA9IDIsIGEuUyA9IDQsIGEuUCA9IDgsIGEuQiA9IDE2LCBhLlcgPSAzMiwgdC5leHBvcnRzID0gYTsKICAgIH0sIHsgIi4vJC5jb3JlIjogMzEsICIuLyQuY3R4IjogMzIsICIuLyQuZ2xvYmFsIjogNDEgfV0sIDM4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuICEhZSgpOwogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgIHJldHVybiAhMDsKICAgICAgICB9CiAgICAgIH07CiAgICB9LCB7fV0sIDM5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY3R4IiksCiAgICAgICAgICBvID0gZSgiLi8kLml0ZXItY2FsbCIpLAogICAgICAgICAgaSA9IGUoIi4vJC5pcy1hcnJheS1pdGVyIiksCiAgICAgICAgICBzID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgYSA9IGUoIi4vJC50by1sZW5ndGgiKSwKICAgICAgICAgIGMgPSBlKCIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCB1KSB7CiAgICAgICAgdmFyIGwsCiAgICAgICAgICAgIGYsCiAgICAgICAgICAgIGQsCiAgICAgICAgICAgIHAgPSBjKGUpLAogICAgICAgICAgICBiID0gbihyLCB1LCB0ID8gMiA6IDEpLAogICAgICAgICAgICBoID0gMDtpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgcCkgdGhyb3cgVHlwZUVycm9yKGUgKyAiIGlzIG5vdCBpdGVyYWJsZSEiKTtpZiAoaShwKSkgZm9yIChsID0gYShlLmxlbmd0aCk7IGwgPiBoOyBoKyspIHsKICAgICAgICAgIHQgPyBiKHMoZiA9IGVbaF0pWzBdLCBmWzFdKSA6IGIoZVtoXSk7CiAgICAgICAgfSBlbHNlIGZvciAoZCA9IHAuY2FsbChlKTsgIShmID0gZC5uZXh0KCkpLmRvbmU7KSB7CiAgICAgICAgICBvKGQsIGIsIGYudmFsdWUsIHQpOwogICAgICAgIH0KICAgICAgfTsKICAgIH0sIHsgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5pcy1hcnJheS1pdGVyIjogNDcsICIuLyQuaXRlci1jYWxsIjogNTAsICIuLyQudG8tbGVuZ3RoIjogNzUsICIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCI6IDc5IH1dLCA0MDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWlvYmplY3QiKSwKICAgICAgICAgIG8gPSBlKCIuLyQiKS5nZXROYW1lcywKICAgICAgICAgIGkgPSB7fS50b1N0cmluZywKICAgICAgICAgIHMgPSAib2JqZWN0IiA9PSAodHlwZW9mIHdpbmRvdyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yod2luZG93KSkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW10sCiAgICAgICAgICBhID0gZnVuY3Rpb24gYShlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBvKGUpOwogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgIHJldHVybiBzLnNsaWNlKCk7CiAgICAgICAgfQogICAgICB9O3QuZXhwb3J0cy5nZXQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBzICYmICJbb2JqZWN0IFdpbmRvd10iID09IGkuY2FsbChlKSA/IGEoZSkgOiBvKG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQudG8taW9iamVjdCI6IDc0IH1dLCA0MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gdC5leHBvcnRzID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoID8gd2luZG93IDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIHNlbGYgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oInJldHVybiB0aGlzIikoKTsibnVtYmVyIiA9PSB0eXBlb2YgX19nICYmIChfX2cgPSBuKTsKICAgIH0sIHt9XSwgNDI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IHt9Lmhhc093blByb3BlcnR5O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIG4uY2FsbChlLCB0KTsKICAgICAgfTsKICAgIH0sIHt9XSwgNDM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIik7dC5leHBvcnRzID0gZSgiLi8kLmRlc2NyaXB0b3JzIikgPyBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBuLnNldERlc2MoZSwgdCwgbygxLCByKSk7CiAgICAgIH0gOiBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIHJldHVybiBlW3RdID0gciwgZTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmRlc2NyaXB0b3JzIjogMzQsICIuLyQucHJvcGVydHktZGVzYyI6IDYxIH1dLCA0NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vJC5nbG9iYWwiKS5kb2N1bWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CiAgICB9LCB7ICIuLyQuZ2xvYmFsIjogNDEgfV0sIDQ1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICB2YXIgbiA9IHZvaWQgMCA9PT0gcjtzd2l0Y2ggKHQubGVuZ3RoKSB7Y2FzZSAwOgogICAgICAgICAgICByZXR1cm4gbiA/IGUoKSA6IGUuY2FsbChyKTtjYXNlIDE6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdKSA6IGUuY2FsbChyLCB0WzBdKTtjYXNlIDI6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdKTtjYXNlIDM6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdLCB0WzJdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdLCB0WzJdKTtjYXNlIDQ6CiAgICAgICAgICAgIHJldHVybiBuID8gZSh0WzBdLCB0WzFdLCB0WzJdLCB0WzNdKSA6IGUuY2FsbChyLCB0WzBdLCB0WzFdLCB0WzJdLCB0WzNdKTt9cmV0dXJuIGUuYXBwbHkociwgdCk7CiAgICAgIH07CiAgICB9LCB7fV0sIDQ2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIik7dC5leHBvcnRzID0gT2JqZWN0KCJ6IikucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiU3RyaW5nIiA9PSBuKGUpID8gZS5zcGxpdCgiIikgOiBPYmplY3QoZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAgfV0sIDQ3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaXRlcmF0b3JzIiksCiAgICAgICAgICBvID0gZSgiLi8kLndrcyIpKCJpdGVyYXRvciIpLAogICAgICAgICAgaSA9IEFycmF5LnByb3RvdHlwZTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUgJiYgKG4uQXJyYXkgPT09IGUgfHwgaVtvXSA9PT0gZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQud2tzIjogNzggfV0sIDQ4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuY29mIik7dC5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiQXJyYXkiID09IG4oZSk7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY29mIjogMzAgfV0sIDQ5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIm9iamVjdCIgPT0gKHR5cGVvZiBlID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihlKSkgPyBudWxsICE9PSBlIDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgZTsKICAgICAgfTsKICAgIH0sIHt9XSwgNTA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5hbi1vYmplY3QiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgciwgbykgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gbyA/IHQobihyKVswXSwgclsxXSkgOiB0KHIpOwogICAgICAgIH0gY2F0Y2ggKGkpIHsKICAgICAgICAgIHZhciBzID0gZVsicmV0dXJuIl07dGhyb3cgdm9pZCAwICE9PSBzICYmIG4ocy5jYWxsKGUpKSwgaTsKICAgICAgICB9CiAgICAgIH07CiAgICB9LCB7ICIuLyQuYW4tb2JqZWN0IjogMjggfV0sIDUxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vJCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBpID0gZSgiLi8kLnNldC10by1zdHJpbmctdGFnIiksCiAgICAgICAgICBzID0ge307ZSgiLi8kLmhpZGUiKShzLCBlKCIuLyQud2tzIikoIml0ZXJhdG9yIiksIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSksIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZS5wcm90b3R5cGUgPSBuLmNyZWF0ZShzLCB7IG5leHQ6IG8oMSwgcikgfSksIGkoZSwgdCArICIgSXRlcmF0b3IiKTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmhpZGUiOiA0MywgIi4vJC5wcm9wZXJ0eS1kZXNjIjogNjEsICIuLyQuc2V0LXRvLXN0cmluZy10YWciOiA2NywgIi4vJC53a3MiOiA3OCB9XSwgNTI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmxpYnJhcnkiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZXhwb3J0IiksCiAgICAgICAgICBpID0gZSgiLi8kLnJlZGVmaW5lIiksCiAgICAgICAgICBzID0gZSgiLi8kLmhpZGUiKSwKICAgICAgICAgIGEgPSBlKCIuLyQuaGFzIiksCiAgICAgICAgICBjID0gZSgiLi8kLml0ZXJhdG9ycyIpLAogICAgICAgICAgdSA9IGUoIi4vJC5pdGVyLWNyZWF0ZSIpLAogICAgICAgICAgbCA9IGUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpLAogICAgICAgICAgZiA9IGUoIi4vJCIpLmdldFByb3RvLAogICAgICAgICAgZCA9IGUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIHAgPSAhKFtdLmtleXMgJiYgIm5leHQiIGluIFtdLmtleXMoKSksCiAgICAgICAgICBiID0gIkBAaXRlcmF0b3IiLAogICAgICAgICAgaCA9ICJrZXlzIiwKICAgICAgICAgIHYgPSAidmFsdWVzIiwKICAgICAgICAgIHkgPSBmdW5jdGlvbiB5KCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9O3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByLCBfLCBnLCBtLCBqKSB7CiAgICAgICAgdShyLCB0LCBfKTt2YXIgJCwKICAgICAgICAgICAgTywKICAgICAgICAgICAgdyA9IGZ1bmN0aW9uIHcoZSkgewogICAgICAgICAgaWYgKCFwICYmIGUgaW4gRSkgcmV0dXJuIEVbZV07c3dpdGNoIChlKSB7Y2FzZSBoOgogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICAgICAgfTtjYXNlIHY6CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcih0aGlzLCBlKTsKICAgICAgICAgICAgICB9O31yZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IHIodGhpcywgZSk7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgICAgIGsgPSB0ICsgIiBJdGVyYXRvciIsCiAgICAgICAgICAgIHggPSBnID09IHYsCiAgICAgICAgICAgIEMgPSAhMSwKICAgICAgICAgICAgRSA9IGUucHJvdG90eXBlLAogICAgICAgICAgICBTID0gRVtkXSB8fCBFW2JdIHx8IGcgJiYgRVtnXSwKICAgICAgICAgICAgVCA9IFMgfHwgdyhnKTtpZiAoUykgewogICAgICAgICAgdmFyIE0gPSBmKFQuY2FsbChuZXcgZSgpKSk7bChNLCBrLCAhMCksICFuICYmIGEoRSwgYikgJiYgcyhNLCBkLCB5KSwgeCAmJiBTLm5hbWUgIT09IHYgJiYgKEMgPSAhMCwgVCA9IGZ1bmN0aW9uIFQoKSB7CiAgICAgICAgICAgIHJldHVybiBTLmNhbGwodGhpcyk7CiAgICAgICAgICB9KTsKICAgICAgICB9aWYgKG4gJiYgIWogfHwgIXAgJiYgIUMgJiYgRVtkXSB8fCBzKEUsIGQsIFQpLCBjW3RdID0gVCwgY1trXSA9IHksIGcpIGlmICgkID0geyB2YWx1ZXM6IHggPyBUIDogdyh2KSwga2V5czogbSA/IFQgOiB3KGgpLCBlbnRyaWVzOiB4ID8gdygiZW50cmllcyIpIDogVCB9LCBqKSBmb3IgKE8gaW4gJCkgewogICAgICAgICAgTyBpbiBFIHx8IGkoRSwgTywgJFtPXSk7CiAgICAgICAgfSBlbHNlIG8oby5QICsgby5GICogKHAgfHwgQyksIHQsICQpO3JldHVybiAkOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuZXhwb3J0IjogMzcsICIuLyQuaGFzIjogNDIsICIuLyQuaGlkZSI6IDQzLCAiLi8kLml0ZXItY3JlYXRlIjogNTEsICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQubGlicmFyeSI6IDU4LCAiLi8kLnJlZGVmaW5lIjogNjMsICIuLyQuc2V0LXRvLXN0cmluZy10YWciOiA2NywgIi4vJC53a3MiOiA3OCB9XSwgNTM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSwKICAgICAgICAgIG8gPSAhMTt0cnkgewogICAgICAgIHZhciBpID0gWzddW25dKCk7aVsicmV0dXJuIl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBvID0gITA7CiAgICAgICAgfSwgQXJyYXkuZnJvbShpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aHJvdyAyOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChzKSB7fXQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKCF0ICYmICFvKSByZXR1cm4gITE7dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgdmFyIGkgPSBbN10sCiAgICAgICAgICAgICAgcyA9IGlbbl0oKTtzLm5leHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHIgPSAhMDsKICAgICAgICAgIH0sIGlbbl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBzOwogICAgICAgICAgfSwgZShpKTsKICAgICAgICB9IGNhdGNoIChhKSB7fXJldHVybiByOwogICAgICB9OwogICAgfSwgeyAiLi8kLndrcyI6IDc4IH1dLCA1NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHQsIGRvbmU6ICEhZSB9OwogICAgICB9OwogICAgfSwge31dLCA1NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IHt9OwogICAgfSwge31dLCA1NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gT2JqZWN0O3QuZXhwb3J0cyA9IHsgY3JlYXRlOiBuLmNyZWF0ZSwgZ2V0UHJvdG86IG4uZ2V0UHJvdG90eXBlT2YsIGlzRW51bToge30ucHJvcGVydHlJc0VudW1lcmFibGUsIGdldERlc2M6IG4uZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLCBzZXREZXNjOiBuLmRlZmluZVByb3BlcnR5LCBzZXREZXNjczogbi5kZWZpbmVQcm9wZXJ0aWVzLCBnZXRLZXlzOiBuLmtleXMsIGdldE5hbWVzOiBuLmdldE93blByb3BlcnR5TmFtZXMsIGdldFN5bWJvbHM6IG4uZ2V0T3duUHJvcGVydHlTeW1ib2xzLCBlYWNoOiBbXS5mb3JFYWNoIH07CiAgICB9LCB7fV0sIDU3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQudG8taW9iamVjdCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgZm9yICh2YXIgciwgaSA9IG8oZSksIHMgPSBuLmdldEtleXMoaSksIGEgPSBzLmxlbmd0aCwgYyA9IDA7IGEgPiBjOykgewogICAgICAgICAgaWYgKGlbciA9IHNbYysrXV0gPT09IHQpIHJldHVybiByOwogICAgICAgIH0KICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLnRvLWlvYmplY3QiOiA3NCB9XSwgNTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSAhMDsKICAgIH0sIHt9XSwgNTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiwKICAgICAgICAgIG8sCiAgICAgICAgICBpLAogICAgICAgICAgcyA9IGUoIi4vJC5nbG9iYWwiKSwKICAgICAgICAgIGEgPSBlKCIuLyQudGFzayIpLnNldCwKICAgICAgICAgIGMgPSBzLk11dGF0aW9uT2JzZXJ2ZXIgfHwgcy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyLAogICAgICAgICAgdSA9IHMucHJvY2VzcywKICAgICAgICAgIGwgPSBzLlByb21pc2UsCiAgICAgICAgICBmID0gInByb2Nlc3MiID09IGUoIi4vJC5jb2YiKSh1KSwKICAgICAgICAgIGQgPSBmdW5jdGlvbiBkKCkgewogICAgICAgIHZhciBlLCB0LCByO2ZvciAoZiAmJiAoZSA9IHUuZG9tYWluKSAmJiAodS5kb21haW4gPSBudWxsLCBlLmV4aXQoKSk7IG47KSB7CiAgICAgICAgICB0ID0gbi5kb21haW4sIHIgPSBuLmZuLCB0ICYmIHQuZW50ZXIoKSwgcigpLCB0ICYmIHQuZXhpdCgpLCBuID0gbi5uZXh0OwogICAgICAgIH1vID0gdm9pZCAwLCBlICYmIGUuZW50ZXIoKTsKICAgICAgfTtpZiAoZikgaSA9IGZ1bmN0aW9uIGkoKSB7CiAgICAgICAgdS5uZXh0VGljayhkKTsKICAgICAgfTtlbHNlIGlmIChjKSB7CiAgICAgICAgdmFyIHAgPSAxLAogICAgICAgICAgICBiID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpO25ldyBjKGQpLm9ic2VydmUoYiwgeyBjaGFyYWN0ZXJEYXRhOiAhMCB9KSwgaSA9IGZ1bmN0aW9uIGkoKSB7CiAgICAgICAgICBiLmRhdGEgPSBwID0gLXA7CiAgICAgICAgfTsKICAgICAgfSBlbHNlIGkgPSBsICYmIGwucmVzb2x2ZSA/IGZ1bmN0aW9uICgpIHsKICAgICAgICBsLnJlc29sdmUoKS50aGVuKGQpOwogICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgIGEuY2FsbChzLCBkKTsKICAgICAgfTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0geyBmbjogZSwgbmV4dDogdm9pZCAwLCBkb21haW46IGYgJiYgdS5kb21haW4gfTtvICYmIChvLm5leHQgPSB0KSwgbiB8fCAobiA9IHQsIGkoKSksIG8gPSB0OwogICAgICB9OwogICAgfSwgeyAiLi8kLmNvZiI6IDMwLCAiLi8kLmdsb2JhbCI6IDQxLCAiLi8kLnRhc2siOiA3MiB9XSwgNjA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5leHBvcnQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuY29yZSIpLAogICAgICAgICAgaSA9IGUoIi4vJC5mYWlscyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgdmFyIHIgPSAoby5PYmplY3QgfHwge30pW2VdIHx8IE9iamVjdFtlXSwKICAgICAgICAgICAgcyA9IHt9O3NbZV0gPSB0KHIpLCBuKG4uUyArIG4uRiAqIGkoZnVuY3Rpb24gKCkgewogICAgICAgICAgcigxKTsKICAgICAgICB9KSwgIk9iamVjdCIsIHMpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmNvcmUiOiAzMSwgIi4vJC5leHBvcnQiOiAzNywgIi4vJC5mYWlscyI6IDM4IH1dLCA2MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIHsgZW51bWVyYWJsZTogISgxICYgZSksIGNvbmZpZ3VyYWJsZTogISgyICYgZSksIHdyaXRhYmxlOiAhKDQgJiBlKSwgdmFsdWU6IHQgfTsKICAgICAgfTsKICAgIH0sIHt9XSwgNjI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5yZWRlZmluZSIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgZm9yICh2YXIgciBpbiB0KSB7CiAgICAgICAgICBuKGUsIHIsIHRbcl0pOwogICAgICAgIH1yZXR1cm4gZTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5yZWRlZmluZSI6IDYzIH1dLCA2MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IGUoIi4vJC5oaWRlIik7CiAgICB9LCB7ICIuLyQuaGlkZSI6IDQzIH1dLCA2NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHQuZXhwb3J0cyA9IE9iamVjdC5pcyB8fCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiBlID09PSB0ID8gMCAhPT0gZSB8fCAxIC8gZSA9PT0gMSAvIHQgOiBlICE9IGUgJiYgdCAhPSB0OwogICAgICB9OwogICAgfSwge31dLCA2NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kIikuZ2V0RGVzYywKICAgICAgICAgIG8gPSBlKCIuLyQuaXMtb2JqZWN0IiksCiAgICAgICAgICBpID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgcyA9IGZ1bmN0aW9uIHMoZSwgdCkgewogICAgICAgIGlmIChpKGUpLCAhbyh0KSAmJiBudWxsICE9PSB0KSB0aHJvdyBUeXBlRXJyb3IodCArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7CiAgICAgIH07dC5leHBvcnRzID0geyBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoIl9fcHJvdG9fXyIgaW4ge30gPyBmdW5jdGlvbiAodCwgciwgbykgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbyA9IGUoIi4vJC5jdHgiKShGdW5jdGlvbi5jYWxsLCBuKE9iamVjdC5wcm90b3R5cGUsICJfX3Byb3RvX18iKS5zZXQsIDIpLCBvKHQsIFtdKSwgciA9ICEodCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgICAgIH0gY2F0Y2ggKGkpIHsKICAgICAgICAgICAgciA9ICEwOwogICAgICAgICAgfXJldHVybiBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICByZXR1cm4gcyhlLCB0KSwgciA/IGUuX19wcm90b19fID0gdCA6IG8oZSwgdCksIGU7CiAgICAgICAgICB9OwogICAgICAgIH0oe30sICExKSA6IHZvaWQgMCksIGNoZWNrOiBzIH07CiAgICB9LCB7ICIuLyQiOiA1NiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5pcy1vYmplY3QiOiA0OSB9XSwgNjY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmNvcmUiKSwKICAgICAgICAgIG8gPSBlKCIuLyQiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuZGVzY3JpcHRvcnMiKSwKICAgICAgICAgIHMgPSBlKCIuLyQud2tzIikoInNwZWNpZXMiKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0gbltlXTtpICYmIHQgJiYgIXRbc10gJiYgby5zZXREZXNjKHQsIHMsIHsgY29uZmlndXJhYmxlOiAhMCwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgfSB9KTsKICAgICAgfTsKICAgIH0sIHsgIi4vJCI6IDU2LCAiLi8kLmNvcmUiOiAzMSwgIi4vJC5kZXNjcmlwdG9ycyI6IDM0LCAiLi8kLndrcyI6IDc4IH1dLCA2NzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kIikuc2V0RGVzYywKICAgICAgICAgIG8gPSBlKCIuLyQuaGFzIiksCiAgICAgICAgICBpID0gZSgiLi8kLndrcyIpKCJ0b1N0cmluZ1RhZyIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICAgZSAmJiAhbyhlID0gciA/IGUgOiBlLnByb3RvdHlwZSwgaSkgJiYgbihlLCBpLCB7IGNvbmZpZ3VyYWJsZTogITAsIHZhbHVlOiB0IH0pOwogICAgICB9OwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuaGFzIjogNDIsICIuLyQud2tzIjogNzggfV0sIDY4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBvID0gIl9fY29yZS1qc19zaGFyZWRfXyIsCiAgICAgICAgICBpID0gbltvXSB8fCAobltvXSA9IHt9KTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBpW2VdIHx8IChpW2VdID0ge30pOwogICAgICB9OwogICAgfSwgeyAiLi8kLmdsb2JhbCI6IDQxIH1dLCA2OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmFuLW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5hLWZ1bmN0aW9uIiksCiAgICAgICAgICBpID0gZSgiLi8kLndrcyIpKCJzcGVjaWVzIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB2YXIgciwKICAgICAgICAgICAgcyA9IG4oZSkuY29uc3RydWN0b3I7cmV0dXJuIHZvaWQgMCA9PT0gcyB8fCB2b2lkIDAgPT0gKHIgPSBuKHMpW2ldKSA/IHQgOiBvKHIpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmEtZnVuY3Rpb24iOiAyNiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC53a3MiOiA3OCB9XSwgNzA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiB0KSkgdGhyb3cgVHlwZUVycm9yKHIgKyAiOiB1c2UgdGhlICduZXcnIG9wZXJhdG9yISIpO3JldHVybiBlOwogICAgICB9OwogICAgfSwge31dLCA3MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZGVmaW5lZCIpO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0LCByKSB7CiAgICAgICAgICB2YXIgaSwKICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgIGEgPSBTdHJpbmcobyh0KSksCiAgICAgICAgICAgICAgYyA9IG4ociksCiAgICAgICAgICAgICAgdSA9IGEubGVuZ3RoO3JldHVybiAwID4gYyB8fCBjID49IHUgPyBlID8gIiIgOiB2b2lkIDAgOiAoaSA9IGEuY2hhckNvZGVBdChjKSwgNTUyOTYgPiBpIHx8IGkgPiA1NjMxOSB8fCBjICsgMSA9PT0gdSB8fCAocyA9IGEuY2hhckNvZGVBdChjICsgMSkpIDwgNTYzMjAgfHwgcyA+IDU3MzQzID8gZSA/IGEuY2hhckF0KGMpIDogaSA6IGUgPyBhLnNsaWNlKGMsIGMgKyAyKSA6IChpIC0gNTUyOTYgPDwgMTApICsgKHMgLSA1NjMyMCkgKyA2NTUzNik7CiAgICAgICAgfTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5kZWZpbmVkIjogMzMsICIuLyQudG8taW50ZWdlciI6IDczIH1dLCA3MjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICBzID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgYSA9IGUoIi4vJC5pbnZva2UiKSwKICAgICAgICAgIGMgPSBlKCIuLyQuaHRtbCIpLAogICAgICAgICAgdSA9IGUoIi4vJC5kb20tY3JlYXRlIiksCiAgICAgICAgICBsID0gZSgiLi8kLmdsb2JhbCIpLAogICAgICAgICAgZiA9IGwucHJvY2VzcywKICAgICAgICAgIGQgPSBsLnNldEltbWVkaWF0ZSwKICAgICAgICAgIHAgPSBsLmNsZWFySW1tZWRpYXRlLAogICAgICAgICAgYiA9IGwuTWVzc2FnZUNoYW5uZWwsCiAgICAgICAgICBoID0gMCwKICAgICAgICAgIHYgPSB7fSwKICAgICAgICAgIHkgPSAib25yZWFkeXN0YXRlY2hhbmdlIiwKICAgICAgICAgIF8gPSBmdW5jdGlvbiBfKCkgewogICAgICAgIHZhciBlID0gK3RoaXM7aWYgKHYuaGFzT3duUHJvcGVydHkoZSkpIHsKICAgICAgICAgIHZhciB0ID0gdltlXTtkZWxldGUgdltlXSwgdCgpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIGcgPSBmdW5jdGlvbiBnKGUpIHsKICAgICAgICBfLmNhbGwoZS5kYXRhKTsKICAgICAgfTtkICYmIHAgfHwgKGQgPSBmdW5jdGlvbiBkKGUpIHsKICAgICAgICBmb3IgKHZhciB0ID0gW10sIHIgPSAxOyBhcmd1bWVudHMubGVuZ3RoID4gcjspIHsKICAgICAgICAgIHQucHVzaChhcmd1bWVudHNbcisrXSk7CiAgICAgICAgfXJldHVybiB2WysraF0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBhKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgPyBlIDogRnVuY3Rpb24oZSksIHQpOwogICAgICAgIH0sIG4oaCksIGg7CiAgICAgIH0sIHAgPSBmdW5jdGlvbiBwKGUpIHsKICAgICAgICBkZWxldGUgdltlXTsKICAgICAgfSwgInByb2Nlc3MiID09IGUoIi4vJC5jb2YiKShmKSA/IG4gPSBmdW5jdGlvbiBuKGUpIHsKICAgICAgICBmLm5leHRUaWNrKHMoXywgZSwgMSkpOwogICAgICB9IDogYiA/IChvID0gbmV3IGIoKSwgaSA9IG8ucG9ydDIsIG8ucG9ydDEub25tZXNzYWdlID0gZywgbiA9IHMoaS5wb3N0TWVzc2FnZSwgaSwgMSkpIDogbC5hZGRFdmVudExpc3RlbmVyICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHBvc3RNZXNzYWdlICYmICFsLmltcG9ydFNjcmlwdHMgPyAobiA9IGZ1bmN0aW9uIG4oZSkgewogICAgICAgIGwucG9zdE1lc3NhZ2UoZSArICIiLCAiKiIpOwogICAgICB9LCBsLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBnLCAhMSkpIDogbiA9IHkgaW4gdSgic2NyaXB0IikgPyBmdW5jdGlvbiAoZSkgewogICAgICAgIGMuYXBwZW5kQ2hpbGQodSgic2NyaXB0IikpW3ldID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgYy5yZW1vdmVDaGlsZCh0aGlzKSwgXy5jYWxsKGUpOwogICAgICAgIH07CiAgICAgIH0gOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHNldFRpbWVvdXQocyhfLCBlLCAxKSwgMCk7CiAgICAgIH0pLCB0LmV4cG9ydHMgPSB7IHNldDogZCwgY2xlYXI6IHAgfTsKICAgIH0sIHsgIi4vJC5jb2YiOiAzMCwgIi4vJC5jdHgiOiAzMiwgIi4vJC5kb20tY3JlYXRlIjogMzUsICIuLyQuZ2xvYmFsIjogNDEsICIuLyQuaHRtbCI6IDQ0LCAiLi8kLmludm9rZSI6IDQ1IH1dLCA3MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gTWF0aC5jZWlsLAogICAgICAgICAgbyA9IE1hdGguZmxvb3I7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gaXNOYU4oZSA9ICtlKSA/IDAgOiAoZSA+IDAgPyBvIDogbikoZSk7CiAgICAgIH07CiAgICB9LCB7fV0sIDc0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuaW9iamVjdCIpLAogICAgICAgICAgbyA9IGUoIi4vJC5kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbihvKGUpKTsKICAgICAgfTsKICAgIH0sIHsgIi4vJC5kZWZpbmVkIjogMzMsICIuLyQuaW9iamVjdCI6IDQ2IH1dLCA3NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWludGVnZXIiKSwKICAgICAgICAgIG8gPSBNYXRoLm1pbjt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlID4gMCA/IG8obihlKSwgOTAwNzE5OTI1NDc0MDk5MSkgOiAwOwogICAgICB9OwogICAgfSwgeyAiLi8kLnRvLWludGVnZXIiOiA3MyB9XSwgNzY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC5kZWZpbmVkIik7dC5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gT2JqZWN0KG4oZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmRlZmluZWQiOiAzMyB9XSwgNzc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IDAsCiAgICAgICAgICBvID0gTWF0aC5yYW5kb20oKTt0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAiU3ltYm9sKCIuY29uY2F0KHZvaWQgMCA9PT0gZSA/ICIiIDogZSwgIilfIiwgKCsrbiArIG8pLnRvU3RyaW5nKDM2KSk7CiAgICAgIH07CiAgICB9LCB7fV0sIDc4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuc2hhcmVkIikoIndrcyIpLAogICAgICAgICAgbyA9IGUoIi4vJC51aWQiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuZ2xvYmFsIikuU3ltYm9sO3QuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIG5bZV0gfHwgKG5bZV0gPSBpICYmIGlbZV0gfHwgKGkgfHwgbykoIlN5bWJvbC4iICsgZSkpOwogICAgICB9OwogICAgfSwgeyAiLi8kLmdsb2JhbCI6IDQxLCAiLi8kLnNoYXJlZCI6IDY4LCAiLi8kLnVpZCI6IDc3IH1dLCA3OTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLmNsYXNzb2YiKSwKICAgICAgICAgIG8gPSBlKCIuLyQud2tzIikoIml0ZXJhdG9yIiksCiAgICAgICAgICBpID0gZSgiLi8kLml0ZXJhdG9ycyIpO3QuZXhwb3J0cyA9IGUoIi4vJC5jb3JlIikuZ2V0SXRlcmF0b3JNZXRob2QgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiB2b2lkIDAgIT0gZSA/IGVbb10gfHwgZVsiQEBpdGVyYXRvciJdIHx8IGlbbihlKV0gOiB2b2lkIDA7CiAgICAgIH07CiAgICB9LCB7ICIuLyQuY2xhc3NvZiI6IDI5LCAiLi8kLmNvcmUiOiAzMSwgIi4vJC5pdGVyYXRvcnMiOiA1NSwgIi4vJC53a3MiOiA3OCB9XSwgODA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIHZhciBuID0gZSgiLi8kLmFkZC10by11bnNjb3BhYmxlcyIpLAogICAgICAgICAgbyA9IGUoIi4vJC5pdGVyLXN0ZXAiKSwKICAgICAgICAgIGkgPSBlKCIuLyQuaXRlcmF0b3JzIiksCiAgICAgICAgICBzID0gZSgiLi8kLnRvLWlvYmplY3QiKTt0LmV4cG9ydHMgPSBlKCIuLyQuaXRlci1kZWZpbmUiKShBcnJheSwgIkFycmF5IiwgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICB0aGlzLl90ID0gcyhlKSwgdGhpcy5faSA9IDAsIHRoaXMuX2sgPSB0OwogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUgPSB0aGlzLl90LAogICAgICAgICAgICB0ID0gdGhpcy5faywKICAgICAgICAgICAgciA9IHRoaXMuX2krKztyZXR1cm4gIWUgfHwgciA+PSBlLmxlbmd0aCA/ICh0aGlzLl90ID0gdm9pZCAwLCBvKDEpKSA6ICJrZXlzIiA9PSB0ID8gbygwLCByKSA6ICJ2YWx1ZXMiID09IHQgPyBvKDAsIGVbcl0pIDogbygwLCBbciwgZVtyXV0pOwogICAgICB9LCAidmFsdWVzIiksIGkuQXJndW1lbnRzID0gaS5BcnJheSwgbigia2V5cyIpLCBuKCJ2YWx1ZXMiKSwgbigiZW50cmllcyIpOwogICAgfSwgeyAiLi8kLmFkZC10by11bnNjb3BhYmxlcyI6IDI3LCAiLi8kLml0ZXItZGVmaW5lIjogNTIsICIuLyQuaXRlci1zdGVwIjogNTQsICIuLyQuaXRlcmF0b3JzIjogNTUsICIuLyQudG8taW9iamVjdCI6IDc0IH1dLCA4MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgIHZhciBuID0gZSgiLi8kLnRvLWlvYmplY3QiKTtlKCIuLyQub2JqZWN0LXNhcCIpKCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBmdW5jdGlvbiAodCwgcikgewogICAgICAgICAgcmV0dXJuIGUobih0KSwgcik7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9LCB7ICIuLyQub2JqZWN0LXNhcCI6IDYwLCAiLi8kLnRvLWlvYmplY3QiOiA3NCB9XSwgODI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICB2YXIgbiA9IGUoIi4vJC50by1vYmplY3QiKTtlKCIuLyQub2JqZWN0LXNhcCIpKCJnZXRQcm90b3R5cGVPZiIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICByZXR1cm4gZShuKHQpKTsKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5vYmplY3Qtc2FwIjogNjAsICIuLyQudG8tb2JqZWN0IjogNzYgfV0sIDgzOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQudG8tb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgia2V5cyIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICByZXR1cm4gZShuKHQpKTsKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5vYmplY3Qtc2FwIjogNjAsICIuLyQudG8tb2JqZWN0IjogNzYgfV0sIDg0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgdmFyIG4gPSBlKCIuLyQuZXhwb3J0Iik7bihuLlMsICJPYmplY3QiLCB7IHNldFByb3RvdHlwZU9mOiBlKCIuLyQuc2V0LXByb3RvIikuc2V0IH0pOwogICAgfSwgeyAiLi8kLmV4cG9ydCI6IDM3LCAiLi8kLnNldC1wcm90byI6IDY1IH1dLCA4NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7fSwge31dLCA4NjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4sCiAgICAgICAgICBvID0gZSgiLi8kIiksCiAgICAgICAgICBpID0gZSgiLi8kLmxpYnJhcnkiKSwKICAgICAgICAgIHMgPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBhID0gZSgiLi8kLmN0eCIpLAogICAgICAgICAgYyA9IGUoIi4vJC5jbGFzc29mIiksCiAgICAgICAgICB1ID0gZSgiLi8kLmV4cG9ydCIpLAogICAgICAgICAgbCA9IGUoIi4vJC5pcy1vYmplY3QiKSwKICAgICAgICAgIGYgPSBlKCIuLyQuYW4tb2JqZWN0IiksCiAgICAgICAgICBkID0gZSgiLi8kLmEtZnVuY3Rpb24iKSwKICAgICAgICAgIHAgPSBlKCIuLyQuc3RyaWN0LW5ldyIpLAogICAgICAgICAgYiA9IGUoIi4vJC5mb3Itb2YiKSwKICAgICAgICAgIGggPSBlKCIuLyQuc2V0LXByb3RvIikuc2V0LAogICAgICAgICAgdiA9IGUoIi4vJC5zYW1lLXZhbHVlIiksCiAgICAgICAgICB5ID0gZSgiLi8kLndrcyIpKCJzcGVjaWVzIiksCiAgICAgICAgICBfID0gZSgiLi8kLnNwZWNpZXMtY29uc3RydWN0b3IiKSwKICAgICAgICAgIGcgPSBlKCIuLyQubWljcm90YXNrIiksCiAgICAgICAgICBtID0gIlByb21pc2UiLAogICAgICAgICAgaiA9IHMucHJvY2VzcywKICAgICAgICAgICQgPSAicHJvY2VzcyIgPT0gYyhqKSwKICAgICAgICAgIF9PID0gc1ttXSwKICAgICAgICAgIHcgPSBmdW5jdGlvbiB3KGUpIHsKICAgICAgICB2YXIgdCA9IG5ldyBfTyhmdW5jdGlvbiAoKSB7fSk7cmV0dXJuIGUgJiYgKHQuY29uc3RydWN0b3IgPSBPYmplY3QpLCBfTy5yZXNvbHZlKHQpID09PSB0OwogICAgICB9LAogICAgICAgICAgayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiB0KGUpIHsKICAgICAgICAgIHZhciByID0gbmV3IF9PKGUpO3JldHVybiBoKHIsIHQucHJvdG90eXBlKSwgcjsKICAgICAgICB9dmFyIHIgPSAhMTt0cnkgewogICAgICAgICAgaWYgKHIgPSBfTyAmJiBfTy5yZXNvbHZlICYmIHcoKSwgaCh0LCBfTyksIHQucHJvdG90eXBlID0gby5jcmVhdGUoX08ucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiB0IH0gfSksIHQucmVzb2x2ZSg1KS50aGVuKGZ1bmN0aW9uICgpIHt9KSBpbnN0YW5jZW9mIHQgfHwgKHIgPSAhMSksIHIgJiYgZSgiLi8kLmRlc2NyaXB0b3JzIikpIHsKICAgICAgICAgICAgdmFyIG4gPSAhMTtfTy5yZXNvbHZlKG8uc2V0RGVzYyh7fSwgInRoZW4iLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICAgICAgbiA9ICEwOwogICAgICAgICAgICAgIH0gfSkpLCByID0gbjsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChpKSB7CiAgICAgICAgICByID0gITE7CiAgICAgICAgfXJldHVybiByOwogICAgICB9KCksCiAgICAgICAgICB4ID0gZnVuY3Rpb24geChlLCB0KSB7CiAgICAgICAgcmV0dXJuIGkgJiYgZSA9PT0gX08gJiYgdCA9PT0gbiA/ICEwIDogdihlLCB0KTsKICAgICAgfSwKICAgICAgICAgIEMgPSBmdW5jdGlvbiBDKGUpIHsKICAgICAgICB2YXIgdCA9IGYoZSlbeV07cmV0dXJuIHZvaWQgMCAhPSB0ID8gdCA6IGU7CiAgICAgIH0sCiAgICAgICAgICBFID0gZnVuY3Rpb24gRShlKSB7CiAgICAgICAgdmFyIHQ7cmV0dXJuIGwoZSkgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgKHQgPSBlLnRoZW4pID8gdCA6ICExOwogICAgICB9LAogICAgICAgICAgUyA9IGZ1bmN0aW9uIFMoZSkgewogICAgICAgIHZhciB0LCByO3RoaXMucHJvbWlzZSA9IG5ldyBlKGZ1bmN0aW9uIChlLCBuKSB7CiAgICAgICAgICBpZiAodm9pZCAwICE9PSB0IHx8IHZvaWQgMCAhPT0gcikgdGhyb3cgVHlwZUVycm9yKCJCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvciIpO3QgPSBlLCByID0gbjsKICAgICAgICB9KSwgdGhpcy5yZXNvbHZlID0gZCh0KSwgdGhpcy5yZWplY3QgPSBkKHIpOwogICAgICB9LAogICAgICAgICAgVCA9IGZ1bmN0aW9uIFQoZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBlKCk7CiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgcmV0dXJuIHsgZXJyb3I6IHQgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBNID0gZnVuY3Rpb24gTShlLCB0KSB7CiAgICAgICAgaWYgKCFlLm4pIHsKICAgICAgICAgIGUubiA9ICEwO3ZhciByID0gZS5jO2coZnVuY3Rpb24gKCkgewogICAgICAgICAgICBmb3IgKHZhciBuID0gZS52LCBvID0gMSA9PSBlLnMsIGkgPSAwLCBhID0gZnVuY3Rpb24gYSh0KSB7CiAgICAgICAgICAgICAgdmFyIHIsCiAgICAgICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgICAgIHMgPSBvID8gdC5vayA6IHQuZmFpbCwKICAgICAgICAgICAgICAgICAgYSA9IHQucmVzb2x2ZSwKICAgICAgICAgICAgICAgICAgYyA9IHQucmVqZWN0O3RyeSB7CiAgICAgICAgICAgICAgICBzID8gKG8gfHwgKGUuaCA9ICEwKSwgciA9IHMgPT09ICEwID8gbiA6IHMobiksIHIgPT09IHQucHJvbWlzZSA/IGMoVHlwZUVycm9yKCJQcm9taXNlLWNoYWluIGN5Y2xlIikpIDogKGkgPSBFKHIpKSA/IGkuY2FsbChyLCBhLCBjKSA6IGEocikpIDogYyhuKTsKICAgICAgICAgICAgICB9IGNhdGNoICh1KSB7CiAgICAgICAgICAgICAgICBjKHUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsgci5sZW5ndGggPiBpOykgewogICAgICAgICAgICAgIGEocltpKytdKTsKICAgICAgICAgICAgfXIubGVuZ3RoID0gMCwgZS5uID0gITEsIHQgJiYgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIHQsCiAgICAgICAgICAgICAgICAgIHIsCiAgICAgICAgICAgICAgICAgIG8gPSBlLnA7TihvKSAmJiAoJCA/IGouZW1pdCgidW5oYW5kbGVkUmVqZWN0aW9uIiwgbiwgbykgOiAodCA9IHMub251bmhhbmRsZWRyZWplY3Rpb24pID8gdCh7IHByb21pc2U6IG8sIHJlYXNvbjogbiB9KSA6IChyID0gcy5jb25zb2xlKSAmJiByLmVycm9yICYmIHIuZXJyb3IoIlVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbiIsIG4pKSwgZS5hID0gdm9pZCAwOwogICAgICAgICAgICB9LCAxKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIE4gPSBmdW5jdGlvbiBOKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IGUuX2QsCiAgICAgICAgICAgIG4gPSByLmEgfHwgci5jLAogICAgICAgICAgICBvID0gMDtpZiAoci5oKSByZXR1cm4gITE7Zm9yICg7IG4ubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGlmICh0ID0gbltvKytdLCB0LmZhaWwgfHwgIU4odC5wcm9taXNlKSkgcmV0dXJuICExOwogICAgICAgIH1yZXR1cm4gITA7CiAgICAgIH0sCiAgICAgICAgICBSID0gZnVuY3Rpb24gUihlKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzO3QuZCB8fCAodC5kID0gITAsIHQgPSB0LnIgfHwgdCwgdC52ID0gZSwgdC5zID0gMiwgdC5hID0gdC5jLnNsaWNlKCksIE0odCwgITApKTsKICAgICAgfSwKICAgICAgICAgIEQgPSBmdW5jdGlvbiBEKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgciA9IHRoaXM7aWYgKCFyLmQpIHsKICAgICAgICAgIHIuZCA9ICEwLCByID0gci5yIHx8IHI7dHJ5IHsKICAgICAgICAgICAgaWYgKHIucCA9PT0gZSkgdGhyb3cgVHlwZUVycm9yKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOyh0ID0gRShlKSkgPyBnKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHsgcjogciwgZDogITEgfTt0cnkgewogICAgICAgICAgICAgICAgdC5jYWxsKGUsIGEoRCwgbiwgMSksIGEoUiwgbiwgMSkpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKG8pIHsKICAgICAgICAgICAgICAgIFIuY2FsbChuLCBvKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pIDogKHIudiA9IGUsIHIucyA9IDEsIE0ociwgITEpKTsKICAgICAgICAgIH0gY2F0Y2ggKG4pIHsKICAgICAgICAgICAgUi5jYWxsKHsgcjogciwgZDogITEgfSwgbik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9O2sgfHwgKF9PID0gZnVuY3Rpb24gTyhlKSB7CiAgICAgICAgZChlKTt2YXIgdCA9IHRoaXMuX2QgPSB7IHA6IHAodGhpcywgX08sIG0pLCBjOiBbXSwgYTogdm9pZCAwLCBzOiAwLCBkOiAhMSwgdjogdm9pZCAwLCBoOiAhMSwgbjogITEgfTt0cnkgewogICAgICAgICAgZShhKEQsIHQsIDEpLCBhKFIsIHQsIDEpKTsKICAgICAgICB9IGNhdGNoIChyKSB7CiAgICAgICAgICBSLmNhbGwodCwgcik7CiAgICAgICAgfQogICAgICB9LCBlKCIuLyQucmVkZWZpbmUtYWxsIikoX08ucHJvdG90eXBlLCB7IHRoZW46IGZ1bmN0aW9uIHRoZW4oZSwgdCkgewogICAgICAgICAgdmFyIHIgPSBuZXcgUyhfKHRoaXMsIF9PKSksCiAgICAgICAgICAgICAgbiA9IHIucHJvbWlzZSwKICAgICAgICAgICAgICBvID0gdGhpcy5fZDtyZXR1cm4gci5vayA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgPyBlIDogITAsIHIuZmFpbCA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgJiYgdCwgby5jLnB1c2gociksIG8uYSAmJiBvLmEucHVzaChyKSwgby5zICYmIE0obywgITEpLCBuOwogICAgICAgIH0sICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaChlKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgZSk7CiAgICAgICAgfSB9KSksIHUodS5HICsgdS5XICsgdS5GICogIWssIHsgUHJvbWlzZTogX08gfSksIGUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpKF9PLCBtKSwgZSgiLi8kLnNldC1zcGVjaWVzIikobSksIG4gPSBlKCIuLyQuY29yZSIpW21dLCB1KHUuUyArIHUuRiAqICFrLCBtLCB7IHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KGUpIHsKICAgICAgICAgIHZhciB0ID0gbmV3IFModGhpcyksCiAgICAgICAgICAgICAgciA9IHQucmVqZWN0O3JldHVybiByKGUpLCB0LnByb21pc2U7CiAgICAgICAgfSB9KSwgdSh1LlMgKyB1LkYgKiAoIWsgfHwgdyghMCkpLCBtLCB7IHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoZSkgewogICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBfTyAmJiB4KGUuY29uc3RydWN0b3IsIHRoaXMpKSByZXR1cm4gZTt2YXIgdCA9IG5ldyBTKHRoaXMpLAogICAgICAgICAgICAgIHIgPSB0LnJlc29sdmU7cmV0dXJuIHIoZSksIHQucHJvbWlzZTsKICAgICAgICB9IH0pLCB1KHUuUyArIHUuRiAqICEoayAmJiBlKCIuLyQuaXRlci1kZXRlY3QiKShmdW5jdGlvbiAoZSkgewogICAgICAgIF9PLmFsbChlKVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7fSk7CiAgICAgIH0pKSwgbSwgeyBhbGw6IGZ1bmN0aW9uIGFsbChlKSB7CiAgICAgICAgICB2YXIgdCA9IEModGhpcyksCiAgICAgICAgICAgICAgciA9IG5ldyBTKHQpLAogICAgICAgICAgICAgIG4gPSByLnJlc29sdmUsCiAgICAgICAgICAgICAgaSA9IHIucmVqZWN0LAogICAgICAgICAgICAgIHMgPSBbXSwKICAgICAgICAgICAgICBhID0gVChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGIoZSwgITEsIHMucHVzaCwgcyk7dmFyIHIgPSBzLmxlbmd0aCwKICAgICAgICAgICAgICAgIGEgPSBBcnJheShyKTtyID8gby5lYWNoLmNhbGwocywgZnVuY3Rpb24gKGUsIG8pIHsKICAgICAgICAgICAgICB2YXIgcyA9ICExO3QucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBzIHx8IChzID0gITAsIGFbb10gPSBlLCAtLXIgfHwgbihhKSk7CiAgICAgICAgICAgICAgfSwgaSk7CiAgICAgICAgICAgIH0pIDogbihhKTsKICAgICAgICAgIH0pO3JldHVybiBhICYmIGkoYS5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9LCByYWNlOiBmdW5jdGlvbiByYWNlKGUpIHsKICAgICAgICAgIHZhciB0ID0gQyh0aGlzKSwKICAgICAgICAgICAgICByID0gbmV3IFModCksCiAgICAgICAgICAgICAgbiA9IHIucmVqZWN0LAogICAgICAgICAgICAgIG8gPSBUKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgYihlLCAhMSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB0LnJlc29sdmUoZSkudGhlbihyLnJlc29sdmUsIG4pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pO3JldHVybiBvICYmIG4oby5lcnJvciksIHIucHJvbWlzZTsKICAgICAgICB9IH0pOwogICAgfSwgeyAiLi8kIjogNTYsICIuLyQuYS1mdW5jdGlvbiI6IDI2LCAiLi8kLmFuLW9iamVjdCI6IDI4LCAiLi8kLmNsYXNzb2YiOiAyOSwgIi4vJC5jb3JlIjogMzEsICIuLyQuY3R4IjogMzIsICIuLyQuZGVzY3JpcHRvcnMiOiAzNCwgIi4vJC5leHBvcnQiOiAzNywgIi4vJC5mb3Itb2YiOiAzOSwgIi4vJC5nbG9iYWwiOiA0MSwgIi4vJC5pcy1vYmplY3QiOiA0OSwgIi4vJC5pdGVyLWRldGVjdCI6IDUzLCAiLi8kLmxpYnJhcnkiOiA1OCwgIi4vJC5taWNyb3Rhc2siOiA1OSwgIi4vJC5yZWRlZmluZS1hbGwiOiA2MiwgIi4vJC5zYW1lLXZhbHVlIjogNjQsICIuLyQuc2V0LXByb3RvIjogNjUsICIuLyQuc2V0LXNwZWNpZXMiOiA2NiwgIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6IDY3LCAiLi8kLnNwZWNpZXMtY29uc3RydWN0b3IiOiA2OSwgIi4vJC5zdHJpY3QtbmV3IjogNzAsICIuLyQud2tzIjogNzggfV0sIDg3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICB2YXIgbiA9IGUoIi4vJC5zdHJpbmctYXQiKSghMCk7ZSgiLi8kLml0ZXItZGVmaW5lIikoU3RyaW5nLCAiU3RyaW5nIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB0aGlzLl90ID0gU3RyaW5nKGUpLCB0aGlzLl9pID0gMDsKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBlLAogICAgICAgICAgICB0ID0gdGhpcy5fdCwKICAgICAgICAgICAgciA9IHRoaXMuX2k7cmV0dXJuIHIgPj0gdC5sZW5ndGggPyB7IHZhbHVlOiB2b2lkIDAsIGRvbmU6ICEwIH0gOiAoZSA9IG4odCwgciksIHRoaXMuX2kgKz0gZS5sZW5ndGgsIHsgdmFsdWU6IGUsIGRvbmU6ICExIH0pOwogICAgICB9KTsKICAgIH0sIHsgIi4vJC5pdGVyLWRlZmluZSI6IDUyLCAiLi8kLnN0cmluZy1hdCI6IDcxIH1dLCA4ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgdmFyIG4gPSBlKCIuLyQiKSwKICAgICAgICAgIG8gPSBlKCIuLyQuZ2xvYmFsIiksCiAgICAgICAgICBpID0gZSgiLi8kLmhhcyIpLAogICAgICAgICAgcyA9IGUoIi4vJC5kZXNjcmlwdG9ycyIpLAogICAgICAgICAgYSA9IGUoIi4vJC5leHBvcnQiKSwKICAgICAgICAgIGMgPSBlKCIuLyQucmVkZWZpbmUiKSwKICAgICAgICAgIHUgPSBlKCIuLyQuZmFpbHMiKSwKICAgICAgICAgIGwgPSBlKCIuLyQuc2hhcmVkIiksCiAgICAgICAgICBmID0gZSgiLi8kLnNldC10by1zdHJpbmctdGFnIiksCiAgICAgICAgICBkID0gZSgiLi8kLnVpZCIpLAogICAgICAgICAgcCA9IGUoIi4vJC53a3MiKSwKICAgICAgICAgIGIgPSBlKCIuLyQua2V5b2YiKSwKICAgICAgICAgIGggPSBlKCIuLyQuZ2V0LW5hbWVzIiksCiAgICAgICAgICB2ID0gZSgiLi8kLmVudW0ta2V5cyIpLAogICAgICAgICAgeSA9IGUoIi4vJC5pcy1hcnJheSIpLAogICAgICAgICAgXyA9IGUoIi4vJC5hbi1vYmplY3QiKSwKICAgICAgICAgIGcgPSBlKCIuLyQudG8taW9iamVjdCIpLAogICAgICAgICAgbSA9IGUoIi4vJC5wcm9wZXJ0eS1kZXNjIiksCiAgICAgICAgICBqID0gbi5nZXREZXNjLAogICAgICAgICAgJCA9IG4uc2V0RGVzYywKICAgICAgICAgIE8gPSBuLmNyZWF0ZSwKICAgICAgICAgIHcgPSBoLmdldCwKICAgICAgICAgIGsgPSBvLlN5bWJvbCwKICAgICAgICAgIHggPSBvLkpTT04sCiAgICAgICAgICBDID0geCAmJiB4LnN0cmluZ2lmeSwKICAgICAgICAgIEUgPSAhMSwKICAgICAgICAgIFMgPSBwKCJfaGlkZGVuIiksCiAgICAgICAgICBUID0gbi5pc0VudW0sCiAgICAgICAgICBNID0gbCgic3ltYm9sLXJlZ2lzdHJ5IiksCiAgICAgICAgICBOID0gbCgic3ltYm9scyIpLAogICAgICAgICAgUiA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGssCiAgICAgICAgICBEID0gT2JqZWN0LnByb3RvdHlwZSwKICAgICAgICAgIFAgPSBzICYmIHUoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiA3ICE9IE8oJCh7fSwgImEiLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gJCh0aGlzLCAiYSIsIHsgdmFsdWU6IDcgfSkuYTsKICAgICAgICAgIH0gfSkpLmE7CiAgICAgIH0pID8gZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgICB2YXIgbiA9IGooRCwgdCk7biAmJiBkZWxldGUgRFt0XSwgJChlLCB0LCByKSwgbiAmJiBlICE9PSBEICYmICQoRCwgdCwgbik7CiAgICAgIH0gOiAkLAogICAgICAgICAgQSA9IGZ1bmN0aW9uIEEoZSkgewogICAgICAgIHZhciB0ID0gTltlXSA9IE8oay5wcm90b3R5cGUpO3JldHVybiB0Ll9rID0gZSwgcyAmJiBFICYmIFAoRCwgZSwgeyBjb25maWd1cmFibGU6ICEwLCBzZXQ6IGZ1bmN0aW9uIHNldCh0KSB7CiAgICAgICAgICAgIGkodGhpcywgUykgJiYgaSh0aGlzW1NdLCBlKSAmJiAodGhpc1tTXVtlXSA9ICExKSwgUCh0aGlzLCBlLCBtKDEsIHQpKTsKICAgICAgICAgIH0gfSksIHQ7CiAgICAgIH0sCiAgICAgICAgICBMID0gZnVuY3Rpb24gTChlKSB7CiAgICAgICAgcmV0dXJuICJzeW1ib2wiID09ICh0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSkpOwogICAgICB9LAogICAgICAgICAgSSA9IGZ1bmN0aW9uIEkoZSwgdCwgcikgewogICAgICAgIHJldHVybiByICYmIGkoTiwgdCkgPyAoci5lbnVtZXJhYmxlID8gKGkoZSwgUykgJiYgZVtTXVt0XSAmJiAoZVtTXVt0XSA9ICExKSwgciA9IE8ociwgeyBlbnVtZXJhYmxlOiBtKDAsICExKSB9KSkgOiAoaShlLCBTKSB8fCAkKGUsIFMsIG0oMSwge30pKSwgZVtTXVt0XSA9ICEwKSwgUChlLCB0LCByKSkgOiAkKGUsIHQsIHIpOwogICAgICB9LAogICAgICAgICAgRiA9IGZ1bmN0aW9uIEYoZSwgdCkgewogICAgICAgIF8oZSk7Zm9yICh2YXIgciwgbiA9IHYodCA9IGcodCkpLCBvID0gMCwgaSA9IG4ubGVuZ3RoOyBpID4gbzspIHsKICAgICAgICAgIEkoZSwgciA9IG5bbysrXSwgdFtyXSk7CiAgICAgICAgfXJldHVybiBlOwogICAgICB9LAogICAgICAgICAgViA9IGZ1bmN0aW9uIFYoZSwgdCkgewogICAgICAgIHJldHVybiB2b2lkIDAgPT09IHQgPyBPKGUpIDogRihPKGUpLCB0KTsKICAgICAgfSwKICAgICAgICAgIHogPSBmdW5jdGlvbiB6KGUpIHsKICAgICAgICB2YXIgdCA9IFQuY2FsbCh0aGlzLCBlKTtyZXR1cm4gdCB8fCAhaSh0aGlzLCBlKSB8fCAhaShOLCBlKSB8fCBpKHRoaXMsIFMpICYmIHRoaXNbU11bZV0gPyB0IDogITA7CiAgICAgIH0sCiAgICAgICAgICBVID0gZnVuY3Rpb24gVShlLCB0KSB7CiAgICAgICAgdmFyIHIgPSBqKGUgPSBnKGUpLCB0KTtyZXR1cm4gIXIgfHwgIWkoTiwgdCkgfHwgaShlLCBTKSAmJiBlW1NdW3RdIHx8IChyLmVudW1lcmFibGUgPSAhMCksIHI7CiAgICAgIH0sCiAgICAgICAgICBIID0gZnVuY3Rpb24gSChlKSB7CiAgICAgICAgZm9yICh2YXIgdCwgciA9IHcoZyhlKSksIG4gPSBbXSwgbyA9IDA7IHIubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGkoTiwgdCA9IHJbbysrXSkgfHwgdCA9PSBTIHx8IG4ucHVzaCh0KTsKICAgICAgICB9cmV0dXJuIG47CiAgICAgIH0sCiAgICAgICAgICBCID0gZnVuY3Rpb24gQihlKSB7CiAgICAgICAgZm9yICh2YXIgdCwgciA9IHcoZyhlKSksIG4gPSBbXSwgbyA9IDA7IHIubGVuZ3RoID4gbzspIHsKICAgICAgICAgIGkoTiwgdCA9IHJbbysrXSkgJiYgbi5wdXNoKE5bdF0pOwogICAgICAgIH1yZXR1cm4gbjsKICAgICAgfSwKICAgICAgICAgIEogPSBmdW5jdGlvbiBKKGUpIHsKICAgICAgICBpZiAodm9pZCAwICE9PSBlICYmICFMKGUpKSB7CiAgICAgICAgICBmb3IgKHZhciB0LCByLCBuID0gW2VdLCBvID0gMSwgaSA9IGFyZ3VtZW50czsgaS5sZW5ndGggPiBvOykgewogICAgICAgICAgICBuLnB1c2goaVtvKytdKTsKICAgICAgICAgIH1yZXR1cm4gdCA9IG5bMV0sICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgJiYgKHIgPSB0KSwgIXIgJiYgeSh0KSB8fCAodCA9IGZ1bmN0aW9uIHQoZSwgX3QyKSB7CiAgICAgICAgICAgIHJldHVybiByICYmIChfdDIgPSByLmNhbGwodGhpcywgZSwgX3QyKSksIEwoX3QyKSA/IHZvaWQgMCA6IF90MjsKICAgICAgICAgIH0pLCBuWzFdID0gdCwgQy5hcHBseSh4LCBuKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBXID0gdShmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUgPSBrKCk7cmV0dXJuICJbbnVsbF0iICE9IEMoW2VdKSB8fCAie30iICE9IEMoeyBhOiBlIH0pIHx8ICJ7fSIgIT0gQyhPYmplY3QoZSkpOwogICAgICB9KTtSIHx8IChrID0gZnVuY3Rpb24gaygpIHsKICAgICAgICBpZiAoTCh0aGlzKSkgdGhyb3cgVHlwZUVycm9yKCJTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IiKTtyZXR1cm4gQShkKGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdm9pZCAwKSk7CiAgICAgIH0sIGMoay5wcm90b3R5cGUsICJ0b1N0cmluZyIsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcy5fazsKICAgICAgfSksIEwgPSBmdW5jdGlvbiBMKGUpIHsKICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIGs7CiAgICAgIH0sIG4uY3JlYXRlID0gViwgbi5pc0VudW0gPSB6LCBuLmdldERlc2MgPSBVLCBuLnNldERlc2MgPSBJLCBuLnNldERlc2NzID0gRiwgbi5nZXROYW1lcyA9IGguZ2V0ID0gSCwgbi5nZXRTeW1ib2xzID0gQiwgcyAmJiAhZSgiLi8kLmxpYnJhcnkiKSAmJiBjKEQsICJwcm9wZXJ0eUlzRW51bWVyYWJsZSIsIHosICEwKSk7dmFyIFkgPSB7ICJmb3IiOiBmdW5jdGlvbiBfZm9yKGUpIHsKICAgICAgICAgIHJldHVybiBpKE0sIGUgKz0gIiIpID8gTVtlXSA6IE1bZV0gPSBrKGUpOwogICAgICAgIH0sIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKGUpIHsKICAgICAgICAgIHJldHVybiBiKE0sIGUpOwogICAgICAgIH0sIHVzZVNldHRlcjogZnVuY3Rpb24gdXNlU2V0dGVyKCkgewogICAgICAgICAgRSA9ICEwOwogICAgICAgIH0sIHVzZVNpbXBsZTogZnVuY3Rpb24gdXNlU2ltcGxlKCkgewogICAgICAgICAgRSA9ICExOwogICAgICAgIH0gfTtuLmVhY2guY2FsbCgiaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMiLnNwbGl0KCIsIiksIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQgPSBwKGUpO1lbZV0gPSBSID8gdCA6IEEodCk7CiAgICAgIH0pLCBFID0gITAsIGEoYS5HICsgYS5XLCB7IFN5bWJvbDogayB9KSwgYShhLlMsICJTeW1ib2wiLCBZKSwgYShhLlMgKyBhLkYgKiAhUiwgIk9iamVjdCIsIHsgY3JlYXRlOiBWLCBkZWZpbmVQcm9wZXJ0eTogSSwgZGVmaW5lUHJvcGVydGllczogRiwgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiBVLCBnZXRPd25Qcm9wZXJ0eU5hbWVzOiBILCBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6IEIgfSksIHggJiYgYShhLlMgKyBhLkYgKiAoIVIgfHwgVyksICJKU09OIiwgeyBzdHJpbmdpZnk6IEogfSksIGYoaywgIlN5bWJvbCIpLCBmKE1hdGgsICJNYXRoIiwgITApLCBmKG8uSlNPTiwgIkpTT04iLCAhMCk7CiAgICB9LCB7ICIuLyQiOiA1NiwgIi4vJC5hbi1vYmplY3QiOiAyOCwgIi4vJC5kZXNjcmlwdG9ycyI6IDM0LCAiLi8kLmVudW0ta2V5cyI6IDM2LCAiLi8kLmV4cG9ydCI6IDM3LCAiLi8kLmZhaWxzIjogMzgsICIuLyQuZ2V0LW5hbWVzIjogNDAsICIuLyQuZ2xvYmFsIjogNDEsICIuLyQuaGFzIjogNDIsICIuLyQuaXMtYXJyYXkiOiA0OCwgIi4vJC5rZXlvZiI6IDU3LCAiLi8kLmxpYnJhcnkiOiA1OCwgIi4vJC5wcm9wZXJ0eS1kZXNjIjogNjEsICIuLyQucmVkZWZpbmUiOiA2MywgIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6IDY3LCAiLi8kLnNoYXJlZCI6IDY4LCAiLi8kLnRvLWlvYmplY3QiOiA3NCwgIi4vJC51aWQiOiA3NywgIi4vJC53a3MiOiA3OCB9XSwgODk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICBlKCIuL2VzNi5hcnJheS5pdGVyYXRvciIpO3ZhciBuID0gZSgiLi8kLml0ZXJhdG9ycyIpO24uTm9kZUxpc3QgPSBuLkhUTUxDb2xsZWN0aW9uID0gbi5BcnJheTsKICAgIH0sIHsgIi4vJC5pdGVyYXRvcnMiOiA1NSwgIi4vZXM2LmFycmF5Lml0ZXJhdG9yIjogODAgfV0sIDkwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCBmdW5jdGlvbiAoZSkgewogICAgICAgIGZ1bmN0aW9uIHQoZSkgewogICAgICAgICAgdGhpcy5nID0gW10sIHRoaXMuayA9IGU7CiAgICAgICAgfWZ1bmN0aW9uIHIoZSkgewogICAgICAgICAgIWZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICAgIHZhciBuID0gZS50YWtlUmVjb3JkcygpO24ubGVuZ3RoICYmIGUuayhuLCBlKSwgZS5mID0gc2V0VGltZW91dChyLCB0Ll9wZXJpb2QpOwogICAgICAgICAgfSgpOwogICAgICAgIH1mdW5jdGlvbiBuKHQpIHsKICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIG4gPSB7IHR5cGU6IG51bGwsIHRhcmdldDogbnVsbCwgYWRkZWROb2RlczogW10sIHJlbW92ZWROb2RlczogW10sIHByZXZpb3VzU2libGluZzogbnVsbCwgbmV4dFNpYmxpbmc6IG51bGwsIGF0dHJpYnV0ZU5hbWU6IG51bGwsIGF0dHJpYnV0ZU5hbWVzcGFjZTogbnVsbCwgb2xkVmFsdWU6IG51bGwgfTtmb3IgKHIgaW4gdCkgewogICAgICAgICAgICBuW3JdICE9PSBlICYmIHRbcl0gIT09IGUgJiYgKG5bcl0gPSB0W3JdKTsKICAgICAgICAgIH1yZXR1cm4gbjsKICAgICAgICB9ZnVuY3Rpb24gbyhlLCB0KSB7CiAgICAgICAgICB2YXIgciA9IGEoZSwgdCk7cmV0dXJuIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICAgIHZhciBvLAogICAgICAgICAgICAgICAgYyA9IG4ubGVuZ3RoO3QuYSAmJiByLmEgJiYgaShuLCBlLCByLmEsIHQuZCksICh0LmIgfHwgdC5lKSAmJiAobyA9IHMobiwgZSwgciwgdCkpLCAobyB8fCBuLmxlbmd0aCAhPT0gYykgJiYgKHIgPSBhKGUsIHQpKTsKICAgICAgICAgIH07CiAgICAgICAgfWZ1bmN0aW9uIGkodCwgciwgbywgaSkgewogICAgICAgICAgZm9yICh2YXIgcywgYSwgYyA9IHt9LCB1ID0gci5hdHRyaWJ1dGVzLCBsID0gdS5sZW5ndGg7IGwtLTspIHsKICAgICAgICAgICAgcyA9IHVbbF0sIGEgPSBzLm5hbWUsIGkgJiYgaVthXSA9PT0gZSB8fCAocy52YWx1ZSAhPT0gb1thXSAmJiB0LnB1c2gobih7IHR5cGU6ICJhdHRyaWJ1dGVzIiwgdGFyZ2V0OiByLCBhdHRyaWJ1dGVOYW1lOiBhLCBvbGRWYWx1ZTogb1thXSwgYXR0cmlidXRlTmFtZXNwYWNlOiBzLm5hbWVzcGFjZVVSSSB9KSksIGNbYV0gPSAhMCk7CiAgICAgICAgICB9Zm9yIChhIGluIG8pIHsKICAgICAgICAgICAgY1thXSB8fCB0LnB1c2gobih7IHRhcmdldDogciwgdHlwZTogImF0dHJpYnV0ZXMiLCBhdHRyaWJ1dGVOYW1lOiBhLCBvbGRWYWx1ZTogb1thXSB9KSk7CiAgICAgICAgICB9CiAgICAgICAgfWZ1bmN0aW9uIHModCwgciwgbywgcykgewogICAgICAgICAgZnVuY3Rpb24gYShlLCByLCBvLCBhLCBjKSB7CiAgICAgICAgICAgIHZhciBsID0gZS5sZW5ndGggLSAxO2MgPSAtIH4oKGwgLSBjKSAvIDIpO2ZvciAodmFyIGYsIGQsIHA7IHAgPSBlLnBvcCgpOykgewogICAgICAgICAgICAgIGYgPSBvW3AuaF0sIGQgPSBhW3AuaV0sIHMuYiAmJiBjICYmIE1hdGguYWJzKHAuaCAtIHAuaSkgPj0gbCAmJiAodC5wdXNoKG4oeyB0eXBlOiAiY2hpbGRMaXN0IiwgdGFyZ2V0OiByLCBhZGRlZE5vZGVzOiBbZl0sIHJlbW92ZWROb2RlczogW2ZdLCBuZXh0U2libGluZzogZi5uZXh0U2libGluZywgcHJldmlvdXNTaWJsaW5nOiBmLnByZXZpb3VzU2libGluZyB9KSksIGMtLSksIHMuYSAmJiBkLmEgJiYgaSh0LCBmLCBkLmEsIHMuZCksIHMuYyAmJiAzID09PSBmLm5vZGVUeXBlICYmIGYubm9kZVZhbHVlICE9PSBkLmMgJiYgdC5wdXNoKG4oeyB0eXBlOiAiY2hhcmFjdGVyRGF0YSIsIHRhcmdldDogZiB9KSksIHMuZSAmJiB1KGYsIGQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9ZnVuY3Rpb24gdShyLCBvKSB7CiAgICAgICAgICAgIGZvciAodmFyIGQsIHAsIGIsIGgsIHYsIHkgPSByLmNoaWxkTm9kZXMsIF8gPSBvLmIsIGcgPSB5Lmxlbmd0aCwgbSA9IF8gPyBfLmxlbmd0aCA6IDAsIGogPSAwLCAkID0gMCwgTyA9IDA7IGcgPiAkIHx8IG0gPiBPOykgewogICAgICAgICAgICAgIGggPSB5WyRdLCB2ID0gKGIgPSBfW09dKSAmJiBiLmosIGggPT09IHYgPyAocy5hICYmIGIuYSAmJiBpKHQsIGgsIGIuYSwgcy5kKSwgcy5jICYmIGIuYyAhPT0gZSAmJiBoLm5vZGVWYWx1ZSAhPT0gYi5jICYmIHQucHVzaChuKHsgdHlwZTogImNoYXJhY3RlckRhdGEiLCB0YXJnZXQ6IGggfSkpLCBwICYmIGEocCwgciwgeSwgXywgaiksIHMuZSAmJiAoaC5jaGlsZE5vZGVzLmxlbmd0aCB8fCBiLmIgJiYgYi5iLmxlbmd0aCkgJiYgdShoLCBiKSwgJCsrLCBPKyspIDogKGwgPSAhMCwgZCB8fCAoZCA9IHt9LCBwID0gW10pLCBoICYmIChkW2IgPSBjKGgpXSB8fCAoZFtiXSA9ICEwLCAtMSA9PT0gKGIgPSBmKF8sIGgsIE8sICJqIikpID8gcy5iICYmICh0LnB1c2gobih7IHR5cGU6ICJjaGlsZExpc3QiLCB0YXJnZXQ6IHIsIGFkZGVkTm9kZXM6IFtoXSwgbmV4dFNpYmxpbmc6IGgubmV4dFNpYmxpbmcsIHByZXZpb3VzU2libGluZzogaC5wcmV2aW91c1NpYmxpbmcgfSkpLCBqKyspIDogcC5wdXNoKHsgaDogJCwgaTogYiB9KSksICQrKyksIHYgJiYgdiAhPT0geVskXSAmJiAoZFtiID0gYyh2KV0gfHwgKGRbYl0gPSAhMCwgLTEgPT09IChiID0gZih5LCB2LCAkKSkgPyBzLmIgJiYgKHQucHVzaChuKHsgdHlwZTogImNoaWxkTGlzdCIsIHRhcmdldDogby5qLCByZW1vdmVkTm9kZXM6IFt2XSwgbmV4dFNpYmxpbmc6IF9bTyArIDFdLCBwcmV2aW91c1NpYmxpbmc6IF9bTyAtIDFdIH0pKSwgai0tKSA6IHAucHVzaCh7IGg6IGIsIGk6IE8gfSkpLCBPKyspKTsKICAgICAgICAgICAgfXAgJiYgYShwLCByLCB5LCBfLCBqKTsKICAgICAgICAgIH12YXIgbDtyZXR1cm4gdShyLCBvKSwgbDsKICAgICAgICB9ZnVuY3Rpb24gYShlLCB0KSB7CiAgICAgICAgICB2YXIgciA9ICEwO3JldHVybiBmdW5jdGlvbiBuKGUpIHsKICAgICAgICAgICAgdmFyIG8gPSB7IGo6IGUgfTtyZXR1cm4gIXQuYyB8fCAzICE9PSBlLm5vZGVUeXBlICYmIDggIT09IGUubm9kZVR5cGUgPyAodC5hICYmIHIgJiYgMSA9PT0gZS5ub2RlVHlwZSAmJiAoby5hID0gbChlLmF0dHJpYnV0ZXMsIGZ1bmN0aW9uIChlLCByKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQuZCAmJiAhdC5kW3IubmFtZV0gfHwgKGVbci5uYW1lXSA9IHIudmFsdWUpLCBlOwogICAgICAgICAgICB9KSksIHIgJiYgKHQuYiB8fCB0LmMgfHwgdC5hICYmIHQuZSkgJiYgKG8uYiA9IHUoZS5jaGlsZE5vZGVzLCBuKSksIHIgPSB0LmUpIDogby5jID0gZS5ub2RlVmFsdWUsIG87CiAgICAgICAgICB9KGUpOwogICAgICAgIH1mdW5jdGlvbiBjKGUpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBlLmlkIHx8IChlLm1vX2lkID0gZS5tb19pZCB8fCBkKyspOwogICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJldHVybiBlLm5vZGVWYWx1ZTsKICAgICAgICAgICAgfSBjYXRjaCAocikgewogICAgICAgICAgICAgIHJldHVybiBkKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9ZnVuY3Rpb24gdShlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0gW10sIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICAgICAgICByW25dID0gdChlW25dLCBuLCBlKTsKICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICB9ZnVuY3Rpb24gbChlLCB0KSB7CiAgICAgICAgICBmb3IgKHZhciByID0ge30sIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICAgICAgICByID0gdChyLCBlW25dLCBuLCBlKTsKICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICB9ZnVuY3Rpb24gZihlLCB0LCByLCBuKSB7CiAgICAgICAgICBmb3IgKDsgciA8IGUubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgaWYgKChuID8gZVtyXVtuXSA6IGVbcl0pID09PSB0KSByZXR1cm4gcjsKICAgICAgICAgIH1yZXR1cm4gLTE7CiAgICAgICAgfXQuX3BlcmlvZCA9IDMwLCB0LnByb3RvdHlwZSA9IHsgb2JzZXJ2ZTogZnVuY3Rpb24gb2JzZXJ2ZShlLCB0KSB7CiAgICAgICAgICAgIGZvciAodmFyIG4gPSB7IGE6ICEhKHQuYXR0cmlidXRlcyB8fCB0LmF0dHJpYnV0ZUZpbHRlciB8fCB0LmF0dHJpYnV0ZU9sZFZhbHVlKSwgYjogISF0LmNoaWxkTGlzdCwgZTogISF0LnN1YnRyZWUsIGM6ICEoIXQuY2hhcmFjdGVyRGF0YSAmJiAhdC5jaGFyYWN0ZXJEYXRhT2xkVmFsdWUpIH0sIGkgPSB0aGlzLmcsIHMgPSAwOyBzIDwgaS5sZW5ndGg7IHMrKykgewogICAgICAgICAgICAgIGlbc10ubSA9PT0gZSAmJiBpLnNwbGljZShzLCAxKTsKICAgICAgICAgICAgfXQuYXR0cmlidXRlRmlsdGVyICYmIChuLmQgPSBsKHQuYXR0cmlidXRlRmlsdGVyLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICAgIHJldHVybiBlW3RdID0gITAsIGU7CiAgICAgICAgICAgIH0pKSwgaS5wdXNoKHsgbTogZSwgbDogbyhlLCBuKSB9KSwgdGhpcy5mIHx8IHIodGhpcyk7CiAgICAgICAgICB9LCB0YWtlUmVjb3JkczogZnVuY3Rpb24gdGFrZVJlY29yZHMoKSB7CiAgICAgICAgICAgIGZvciAodmFyIGUgPSBbXSwgdCA9IHRoaXMuZywgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgICAgdFtyXS5sKGUpOwogICAgICAgICAgICB9cmV0dXJuIGU7CiAgICAgICAgICB9LCBkaXNjb25uZWN0OiBmdW5jdGlvbiBkaXNjb25uZWN0KCkgewogICAgICAgICAgICB0aGlzLmcgPSBbXSwgY2xlYXJUaW1lb3V0KHRoaXMuZiksIHRoaXMuZiA9IG51bGw7CiAgICAgICAgICB9IH07dmFyIGQgPSAxO3JldHVybiB0OwogICAgICB9KHZvaWQgMCk7CiAgICB9LCB7fV0sIDkxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgT2JqZWN0Lm9ic2VydmUgfHwgZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgdmFyIG8sCiAgICAgICAgICAgIGksCiAgICAgICAgICAgIHMgPSBbImFkZCIsICJ1cGRhdGUiLCAiZGVsZXRlIiwgInJlY29uZmlndXJlIiwgInNldFByb3RvdHlwZSIsICJwcmV2ZW50RXh0ZW5zaW9ucyJdLAogICAgICAgICAgICBhID0gdC5pc0FycmF5IHx8IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgcmV0dXJuICJbb2JqZWN0IEFycmF5XSIgPT09IGUuY2FsbCh0KTsKICAgICAgICAgIH07CiAgICAgICAgfShlLnByb3RvdHlwZS50b1N0cmluZyksCiAgICAgICAgICAgIGMgPSB0LnByb3RvdHlwZS5pbmRleE9mID8gdC5pbmRleE9mIHx8IGZ1bmN0aW9uIChlLCByLCBuKSB7CiAgICAgICAgICByZXR1cm4gdC5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGUsIHIsIG4pOwogICAgICAgIH0gOiBmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAgICAgZm9yICh2YXIgbiA9IHIgfHwgMDsgbiA8IGUubGVuZ3RoOyBuKyspIHsKICAgICAgICAgICAgaWYgKGVbbl0gPT09IHQpIHJldHVybiBuOwogICAgICAgICAgfXJldHVybiAtMTsKICAgICAgICB9LAogICAgICAgICAgICB1ID0gci5NYXAgIT09IG4gJiYgTWFwLnByb3RvdHlwZS5mb3JFYWNoID8gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIG5ldyBNYXAoKTsKICAgICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGUgPSBbXSwKICAgICAgICAgICAgICB0ID0gW107cmV0dXJuIHsgc2l6ZTogMCwgaGFzOiBmdW5jdGlvbiBoYXModCkgewogICAgICAgICAgICAgIHJldHVybiBjKGUsIHQpID4gLTE7CiAgICAgICAgICAgIH0sIGdldDogZnVuY3Rpb24gZ2V0KHIpIHsKICAgICAgICAgICAgICByZXR1cm4gdFtjKGUsIHIpXTsKICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiBzZXQociwgbikgewogICAgICAgICAgICAgIHZhciBvID0gYyhlLCByKTstMSA9PT0gbyA/IChlLnB1c2gociksIHQucHVzaChuKSwgdGhpcy5zaXplKyspIDogdFtvXSA9IG47CiAgICAgICAgICAgIH0sICJkZWxldGUiOiBmdW5jdGlvbiBfZGVsZXRlKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IGMoZSwgcik7biA+IC0xICYmIChlLnNwbGljZShuLCAxKSwgdC5zcGxpY2UobiwgMSksIHRoaXMuc2l6ZS0tKTsKICAgICAgICAgICAgfSwgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChyKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7CiAgICAgICAgICAgICAgICByLmNhbGwoYXJndW1lbnRzWzFdLCB0W25dLCBlW25dLCB0aGlzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gfTsKICAgICAgICB9LAogICAgICAgICAgICBsID0gZS5nZXRPd25Qcm9wZXJ0eU5hbWVzID8gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHQgPSBlLmdldE93blByb3BlcnR5TmFtZXM7dHJ5IHsKICAgICAgICAgICAgYXJndW1lbnRzLmNhbGxlZTsKICAgICAgICAgIH0gY2F0Y2ggKHIpIHsKICAgICAgICAgICAgdmFyIG4gPSAodChjKS5qb2luKCIgIikgKyAiICIpLnJlcGxhY2UoL3Byb3RvdHlwZSB8bGVuZ3RoIHxuYW1lIC9nLCAiIikuc2xpY2UoMCwgLTEpLnNwbGl0KCIgIik7bi5sZW5ndGggJiYgKHQgPSBmdW5jdGlvbiB0KF90MykgewogICAgICAgICAgICAgIHZhciByID0gZS5nZXRPd25Qcm9wZXJ0eU5hbWVzKF90Myk7aWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIF90MykgZm9yICh2YXIgbywgaSA9IDA7IGkgPCBuLmxlbmd0aDspIHsKICAgICAgICAgICAgICAgIChvID0gYyhyLCBuW2krK10pKSA+IC0xICYmIHIuc3BsaWNlKG8sIDEpOwogICAgICAgICAgICAgIH1yZXR1cm4gcjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9cmV0dXJuIHQ7CiAgICAgICAgfSgpIDogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgbyA9IFtdO2lmICgiaGFzT3duUHJvcGVydHkiIGluIHQpIGZvciAociBpbiB0KSB7CiAgICAgICAgICAgIHQuaGFzT3duUHJvcGVydHkocikgJiYgby5wdXNoKHIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbiA9IGUuaGFzT3duUHJvcGVydHk7Zm9yIChyIGluIHQpIHsKICAgICAgICAgICAgICBuLmNhbGwodCwgcikgJiYgby5wdXNoKHIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9cmV0dXJuIGEodCkgJiYgby5wdXNoKCJsZW5ndGgiKSwgbzsKICAgICAgICB9LAogICAgICAgICAgICBmID0gZS5nZXRQcm90b3R5cGVPZiwKICAgICAgICAgICAgZCA9IGUuZGVmaW5lUHJvcGVydGllcyAmJiBlLmdldE93blByb3BlcnR5RGVzY3JpcHRvciwKICAgICAgICAgICAgcCA9IHIucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHIud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlID0gK25ldyBEYXRlKCksCiAgICAgICAgICAgICAgdCA9IGU7cmV0dXJuIGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByKCh0ID0gK25ldyBEYXRlKCkpIC0gZSk7CiAgICAgICAgICAgIH0sIDE3KTsKICAgICAgICAgIH07CiAgICAgICAgfSgpLAogICAgICAgICAgICBiID0gZnVuY3Rpb24gYihlLCB0LCByKSB7CiAgICAgICAgICB2YXIgbiA9IG8uZ2V0KGUpO24gPyAodihuLCBlKSwgbShlLCBuLCB0LCByKSkgOiAobiA9IGgoZSksIG0oZSwgbiwgdCwgciksIDEgPT09IG8uc2l6ZSAmJiBwKHkpKTsKICAgICAgICB9LAogICAgICAgICAgICBoID0gZnVuY3Rpb24gaCh0LCByKSB7CiAgICAgICAgICB2YXIgbiwKICAgICAgICAgICAgICBpID0gbCh0KSwKICAgICAgICAgICAgICBzID0gW10sCiAgICAgICAgICAgICAgYSA9IDAsCiAgICAgICAgICAgICAgciA9IHsgaGFuZGxlcnM6IHUoKSwgZnJvemVuOiBlLmlzRnJvemVuID8gZS5pc0Zyb3plbih0KSA6ICExLCBleHRlbnNpYmxlOiBlLmlzRXh0ZW5zaWJsZSA/IGUuaXNFeHRlbnNpYmxlKHQpIDogITAsIHByb3RvOiBmICYmIGYodCksIHByb3BlcnRpZXM6IGksIHZhbHVlczogcywgbm90aWZpZXI6IGcodCwgcikgfTtpZiAoZCkgZm9yIChuID0gci5kZXNjcmlwdG9ycyA9IFtdOyBhIDwgaS5sZW5ndGg7KSB7CiAgICAgICAgICAgIG5bYV0gPSBkKHQsIGlbYV0pLCBzW2FdID0gdFtpW2ErK11dOwogICAgICAgICAgfSBlbHNlIGZvciAoOyBhIDwgaS5sZW5ndGg7KSB7CiAgICAgICAgICAgIHNbYV0gPSB0W2lbYSsrXV07CiAgICAgICAgICB9cmV0dXJuIG8uc2V0KHQsIHIpLCByOwogICAgICAgIH0sCiAgICAgICAgICAgIHYgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgdCA9IGQgPyBmdW5jdGlvbiAoZSwgdCwgciwgbiwgbykgewogICAgICAgICAgICB2YXIgaSA9IHQucHJvcGVydGllc1tyXSwKICAgICAgICAgICAgICAgIHMgPSBlW2ldLAogICAgICAgICAgICAgICAgYSA9IHQudmFsdWVzW3JdLAogICAgICAgICAgICAgICAgYyA9IHQuZGVzY3JpcHRvcnNbcl07InZhbHVlIiBpbiBvICYmIChhID09PSBzID8gMCA9PT0gYSAmJiAxIC8gYSAhPT0gMSAvIHMgOiBhID09PSBhIHx8IHMgPT09IHMpICYmIChqKGUsIHQsIHsgbmFtZTogaSwgdHlwZTogInVwZGF0ZSIsIG9iamVjdDogZSwgb2xkVmFsdWU6IGEgfSwgbiksIHQudmFsdWVzW3JdID0gcyksICFjLmNvbmZpZ3VyYWJsZSB8fCBvLmNvbmZpZ3VyYWJsZSAmJiBvLndyaXRhYmxlID09PSBjLndyaXRhYmxlICYmIG8uZW51bWVyYWJsZSA9PT0gYy5lbnVtZXJhYmxlICYmIG8uZ2V0ID09PSBjLmdldCAmJiBvLnNldCA9PT0gYy5zZXQgfHwgKGooZSwgdCwgeyBuYW1lOiBpLCB0eXBlOiAicmVjb25maWd1cmUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBhIH0sIG4pLCB0LmRlc2NyaXB0b3JzW3JdID0gbyk7CiAgICAgICAgICB9IDogZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKICAgICAgICAgICAgdmFyIG8gPSB0LnByb3BlcnRpZXNbcl0sCiAgICAgICAgICAgICAgICBpID0gZVtvXSwKICAgICAgICAgICAgICAgIHMgPSB0LnZhbHVlc1tyXTsocyA9PT0gaSA/IDAgPT09IHMgJiYgMSAvIHMgIT09IDEgLyBpIDogcyA9PT0gcyB8fCBpID09PSBpKSAmJiAoaihlLCB0LCB7IG5hbWU6IG8sIHR5cGU6ICJ1cGRhdGUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBzIH0sIG4pLCB0LnZhbHVlc1tyXSA9IGkpOwogICAgICAgICAgfSwKICAgICAgICAgICAgICByID0gZCA/IGZ1bmN0aW9uIChlLCByLCBuLCBvLCBpKSB7CiAgICAgICAgICAgIGZvciAodmFyIHMsIGEgPSByLmxlbmd0aDsgbiAmJiBhLS07KSB7CiAgICAgICAgICAgICAgbnVsbCAhPT0gclthXSAmJiAocyA9IGQoZSwgclthXSksIG4tLSwgcyA/IHQoZSwgbywgYSwgaSwgcykgOiAoaihlLCBvLCB7IG5hbWU6IHJbYV0sIHR5cGU6ICJkZWxldGUiLCBvYmplY3Q6IGUsIG9sZFZhbHVlOiBvLnZhbHVlc1thXSB9LCBpKSwgby5wcm9wZXJ0aWVzLnNwbGljZShhLCAxKSwgby52YWx1ZXMuc3BsaWNlKGEsIDEpLCBvLmRlc2NyaXB0b3JzLnNwbGljZShhLCAxKSkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IDogZnVuY3Rpb24gKGUsIHQsIHIsIG4sIG8pIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IHQubGVuZ3RoOyByICYmIGktLTspIHsKICAgICAgICAgICAgICBudWxsICE9PSB0W2ldICYmIChqKGUsIG4sIHsgbmFtZTogdFtpXSwgdHlwZTogImRlbGV0ZSIsIG9iamVjdDogZSwgb2xkVmFsdWU6IG4udmFsdWVzW2ldIH0sIG8pLCBuLnByb3BlcnRpZXMuc3BsaWNlKGksIDEpLCBuLnZhbHVlcy5zcGxpY2UoaSwgMSksIHItLSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07cmV0dXJuIGZ1bmN0aW9uIChuLCBvLCBpKSB7CiAgICAgICAgICAgIGlmIChuLmhhbmRsZXJzLnNpemUgJiYgIW4uZnJvemVuKSB7CiAgICAgICAgICAgICAgdmFyIHMsCiAgICAgICAgICAgICAgICAgIGEsCiAgICAgICAgICAgICAgICAgIHUsCiAgICAgICAgICAgICAgICAgIHAsCiAgICAgICAgICAgICAgICAgIGIsCiAgICAgICAgICAgICAgICAgIGgsCiAgICAgICAgICAgICAgICAgIHYsCiAgICAgICAgICAgICAgICAgIHksCiAgICAgICAgICAgICAgICAgIF8gPSBuLnZhbHVlcywKICAgICAgICAgICAgICAgICAgZyA9IG4uZGVzY3JpcHRvcnMsCiAgICAgICAgICAgICAgICAgIG0gPSAwO2lmIChuLmV4dGVuc2libGUpIHsKICAgICAgICAgICAgICAgIGlmIChzID0gbi5wcm9wZXJ0aWVzLnNsaWNlKCksIGEgPSBzLmxlbmd0aCwgdSA9IGwobyksIGcpIHsKICAgICAgICAgICAgICAgICAgZm9yICg7IG0gPCB1Lmxlbmd0aDspIHsKICAgICAgICAgICAgICAgICAgICBiID0gdVttKytdLCBwID0gYyhzLCBiKSwgeSA9IGQobywgYiksIC0xID09PSBwID8gKGoobywgbiwgeyBuYW1lOiBiLCB0eXBlOiAiYWRkIiwgb2JqZWN0OiBvIH0sIGkpLCBuLnByb3BlcnRpZXMucHVzaChiKSwgXy5wdXNoKG9bYl0pLCBnLnB1c2goeSkpIDogKHNbcF0gPSBudWxsLCBhLS0sIHQobywgbiwgcCwgaSwgeSkpOwogICAgICAgICAgICAgICAgICB9cihvLCBzLCBhLCBuLCBpKSwgZS5pc0V4dGVuc2libGUobykgfHwgKG4uZXh0ZW5zaWJsZSA9ICExLCBqKG8sIG4sIHsgdHlwZTogInByZXZlbnRFeHRlbnNpb25zIiwgb2JqZWN0OiBvIH0sIGkpLCBuLmZyb3plbiA9IGUuaXNGcm96ZW4obykpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZm9yICg7IG0gPCB1Lmxlbmd0aDspIHsKICAgICAgICAgICAgICAgICAgICBiID0gdVttKytdLCBwID0gYyhzLCBiKSwgaCA9IG9bYl0sIC0xID09PSBwID8gKGoobywgbiwgeyBuYW1lOiBiLCB0eXBlOiAiYWRkIiwgb2JqZWN0OiBvIH0sIGkpLCBuLnByb3BlcnRpZXMucHVzaChiKSwgXy5wdXNoKGgpKSA6IChzW3BdID0gbnVsbCwgYS0tLCB0KG8sIG4sIHAsIGkpKTsKICAgICAgICAgICAgICAgICAgfXIobywgcywgYSwgbiwgaSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmICghbi5mcm96ZW4pIHsKICAgICAgICAgICAgICAgIGZvciAoOyBtIDwgcy5sZW5ndGg7IG0rKykgewogICAgICAgICAgICAgICAgICBiID0gc1ttXSwgdChvLCBuLCBtLCBpLCBkKG8sIGIpKTsKICAgICAgICAgICAgICAgIH1lLmlzRnJvemVuKG8pICYmIChuLmZyb3plbiA9ICEwKTsKICAgICAgICAgICAgICB9ZiAmJiAodiA9IGYobyksIHYgIT09IG4ucHJvdG8gJiYgKGoobywgbiwgeyB0eXBlOiAic2V0UHJvdG90eXBlIiwgbmFtZTogIl9fcHJvdG9fXyIsIG9iamVjdDogbywgb2xkVmFsdWU6IG4ucHJvdG8gfSksIG4ucHJvdG8gPSB2KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfSgpLAogICAgICAgICAgICB5ID0gZnVuY3Rpb24geSgpIHsKICAgICAgICAgIG8uc2l6ZSAmJiAoby5mb3JFYWNoKHYpLCBpLmZvckVhY2goXyksIHAoeSkpOwogICAgICAgIH0sCiAgICAgICAgICAgIF8gPSBmdW5jdGlvbiBfKGUsIHQpIHsKICAgICAgICAgIHZhciByID0gZS5jaGFuZ2VSZWNvcmRzO3IubGVuZ3RoICYmIChlLmNoYW5nZVJlY29yZHMgPSBbXSwgdChyKSk7CiAgICAgICAgfSwKICAgICAgICAgICAgZyA9IGZ1bmN0aW9uIGcoZSwgdCkgewogICAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyICYmICh0ID0gby5nZXQoZSkpLCB0ICYmIHQubm90aWZpZXIgfHwgeyBub3RpZnk6IGZ1bmN0aW9uIG5vdGlmeSh0KSB7CiAgICAgICAgICAgICAgdC50eXBlO3ZhciByID0gby5nZXQoZSk7aWYgKHIpIHsKICAgICAgICAgICAgICAgIHZhciBuLAogICAgICAgICAgICAgICAgICAgIGkgPSB7IG9iamVjdDogZSB9O2ZvciAobiBpbiB0KSB7CiAgICAgICAgICAgICAgICAgICJvYmplY3QiICE9PSBuICYmIChpW25dID0gdFtuXSk7CiAgICAgICAgICAgICAgICB9aihlLCByLCBpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHBlcmZvcm1DaGFuZ2U6IGZ1bmN0aW9uIHBlcmZvcm1DaGFuZ2UodCwgcikgewogICAgICAgICAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgdCkgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBub24tc3RyaW5nIGNoYW5nZVR5cGUiKTtpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgcikgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IHBlcmZvcm0gbm9uLWZ1bmN0aW9uIik7dmFyIGksCiAgICAgICAgICAgICAgICAgIHMsCiAgICAgICAgICAgICAgICAgIGEgPSBvLmdldChlKSwKICAgICAgICAgICAgICAgICAgYyA9IGFyZ3VtZW50c1syXSwKICAgICAgICAgICAgICAgICAgdSA9IGMgPT09IG4gPyByKCkgOiByLmNhbGwoYyk7aWYgKGEgJiYgdihhLCBlLCB0KSwgYSAmJiB1ICYmICJvYmplY3QiID09ICh0eXBlb2YgdSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YodSkpKSB7CiAgICAgICAgICAgICAgICBzID0geyBvYmplY3Q6IGUsIHR5cGU6IHQgfTtmb3IgKGkgaW4gdSkgewogICAgICAgICAgICAgICAgICAib2JqZWN0IiAhPT0gaSAmJiAidHlwZSIgIT09IGkgJiYgKHNbaV0gPSB1W2ldKTsKICAgICAgICAgICAgICAgIH1qKGUsIGEsIHMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSB9OwogICAgICAgIH0sCiAgICAgICAgICAgIG0gPSBmdW5jdGlvbiBtKGUsIHQsIHIsIG4pIHsKICAgICAgICAgIHZhciBvID0gaS5nZXQocik7byB8fCBpLnNldChyLCBvID0geyBvYnNlcnZlZDogdSgpLCBjaGFuZ2VSZWNvcmRzOiBbXSB9KSwgby5vYnNlcnZlZC5zZXQoZSwgeyBhY2NlcHRMaXN0OiBuLnNsaWNlKCksIGRhdGE6IHQgfSksIHQuaGFuZGxlcnMuc2V0KHIsIG8pOwogICAgICAgIH0sCiAgICAgICAgICAgIGogPSBmdW5jdGlvbiBqKGUsIHQsIHIsIG4pIHsKICAgICAgICAgIHQuaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgICB2YXIgbyA9IHQub2JzZXJ2ZWQuZ2V0KGUpLmFjY2VwdExpc3Q7KCJzdHJpbmciICE9IHR5cGVvZiBuIHx8IC0xID09PSBjKG8sIG4pKSAmJiBjKG8sIHIudHlwZSkgPiAtMSAmJiB0LmNoYW5nZVJlY29yZHMucHVzaChyKTsKICAgICAgICAgIH0pOwogICAgICAgIH07byA9IHUoKSwgaSA9IHUoKSwgZS5vYnNlcnZlID0gZnVuY3Rpb24gKHQsIHIsIG8pIHsKICAgICAgICAgIGlmICghdCB8fCAib2JqZWN0IiAhPSAodHlwZW9mIHQgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKHQpKSAmJiAiZnVuY3Rpb24iICE9IHR5cGVvZiB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3Qub2JzZXJ2ZSBjYW5ub3Qgb2JzZXJ2ZSBub24tb2JqZWN0Iik7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIHIpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBkZWxpdmVyIHRvIG5vbi1mdW5jdGlvbiIpO2lmIChlLmlzRnJvemVuICYmIGUuaXNGcm96ZW4ocikpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBkZWxpdmVyIHRvIGEgZnJvemVuIGZ1bmN0aW9uIG9iamVjdCIpO2lmIChvID09PSBuKSBvID0gcztlbHNlIGlmICghbyB8fCAib2JqZWN0IiAhPSAodHlwZW9mIG8gPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG8pKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhpcmQgYXJndW1lbnQgdG8gT2JqZWN0Lm9ic2VydmUgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzLiIpO3JldHVybiBiKHQsIHIsIG8pLCB0OwogICAgICAgIH0sIGUudW5vYnNlcnZlID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIGlmIChudWxsID09PSBlIHx8ICJvYmplY3QiICE9ICh0eXBlb2YgZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZSkpICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC51bm9ic2VydmUgY2Fubm90IHVub2JzZXJ2ZSBub24tb2JqZWN0Iik7aWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIHQpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC51bm9ic2VydmUgY2Fubm90IGRlbGl2ZXIgdG8gbm9uLWZ1bmN0aW9uIik7dmFyIHIsCiAgICAgICAgICAgICAgbiA9IGkuZ2V0KHQpO3JldHVybiBuICYmIChyID0gbi5vYnNlcnZlZC5nZXQoZSkpICYmIChuLm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgdihlLmRhdGEsIHQpOwogICAgICAgICAgfSksIHAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfKG4sIHQpOwogICAgICAgICAgfSksIDEgPT09IG4ub2JzZXJ2ZWQuc2l6ZSAmJiBuLm9ic2VydmVkLmhhcyhlKSA/IGlbImRlbGV0ZSJdKHQpIDogbi5vYnNlcnZlZFsiZGVsZXRlIl0oZSksIDEgPT09IHIuZGF0YS5oYW5kbGVycy5zaXplID8gb1siZGVsZXRlIl0oZSkgOiByLmRhdGEuaGFuZGxlcnNbImRlbGV0ZSJdKHQpKSwgZTsKICAgICAgICB9LCBlLmdldE5vdGlmaWVyID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIGlmIChudWxsID09PSB0IHx8ICJvYmplY3QiICE9ICh0eXBlb2YgdCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YodCkpICYmICJmdW5jdGlvbiIgIT0gdHlwZW9mIHQpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5nZXROb3RpZmllciBjYW5ub3QgZ2V0Tm90aWZpZXIgbm9uLW9iamVjdCIpO3JldHVybiBlLmlzRnJvemVuICYmIGUuaXNGcm96ZW4odCkgPyBudWxsIDogZyh0KTsKICAgICAgICB9LCBlLmRlbGl2ZXJDaGFuZ2VSZWNvcmRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3QuZGVsaXZlckNoYW5nZVJlY29yZHMgY2Fubm90IGRlbGl2ZXIgdG8gbm9uLWZ1bmN0aW9uIik7dmFyIHQgPSBpLmdldChlKTt0ICYmICh0Lm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgdihlLmRhdGEsIHQpOwogICAgICAgICAgfSksIF8odCwgZSkpOwogICAgICAgIH07CiAgICAgIH0oT2JqZWN0LCBBcnJheSwgdGhpcyk7CiAgICB9LCB7fV0sIDkyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pLCByLkRhdGFPYmplY3RPYnNlcnZlciA9IHIuRGF0YU9iamVjdFJlcG9ydGVyID0gci5TeW5jaGVyID0gdm9pZCAwLCBlKCJtdXRhdGlvbm9ic2VydmVyLXNoaW0iKSwgZSgib2JqZWN0Lm9ic2VydmUiKSwgZSgiYXJyYXkub2JzZXJ2ZSIpO3ZhciBvID0gZSgiLi9zeW5jaGVyL1N5bmNoZXIiKSwKICAgICAgICAgIGkgPSBuKG8pLAogICAgICAgICAgcyA9IGUoIi4vc3luY2hlci9EYXRhT2JqZWN0UmVwb3J0ZXIiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoIi4vc3luY2hlci9EYXRhT2JqZWN0T2JzZXJ2ZXIiKSwKICAgICAgICAgIHUgPSBuKGMpO3IuU3luY2hlciA9IGlbImRlZmF1bHQiXSwgci5EYXRhT2JqZWN0UmVwb3J0ZXIgPSBhWyJkZWZhdWx0Il0sIHIuRGF0YU9iamVjdE9ic2VydmVyID0gdVsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi9zeW5jaGVyL0RhdGFPYmplY3RPYnNlcnZlciI6IDk1LCAiLi9zeW5jaGVyL0RhdGFPYmplY3RSZXBvcnRlciI6IDk2LCAiLi9zeW5jaGVyL1N5bmNoZXIiOiA5OSwgImFycmF5Lm9ic2VydmUiOiAxLCAibXV0YXRpb25vYnNlcnZlci1zaGltIjogOTAsICJvYmplY3Qub2JzZXJ2ZSI6IDkxIH1dLCA5MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCIuL1N5bmNPYmplY3QiKSwKICAgICAgICAgIHAgPSBuKGQpLAogICAgICAgICAgYiA9IGUoIi4vRGF0YU9iamVjdENoaWxkIiksCiAgICAgICAgICBoID0gbihiKSwKICAgICAgICAgIHYgPSBlKCIuLi91dGlscy91dGlscy5qcyIpLAogICAgICAgICAgeSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiBlKHQsIHIsIG4sIG8sIGksIHMpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIGUpO3ZhciBhID0gdGhpczthLl9zeW5jaGVyID0gdCwgYS5fdXJsID0gciwgYS5fc2NoZW1hID0gbiwgYS5fc3RhdHVzID0gbywgYS5fc3luY09iaiA9IG5ldyBwWyJkZWZhdWx0Il0oaSksIGEuX2NoaWxkcmVucyA9IHMsIGEuX3ZlcnNpb24gPSAwLCBhLl9jaGlsZElkID0gMCwgYS5fY2hpbGRyZW5PYmplY3RzID0ge30sIGEuX2NoaWxkcmVuTGlzdGVuZXJzID0gW10sIGEuX293bmVyID0gdC5fb3duZXIsIGEuX2J1cyA9IHQuX2J1czsKICAgICAgICB9cmV0dXJuICgwLCBmWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzLAogICAgICAgICAgICAgICAgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gdC5fdXJsICsgIi9jaGlsZHJlbi8iO3QuX2NoaWxkcmVucyAmJiB0Ll9jaGlsZHJlbnMuZm9yRWFjaChmdW5jdGlvbiAobikgewogICAgICAgICAgICAgIHZhciBvID0gciArIG4sCiAgICAgICAgICAgICAgICAgIGkgPSB0Ll9idXMuYWRkTGlzdGVuZXIobywgZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICAgIGlmIChyLmZyb20gIT09IGUuX293bmVyKSBzd2l0Y2ggKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0LUNoaWxkcmVuLVJDVjogIiwgciksIHIudHlwZSkge2Nhc2UgImNyZWF0ZSI6CiAgICAgICAgICAgICAgICAgICAgdC5fb25DaGlsZENyZWF0ZShyKTticmVhaztjYXNlICJkZWxldGUiOgogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHIpO2JyZWFrO2RlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgdC5fY2hhbmdlQ2hpbGRyZW4ocik7fQogICAgICAgICAgICAgIH0pO3QuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2goaSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXM7ZS5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGUucmVtb3ZlKCk7CiAgICAgICAgICAgIH0pLCAoMCwgYVsiZGVmYXVsdCJdKShlLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlLl9jaGlsZHJlbk9iamVjdHNbdF0uX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAicGF1c2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHRocm93ICJOb3QgaW1wbGVtZW50ZWQiOwogICAgICAgICAgfSB9LCB7IGtleTogInJlc3VtZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdGhyb3cgIk5vdCBpbXBsZW1lbnRlZCI7CiAgICAgICAgICB9IH0sIHsga2V5OiAic3RvcCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdGhyb3cgIk5vdCBpbXBsZW1lbnRlZCI7CiAgICAgICAgICB9IH0sIHsga2V5OiAiYWRkQ2hpbGQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7ci5fY2hpbGRJZCsrO3ZhciBuID0gci5fb3duZXIgKyAiIyIgKyByLl9jaGlsZElkLAogICAgICAgICAgICAgICAgbyA9IHIuX3VybCArICIvY2hpbGRyZW4vIiArIGUsCiAgICAgICAgICAgICAgICBzID0geyB0eXBlOiAiY3JlYXRlIiwgZnJvbTogci5fb3duZXIsIHRvOiBvLCBib2R5OiB7IHJlc291cmNlOiBuLCB2YWx1ZTogdCB9IH07cmV0dXJuIG5ldyBpWyJkZWZhdWx0Il0oZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB2YXIgaSA9IHIuX2J1cy5wb3N0TWVzc2FnZShzKTtjb25zb2xlLmxvZygiY3JlYXRlLXJlcG9ydGVyLWNoaWxkKCAiICsgci5fb3duZXIgKyAiICk6ICIsIHMpO3ZhciBhID0gbmV3IGhbImRlZmF1bHQiXShyLCBuLCB0LCByLl9vd25lciwgaSk7YS5vbkNoYW5nZShmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgci5fb25DaGFuZ2UoZSwgeyBwYXRoOiBvLCBjaGlsZElkOiBuIH0pOwogICAgICAgICAgICAgIH0pLCByLl9jaGlsZHJlbk9iamVjdHNbbl0gPSBhLCBlKGEpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvbkFkZENoaWxkIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoaWxkQ3JlYXRlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IGUuYm9keS5yZXNvdXJjZTtjb25zb2xlLmxvZygiY3JlYXRlLW9ic2VydmVyLWNoaWxkKCAiICsgdC5fb3duZXIgKyAiICk6ICIsIGUpO3ZhciBuID0gbmV3IGhbImRlZmF1bHQiXSh0LCByLCBlLmJvZHkudmFsdWUpO3QuX2NoaWxkcmVuT2JqZWN0c1tyXSA9IG4sIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IDIwMCwgc291cmNlOiB0Ll9vd25lciB9IH0pOwogICAgICAgICAgICB9KTt2YXIgbyA9IHsgdHlwZTogZS50eXBlLCBmcm9tOiBlLmZyb20sIHVybDogZS50bywgdmFsdWU6IGUuYm9keS52YWx1ZSwgY2hpbGRJZDogciwgaWRlbnRpdHk6IGUuYm9keS5pZGVudGl0eSB9O3QuX29uQWRkQ2hpbGRyZW5IYW5kbGVyICYmIChjb25zb2xlLmxvZygiQURELUNISUxEUkVOLUVWRU5UOiAiLCBvKSwgdC5fb25BZGRDaGlsZHJlbkhhbmRsZXIobykpOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoYW5nZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gdGhpcztpZiAoci5fdmVyc2lvbisrLCAib24iID09PSByLl9zdGF0dXMpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHsgdHlwZTogInVwZGF0ZSIsIGZyb206IHIuX3VybCwgdG86IHIuX3VybCArICIvY2hhbmdlcyIsIGJvZHk6IHsgdmVyc2lvbjogci5fdmVyc2lvbiwgc291cmNlOiByLl9vd25lciwgYXR0cmlidXRlOiBlLmZpZWxkIH0gfTtlLm9UeXBlID09PSBkLk9iamVjdFR5cGUuT0JKRUNUID8gZS5jVHlwZSAhPT0gZC5DaGFuZ2VUeXBlLlJFTU9WRSAmJiAobi5ib2R5LnZhbHVlID0gZS5kYXRhKSA6IChuLmJvZHkuYXR0cmlidXRlVHlwZSA9IGUub1R5cGUsIG4uYm9keS52YWx1ZSA9IGUuZGF0YSwgZS5jVHlwZSAhPT0gZC5DaGFuZ2VUeXBlLlVQREFURSAmJiAobi5ib2R5Lm9wZXJhdGlvbiA9IGUuY1R5cGUpKSwgdCAmJiAobi50byA9IHQucGF0aCwgbi5ib2R5LnJlc291cmNlID0gdC5jaGlsZElkKSwgci5fYnVzLnBvc3RNZXNzYWdlKG4pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IH0sIHsga2V5OiAiX2NoYW5nZU9iamVjdCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gdGhpcztpZiAoci5fdmVyc2lvbiArIDEgPT09IHQuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgICAgICAgci5fdmVyc2lvbisrO3ZhciBuID0gdC5ib2R5LmF0dHJpYnV0ZSwKICAgICAgICAgICAgICAgICAgbyA9ICgwLCB2LmRlZXBDbG9uZSkodC5ib2R5LnZhbHVlKSwKICAgICAgICAgICAgICAgICAgaSA9IGUuZmluZEJlZm9yZShuKTtpZiAodC5ib2R5LmF0dHJpYnV0ZVR5cGUgPT09IGQuT2JqZWN0VHlwZS5BUlJBWSkgewogICAgICAgICAgICAgICAgaWYgKHQuYm9keS5vcGVyYXRpb24gPT09IGQuQ2hhbmdlVHlwZS5BREQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHMgPSBpLm9iaiwKICAgICAgICAgICAgICAgICAgICAgIGEgPSBpLmxhc3Q7QXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShzLCBbYSwgMF0uY29uY2F0KG8pKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5ib2R5Lm9wZXJhdGlvbiA9PT0gZC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICAgICAgICB2YXIgYyA9IGkub2JqLAogICAgICAgICAgICAgICAgICAgICAgdSA9IGkubGFzdDtjLnNwbGljZSh1LCBvKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpLm9ialtpLmxhc3RdID0gbzsKICAgICAgICAgICAgICB9IGVsc2UgdC5ib2R5LnZhbHVlID8gaS5vYmpbaS5sYXN0XSA9IG8gOiBkZWxldGUgaS5vYmpbaS5sYXN0XTsKICAgICAgICAgICAgfSBlbHNlIGNvbnNvbGUubG9nKCJVTlNZTkNIUk9OSVpFRCBWRVJTSU9OOiAoZGF0YSA9PiAiICsgci5fdmVyc2lvbiArICIsIG1zZyA9PiAiICsgdC5ib2R5LnZlcnNpb24gKyAiKSIpOwogICAgICAgICAgfSB9LCB7IGtleTogIl9jaGFuZ2VDaGlsZHJlbiIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcztjb25zb2xlLmxvZygiQ2hhbmdlIGNoaWxkcmVuOiAiLCB0Ll9vd25lciwgZSk7dmFyIHIgPSBlLmJvZHkucmVzb3VyY2UsCiAgICAgICAgICAgICAgICBuID0gdC5fY2hpbGRyZW5PYmplY3RzW3JdO24gPyB0Ll9jaGFuZ2VPYmplY3Qobi5fc3luY09iaiwgZSkgOiBjb25zb2xlLmxvZygiTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAiLCByKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJ1cmwiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzY2hlbWEiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtYTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzdGF0dXMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1czsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkYXRhIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICAgICAgICB9IH0sIHsga2V5OiAiY2hpbGRyZW5zIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpO3JbImRlZmF1bHQiXSA9IHksIHQuZXhwb3J0cyA9IHJbImRlZmF1bHQiXTsKICAgIH0sIHsgIi4uL3V0aWxzL3V0aWxzLmpzIjogMTAwLCAiLi9EYXRhT2JqZWN0Q2hpbGQiOiA5NCwgIi4vU3luY09iamVjdCI6IDk4LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjogNywgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIjogOSwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDExLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjogMTIgfV0sIDk0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBvID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoIi4vU3luY09iamVjdCIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCwgciwgbiwgbywgcykgewogICAgICAgICAgKDAsIGlbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIGEgPSB0aGlzO2EuX3BhcmVudCA9IHQsIGEuX2NoaWxkSWQgPSByLCBhLl9vd25lciA9IG8sIGEuX21zZ0lkID0gcywgYS5fc3luY09iaiA9IG5ldyB1WyJkZWZhdWx0Il0obiksIGEuX2J1cyA9IHQuX2J1cywgYS5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX293bmVyICYmIChlLl9saXN0ZW5lciA9IGUuX2J1cy5hZGRMaXN0ZW5lcihlLl9vd25lciwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAicmVzcG9uc2UiID09PSB0LnR5cGUgJiYgdC5pZCA9PT0gZS5fbXNnSWQgJiYgKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZToiLCB0KSwgZS5fb25SZXNwb25zZSh0KSk7CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfcmVsZWFzZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX2xpc3RlbmVyICYmIGUuX2xpc3RlbmVyLnJlbW92ZSgpOwogICAgICAgICAgfSB9LCB7IGtleTogImRlbGV0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2RlbGV0ZSBlLl9wYXJlbnQuX2NoaWxkcmVuW2UuX2NoaWxkSWRdLCBlLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICB9IH0sIHsga2V5OiAib25DaGFuZ2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlKHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvblJlc3BvbnNlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIl9vblJlc3BvbnNlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHsgdHlwZTogZS50eXBlLCB1cmw6IGUuYm9keS5zb3VyY2UsIGNvZGU6IGUuYm9keS5jb2RlIH07dC5fb25SZXNwb25zZUhhbmRsZXIgJiYgdC5fb25SZXNwb25zZUhhbmRsZXIocik7CiAgICAgICAgICB9IH0sIHsga2V5OiAiY2hpbGRJZCIsIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkYXRhIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpO3JbImRlZmF1bHQiXSA9IGwsIHQuZXhwb3J0cyA9IHJbImRlZmF1bHQiXTsKICAgIH0sIHsgIi4vU3luY09iamVjdCI6IDk4LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiKSwKICAgICAgICAgIGkgPSBuKG8pLAogICAgICAgICAgcyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiIpLAogICAgICAgICAgYSA9IG4ocyksCiAgICAgICAgICBjID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICB1ID0gbihjKSwKICAgICAgICAgIGwgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIGYgPSBuKGwpLAogICAgICAgICAgZCA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiksCiAgICAgICAgICBwID0gbihkKSwKICAgICAgICAgIGIgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IiksCiAgICAgICAgICBoID0gbihiKSwKICAgICAgICAgIHYgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiKSwKICAgICAgICAgIHkgPSBuKHYpLAogICAgICAgICAgXyA9IGUoIi4vRGF0YU9iamVjdCIpLAogICAgICAgICAgZyA9IG4oXyksCiAgICAgICAgICBtID0gZSgiLi9EYXRhT2JqZWN0Q2hpbGQiKSwKICAgICAgICAgIGogPSBuKG0pLAogICAgICAgICAgJCA9IHsgQU5ZOiAiYW55IiwgU1RBUlQ6ICJzdGFydCIsIEVYQUNUOiAiZXhhY3QiIH0sCiAgICAgICAgICBPID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBmdW5jdGlvbiB0KGUsIHIsIG4sIG8sIHMsIGMsIGwpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIHQpO3ZhciBmID0gKDAsIHBbImRlZmF1bHQiXSkodGhpcywgKDAsIGFbImRlZmF1bHQiXSkodCkuY2FsbCh0aGlzLCBlLCByLCBuLCBvLCBzLmRhdGEsIGMpKSwKICAgICAgICAgICAgICBkID0gZjtyZXR1cm4gZC5fdmVyc2lvbiA9IGwsIGQuX2ZpbHRlcnMgPSB7fSwgZC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGQuX29uRmlsdGVyKGUpOwogICAgICAgICAgfSksICgwLCBpWyJkZWZhdWx0Il0pKHMuY2hpbGRyZW5zKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHZhciB0ID0gcy5jaGlsZHJlbnNbZV07ZC5fY2hpbGRyZW5PYmplY3RzW2VdID0gbmV3IGpbImRlZmF1bHQiXShkLCBlLCB0KTsKICAgICAgICAgIH0pLCBkLl9hbGxvY2F0ZUxpc3RlbmVycygpLCBmOwogICAgICAgIH1yZXR1cm4gKDAsIHlbImRlZmF1bHQiXSkodCwgZSksICgwLCBmWyJkZWZhdWx0Il0pKHQsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgKDAsIGhbImRlZmF1bHQiXSkoKDAsIGFbImRlZmF1bHQiXSkodC5wcm90b3R5cGUpLCAiX2FsbG9jYXRlTGlzdGVuZXJzIiwgdGhpcykuY2FsbCh0aGlzKTt2YXIgZSA9IHRoaXM7ZS5fY2hhbmdlTGlzdGVuZXIgPSBlLl9idXMuYWRkTGlzdGVuZXIoZS5fdXJsICsgIi9jaGFuZ2VzIiwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAidXBkYXRlIiA9PT0gdC50eXBlICYmIChjb25zb2xlLmxvZygiRGF0YU9iamVjdE9ic2VydmVyLSIgKyBlLl91cmwgKyAiLVJDVjogIiwgdCksIGUuX2NoYW5nZU9iamVjdChlLl9zeW5jT2JqLCB0KSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICAoMCwgaFsiZGVmYXVsdCJdKSgoMCwgYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksICJfcmVsZWFzZUxpc3RlbmVycyIsIHRoaXMpLmNhbGwodGhpcyk7dmFyIGUgPSB0aGlzO2UuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgICAgICAgfSB9LCB7IGtleTogImRlbGV0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX3JlbGVhc2VMaXN0ZW5lcnMoKSwgZGVsZXRlIGUuX3N5bmNoZXIuX29ic2VydmVyc1tlLl91cmxdOwogICAgICAgICAgfSB9LCB7IGtleTogInVuc3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMsCiAgICAgICAgICAgICAgICB0ID0geyB0eXBlOiAidW5zdWJzY3JpYmUiLCBmcm9tOiBlLl9vd25lciwgdG86IGUuX3N5bmNoZXIuX3N1YlVSTCwgYm9keTogeyByZXNvdXJjZTogZS5fdXJsIH0gfTtlLl9idXMucG9zdE1lc3NhZ2UodCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAiLCB0KSwgMjAwID09PSB0LmJvZHkuY29kZSAmJiAoZS5fcmVsZWFzZUxpc3RlbmVycygpLCBkZWxldGUgZS5fc3luY2hlci5fb2JzZXJ2ZXJzW2UuX3VybF0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvbkNoYW5nZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciByID0gZSwKICAgICAgICAgICAgICAgIG4gPSB7IHR5cGU6ICQuRVhBQ1QsIGNhbGxiYWNrOiB0IH0sCiAgICAgICAgICAgICAgICBvID0gZS5pbmRleE9mKCIqIik7byA9PT0gZS5sZW5ndGggLSAxICYmICgwID09PSBvID8gbi50eXBlID0gJC5BTlkgOiAobi50eXBlID0gJC5TVEFSVCwgciA9IGUuc3Vic3RyKDAsIGUubGVuZ3RoIC0gMSkpKSwgdGhpcy5fZmlsdGVyc1tyXSA9IG47CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uRmlsdGVyIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzOygwLCBpWyJkZWZhdWx0Il0pKHQuX2ZpbHRlcnMpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHQuX2ZpbHRlcnNbcl07bi50eXBlID09PSAkLkFOWSA/IG4uY2FsbGJhY2soZSkgOiBuLnR5cGUgPT09ICQuU1RBUlQgPyAwID09PSBlLmZpZWxkLmluZGV4T2YocikgJiYgbi5jYWxsYmFjayhlKSA6IG4udHlwZSA9PT0gJC5FWEFDVCAmJiBlLmZpZWxkID09PSByICYmIG4uY2FsbGJhY2soZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9XSksIHQ7CiAgICAgIH0oZ1siZGVmYXVsdCJdKTtyWyJkZWZhdWx0Il0gPSBPLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuL0RhdGFPYmplY3QiOiA5MywgIi4vRGF0YU9iamVjdENoaWxkIjogOTQsICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiOiA2LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjogNywgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6IDExLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjogMTIsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IjogMTMsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiOiAxNCwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjogMTUgfV0sIDk2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBvID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksCiAgICAgICAgICBpID0gbihvKSwKICAgICAgICAgIHMgPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiKSwKICAgICAgICAgIGEgPSBuKHMpLAogICAgICAgICAgYyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgdSA9IG4oYyksCiAgICAgICAgICBsID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIpLAogICAgICAgICAgcCA9IG4oZCksCiAgICAgICAgICBiID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2dldCIpLAogICAgICAgICAgaCA9IG4oYiksCiAgICAgICAgICB2ID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIiksCiAgICAgICAgICB5ID0gbih2KSwKICAgICAgICAgIF8gPSBlKCIuL0RhdGFPYmplY3QiKSwKICAgICAgICAgIGcgPSBuKF8pLAogICAgICAgICAgbSA9IGUoIi4uL3V0aWxzL3V0aWxzLmpzIiksCiAgICAgICAgICBqID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBmdW5jdGlvbiB0KGUsIHIsIG4sIG8sIGksIHMpIHsKICAgICAgICAgICgwLCB1WyJkZWZhdWx0Il0pKHRoaXMsIHQpO3ZhciBjID0gKDAsIHBbImRlZmF1bHQiXSkodGhpcywgKDAsIGFbImRlZmF1bHQiXSkodCkuY2FsbCh0aGlzLCBlLCByLCBuLCBvLCBpLCBzKSksCiAgICAgICAgICAgICAgbCA9IGM7cmV0dXJuIGwuX3N1YnNjcmlwdGlvbnMgPSB7fSwgbC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItIiArIHIgKyAiLVNFTkQ6ICIsIGUpLCBsLl9vbkNoYW5nZShlKTsKICAgICAgICAgIH0pLCBsLl9hbGxvY2F0ZUxpc3RlbmVycygpLCBjOwogICAgICAgIH1yZXR1cm4gKDAsIHlbImRlZmF1bHQiXSkodCwgZSksICgwLCBmWyJkZWZhdWx0Il0pKHQsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgKDAsIGhbImRlZmF1bHQiXSkoKDAsIGFbImRlZmF1bHQiXSkodC5wcm90b3R5cGUpLCAiX2FsbG9jYXRlTGlzdGVuZXJzIiwgdGhpcykuY2FsbCh0aGlzKTt2YXIgZSA9IHRoaXM7ZS5fcmVzcG9uc2VMaXN0ZW5lciA9IGUuX2J1cy5hZGRMaXN0ZW5lcihlLl91cmwsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgInJlc3BvbnNlIiA9PT0gdC50eXBlICYmIGUuX29uUmVzcG9uc2UodCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9yZWxlYXNlTGlzdGVuZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICAoMCwgaFsiZGVmYXVsdCJdKSgoMCwgYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksICJfcmVsZWFzZUxpc3RlbmVycyIsIHRoaXMpLmNhbGwodGhpcyk7dmFyIGUgPSB0aGlzO2UuX3Jlc3BvbnNlTGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiaW52aXRlT2JzZXJ2ZXJzIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHsgdHlwZTogImNyZWF0ZSIsIGZyb206IHQuX3N5bmNoZXIuX293bmVyLCB0bzogdC5fc3luY2hlci5fc3ViVVJMLCBib2R5OiB7IHJlc291cmNlOiB0Ll91cmwsIHNjaGVtYTogdC5fc2NoZW1hLCB2YWx1ZTogdC5fc3luY09iai5kYXRhLCBhdXRob3Jpc2U6IGUgfSB9O3QuX2J1cy5wb3N0TWVzc2FnZShyKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJkZWxldGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpcywKICAgICAgICAgICAgICAgIHQgPSB7IHR5cGU6ICJkZWxldGUiLCBmcm9tOiBlLl9vd25lciwgdG86IGUuX3N5bmNoZXIuX3N1YlVSTCwgYm9keTogeyByZXNvdXJjZTogZS5fdXJsIH0gfTtlLl9idXMucG9zdE1lc3NhZ2UodCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YU9iamVjdFJlcG9ydGVyLURFTEVURTogIiwgdCksIDIwMCA9PT0gdC5ib2R5LmNvZGUgJiYgKGUuX3JlbGVhc2VMaXN0ZW5lcnMoKSwgZGVsZXRlIGUuX3N5bmNoZXIuX3JlcG9ydGVyc1tlLl91cmxdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAib25TdWJzY3JpcHRpb24iLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIgPSBlOwogICAgICAgICAgfSB9LCB7IGtleTogIm9uUmVzcG9uc2UiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGU7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uRm9yd2FyZCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcztzd2l0Y2ggKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItUkNWOiAiLCBlKSwgZS5ib2R5LnR5cGUpIHtjYXNlICJzdWJzY3JpYmUiOgogICAgICAgICAgICAgICAgdC5fb25TdWJzY3JpYmUoZSk7YnJlYWs7Y2FzZSAidW5zdWJzY3JpYmUiOgogICAgICAgICAgICAgICAgdC5fb25VblN1YnNjcmliZShlKTt9CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uU3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IGUuYm9keS5mcm9tLAogICAgICAgICAgICAgICAgbiA9IHsgdHlwZTogZS5ib2R5LnR5cGUsIHVybDogciwgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHsgdXJsOiByLCBzdGF0dXM6ICJvbiIgfTt0Ll9zdWJzY3JpcHRpb25zW3JdID0gbjt2YXIgbyA9IHt9O3JldHVybiAoMCwgaVsiZGVmYXVsdCJdKSh0Ll9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgdmFyIHIgPSB0Ll9jaGlsZHJlbk9iamVjdHNbZV0uZGF0YTtvW2VdID0gKDAsIG0uZGVlcENsb25lKShyKTsKICAgICAgICAgICAgICAgIH0pLCB0Ll9idXMucG9zdE1lc3NhZ2UoeyBpZDogZS5pZCwgdHlwZTogInJlc3BvbnNlIiwgZnJvbTogZS50bywgdG86IGUuZnJvbSwgYm9keTogeyBjb2RlOiAyMDAsIHNjaGVtYTogdC5fc2NoZW1hLCB2ZXJzaW9uOiB0Ll92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgbS5kZWVwQ2xvbmUpKHQuZGF0YSksIGNoaWxkcmVuczogbyB9IH0gfSksIG47CiAgICAgICAgICAgICAgfSwgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocikgewogICAgICAgICAgICAgICAgdC5fYnVzLnBvc3RNZXNzYWdlKHsgaWQ6IGUuaWQsIHR5cGU6ICJyZXNwb25zZSIsIGZyb206IGUudG8sIHRvOiBlLmZyb20sIGJvZHk6IHsgY29kZTogNDAzLCBkZXNjOiByIH0gfSk7CiAgICAgICAgICAgICAgfSB9O3QuX29uU3Vic2NyaXB0aW9uSGFuZGxlciAmJiAoY29uc29sZS5sb2coIlNVQlNDUklQVElPTi1FVkVOVDogIiwgbiksIHQuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihuKSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX29uVW5TdWJzY3JpYmUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5ib2R5LmZyb20sCiAgICAgICAgICAgICAgICBuID0gdC5fc3Vic2NyaXB0aW9uc1tyXTtkZWxldGUgdC5fc3Vic2NyaXB0aW9uc1tyXTt2YXIgbyA9IHsgdHlwZTogZS5ib2R5LnR5cGUsIHVybDogciwgb2JqZWN0OiBuIH07dC5fb25TdWJzY3JpcHRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAiLCBvKSwgdC5fb25TdWJzY3JpcHRpb25IYW5kbGVyKG8pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZXNwb25zZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcywKICAgICAgICAgICAgICAgIHIgPSB7IHR5cGU6IGUudHlwZSwgdXJsOiBlLmZyb20sIGNvZGU6IGUuYm9keS5jb2RlIH07dC5fb25SZXNwb25zZUhhbmRsZXIgJiYgKGNvbnNvbGUubG9nKCJSRVNQT05TRS1FVkVOVDogIiwgciksIHQuX29uUmVzcG9uc2VIYW5kbGVyKHIpKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJzdWJzY3JpcHRpb25zIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgICAgICAgfSB9XSksIHQ7CiAgICAgIH0oZ1siZGVmYXVsdCJdKTtyWyJkZWZhdWx0Il0gPSBqLCB0LmV4cG9ydHMgPSByWyJkZWZhdWx0Il07CiAgICB9LCB7ICIuLi91dGlscy91dGlscy5qcyI6IDEwMCwgIi4vRGF0YU9iamVjdCI6IDkzLCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjogNiwgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cyI6IDcsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOiAxMSwgImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI6IDEyLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2dldCI6IDEzLCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIjogMTQsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI6IDE1IH1dLCA5NzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsgImRlZmF1bHQiOiBlIH07CiAgICAgIH1PYmplY3QuZGVmaW5lUHJvcGVydHkociwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiAhMCB9KTt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZSh0LCByLCBuLCBvKSB7CiAgICAgICAgICAoMCwgaVsiZGVmYXVsdCJdKSh0aGlzLCBlKTt2YXIgcyA9IHRoaXM7cy5fb3duZXIgPSB0LCBzLl91cmwgPSByLCBzLl9idXMgPSBuLCBzLl9jaGlsZHJlbiA9IG8sIHMuX2NoYW5nZXMgPSBbXSwgcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgICAgICB9cmV0dXJuICgwLCBhWyJkZWZhdWx0Il0pKGUsIFt7IGtleTogIl9hbGxvY2F0ZUxpc3RlbmVycyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzO2UuX2xpc3RlbmVyID0gZS5fYnVzLmFkZExpc3RlbmVyKGUuX3VybCwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRGF0YVByb3Zpc2lvbmFsLSIgKyBlLl91cmwgKyAiLVJDVjogIiwgdCksIGUuX2NoYW5nZXMucHVzaCh0KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAiX3JlbGVhc2VMaXN0ZW5lcnMiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpcztlLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJhcHBseSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpczt0Ll9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlLl9jaGFuZ2VPYmplY3QoZS5fc3luY09iaiwgdCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogImNoaWxkcmVuIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gYywgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSksIHIuT2JqZWN0VHlwZSA9IHIuQ2hhbmdlVHlwZSA9IHZvaWQgMDt2YXIgbyA9IGUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cyIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIHUgPSBuKGMpLAogICAgICAgICAgbCA9IGUoIi4uL3V0aWxzL3V0aWxzLmpzIiksCiAgICAgICAgICBmID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUodCkgewogICAgICAgICAgKDAsIGFbImRlZmF1bHQiXSkodGhpcywgZSk7dmFyIHIgPSB0aGlzO3IuX29ic2VydmVycyA9IFtdLCByLl9maWx0ZXJzID0ge30sIHQgPyByLl9kYXRhID0gKDAsIGwuZGVlcENsb25lKSh0KSA6IHIuX2RhdGEgPSB7fSwgci5faW50ZXJuYWxPYnNlcnZlKG5ldyBkKCksIHIuX2RhdGEpOwogICAgICAgIH1yZXR1cm4gKDAsIHVbImRlZmF1bHQiXSkoZSwgW3sga2V5OiAib2JzZXJ2ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHRoaXMuX29ic2VydmVycy5wdXNoKGUpOwogICAgICAgICAgfSB9LCB7IGtleTogImZpbmQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IGUuc3BsaXQoIi4iKTtyZXR1cm4gdGhpcy5fZmluZFdpdGhTcGxpdCh0KTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJmaW5kQmVmb3JlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB7fSwKICAgICAgICAgICAgICAgIHIgPSBlLnNwbGl0KCIuIik7cmV0dXJuIHQubGFzdCA9IHIucG9wKCksIHQub2JqID0gdGhpcy5fZmluZFdpdGhTcGxpdChyKSwgdDsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfZmluZFdpdGhTcGxpdCIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHZhciB0ID0gdGhpcy5fZGF0YTtyZXR1cm4gZS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgdCA9IHRbZV07CiAgICAgICAgICAgIH0pLCB0OwogICAgICAgICAgfSB9LCB7IGtleTogIl9maXJlRXZlbnQiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB0aGlzLl9vYnNlcnZlcnMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHQoZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIl9pc09ic2VydmFibGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICByZXR1cm4gZS5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0IHx8IGUuY29uc3RydWN0b3IgPT09IEFycmF5OwogICAgICAgICAgfSB9LCB7IGtleTogIl9pbnRlcm5hbE9ic2VydmUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7aWYgKHIuX2lzT2JzZXJ2YWJsZSh0KSkgewogICAgICAgICAgICAgIHZhciBuID0gZnVuY3Rpb24gbih0KSB7CiAgICAgICAgICAgICAgICByLl9vbkNoYW5nZXMoZSwgdCk7CiAgICAgICAgICAgICAgfTtpZiAodC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgICAgICAgICBPYmplY3Qub2JzZXJ2ZSh0LCBuKTtmb3IgKHZhciBvIGluIHQpIHsKICAgICAgICAgICAgICAgICAgci5faXNPYnNlcnZhYmxlKHRbb10pICYmIHIuX2ludGVybmFsT2JzZXJ2ZShlWyJuZXciXShvKSwgdFtvXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgICAgICAgICAgQXJyYXkub2JzZXJ2ZSh0LCBuKTtmb3IgKHZhciBpIGluIHQpIHsKICAgICAgICAgICAgICAgICAgaWYgKHIuX2lzT2JzZXJ2YWJsZSh0W2ldKSkgewogICAgICAgICAgICAgICAgICAgIHZhciBzID0gZVsibmV3Il0obmV3IHAodFtpXSwgaSkpO3IuX2ludGVybmFsT2JzZXJ2ZShzLCB0W2ldKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSB9LCB7IGtleTogIl9vbkNoYW5nZXMiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXM7Zm9yICh2YXIgbiBpbiB0KSB7CiAgICAgICAgICAgICAgdmFyIG8gPSB0W25dLm9iamVjdCwKICAgICAgICAgICAgICAgICAgaSA9IHZvaWQgMDtpZiAoby5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0ICYmIChpID0gaC5PQkpFQ1QpLCBvLmNvbnN0cnVjdG9yID09PSBBcnJheSAmJiAoaSA9IGguQVJSQVkpLCAic3BsaWNlIiA9PT0gdFtuXS50eXBlKSAhZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIHMgPSB0W25dLmluZGV4LAogICAgICAgICAgICAgICAgICAgIGEgPSBlWyJuZXciXSgiIiArIHMpLAogICAgICAgICAgICAgICAgICAgIGMgPSBhLnRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICAgICAgdSA9IHRbbl0ucmVtb3ZlZC5sZW5ndGg7aWYgKDAgIT09IHUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGYgPSB0W25dLnJlbW92ZWQ7Zi5mb3JFYWNoKGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgICAgICAgci5faXNPYnNlcnZhYmxlKHQpICYmIGUucmVtb3ZlSW5kZXgocyArIG4pOwogICAgICAgICAgICAgICAgICB9KSwgci5fZmlyZUV2ZW50KHsgY1R5cGU6IGIuUkVNT1ZFLCBvVHlwZTogaSwgZmllbGQ6IGMsIGRhdGE6IHUgfSk7CiAgICAgICAgICAgICAgICB9dmFyIGQgPSB0W25dLmFkZGVkQ291bnQ7aWYgKDAgIT09IGQpIHsKICAgICAgICAgICAgICAgICAgdmFyIGggPSBvLnNsaWNlKHMsIHMgKyBkKTtoLmZvckVhY2goZnVuY3Rpb24gKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoci5faXNPYnNlcnZhYmxlKHQpKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IGVbIm5ldyJdKG5ldyBwKHQsIHMgKyBuKSk7ci5faW50ZXJuYWxPYnNlcnZlKG8sIHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSksIHIuX2ZpcmVFdmVudCh7IGNUeXBlOiBiLkFERCwgb1R5cGU6IGksIGZpZWxkOiBjLCBkYXRhOiAoMCwgbC5kZWVwQ2xvbmUpKGgpIH0pOwogICAgICAgICAgICAgICAgfXMgIT09IG8ubGVuZ3RoIC0gMSAmJiBlLnJlSW5kZXhGcm9tKG8pOwogICAgICAgICAgICAgIH0oKTtlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBzID0gZVsibmV3Il0odFtuXS5uYW1lKSwKICAgICAgICAgICAgICAgICAgICBhID0gcy50b1N0cmluZygpO2lmICgtMSAhPT0gYS5pbmRleE9mKCJTeW1ib2wiKSkgY29udGludWU7dmFyIGMgPSBvW3Rbbl0ubmFtZV07InVwZGF0ZSIgPT09IHRbbl0udHlwZSAmJiB0aGlzLl9maXJlRXZlbnQoeyBjVHlwZTogYi5VUERBVEUsIG9UeXBlOiBpLCBmaWVsZDogYSwgZGF0YTogKDAsIGwuZGVlcENsb25lKShjKSB9KSwgImFkZCIgPT09IHRbbl0udHlwZSAmJiAodGhpcy5faW50ZXJuYWxPYnNlcnZlKHMsIGMpLCB0aGlzLl9maXJlRXZlbnQoeyBjVHlwZTogYi5BREQsIG9UeXBlOiBpLCBmaWVsZDogYSwgZGF0YTogKDAsIGwuZGVlcENsb25lKShjKSB9KSksICJkZWxldGUiID09PSB0W25dLnR5cGUgJiYgdGhpcy5fZmlyZUV2ZW50KHsgY1R5cGU6IGIuUkVNT1ZFLCBvVHlwZTogaSwgZmllbGQ6IGEgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IH0sIHsga2V5OiAiZGF0YSIsIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCksCiAgICAgICAgICBkID0gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIGUoKSB7CiAgICAgICAgICAoMCwgYVsiZGVmYXVsdCJdKSh0aGlzLCBlKSwgdGhpcy5fcGF0aCA9IFtdLCB0aGlzLl9vYnNlcnZhYmxlcyA9IHt9OwogICAgICAgIH1yZXR1cm4gKDAsIHVbImRlZmF1bHQiXSkoZSwgW3sga2V5OiAicmVtb3ZlSW5kZXgiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICBkZWxldGUgdGhpcy5fb2JzZXJ2YWJsZXNbZV07CiAgICAgICAgICB9IH0sIHsga2V5OiAicmVJbmRleEZyb20iLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXM7KDAsIGlbImRlZmF1bHQiXSkodGhpcy5fb2JzZXJ2YWJsZXMpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICB2YXIgbiA9IHQuX29ic2VydmFibGVzW3JdLAogICAgICAgICAgICAgICAgICBvID0gZS5pbmRleE9mKG4ub2JqKTtuLmlkeCAhPSBvICYmIChuLmlkeCA9IG8sIGRlbGV0ZSB0Ll9vYnNlcnZhYmxlc1tyXSwgdC5fb2JzZXJ2YWJsZXNbb10gPSBuKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAibmV3IiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgZS5jb25zdHJ1Y3RvciA9PSBwICYmICh0aGlzLl9vYnNlcnZhYmxlc1tlLmlkeF0gPSBlKTt2YXIgdCA9IHRoaXMuY2xvbmUoKTtyZXR1cm4gdC5fcGF0aC5wdXNoKGUpLCB0OwogICAgICAgICAgfSB9LCB7IGtleTogImNsb25lIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgdCA9IG5ldyBlKCk7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHQuX3BhdGgucHVzaChlKTsKICAgICAgICAgICAgfSksIHQ7CiAgICAgICAgICB9IH0sIHsga2V5OiAidG9TdHJpbmciLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gIiI7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbiAodCwgcikgewogICAgICAgICAgICAgIDAgPT09IHIgPyBlID0gdC50b1N0cmluZygpIDogZSArPSAiLiIgKyB0LnRvU3RyaW5nKCk7CiAgICAgICAgICAgIH0pLCBlOwogICAgICAgICAgfSB9XSksIGU7CiAgICAgIH0oKSwKICAgICAgICAgIHAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZnVuY3Rpb24gZSh0LCByKSB7CiAgICAgICAgICAoMCwgYVsiZGVmYXVsdCJdKSh0aGlzLCBlKSwgdGhpcy5vYmogPSB0LCB0aGlzLmlkeCA9IHI7CiAgICAgICAgfXJldHVybiAoMCwgdVsiZGVmYXVsdCJdKShlLCBbeyBrZXk6ICJ0b1N0cmluZyIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuaWR4LnRvU3RyaW5nKCk7CiAgICAgICAgICB9IH1dKSwgZTsKICAgICAgfSgpLAogICAgICAgICAgYiA9IHIuQ2hhbmdlVHlwZSA9IHsgVVBEQVRFOiAidXBkYXRlIiwgQUREOiAiYWRkIiwgUkVNT1ZFOiAicmVtb3ZlIiB9LAogICAgICAgICAgaCA9IHIuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAib2JqZWN0IiwgQVJSQVk6ICJhcnJheSIgfTtyWyJkZWZhdWx0Il0gPSBmOwogICAgfSwgeyAiLi4vdXRpbHMvdXRpbHMuanMiOiAxMDAsICJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiOiA3LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgOTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewogICAgICAidXNlIHN0cmljdCI7CiAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7ICJkZWZhdWx0IjogZSB9OwogICAgICB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogITAgfSk7dmFyIG8gPSBlKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLAogICAgICAgICAgaSA9IG4obyksCiAgICAgICAgICBzID0gZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksCiAgICAgICAgICBhID0gbihzKSwKICAgICAgICAgIGMgPSBlKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSwKICAgICAgICAgIHUgPSBuKGMpLAogICAgICAgICAgbCA9IGUoIi4vRGF0YU9iamVjdFJlcG9ydGVyIiksCiAgICAgICAgICBmID0gbihsKSwKICAgICAgICAgIGQgPSBlKCIuL0RhdGFPYmplY3RPYnNlcnZlciIpLAogICAgICAgICAgcCA9IG4oZCksCiAgICAgICAgICBiID0gZSgiLi9EYXRhUHJvdmlzaW9uYWwiKSwKICAgICAgICAgIGggPSBuKGIpLAogICAgICAgICAgdiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiBlKHQsIHIsIG4pIHsKICAgICAgICAgICgwLCBhWyJkZWZhdWx0Il0pKHRoaXMsIGUpO3ZhciBvID0gdGhpcztvLl9vd25lciA9IHQsIG8uX2J1cyA9IHIsIG8uX3N1YlVSTCA9IG4ucnVudGltZVVSTCArICIvc20iLCBvLl9yZXBvcnRlcnMgPSB7fSwgby5fb2JzZXJ2ZXJzID0ge30sIG8uX3Byb3Zpc2lvbmFscyA9IHt9LCByLmFkZExpc3RlbmVyKHQsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmIChlLmZyb20gIT09IHQpIHN3aXRjaCAoY29uc29sZS5sb2coIlN5bmNoZXItUkNWOiAiLCBlKSwgZS50eXBlKSB7Y2FzZSAiZm9yd2FyZCI6CiAgICAgICAgICAgICAgICBvLl9vbkZvcndhcmQoZSk7YnJlYWs7Y2FzZSAiY3JlYXRlIjoKICAgICAgICAgICAgICAgIG8uX29uUmVtb3RlQ3JlYXRlKGUpO2JyZWFrO2Nhc2UgImRlbGV0ZSI6CiAgICAgICAgICAgICAgICBvLl9vblJlbW90ZURlbGV0ZShlKTt9CiAgICAgICAgICB9KTsKICAgICAgICB9cmV0dXJuICgwLCB1WyJkZWZhdWx0Il0pKGUsIFt7IGtleTogImNyZWF0ZSIsIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0LCByKSB7CiAgICAgICAgICAgIHZhciBuID0gdGhpcztyLnJlcG9ydGVyID0gbi5fb3duZXIsIHIuc2NoZW1hID0gZTt2YXIgbyA9IHsgdHlwZTogImNyZWF0ZSIsIGZyb206IG4uX293bmVyLCB0bzogbi5fc3ViVVJMLCBib2R5OiB7IHNjaGVtYTogZSwgdmFsdWU6IHIsIGF1dGhvcmlzZTogdCB9IH07cmV0dXJuIG5ldyBpWyJkZWZhdWx0Il0oZnVuY3Rpb24gKHQsIGkpIHsKICAgICAgICAgICAgICBuLl9idXMucG9zdE1lc3NhZ2UobywgZnVuY3Rpb24gKG8pIHsKICAgICAgICAgICAgICAgIGlmIChjb25zb2xlLmxvZygiY3JlYXRlLXJlc3BvbnNlOiAiLCBvKSwgMjAwID09PSBvLmJvZHkuY29kZSkgewogICAgICAgICAgICAgICAgICB2YXIgcyA9IG8uYm9keS5yZXNvdXJjZSwKICAgICAgICAgICAgICAgICAgICAgIGEgPSBuZXcgZlsiZGVmYXVsdCJdKG4sIHMsIGUsICJvbiIsIHIsIG8uYm9keS5jaGlsZHJlblJlc291cmNlcyk7bi5fcmVwb3J0ZXJzW3NdID0gYSwgdChhKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpKG8uYm9keS5kZXNjKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IH0sIHsga2V5OiAic3Vic2NyaWJlIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUsIHQpIHsKICAgICAgICAgICAgdmFyIHIgPSB0aGlzLAogICAgICAgICAgICAgICAgbiA9IHsgdHlwZTogInN1YnNjcmliZSIsIGZyb206IHIuX293bmVyLCB0bzogci5fc3ViVVJMLCBib2R5OiB7IHNjaGVtYTogZSwgcmVzb3VyY2U6IHQgfSB9O3JldHVybiBuZXcgaVsiZGVmYXVsdCJdKGZ1bmN0aW9uIChvLCBpKSB7CiAgICAgICAgICAgICAgci5fYnVzLnBvc3RNZXNzYWdlKG4sIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygic3Vic2NyaWJlLXJlc3BvbnNlOiAiLCBuKTt2YXIgcyA9IHIuX3Byb3Zpc2lvbmFsc1t0XTtpZiAoZGVsZXRlIHIuX3Byb3Zpc2lvbmFsc1t0XSwgcyAmJiBzLl9yZWxlYXNlTGlzdGVuZXJzKCksIG4uYm9keS5jb2RlIDwgMjAwKSBzID0gbmV3IGhbImRlZmF1bHQiXShyLl9vd25lciwgdCwgci5fYnVzLCBuLmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMpLCByLl9wcm92aXNpb25hbHNbdF0gPSBzO2Vsc2UgaWYgKDIwMCA9PT0gbi5ib2R5LmNvZGUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGEgPSBuZXcgcFsiZGVmYXVsdCJdKHIsIHQsIGUsICJvbiIsIG4uYm9keS52YWx1ZSwgcy5jaGlsZHJlbiwgbi5ib2R5LnZlcnNpb24pO3IuX29ic2VydmVyc1t0XSA9IGEsIG8oYSksIHMuYXBwbHkoYSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaShuLmJvZHkuZGVzYyk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIm9uTm90aWZpY2F0aW9uIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gZTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25Gb3J3YXJkIiwgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgciA9IHQuX3JlcG9ydGVyc1tlLmJvZHkudG9dO3IuX29uRm9yd2FyZChlKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZW1vdGVDcmVhdGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5mcm9tLnNsaWNlKDAsIC0xMyksCiAgICAgICAgICAgICAgICBuID0geyB0eXBlOiBlLnR5cGUsIGZyb206IGUuYm9keS5zb3VyY2UsIHVybDogciwgc2NoZW1hOiBlLmJvZHkuc2NoZW1hLCB2YWx1ZTogZS5ib2R5LnZhbHVlLCBpZGVudGl0eTogZS5ib2R5LmlkZW50aXR5LCBhY2s6IGZ1bmN0aW9uIGFjayhyKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IDIwMDtyICYmIChuID0gciksIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IG4gfSB9KTsKICAgICAgICAgICAgICB9IH07dC5fb25Ob3RpZmljYXRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLCBuKSwgdC5fb25Ob3RpZmljYXRpb25IYW5kbGVyKG4pKTsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJfb25SZW1vdGVEZWxldGUiLCB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICAgICAgICByID0gZS5ib2R5LnJlc291cmNlLAogICAgICAgICAgICAgICAgbiA9IHQuX29ic2VydmVyc1tyXTtpZiAobikgewogICAgICAgICAgICAgIHZhciBvID0geyB0eXBlOiBlLnR5cGUsIHVybDogciwgaWRlbnRpdHk6IGUuYm9keS5pZGVudGl0eSwgYWNrOiBmdW5jdGlvbiBhY2socikgewogICAgICAgICAgICAgICAgICB2YXIgbyA9IDIwMDtyICYmIChvID0gciksIDIwMCA9PT0gbyAmJiBuWyJkZWxldGUiXSgpLCB0Ll9idXMucG9zdE1lc3NhZ2UoeyBpZDogZS5pZCwgdHlwZTogInJlc3BvbnNlIiwgZnJvbTogZS50bywgdG86IGUuZnJvbSwgYm9keTogeyBjb2RlOiBvLCBzb3VyY2U6IHQuX293bmVyIH0gfSk7CiAgICAgICAgICAgICAgICB9IH07dC5fb25Ob3RpZmljYXRpb25IYW5kbGVyICYmIChjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLCBvKSwgdC5fb25Ob3RpZmljYXRpb25IYW5kbGVyKG8pKTsKICAgICAgICAgICAgfSBlbHNlIHQuX2J1cy5wb3N0TWVzc2FnZSh7IGlkOiBlLmlkLCB0eXBlOiAicmVzcG9uc2UiLCBmcm9tOiBlLnRvLCB0bzogZS5mcm9tLCBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiB0Ll9vd25lciB9IH0pOwogICAgICAgICAgfSB9LCB7IGtleTogIm93bmVyIiwgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJyZXBvcnRlcnMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlcG9ydGVyczsKICAgICAgICAgIH0gfSwgeyBrZXk6ICJvYnNlcnZlcnMiLCBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29ic2VydmVyczsKICAgICAgICAgIH0gfV0pLCBlOwogICAgICB9KCk7clsiZGVmYXVsdCJdID0gdiwgdC5leHBvcnRzID0gclsiZGVmYXVsdCJdOwogICAgfSwgeyAiLi9EYXRhT2JqZWN0T2JzZXJ2ZXIiOiA5NSwgIi4vRGF0YU9iamVjdFJlcG9ydGVyIjogOTYsICIuL0RhdGFQcm92aXNpb25hbCI6IDk3LCAiYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UiOiA5LCAiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjogMTEsICJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOiAxMiB9XSwgMTAwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogeyAiZGVmYXVsdCI6IGUgfTsKICAgICAgfWZ1bmN0aW9uIG8oZSkgewogICAgICAgIHZhciB0ID0gLyhbYS16QS1aLV0qKTpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fSkoWy1hLXpBLVowLTlAOiUuX1wrfiM9XC9dKikvZ2ksCiAgICAgICAgICAgIHIgPSAiJDEsJDIsJDMiLAogICAgICAgICAgICBuID0gZS5yZXBsYWNlKHQsIHIpLnNwbGl0KCIsIik7blswXSA9PT0gZSAmJiAoblswXSA9ICJodHRwcyIsIG5bMV0gPSBlKTt2YXIgbyA9IHsgdHlwZTogblswXSwgZG9tYWluOiBuWzFdLCBpZGVudGl0eTogblsyXSB9O3JldHVybiBvOwogICAgICB9ZnVuY3Rpb24gaShlKSB7CiAgICAgICAgcmV0dXJuIGUgPyBKU09OLnBhcnNlKCgwLCBhWyJkZWZhdWx0Il0pKGUpKSA6IHZvaWQgMDsKICAgICAgfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6ICEwIH0pO3ZhciBzID0gZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL2pzb24vc3RyaW5naWZ5IiksCiAgICAgICAgICBhID0gbihzKTtyLmRpdmlkZVVSTCA9IG8sIHIuZGVlcENsb25lID0gaTsKICAgIH0sIHsgImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSI6IDIgfV0gfSwge30sIFs5Ml0pKDkyKTsKfSk7Cgp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKfSx7fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gYWN0aXZhdGU7Cgp2YXIgX0h5cGVydHlEaXNjb3ZlcnkgPSByZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9kaXN0L0h5cGVydHlEaXNjb3ZlcnknKTsKCnZhciBfSHlwZXJ0eURpc2NvdmVyeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9IeXBlcnR5RGlzY292ZXJ5KTsKCnZhciBfU3luY2hlciA9IHJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlcicpOwoKdmFyIF9JZGVudGl0eU1hbmFnZXIgPSByZXF1aXJlKCcuL3V0aWxzL0lkZW50aXR5TWFuYWdlci5qcycpOwoKdmFyIF9JZGVudGl0eU1hbmFnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSWRlbnRpdHlNYW5hZ2VyKTsKCnZhciBfRXZlbnRFbWl0dGVyMiA9IHJlcXVpcmUoJy4vdXRpbHMvRXZlbnRFbWl0dGVyLmpzJyk7Cgp2YXIgX0V2ZW50RW1pdHRlcjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9FdmVudEVtaXR0ZXIyKTsKCnZhciBfdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzL3V0aWxzLmpzJyk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpID8gY2FsbCA6IHNlbGY7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqLwoKLy8gU2VydmljZSBGcmFtZXdvcmsKCgovLyBVdGlscwoKCnZhciBzdGF0dXMgPSB7CiAgbmFtZTogJ3N0YXR1cycsCiAgc3RhdHVzOiAnZGlzY29ubmVjdGVkJwp9OwoKLyoqCiogSHlwZXJ0eSBQcmVzZW5jZTsKKiBAYXV0aG9yIEFwaXplZSBbZGV2QGFwaXplZS5jb21dCiogQHZlcnNpb24gMC4xLjAKKi8KCnZhciBVc2VyU3RhdHVzID0gZnVuY3Rpb24gKF9FdmVudEVtaXR0ZXIpIHsKICBfaW5oZXJpdHMoVXNlclN0YXR1cywgX0V2ZW50RW1pdHRlcik7CgogIGZ1bmN0aW9uIFVzZXJTdGF0dXMoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVXNlclN0YXR1cyk7CgogICAgaWYgKCFoeXBlcnR5VVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBoeXBlcnR5VVJMIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFidXMpIHRocm93IG5ldyBFcnJvcignVGhlIE1pbmlCdXMgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgogICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFVzZXJTdGF0dXMpLmNhbGwodGhpcywgaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uKSk7CgogICAgdmFyIGRvbWFpbiA9ICgwLCBfdXRpbHMuZGl2aWRlVVJMKShoeXBlcnR5VVJMKS5kb21haW47CgogICAgX3RoaXMuX3N5bmNoZXIgPSBuZXcgX1N5bmNoZXIuU3luY2hlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pOwoKICAgIF90aGlzLl9oeXBlcnR5RGlzY292ZXJ5ID0gbmV3IF9IeXBlcnR5RGlzY292ZXJ5Mi5kZWZhdWx0KGh5cGVydHlVUkwsIGJ1cyk7CgogICAgX3RoaXMuX2lkZW50aXR5TWFuYWdlciA9IG5ldyBfSWRlbnRpdHlNYW5hZ2VyMi5kZWZhdWx0KGh5cGVydHlVUkwsIGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTCwgYnVzKTsKCiAgICBfdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovLycgKyBkb21haW4gKyAnLy53ZWxsLWtub3duL2RhdGFzY2hlbWFzL1VzZXJTdGF0dXNEYXRhU2NoZW1hJzsKCiAgICBfdGhpcy5faHlwZXJ0eVVSTCA9IGh5cGVydHlVUkw7CiAgICBfdGhpcy5fZG9tYWluID0gZG9tYWluOwoKICAgIF90aGlzLl9oZWFydGJlYXQgPSBbXTsKCiAgICBfdGhpcy5fc3luY2hlci5vbk5vdGlmaWNhdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uKGV2ZW50KTsKICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhVc2VyU3RhdHVzLCBbewogICAga2V5OiAnX29uTm90aWZpY2F0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Ob3RpZmljYXRpb24oZXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBjb25zb2xlLmluZm8oJ0V2ZW50IFJlY2VpdmVkOiAnLCBldmVudCk7CgogICAgICB0aGlzLnRyaWdnZXIoJ2ludml0YXRpb24nLCBldmVudC5pZGVudGl0eSk7CgogICAgICBldmVudC5hY2soKTsKCiAgICAgIC8vIFN1YnNjcmliZSBIZWxsbyBXb3JsZCBPYmplY3QKICAgICAgdGhpcy5fc3luY2hlci5zdWJzY3JpYmUodGhpcy5fb2JqZWN0RGVzY1VSTCwgZXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uIChzdGF0dXNPYmplY3RPYnNlcnZlcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0gU3RhdHVzIE9ic2VydmVyIHJlY2VpdmVkIC0tLS0tLS0tLScsIHN0YXR1c09iamVjdE9ic2VydmVyKTsKCiAgICAgICAgX3RoaXMyLnRyaWdnZXIoJ3N0YXR1c0NoYW5nZScsIHsKICAgICAgICAgIGlkZW50aXR5OiBldmVudC5pZGVudGl0eSwKICAgICAgICAgIHN0YXR1czogc3RhdHVzT2JqZWN0T2JzZXJ2ZXIuZGF0YS5zdGF0dXMKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMyLl9tYW5hZ2VQcmVzZW5jZUhlYXJ0YmVhdChldmVudC5pZGVudGl0eSk7CgogICAgICAgIHN0YXR1c09iamVjdE9ic2VydmVyLm9uQ2hhbmdlKCcqJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgY29uc29sZS5pbmZvKCdzdGF0dXMgZXZlbnQgcmVjZWl2ZWQ6JywgZXZlbnQpOwogICAgICAgICAgX3RoaXMyLnRyaWdnZXIoJ3N0YXR1c0NoYW5nZScsIHsKICAgICAgICAgICAgaWRlbnRpdHk6IGV2ZW50LmlkZW50aXR5LAogICAgICAgICAgICBzdGF0dXM6IHN0YXR1c09iamVjdE9ic2VydmVyLmRhdGEuc3RhdHVzCiAgICAgICAgICB9KTsKICAgICAgICAgIF90aGlzMi5fbWFuYWdlUHJlc2VuY2VIZWFydGJlYXQoZXZlbnQuaWRlbnRpdHkpOwogICAgICAgIH0pOwoKICAgICAgICBjb25zb2xlLmxvZyhldmVudC5pZGVudGl0eS5lbWFpbCwgJ2hhcyBzdWJzY3JpYmUgdG8gbXkgc3RhdHVzIGRhdGEgb2JqZWN0LCBzZW5kIGludml0ZSB0byBsaXN0ZW4gbWluZScpOwogICAgICAgIF90aGlzMi5fc3RhdHVzT2JqZWN0UmVwb3J0ZXIuaW52aXRlT2JzZXJ2ZXJzKFtldmVudC5mcm9tXSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBhIG5ldyBzdGF0dXMgb2JqZWN0IHN5bmNoZXIKICAgICAqIEBwYXJhbSAge1VSTC5Vc2VyVVJMfSBwYXJ0aWNpcGFudHMgTGlzdCBvZiBVc2VyIGFsbG93ZWQKICAgICAqIEByZXR1cm4ge1Byb21pc2V9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnY3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUocGFydGljaXBhbnRzKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgc3RhdHVzLnN0YXR1cyA9ICdjb25uZWN0ZWQnOwogICAgICAgIHN0YXR1cy5vd25lciA9IF90aGlzMy5faHlwZXJ0eVVSTDsKICAgICAgICBzdGF0dXMubmFtZSA9ICdwcmVzZW5jZSc7CgogICAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gTWFwcGluZyBQYXJ0aWNwYW50cyAtLS0tLS0tLS0tLS0tLS0tLS0tLScpOwogICAgICAgIF90aGlzMy5fbWFwcGluZ1VzZXIocGFydGljaXBhbnRzKS50aGVuKGZ1bmN0aW9uIChoeXBlcnRpZXMpIHsKICAgICAgICAgIHJldHVybiBfdGhpczMuY3JlYXRlU3luY2hlcihoeXBlcnRpZXMsIHN0YXR1cyk7CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoc3RhdHVzT2JqZWN0UmVwb3J0ZXIpIHsKICAgICAgICAgIF90aGlzMy5fc3RhdHVzT2JqZWN0UmVwb3J0ZXIgPSBzdGF0dXNPYmplY3RSZXBvcnRlcjsKICAgICAgICAgIF90aGlzMy5fc3RhdHVzT2JqZWN0UmVwb3J0ZXIub25TdWJzY3JpcHRpb24oZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0gU3RhdHVzIFJlcG9ydGVyIHJlY2VpdmVkIHN1YnNjcmlwdGlvbiByZXF1ZXN0IC0tLS0tLS0tLScsIGV2ZW50KTsKICAgICAgICAgICAgZXZlbnQuYWNjZXB0KCk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMzLl9zZW5kSGVhcnRiZWF0KCk7CiAgICAgICAgICB9LCA1MDAwMCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgcmVqZWN0KHJlYXNvbik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NyZWF0ZVN5bmNoZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVN5bmNoZXIoaHlwZXJ0aWVzLCBzdGF0dXMpIHsKICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gU3luY2hlciBDcmVhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScsIGh5cGVydGllcywgc3RhdHVzKTsKICAgICAgcmV0dXJuIHRoaXMuX3N5bmNoZXIuY3JlYXRlKHRoaXMuX29iamVjdERlc2NVUkwsIGh5cGVydGllcywgc3RhdHVzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdqb2luJywKICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luKHJlc291cmNlKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gU3luY2hlciBzdWJzY3JpYmUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpOwoKICAgICAgICBfdGhpczQuX3N5bmNoZXIuc3Vic2NyaWJlKF90aGlzNC5fb2JqZWN0RGVzY1VSTCwgcmVzb3VyY2UpLnRoZW4oZnVuY3Rpb24gKGRhdGFPYmplY3RPYnNlcnZlcikgewogICAgICAgICAgY29uc29sZS5pbmZvKCdEYXRhIE9iamVjdCBPYnNlcnZlcjogJywgZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICByZWplY3QocmVhc29uKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnc2V0U3RhdHVzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTdGF0dXMobmV3U3RhdHVzKSB7CiAgICAgIGNvbnNvbGUubG9nKCdjaGFuZ2Ugc3RhdHVzIHRvJywgbmV3U3RhdHVzKTsKICAgICAgdGhpcy5fc3RhdHVzT2JqZWN0UmVwb3J0ZXIuZGF0YS5zdGF0dXMgPSBuZXdTdGF0dXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBVcGRhdGUgc3RhdHVzIG9iamVjdCBkYXRlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnX3NlbmRIZWFydGJlYXQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kSGVhcnRiZWF0KCkgewogICAgICBjb25zb2xlLmxvZygnc2VuZCBoZWFydGJlYXQnKTsKICAgICAgdGhpcy5fc3RhdHVzT2JqZWN0UmVwb3J0ZXIuZGF0YS5kYXRlID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNb25pdG9yIHVzZXIgYWN0aXZpdHkgd2l0aGluIGhlYXJ0YmVhdCB0aW1lb3V0IHBlcmlvZAogICAgICovCgogIH0sIHsKICAgIGtleTogJ19tYW5hZ2VQcmVzZW5jZUhlYXJ0YmVhdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX21hbmFnZVByZXNlbmNlSGVhcnRiZWF0KGlkZW50aXR5KSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgY29uc29sZS5sb2coJ3JlbmV3IGhlYXJ0YmVhdCBwZXJpb2QgZm9yJywgaWRlbnRpdHkpOwogICAgICB2YXIgZW1haWwgPSBpZGVudGl0eS5lbWFpbDsKICAgICAgaWYgKGVtYWlsIGluIHRoaXMuX2hlYXJ0YmVhdCkgewogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9oZWFydGJlYXRbZW1haWxdKTsKICAgICAgfQogICAgICB0aGlzLl9oZWFydGJlYXRbZW1haWxdID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5sb2coZW1haWwsICdoYXMgZGlzY29ubmVjdCcpOwogICAgICAgIGNsZWFyVGltZW91dChfdGhpczUuX2hlYXJ0YmVhdFtlbWFpbF0pOwogICAgICAgIF90aGlzNS50cmlnZ2VyKCdzdGF0dXNDaGFuZ2UnLCB7CiAgICAgICAgICBpZGVudGl0eTogaWRlbnRpdHksCiAgICAgICAgICBzdGF0dXM6ICdkaXNjb25uZWN0ZWQnCiAgICAgICAgfSk7CiAgICAgIH0sIDYwMDAwKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfbWFwcGluZ1VzZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYXBwaW5nVXNlcih1c2VyTGlzdCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIF9tYXBwaW5nVXNlciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tJywgdXNlckxpc3QpOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgaHlwZXJ0aWVzID0gW107CiAgICAgICAgdmFyIGNvdW50ID0gMDsKCiAgICAgICAgaWYgKHVzZXJMaXN0Lmxlbmd0aCA9PT0gMCkgcmVqZWN0KGh5cGVydGllcyk7CgogICAgICAgIHZhciByZXN1bHRVc2VycyA9IGZ1bmN0aW9uIHJlc3VsdFVzZXJzKCkgewogICAgICAgICAgaWYgKGNvdW50ID09PSB1c2VyTGlzdC5sZW5ndGgpIHsKICAgICAgICAgICAgY29uc29sZS5pbmZvKCdIYXZlICcgKyBoeXBlcnRpZXMubGVuZ3RoICsgJ3VzZXJzIGZvdW5kOycpOwogICAgICAgICAgICByZXNvbHZlKGh5cGVydGllcyk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgdmFyIGFjdGl2ZVVzZXJzID0gZnVuY3Rpb24gYWN0aXZlVXNlcnModXNlcikgewogICAgICAgICAgY291bnQrKzsKICAgICAgICAgIGh5cGVydGllcy5wdXNoKHVzZXIuaHlwZXJ0eVVSTCk7CiAgICAgICAgICByZXN1bHRVc2VycygpOwogICAgICAgIH07CgogICAgICAgIHZhciBpbmFjdGl2ZVVzZXJzID0gZnVuY3Rpb24gaW5hY3RpdmVVc2VycygpIHsKICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgICByZXN1bHRVc2VycygpOwogICAgICAgIH07CgogICAgICAgIHVzZXJMaXN0LmZvckVhY2goZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXIpOwogICAgICAgICAgaWYgKHVzZXIuZW1haWwubGVuZ3RoKSB7CiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIF9tYXBwaW5nVXNlciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tJywgdXNlckxpc3QpOwogICAgICAgICAgICByZXR1cm4gX3RoaXM2Ll9oeXBlcnR5RGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0eVBlclVzZXIodXNlci5lbWFpbCwgdXNlci5kb21haW4pLnRoZW4oYWN0aXZlVXNlcnMpLmNhdGNoKGluYWN0aXZlVXNlcnMpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBVc2VyU3RhdHVzOwp9KF9FdmVudEVtaXR0ZXIzLmRlZmF1bHQpOwoKZnVuY3Rpb24gYWN0aXZhdGUoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uKSB7CgogIHJldHVybiB7CiAgICBuYW1lOiAnVXNlclN0YXR1cycsCiAgICBpbnN0YW5jZTogbmV3IFVzZXJTdGF0dXMoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uKQogIH07Cn0KCn0seyIuL3V0aWxzL0V2ZW50RW1pdHRlci5qcyI6NSwiLi91dGlscy9JZGVudGl0eU1hbmFnZXIuanMiOjYsIi4vdXRpbHMvdXRpbHMuanMiOjcsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvSHlwZXJ0eURpc2NvdmVyeSI6Miwic2VydmljZS1mcmFtZXdvcmsvZGlzdC9TeW5jaGVyIjozfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8qKgogKiBFdmVudEVtaXR0ZXIKICogQWxsIGNsYXNzZXMgd2hpY2ggZXh0ZW5kcyB0aGlzLCBjYW4gaGF2ZSBhZGRFdmVudExpc3RlbmVyIGFuZCB0cmlnZ2VyIGV2ZW50czsKICovCgp2YXIgRXZlbnRFbWl0dGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFdmVudEVtaXR0ZXIpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEV2ZW50RW1pdHRlciwgW3sKICAgIGtleTogImFkZEV2ZW50TGlzdGVuZXIiLAoKCiAgICAvKioKICAgICAqIGFkZEV2ZW50TGlzdGVuZXIgbGlzdGVuIGZvciBhbiBldmVudFR5cGUKICAgICAqIEBwYXJhbSAge3N0cmluZ30gICAgICAgICBldmVudFR5cGUgLSBsaXN0ZW5pbmcgZm9yIHRoaXMgdHlwZSBvZiBldmVudAogICAgICogQHBhcmFtICB7RnVuY3Rpb259ICAgICAgIGNiICAgICAgICAtIGNhbGxiYWNrIGZ1bmN0aW9uIHdpbGwgYmUgZXhlY3V0ZWQgd2hlbiB0aGUgZXZlbnQgaXQgaXMgaW52b2tlZAogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGNiKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzW2V2ZW50VHlwZV0gPSBjYjsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSB0aGUgZXZlbnRUeXBlCiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGV2ZW50VHlwZSAtIGV2ZW50IHdpbGwgYmUgaW52b2tlZAogICAgICogQHBhcmFtICB7b2JqZWN0fSBwYXJhbXMgLSBwYXJhbWV0ZXJzIHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBhZGRFdmVudExpc3RlbmVyCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAidHJpZ2dlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdHJpZ2dlcihldmVudFR5cGUsIHBhcmFtcykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzW2V2ZW50VHlwZV0pIHsKICAgICAgICBfdGhpc1tldmVudFR5cGVdKHBhcmFtcyk7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBFdmVudEVtaXR0ZXI7Cn0oKTsKCmV4cG9ydHMuZGVmYXVsdCA9IEV2ZW50RW1pdHRlcjsKCn0se31dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgoKdmFyIF91dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiogQ29yZSBJZGVudGl0eU1hbmFnZXIgaW50ZXJmYWNlCiogQ2xhc3MgdG8gYWxsb3cgYXBwbGljYXRpb25zIHRvIHNlYXJjaCBmb3IgSWRlbnRpdGllcyByZWdpc3RlcmVkIGluIHJ1bnRpbWUtY29yZQoqLwoKdmFyIElkZW50aXR5TWFuYWdlciA9IGZ1bmN0aW9uICgpIHsKCiAgLyoqCiAgKiBUbyBpbml0aWFsaXNlIHRoZSBJZGVudGl0eU1hbmFnZXIsIHdoaWNoIHdpbGwgcHJvdmlkZSB0aGUgc3VwcG9ydCBmb3IgaHlwZXJ0aWVzIHRvCiAgKiBxdWVyeSBhYm91dCBpZGVudGl0aWVzIHJlZ2lzdGVyZWQKICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgaHlwZXJ0eVVSTCAgICAgICAgICAgIGh5cGVydHlVUkwKICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgcnVudGltZVVSTCAgICAgICAgICAgIHJ1bnRpbWVVUkwKICAqIEBwYXJhbSAge01lc3NhZ2VCdXN9ICAgICAgICAgIG1zZ2J1cyAgICAgICAgICAgICAgICBtc2didXMKICAqLwoKICBmdW5jdGlvbiBJZGVudGl0eU1hbmFnZXIoaHlwZXJ0eVVSTCwgcnVudGltZVVSTCwgbXNnQnVzKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSWRlbnRpdHlNYW5hZ2VyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgX3RoaXMubWVzc2FnZUJ1cyA9IG1zZ0J1czsKCiAgICBfdGhpcy5kb21haW4gPSAoMCwgX3V0aWxzLmRpdmlkZVVSTCkoaHlwZXJ0eVVSTCkuZG9tYWluOwogICAgX3RoaXMuaHlwZXJ0eVVSTCA9IGh5cGVydHlVUkw7CiAgICBfdGhpcy5ydW50aW1lVVJMID0gcnVudGltZVVSTDsKICB9CgogIC8qKgogICogRnVuY3Rpb24gdG8gcXVlcnkgdGhlIHJ1bnRpbWUgcmVnaXN0cnkgYWJvdXQgdGhlIGlkZW50aXR5IHRvIHdoaWNoIHRoZSBoeXBlcnR5IHdhcyBhc3NvY2lhdGVkCiAgKiBAcGFyYW0ge1N0cmluZ30gICAgICAgaHlwZXJ0eVVSTCAgIChPcHRpb25hbCkKICAqIEByZXR1cm4ge1Byb21pc2V9ICAgICB1c2VyVVJMICAgICAgIHVzZXJVUkwgYXNzb2NpYXRlZCB0byB0aGUgaHlwZXJ0eQogICovCgoKICBfY3JlYXRlQ2xhc3MoSWRlbnRpdHlNYW5hZ2VyLCBbewogICAga2V5OiAnZGlzY292ZXJVc2VyUmVnaXN0ZXJlZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJVc2VyUmVnaXN0ZXJlZChoeXBlcnR5VVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CiAgICAgIHZhciBhY3RpdmVIeXBlcnR5VVJMID0gdm9pZCAwOwoKICAgICAgaWYgKCFoeXBlcnR5VVJMKSB7CiAgICAgICAgYWN0aXZlSHlwZXJ0eVVSTCA9IF90aGlzLmh5cGVydHlVUkw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aXZlSHlwZXJ0eVVSTCA9IGh5cGVydHlVUkw7CiAgICAgIH0KCiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBhY3RpdmVIeXBlcnR5VVJMLCB0bzogX3RoaXMucnVudGltZVVSTCArICcvcmVnaXN0cnkvJywgYm9keTogeyByZXNvdXJjZTogJy4nLCBjcml0ZXJpYTogYWN0aXZlSHlwZXJ0eVVSTCB9CiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgogICAgICAgICAgdmFyIHVzZXJVUkwgPSByZXBseS5ib2R5LnJlc291cmNlOwogICAgICAgICAgaWYgKHVzZXJVUkwpIHsKICAgICAgICAgICAgcmVzb2x2ZSh1c2VyVVJMKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdCgnTm8gdXNlciB3YXMgbm90IGZvdW5kJyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIElkZW50aXR5TWFuYWdlcjsKfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gSWRlbnRpdHlNYW5hZ2VyOwoKfSx7Ii4vdXRpbHMiOjd9XSw3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChwcm9jZXNzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kZWVwQ2xvbmUgPSBkZWVwQ2xvbmU7CmV4cG9ydHMuZ2V0Q29uZmlnID0gZ2V0Q29uZmlnOwpleHBvcnRzLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYTsKZXhwb3J0cy5zZXJpYWxpemUgPSBzZXJpYWxpemU7CmV4cG9ydHMuZ2V0VGVtcGxhdGUgPSBnZXRUZW1wbGF0ZTsKLyoqCiAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKiovCgovLyBqc2hpbnQgYnJvd3Nlcjp0cnVlLCBqcXVlcnk6IHRydWUKLy8ganNoaW50IHZhcnN0bXQ6IHRydWUKLyogZ2xvYmFsIEhhbmRsZWJhcnMgKi8KCi8qKgogKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsCiAqIEBtb2R1bGUgdXRpbHMKICovCgovKioKICogQHR5cGVkZWYgZGl2aWRlVVJMCiAqIEB0eXBlIE9iamVjdAogKiBAcHJvcGVydHkge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG9mIFVSTAogKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTAogKi8KCi8qKgogKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICogQHBhcmFtICB7VVJMLlVSTH0gdXJsIC0gdXJsIGFkZHJlc3MKICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTAogKi8KZnVuY3Rpb24gZGl2aWRlVVJMKHVybCkgewoKICAvLyBsZXQgcmUgPSAvKFthLXpBLVotXSopPzpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKSooXC9bXC9cZFx3XC4tXSopKig/OltcP10pKiguKykqL2dpOwogIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogIHZhciBzdWJzdCA9ICckMSwkMiwkMyc7CiAgdmFyIHBhcnRzID0gdXJsLnJlcGxhY2UocmUsIHN1YnN0KS5zcGxpdCgnLCcpOwoKICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgaWYgKHBhcnRzWzBdID09PSB1cmwpIHsKICAgIHBhcnRzWzBdID0gJ2h0dHBzJzsKICAgIHBhcnRzWzFdID0gdXJsOwogIH0KCiAgdmFyIHJlc3VsdCA9IHsKICAgIHR5cGU6IHBhcnRzWzBdLAogICAgZG9tYWluOiBwYXJ0c1sxXSwKICAgIGlkZW50aXR5OiBwYXJ0c1syXQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQogKiBAcGFyYW0gIHtPYmplY3R9ICBvYmogLSBvYmplY3QgdG8gYmUgY2xvbmVkCiAqIEByZXR1cm4ge09iamVjdH0KICovCmZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHsKICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uCiAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7Cn0KCi8qKgogKiBHZXQgdGhlIGNvbmZpZ3VyYXRpb24gZnJvbSBhbiBqc29uIGZpbGU7CiAqIEBwYXJhbSAge0pTT05PYmplY3R9IGpzb25GaWxlCiAqIEByZXR1cm4ge29iamVjdH0KICovCmZ1bmN0aW9uIGdldENvbmZpZyhKU09OT2JqZWN0KSB7CiAgY29uc29sZS5sb2cocHJvY2Vzcy5lbnYuZW52aXJvbm1lbnQpOwogIHJldHVybiBKU09OT2JqZWN0W3Byb2Nlc3MuZW52LmVudmlyb25tZW50XTsKfQoKLyoqCiAqIEdldCBXZWJSVEMgQVBJIHJlc291cmNlcwogKiBAcGFyYW0gIHtPYmplY3R9ICAgICBvcHRpb25zIE9iamVjdCBjb250YWluaW5nIHRoZSBpbmZvcm1hdGlvbiB0aGF0IHJlc291cmNlcyB3aWxsIGJlIHVzZWQgKGNhbWVyYSwgbWljLCByZXNvbHV0aW9uLCBldGMpOwogKiBAcmV0dXJuIHtQcm9taXNlfQogKi8KZnVuY3Rpb24gZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKSB7CgogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24gKG1lZGlhU3RyZWFtKSB7CiAgICAgIHJlc29sdmUobWVkaWFTdHJlYW0pOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICByZWplY3QocmVhc29uKTsKICAgIH0pOwogIH0pOwp9CgpmdW5jdGlvbiBzZXJpYWxpemUoKSB7CgogICQuZm4uc2VyaWFsaXplT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIG8gPSB7fTsKICAgIHZhciBhID0gdGhpcy5zZXJpYWxpemVBcnJheSgpOwogICAgJC5lYWNoKGEsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKG9bdGhpcy5uYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKCFvW3RoaXMubmFtZV0ucHVzaCkgewogICAgICAgICAgb1t0aGlzLm5hbWVdID0gW29bdGhpcy5uYW1lXV07CiAgICAgICAgfQoKICAgICAgICBvW3RoaXMubmFtZV0ucHVzaCh0aGlzLnZhbHVlIHx8ICcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvW3RoaXMubmFtZV0gPSB0aGlzLnZhbHVlIHx8ICcnOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gbzsKICB9OwoKICAkLmZuLnNlcmlhbGl6ZU9iamVjdEFycmF5ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIG8gPSB7fTsKICAgIHZhciBhID0gdGhpcy5zZXJpYWxpemVBcnJheSgpOwogICAgJC5lYWNoKGEsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKG9bdGhpcy5uYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKCFvW3RoaXMubmFtZV0ucHVzaCkgewogICAgICAgICAgb1t0aGlzLm5hbWVdID0gW29bdGhpcy5uYW1lXV07CiAgICAgICAgfQoKICAgICAgICBvW3RoaXMubmFtZV0ucHVzaCh0aGlzLnZhbHVlIHx8ICcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIW9bdGhpcy5uYW1lXSkgb1t0aGlzLm5hbWVdID0gW107CiAgICAgICAgb1t0aGlzLm5hbWVdLnB1c2godGhpcy52YWx1ZSB8fCAnJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBvOwogIH07Cn0KCmZ1bmN0aW9uIGdldFRlbXBsYXRlKHBhdGgsIHNjcmlwdCkgewoKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgIGlmIChIYW5kbGViYXJzLnRlbXBsYXRlcyA9PT0gdW5kZWZpbmVkIHx8IEhhbmRsZWJhcnMudGVtcGxhdGVzW25hbWVdID09PSB1bmRlZmluZWQpIHsKICAgICAgSGFuZGxlYmFycy50ZW1wbGF0ZXMgPSB7fTsKICAgIH0gZWxzZSB7CiAgICAgIHJlc29sdmUoSGFuZGxlYmFycy50ZW1wbGF0ZXNbbmFtZV0pOwogICAgfQoKICAgIHZhciB0ZW1wbGF0ZUZpbGUgPSAkLmFqYXgoewogICAgICB1cmw6IHBhdGggKyAnLmhicycsCiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSkgewogICAgICAgIEhhbmRsZWJhcnMudGVtcGxhdGVzW25hbWVdID0gSGFuZGxlYmFycy5jb21waWxlKGRhdGEpOwogICAgICB9LAoKICAgICAgZmFpbDogZnVuY3Rpb24gZmFpbChyZWFzb24pIHsKICAgICAgICByZXR1cm4gcmVhc29uOwogICAgICB9CiAgICB9KTsKCiAgICB2YXIgc2NyaXB0RmlsZSA9ICQuZ2V0U2NyaXB0KHNjcmlwdCk7CgogICAgdmFyIHJlcXVlc3RzID0gW107CiAgICBpZiAocGF0aCkgcmVxdWVzdHMucHVzaCh0ZW1wbGF0ZUZpbGUpOwogICAgaWYgKHNjcmlwdCkgcmVxdWVzdHMucHVzaChzY3JpcHRGaWxlKTsKCiAgICBQcm9taXNlLmFsbChyZXF1ZXN0cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgIHJlc29sdmUoSGFuZGxlYmFycy50ZW1wbGF0ZXNbbmFtZV0pOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICByZWplY3QocmVhc29uKTsKICAgIH0pOwogIH0pOwp9Cgp9KS5jYWxsKHRoaXMscmVxdWlyZSgnX3Byb2Nlc3MnKSkKfSx7Il9wcm9jZXNzIjoxfV19LHt9LFs0XSkoNCkKfSk7",
      "sourceCodeClassname": "UserStatusHyperty",
      "encoding": "base64",
      "signature": ""
    },
    "cguid": 1,
    "type": "Hyperties",
    "version": "0.1",
    "description": "Description of UserStatusHyperty",
    "objectName": "UserStatusHyperty",
    "configuration": {},
    "sourcePackageURL": "/sourcePackage",
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "dataObjects": [],
    "accessControlPolicy": "somePolicy"
},
"HypertyConnector": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChnbG9iYWwpewovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8vIERpc3RyaWJ1dGlvbiBmaWxlIGZvciBIeXBlcnR5RGlzY292ZXJ5LmpzIAovLyB2ZXJzaW9uOiAwLjIuMAoKIWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiPT10eXBlb2YgZXhwb3J0cyYmInVuZGVmaW5lZCIhPXR5cGVvZiBtb2R1bGUpbW9kdWxlLmV4cG9ydHM9ZSgpO2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sZSk7ZWxzZXt2YXIgdDt0PSJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzoidW5kZWZpbmVkIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmP3NlbGY6dGhpcyx0Lkh5cGVydHlEaXNjb3Zlcnk9ZSgpfX0oZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24gZSh0LHIsbil7ZnVuY3Rpb24gbyhjLHMpe2lmKCFyW2NdKXtpZighdFtjXSl7dmFyIHU9ImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIXMmJnUpcmV0dXJuIHUoYywhMCk7aWYoaSlyZXR1cm4gaShjLCEwKTt2YXIgYT1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitjKyInIik7dGhyb3cgYS5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixhfXZhciBmPXJbY109e2V4cG9ydHM6e319O3RbY11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIHI9dFtjXVsxXVtlXTtyZXR1cm4gbyhyP3I6ZSl9LGYsZi5leHBvcnRzLGUsdCxyLG4pfXJldHVybiByW2NdLmV4cG9ydHN9Zm9yKHZhciBpPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGM9MDtjPG4ubGVuZ3RoO2MrKylvKG5bY10pO3JldHVybiBvfSh7MTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSI6Nn1dLDI6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5Ijo3fV0sMzpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlIiksX19lc01vZHVsZTohMH19LHsiY29yZS1qcy9saWJyYXJ5L2ZuL3Byb21pc2UiOjh9XSw0OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3IuX19lc01vZHVsZT0hMCxyWyJkZWZhdWx0Il09ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX19LHt9XSw1OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19ci5fX2VzTW9kdWxlPSEwO3ZhciBvPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5IiksaT1uKG8pO3JbImRlZmF1bHQiXT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIHI9MDtyPHQubGVuZ3RoO3IrKyl7dmFyIG49dFtyXTtuLmVudW1lcmFibGU9bi5lbnVtZXJhYmxlfHwhMSxuLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gbiYmKG4ud3JpdGFibGU9ITApLCgwLGlbImRlZmF1bHQiXSkoZSxuLmtleSxuKX19cmV0dXJuIGZ1bmN0aW9uKHQscixuKXtyZXR1cm4gciYmZSh0LnByb3RvdHlwZSxyKSxuJiZlKHQsbiksdH19KCl9LHsiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkiOjJ9XSw2OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vLi4vbW9kdWxlcy9fY29yZSIpLG89bi5KU09OfHwobi5KU09OPXtzdHJpbmdpZnk6SlNPTi5zdHJpbmdpZnl9KTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG8uc3RyaW5naWZ5LmFwcGx5KG8sYXJndW1lbnRzKX19LHsiLi4vLi4vbW9kdWxlcy9fY29yZSI6MTZ9XSw3OltmdW5jdGlvbihlLHQscil7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSIpO3ZhciBuPWUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKS5PYmplY3Q7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gbi5kZWZpbmVQcm9wZXJ0eShlLHQscil9fSx7Ii4uLy4uL21vZHVsZXMvX2NvcmUiOjE2LCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZGVmaW5lLXByb3BlcnR5Ijo3MX1dLDg6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIiksZSgiLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yIiksZSgiLi4vbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlIiksZSgiLi4vbW9kdWxlcy9lczYucHJvbWlzZSIpLHQuZXhwb3J0cz1lKCIuLi9tb2R1bGVzL19jb3JlIikuUHJvbWlzZX0seyIuLi9tb2R1bGVzL19jb3JlIjoxNiwiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyI6NzIsIi4uL21vZHVsZXMvZXM2LnByb21pc2UiOjczLCIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOjc0LCIuLi9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUiOjc1fV0sOTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZigiZnVuY3Rpb24iIT10eXBlb2YgZSl0aHJvdyBUeXBlRXJyb3IoZSsiIGlzIG5vdCBhIGZ1bmN0aW9uISIpO3JldHVybiBlfX0se31dLDEwOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKCl7fX0se31dLDExOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLG4pe2lmKCEoZSBpbnN0YW5jZW9mIHQpfHx2b2lkIDAhPT1uJiZuIGluIGUpdGhyb3cgVHlwZUVycm9yKHIrIjogaW5jb3JyZWN0IGludm9jYXRpb24hIik7cmV0dXJuIGV9fSx7fV0sMTI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19pcy1vYmplY3QiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7aWYoIW4oZSkpdGhyb3cgVHlwZUVycm9yKGUrIiBpcyBub3QgYW4gb2JqZWN0ISIpO3JldHVybiBlfX0seyIuL19pcy1vYmplY3QiOjMzfV0sMTM6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1pb2JqZWN0Iiksbz1lKCIuL190by1sZW5ndGgiKSxpPWUoIi4vX3RvLWluZGV4Iik7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0LHIsYyl7dmFyIHMsdT1uKHQpLGE9byh1Lmxlbmd0aCksZj1pKGMsYSk7aWYoZSYmciE9cil7Zm9yKDthPmY7KWlmKHM9dVtmKytdLHMhPXMpcmV0dXJuITB9ZWxzZSBmb3IoO2E+ZjtmKyspaWYoKGV8fGYgaW4gdSkmJnVbZl09PT1yKXJldHVybiBlfHxmfHwwO3JldHVybiFlJiYtMX19fSx7Ii4vX3RvLWluZGV4Ijo2MSwiLi9fdG8taW9iamVjdCI6NjMsIi4vX3RvLWxlbmd0aCI6NjR9XSwxNDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2NvZiIpLG89ZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIiksaT0iQXJndW1lbnRzIj09bihmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHN9KCkpLGM9ZnVuY3Rpb24oZSx0KXt0cnl7cmV0dXJuIGVbdF19Y2F0Y2gocil7fX07dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0LHIscztyZXR1cm4gdm9pZCAwPT09ZT8iVW5kZWZpbmVkIjpudWxsPT09ZT8iTnVsbCI6InN0cmluZyI9PXR5cGVvZihyPWModD1PYmplY3QoZSksbykpP3I6aT9uKHQpOiJPYmplY3QiPT0ocz1uKHQpKSYmImZ1bmN0aW9uIj09dHlwZW9mIHQuY2FsbGVlPyJBcmd1bWVudHMiOnN9fSx7Ii4vX2NvZiI6MTUsIi4vX3drcyI6Njh9XSwxNTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXt9LnRvU3RyaW5nO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbi5jYWxsKGUpLnNsaWNlKDgsLTEpfX0se31dLDE2OltmdW5jdGlvbihlLHQscil7dmFyIG49dC5leHBvcnRzPXt2ZXJzaW9uOiIyLjQuMCJ9OyJudW1iZXIiPT10eXBlb2YgX19lJiYoX19lPW4pfSx7fV0sMTc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19hLWZ1bmN0aW9uIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtpZihuKGUpLHZvaWQgMD09PXQpcmV0dXJuIGU7c3dpdGNoKHIpe2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24ocil7cmV0dXJuIGUuY2FsbCh0LHIpfTtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKHIsbil7cmV0dXJuIGUuY2FsbCh0LHIsbil9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24ocixuLG8pe3JldHVybiBlLmNhbGwodCxyLG4sbyl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHQsYXJndW1lbnRzKX19fSx7Ii4vX2EtZnVuY3Rpb24iOjl9XSwxODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZih2b2lkIDA9PWUpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIitlKTtyZXR1cm4gZX19LHt9XSwxOTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz0hZSgiLi9fZmFpbHMiKShmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sImEiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gN319KS5hfSl9LHsiLi9fZmFpbHMiOjIzfV0sMjA6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19pcy1vYmplY3QiKSxvPWUoIi4vX2dsb2JhbCIpLmRvY3VtZW50LGk9bihvKSYmbihvLmNyZWF0ZUVsZW1lbnQpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaT9vLmNyZWF0ZUVsZW1lbnQoZSk6e319fSx7Ii4vX2dsb2JhbCI6MjUsIi4vX2lzLW9iamVjdCI6MzN9XSwyMTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz0iY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mIi5zcGxpdCgiLCIpfSx7fV0sMjI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX2NvcmUiKSxpPWUoIi4vX2N0eCIpLGM9ZSgiLi9faGlkZSIpLHM9InByb3RvdHlwZSIsdT1mdW5jdGlvbihlLHQscil7dmFyIGEsZixfLGw9ZSZ1LkYsZD1lJnUuRyxwPWUmdS5TLHY9ZSZ1LlAseT1lJnUuQixoPWUmdS5XLGI9ZD9vOm9bdF18fChvW3RdPXt9KSxtPWJbc10sZz1kP246cD9uW3RdOihuW3RdfHx7fSlbc107ZCYmKHI9dCk7Zm9yKGEgaW4gcilmPSFsJiZnJiZ2b2lkIDAhPT1nW2FdLGYmJmEgaW4gYnx8KF89Zj9nW2FdOnJbYV0sYlthXT1kJiYiZnVuY3Rpb24iIT10eXBlb2YgZ1thXT9yW2FdOnkmJmY/aShfLG4pOmgmJmdbYV09PV8/ZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCxyLG4pe2lmKHRoaXMgaW5zdGFuY2VvZiBlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBuZXcgZTtjYXNlIDE6cmV0dXJuIG5ldyBlKHQpO2Nhc2UgMjpyZXR1cm4gbmV3IGUodCxyKX1yZXR1cm4gbmV3IGUodCxyLG4pfXJldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07cmV0dXJuIHRbc109ZVtzXSx0fShfKTp2JiYiZnVuY3Rpb24iPT10eXBlb2YgXz9pKEZ1bmN0aW9uLmNhbGwsXyk6Xyx2JiYoKGIudmlydHVhbHx8KGIudmlydHVhbD17fSkpW2FdPV8sZSZ1LlImJm0mJiFtW2FdJiZjKG0sYSxfKSkpfTt1LkY9MSx1Lkc9Mix1LlM9NCx1LlA9OCx1LkI9MTYsdS5XPTMyLHUuVT02NCx1LlI9MTI4LHQuZXhwb3J0cz11fSx7Ii4vX2NvcmUiOjE2LCIuL19jdHgiOjE3LCIuL19nbG9iYWwiOjI1LCIuL19oaWRlIjoyN31dLDIzOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3RyeXtyZXR1cm4hIWUoKX1jYXRjaCh0KXtyZXR1cm4hMH19fSx7fV0sMjQ6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19jdHgiKSxvPWUoIi4vX2l0ZXItY2FsbCIpLGk9ZSgiLi9faXMtYXJyYXktaXRlciIpLGM9ZSgiLi9fYW4tb2JqZWN0Iikscz1lKCIuL190by1sZW5ndGgiKSx1PWUoIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIiksYT17fSxmPXt9LHI9dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLF8sbCl7dmFyIGQscCx2LHksaD1sP2Z1bmN0aW9uKCl7cmV0dXJuIGV9OnUoZSksYj1uKHIsXyx0PzI6MSksbT0wO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBoKXRocm93IFR5cGVFcnJvcihlKyIgaXMgbm90IGl0ZXJhYmxlISIpO2lmKGkoaCkpe2ZvcihkPXMoZS5sZW5ndGgpO2Q+bTttKyspaWYoeT10P2IoYyhwPWVbbV0pWzBdLHBbMV0pOmIoZVttXSkseT09PWF8fHk9PT1mKXJldHVybiB5fWVsc2UgZm9yKHY9aC5jYWxsKGUpOyEocD12Lm5leHQoKSkuZG9uZTspaWYoeT1vKHYsYixwLnZhbHVlLHQpLHk9PT1hfHx5PT09ZilyZXR1cm4geX07ci5CUkVBSz1hLHIuUkVUVVJOPWZ9LHsiLi9fYW4tb2JqZWN0IjoxMiwiLi9fY3R4IjoxNywiLi9faXMtYXJyYXktaXRlciI6MzIsIi4vX2l0ZXItY2FsbCI6MzQsIi4vX3RvLWxlbmd0aCI6NjQsIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIjo2OX1dLDI1OltmdW5jdGlvbihlLHQscil7dmFyIG49dC5leHBvcnRzPSJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cuTWF0aD09TWF0aD93aW5kb3c6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmJiZzZWxmLk1hdGg9PU1hdGg/c2VsZjpGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpOyJudW1iZXIiPT10eXBlb2YgX19nJiYoX19nPW4pfSx7fV0sMjY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj17fS5oYXNPd25Qcm9wZXJ0eTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jYWxsKGUsdCl9fSx7fV0sMjc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19vYmplY3QtZHAiKSxvPWUoIi4vX3Byb3BlcnR5LWRlc2MiKTt0LmV4cG9ydHM9ZSgiLi9fZGVzY3JpcHRvcnMiKT9mdW5jdGlvbihlLHQscil7cmV0dXJuIG4uZihlLHQsbygxLHIpKX06ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlW3RdPXIsZX19LHsiLi9fZGVzY3JpcHRvcnMiOjE5LCIuL19vYmplY3QtZHAiOjQzLCIuL19wcm9wZXJ0eS1kZXNjIjo1MH1dLDI4OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWUoIi4vX2dsb2JhbCIpLmRvY3VtZW50JiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnR9LHsiLi9fZ2xvYmFsIjoyNX1dLDI5OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPSFlKCIuL19kZXNjcmlwdG9ycyIpJiYhZSgiLi9fZmFpbHMiKShmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSgiLi9fZG9tLWNyZWF0ZSIpKCJkaXYiKSwiYSIse2dldDpmdW5jdGlvbigpe3JldHVybiA3fX0pLmF9KX0seyIuL19kZXNjcmlwdG9ycyI6MTksIi4vX2RvbS1jcmVhdGUiOjIwLCIuL19mYWlscyI6MjN9XSwzMDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7dmFyIG49dm9pZCAwPT09cjtzd2l0Y2godC5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gbj9lKCk6ZS5jYWxsKHIpO2Nhc2UgMTpyZXR1cm4gbj9lKHRbMF0pOmUuY2FsbChyLHRbMF0pO2Nhc2UgMjpyZXR1cm4gbj9lKHRbMF0sdFsxXSk6ZS5jYWxsKHIsdFswXSx0WzFdKTtjYXNlIDM6cmV0dXJuIG4/ZSh0WzBdLHRbMV0sdFsyXSk6ZS5jYWxsKHIsdFswXSx0WzFdLHRbMl0pO2Nhc2UgNDpyZXR1cm4gbj9lKHRbMF0sdFsxXSx0WzJdLHRbM10pOmUuY2FsbChyLHRbMF0sdFsxXSx0WzJdLHRbM10pfXJldHVybiBlLmFwcGx5KHIsdCl9fSx7fV0sMzE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19jb2YiKTt0LmV4cG9ydHM9T2JqZWN0KCJ6IikucHJvcGVydHlJc0VudW1lcmFibGUoMCk/T2JqZWN0OmZ1bmN0aW9uKGUpe3JldHVybiJTdHJpbmciPT1uKGUpP2Uuc3BsaXQoIiIpOk9iamVjdChlKX19LHsiLi9fY29mIjoxNX1dLDMyOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faXRlcmF0b3JzIiksbz1lKCIuL193a3MiKSgiaXRlcmF0b3IiKSxpPUFycmF5LnByb3RvdHlwZTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMCE9PWUmJihuLkFycmF5PT09ZXx8aVtvXT09PWUpfX0seyIuL19pdGVyYXRvcnMiOjM5LCIuL193a3MiOjY4fV0sMzM6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIm9iamVjdCI9PXR5cGVvZiBlP251bGwhPT1lOiJmdW5jdGlvbiI9PXR5cGVvZiBlfX0se31dLDM0OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fYW4tb2JqZWN0Iik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLG8pe3RyeXtyZXR1cm4gbz90KG4ocilbMF0sclsxXSk6dChyKX1jYXRjaChpKXt2YXIgYz1lWyJyZXR1cm4iXTt0aHJvdyB2b2lkIDAhPT1jJiZuKGMuY2FsbChlKSksaX19fSx7Ii4vX2FuLW9iamVjdCI6MTJ9XSwzNTpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCIuL19vYmplY3QtY3JlYXRlIiksbz1lKCIuL19wcm9wZXJ0eS1kZXNjIiksaT1lKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpLGM9e307ZSgiLi9faGlkZSIpKGMsZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLHQuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7ZS5wcm90b3R5cGU9bihjLHtuZXh0Om8oMSxyKX0pLGkoZSx0KyIgSXRlcmF0b3IiKX19LHsiLi9faGlkZSI6MjcsIi4vX29iamVjdC1jcmVhdGUiOjQyLCIuL19wcm9wZXJ0eS1kZXNjIjo1MCwiLi9fc2V0LXRvLXN0cmluZy10YWciOjU1LCIuL193a3MiOjY4fV0sMzY6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi9fbGlicmFyeSIpLG89ZSgiLi9fZXhwb3J0IiksaT1lKCIuL19yZWRlZmluZSIpLGM9ZSgiLi9faGlkZSIpLHM9ZSgiLi9faGFzIiksdT1lKCIuL19pdGVyYXRvcnMiKSxhPWUoIi4vX2l0ZXItY3JlYXRlIiksZj1lKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpLF89ZSgiLi9fb2JqZWN0LWdwbyIpLGw9ZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksZD0hKFtdLmtleXMmJiJuZXh0ImluW10ua2V5cygpKSxwPSJAQGl0ZXJhdG9yIix2PSJrZXlzIix5PSJ2YWx1ZXMiLGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLGIsbSxnLGope2Eocix0LGIpO3ZhciB4LHcsayxPPWZ1bmN0aW9uKGUpe2lmKCFkJiZlIGluIEUpcmV0dXJuIEVbZV07c3dpdGNoKGUpe2Nhc2UgdjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyxlKX07Y2FzZSB5OnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgcih0aGlzLGUpfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyxlKX19LE09dCsiIEl0ZXJhdG9yIixQPW09PXksUz0hMSxFPWUucHJvdG90eXBlLFQ9RVtsXXx8RVtwXXx8bSYmRVttXSxBPVR8fE8obSksVT1tP1A/TygiZW50cmllcyIpOkE6dm9pZCAwLEM9IkFycmF5Ij09dD9FLmVudHJpZXN8fFQ6VDtpZihDJiYoaz1fKEMuY2FsbChuZXcgZSkpLGshPT1PYmplY3QucHJvdG90eXBlJiYoZihrLE0sITApLG58fHMoayxsKXx8YyhrLGwsaCkpKSxQJiZUJiZULm5hbWUhPT15JiYoUz0hMCxBPWZ1bmN0aW9uKCl7cmV0dXJuIFQuY2FsbCh0aGlzKX0pLG4mJiFqfHwhZCYmIVMmJkVbbF18fGMoRSxsLEEpLHVbdF09QSx1W01dPWgsbSlpZih4PXt2YWx1ZXM6UD9BOk8oeSksa2V5czpnP0E6Tyh2KSxlbnRyaWVzOlV9LGopZm9yKHcgaW4geCl3IGluIEV8fGkoRSx3LHhbd10pO2Vsc2UgbyhvLlArby5GKihkfHxTKSx0LHgpO3JldHVybiB4fX0seyIuL19leHBvcnQiOjIyLCIuL19oYXMiOjI2LCIuL19oaWRlIjoyNywiLi9faXRlci1jcmVhdGUiOjM1LCIuL19pdGVyYXRvcnMiOjM5LCIuL19saWJyYXJ5Ijo0MCwiLi9fb2JqZWN0LWdwbyI6NDYsIi4vX3JlZGVmaW5lIjo1MiwiLi9fc2V0LXRvLXN0cmluZy10YWciOjU1LCIuL193a3MiOjY4fV0sMzc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL193a3MiKSgiaXRlcmF0b3IiKSxvPSExO3RyeXt2YXIgaT1bN11bbl0oKTtpWyJyZXR1cm4iXT1mdW5jdGlvbigpe289ITB9LEFycmF5LmZyb20oaSxmdW5jdGlvbigpe3Rocm93IDJ9KX1jYXRjaChjKXt9dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7aWYoIXQmJiFvKXJldHVybiExO3ZhciByPSExO3RyeXt2YXIgaT1bN10sYz1pW25dKCk7Yy5uZXh0PWZ1bmN0aW9uKCl7cmV0dXJue2RvbmU6cj0hMH19LGlbbl09ZnVuY3Rpb24oKXtyZXR1cm4gY30sZShpKX1jYXRjaChzKXt9cmV0dXJuIHJ9fSx7Ii4vX3drcyI6Njh9XSwzODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybnt2YWx1ZTp0LGRvbmU6ISFlfX19LHt9XSwzOTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17fX0se31dLDQwOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPSEwfSx7fV0sNDE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX3Rhc2siKS5zZXQsaT1uLk11dGF0aW9uT2JzZXJ2ZXJ8fG4uV2ViS2l0TXV0YXRpb25PYnNlcnZlcixjPW4ucHJvY2VzcyxzPW4uUHJvbWlzZSx1PSJwcm9jZXNzIj09ZSgiLi9fY29mIikoYyk7dC5leHBvcnRzPWZ1bmN0aW9uKCl7dmFyIGUsdCxyLGE9ZnVuY3Rpb24oKXt2YXIgbixvO2Zvcih1JiYobj1jLmRvbWFpbikmJm4uZXhpdCgpO2U7KXtvPWUuZm4sZT1lLm5leHQ7dHJ5e28oKX1jYXRjaChpKXt0aHJvdyBlP3IoKTp0PXZvaWQgMCxpfX10PXZvaWQgMCxuJiZuLmVudGVyKCl9O2lmKHUpcj1mdW5jdGlvbigpe2MubmV4dFRpY2soYSl9O2Vsc2UgaWYoaSl7dmFyIGY9ITAsXz1kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiIik7bmV3IGkoYSkub2JzZXJ2ZShfLHtjaGFyYWN0ZXJEYXRhOiEwfSkscj1mdW5jdGlvbigpe18uZGF0YT1mPSFmfX1lbHNlIGlmKHMmJnMucmVzb2x2ZSl7dmFyIGw9cy5yZXNvbHZlKCk7cj1mdW5jdGlvbigpe2wudGhlbihhKX19ZWxzZSByPWZ1bmN0aW9uKCl7by5jYWxsKG4sYSl9O3JldHVybiBmdW5jdGlvbihuKXt2YXIgbz17Zm46bixuZXh0OnZvaWQgMH07dCYmKHQubmV4dD1vKSxlfHwoZT1vLHIoKSksdD1vfX19LHsiLi9fY29mIjoxNSwiLi9fZ2xvYmFsIjoyNSwiLi9fdGFzayI6NjB9XSw0MjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2FuLW9iamVjdCIpLG89ZSgiLi9fb2JqZWN0LWRwcyIpLGk9ZSgiLi9fZW51bS1idWcta2V5cyIpLGM9ZSgiLi9fc2hhcmVkLWtleSIpKCJJRV9QUk9UTyIpLHM9ZnVuY3Rpb24oKXt9LHU9InByb3RvdHlwZSIsYT1mdW5jdGlvbigpe3ZhciB0LHI9ZSgiLi9fZG9tLWNyZWF0ZSIpKCJpZnJhbWUiKSxuPWkubGVuZ3RoLG89Ij4iO2ZvcihyLnN0eWxlLmRpc3BsYXk9Im5vbmUiLGUoIi4vX2h0bWwiKS5hcHBlbmRDaGlsZChyKSxyLnNyYz0iamF2YXNjcmlwdDoiLHQ9ci5jb250ZW50V2luZG93LmRvY3VtZW50LHQub3BlbigpLHQud3JpdGUoIjxzY3JpcHQ+ZG9jdW1lbnQuRj1PYmplY3Q8L3NjcmlwdCIrbyksdC5jbG9zZSgpLGE9dC5GO24tLTspZGVsZXRlIGFbdV1baVtuXV07cmV0dXJuIGEoKX07dC5leHBvcnRzPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKGUsdCl7dmFyIHI7cmV0dXJuIG51bGwhPT1lPyhzW3VdPW4oZSkscj1uZXcgcyxzW3VdPW51bGwscltjXT1lKTpyPWEoKSx2b2lkIDA9PT10P3I6byhyLHQpfX0seyIuL19hbi1vYmplY3QiOjEyLCIuL19kb20tY3JlYXRlIjoyMCwiLi9fZW51bS1idWcta2V5cyI6MjEsIi4vX2h0bWwiOjI4LCIuL19vYmplY3QtZHBzIjo0NCwiLi9fc2hhcmVkLWtleSI6NTZ9XSw0MzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2FuLW9iamVjdCIpLG89ZSgiLi9faWU4LWRvbS1kZWZpbmUiKSxpPWUoIi4vX3RvLXByaW1pdGl2ZSIpLGM9T2JqZWN0LmRlZmluZVByb3BlcnR5O3IuZj1lKCIuL19kZXNjcmlwdG9ycyIpP09iamVjdC5kZWZpbmVQcm9wZXJ0eTpmdW5jdGlvbihlLHQscil7aWYobihlKSx0PWkodCwhMCksbihyKSxvKXRyeXtyZXR1cm4gYyhlLHQscil9Y2F0Y2gocyl7fWlmKCJnZXQiaW4gcnx8InNldCJpbiByKXRocm93IFR5cGVFcnJvcigiQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhIik7cmV0dXJuInZhbHVlImluIHImJihlW3RdPXIudmFsdWUpLGV9fSx7Ii4vX2FuLW9iamVjdCI6MTIsIi4vX2Rlc2NyaXB0b3JzIjoxOSwiLi9faWU4LWRvbS1kZWZpbmUiOjI5LCIuL190by1wcmltaXRpdmUiOjY2fV0sNDQ6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19vYmplY3QtZHAiKSxvPWUoIi4vX2FuLW9iamVjdCIpLGk9ZSgiLi9fb2JqZWN0LWtleXMiKTt0LmV4cG9ydHM9ZSgiLi9fZGVzY3JpcHRvcnMiKT9PYmplY3QuZGVmaW5lUHJvcGVydGllczpmdW5jdGlvbihlLHQpe28oZSk7Zm9yKHZhciByLGM9aSh0KSxzPWMubGVuZ3RoLHU9MDtzPnU7KW4uZihlLHI9Y1t1KytdLHRbcl0pO3JldHVybiBlfX0seyIuL19hbi1vYmplY3QiOjEyLCIuL19kZXNjcmlwdG9ycyI6MTksIi4vX29iamVjdC1kcCI6NDMsIi4vX29iamVjdC1rZXlzIjo0OH1dLDQ1OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LXBpZSIpLG89ZSgiLi9fcHJvcGVydHktZGVzYyIpLGk9ZSgiLi9fdG8taW9iamVjdCIpLGM9ZSgiLi9fdG8tcHJpbWl0aXZlIikscz1lKCIuL19oYXMiKSx1PWUoIi4vX2llOC1kb20tZGVmaW5lIiksYT1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO3IuZj1lKCIuL19kZXNjcmlwdG9ycyIpP2E6ZnVuY3Rpb24oZSx0KXtpZihlPWkoZSksdD1jKHQsITApLHUpdHJ5e3JldHVybiBhKGUsdCl9Y2F0Y2gocil7fXJldHVybiBzKGUsdCk/byghbi5mLmNhbGwoZSx0KSxlW3RdKTp2b2lkIDB9fSx7Ii4vX2Rlc2NyaXB0b3JzIjoxOSwiLi9faGFzIjoyNiwiLi9faWU4LWRvbS1kZWZpbmUiOjI5LCIuL19vYmplY3QtcGllIjo0OSwiLi9fcHJvcGVydHktZGVzYyI6NTAsIi4vX3RvLWlvYmplY3QiOjYzLCIuL190by1wcmltaXRpdmUiOjY2fV0sNDY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19oYXMiKSxvPWUoIi4vX3RvLW9iamVjdCIpLGk9ZSgiLi9fc2hhcmVkLWtleSIpKCJJRV9QUk9UTyIpLGM9T2JqZWN0LnByb3RvdHlwZTt0LmV4cG9ydHM9T2JqZWN0LmdldFByb3RvdHlwZU9mfHxmdW5jdGlvbihlKXtyZXR1cm4gZT1vKGUpLG4oZSxpKT9lW2ldOiJmdW5jdGlvbiI9PXR5cGVvZiBlLmNvbnN0cnVjdG9yJiZlIGluc3RhbmNlb2YgZS5jb25zdHJ1Y3Rvcj9lLmNvbnN0cnVjdG9yLnByb3RvdHlwZTplIGluc3RhbmNlb2YgT2JqZWN0P2M6bnVsbH19LHsiLi9faGFzIjoyNiwiLi9fc2hhcmVkLWtleSI6NTYsIi4vX3RvLW9iamVjdCI6NjV9XSw0NzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2hhcyIpLG89ZSgiLi9fdG8taW9iamVjdCIpLGk9ZSgiLi9fYXJyYXktaW5jbHVkZXMiKSghMSksYz1lKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIHIscz1vKGUpLHU9MCxhPVtdO2ZvcihyIGluIHMpciE9YyYmbihzLHIpJiZhLnB1c2gocik7Zm9yKDt0Lmxlbmd0aD51OyluKHMscj10W3UrK10pJiYofmkoYSxyKXx8YS5wdXNoKHIpKTtyZXR1cm4gYX19LHsiLi9fYXJyYXktaW5jbHVkZXMiOjEzLCIuL19oYXMiOjI2LCIuL19zaGFyZWQta2V5Ijo1NiwiLi9fdG8taW9iamVjdCI6NjN9XSw0ODpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX29iamVjdC1rZXlzLWludGVybmFsIiksbz1lKCIuL19lbnVtLWJ1Zy1rZXlzIik7dC5leHBvcnRzPU9iamVjdC5rZXlzfHxmdW5jdGlvbihlKXtyZXR1cm4gbihlLG8pfX0seyIuL19lbnVtLWJ1Zy1rZXlzIjoyMSwiLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwiOjQ3fV0sNDk6W2Z1bmN0aW9uKGUsdCxyKXtyLmY9e30ucHJvcGVydHlJc0VudW1lcmFibGV9LHt9XSw1MDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybntlbnVtZXJhYmxlOiEoMSZlKSxjb25maWd1cmFibGU6ISgyJmUpLHdyaXRhYmxlOiEoNCZlKSx2YWx1ZTp0fX19LHt9XSw1MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2hpZGUiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0LHIpe2Zvcih2YXIgbyBpbiB0KXImJmVbb10/ZVtvXT10W29dOm4oZSxvLHRbb10pO3JldHVybiBlfX0seyIuL19oaWRlIjoyN31dLDUyOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWUoIi4vX2hpZGUiKX0seyIuL19oaWRlIjoyN31dLDUzOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faXMtb2JqZWN0Iiksbz1lKCIuL19hbi1vYmplY3QiKSxpPWZ1bmN0aW9uKGUsdCl7aWYobyhlKSwhbih0KSYmbnVsbCE9PXQpdGhyb3cgVHlwZUVycm9yKHQrIjogY2FuJ3Qgc2V0IGFzIHByb3RvdHlwZSEiKX07dC5leHBvcnRzPXtzZXQ6T2JqZWN0LnNldFByb3RvdHlwZU9mfHwoIl9fcHJvdG9fXyJpbnt9P2Z1bmN0aW9uKHQscixuKXt0cnl7bj1lKCIuL19jdHgiKShGdW5jdGlvbi5jYWxsLGUoIi4vX29iamVjdC1nb3BkIikuZihPYmplY3QucHJvdG90eXBlLCJfX3Byb3RvX18iKS5zZXQsMiksbih0LFtdKSxyPSEodCBpbnN0YW5jZW9mIEFycmF5KX1jYXRjaChvKXtyPSEwfXJldHVybiBmdW5jdGlvbihlLHQpe3JldHVybiBpKGUsdCkscj9lLl9fcHJvdG9fXz10Om4oZSx0KSxlfX0oe30sITEpOnZvaWQgMCksY2hlY2s6aX19LHsiLi9fYW4tb2JqZWN0IjoxMiwiLi9fY3R4IjoxNywiLi9faXMtb2JqZWN0IjozMywiLi9fb2JqZWN0LWdvcGQiOjQ1fV0sNTQ6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi9fZ2xvYmFsIiksbz1lKCIuL19jb3JlIiksaT1lKCIuL19vYmplY3QtZHAiKSxjPWUoIi4vX2Rlc2NyaXB0b3JzIikscz1lKCIuL193a3MiKSgic3BlY2llcyIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXt2YXIgdD0iZnVuY3Rpb24iPT10eXBlb2Ygb1tlXT9vW2VdOm5bZV07YyYmdCYmIXRbc10mJmkuZih0LHMse2NvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc319KX19LHsiLi9fY29yZSI6MTYsIi4vX2Rlc2NyaXB0b3JzIjoxOSwiLi9fZ2xvYmFsIjoyNSwiLi9fb2JqZWN0LWRwIjo0MywiLi9fd2tzIjo2OH1dLDU1OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LWRwIikuZixvPWUoIi4vX2hhcyIpLGk9ZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtlJiYhbyhlPXI/ZTplLnByb3RvdHlwZSxpKSYmbihlLGkse2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTp0fSl9fSx7Ii4vX2hhcyI6MjYsIi4vX29iamVjdC1kcCI6NDMsIi4vX3drcyI6Njh9XSw1NjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX3NoYXJlZCIpKCJrZXlzIiksbz1lKCIuL191aWQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG5bZV18fChuW2VdPW8oZSkpfX0seyIuL19zaGFyZWQiOjU3LCIuL191aWQiOjY3fV0sNTc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPSJfX2NvcmUtanNfc2hhcmVkX18iLGk9bltvXXx8KG5bb109e30pO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaVtlXXx8KGlbZV09e30pfX0seyIuL19nbG9iYWwiOjI1fV0sNTg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19hbi1vYmplY3QiKSxvPWUoIi4vX2EtZnVuY3Rpb24iKSxpPWUoIi4vX3drcyIpKCJzcGVjaWVzIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIHIsYz1uKGUpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDA9PT1jfHx2b2lkIDA9PShyPW4oYylbaV0pP3Q6byhyKX19LHsiLi9fYS1mdW5jdGlvbiI6OSwiLi9fYW4tb2JqZWN0IjoxMiwiLi9fd2tzIjo2OH1dLDU5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fdG8taW50ZWdlciIpLG89ZSgiLi9fZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCxyKXt2YXIgaSxjLHM9U3RyaW5nKG8odCkpLHU9bihyKSxhPXMubGVuZ3RoO3JldHVybiAwPnV8fHU+PWE/ZT8iIjp2b2lkIDA6KGk9cy5jaGFyQ29kZUF0KHUpLDU1Mjk2Pml8fGk+NTYzMTl8fHUrMT09PWF8fChjPXMuY2hhckNvZGVBdCh1KzEpKTw1NjMyMHx8Yz41NzM0Mz9lP3MuY2hhckF0KHUpOmk6ZT9zLnNsaWNlKHUsdSsyKTooaS01NTI5Njw8MTApKyhjLTU2MzIwKSs2NTUzNil9fX0seyIuL19kZWZpbmVkIjoxOCwiLi9fdG8taW50ZWdlciI6NjJ9XSw2MDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG8saSxjPWUoIi4vX2N0eCIpLHM9ZSgiLi9faW52b2tlIiksdT1lKCIuL19odG1sIiksYT1lKCIuL19kb20tY3JlYXRlIiksZj1lKCIuL19nbG9iYWwiKSxfPWYucHJvY2VzcyxsPWYuc2V0SW1tZWRpYXRlLGQ9Zi5jbGVhckltbWVkaWF0ZSxwPWYuTWVzc2FnZUNoYW5uZWwsdj0wLHk9e30saD0ib25yZWFkeXN0YXRlY2hhbmdlIixiPWZ1bmN0aW9uKCl7dmFyIGU9K3RoaXM7aWYoeS5oYXNPd25Qcm9wZXJ0eShlKSl7dmFyIHQ9eVtlXTtkZWxldGUgeVtlXSx0KCl9fSxtPWZ1bmN0aW9uKGUpe2IuY2FsbChlLmRhdGEpfTtsJiZkfHwobD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9W10scj0xO2FyZ3VtZW50cy5sZW5ndGg+cjspdC5wdXNoKGFyZ3VtZW50c1tyKytdKTtyZXR1cm4geVsrK3ZdPWZ1bmN0aW9uKCl7cygiZnVuY3Rpb24iPT10eXBlb2YgZT9lOkZ1bmN0aW9uKGUpLHQpfSxuKHYpLHZ9LGQ9ZnVuY3Rpb24oZSl7ZGVsZXRlIHlbZV19LCJwcm9jZXNzIj09ZSgiLi9fY29mIikoXyk/bj1mdW5jdGlvbihlKXtfLm5leHRUaWNrKGMoYixlLDEpKX06cD8obz1uZXcgcCxpPW8ucG9ydDIsby5wb3J0MS5vbm1lc3NhZ2U9bSxuPWMoaS5wb3N0TWVzc2FnZSxpLDEpKTpmLmFkZEV2ZW50TGlzdGVuZXImJiJmdW5jdGlvbiI9PXR5cGVvZiBwb3N0TWVzc2FnZSYmIWYuaW1wb3J0U2NyaXB0cz8obj1mdW5jdGlvbihlKXtmLnBvc3RNZXNzYWdlKGUrIiIsIioiKX0sZi5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixtLCExKSk6bj1oIGluIGEoInNjcmlwdCIpP2Z1bmN0aW9uKGUpe3UuYXBwZW5kQ2hpbGQoYSgic2NyaXB0IikpW2hdPWZ1bmN0aW9uKCl7dS5yZW1vdmVDaGlsZCh0aGlzKSxiLmNhbGwoZSl9fTpmdW5jdGlvbihlKXtzZXRUaW1lb3V0KGMoYixlLDEpLDApfSksdC5leHBvcnRzPXtzZXQ6bCxjbGVhcjpkfX0seyIuL19jb2YiOjE1LCIuL19jdHgiOjE3LCIuL19kb20tY3JlYXRlIjoyMCwiLi9fZ2xvYmFsIjoyNSwiLi9faHRtbCI6MjgsIi4vX2ludm9rZSI6MzB9XSw2MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX3RvLWludGVnZXIiKSxvPU1hdGgubWF4LGk9TWF0aC5taW47dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9bihlKSwwPmU/byhlK3QsMCk6aShlLHQpfX0seyIuL190by1pbnRlZ2VyIjo2Mn1dLDYyOltmdW5jdGlvbihlLHQscil7dmFyIG49TWF0aC5jZWlsLG89TWF0aC5mbG9vcjt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGlzTmFOKGU9K2UpPzA6KGU+MD9vOm4pKGUpfX0se31dLDYzOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faW9iamVjdCIpLG89ZSgiLi9fZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbihvKGUpKX19LHsiLi9fZGVmaW5lZCI6MTgsIi4vX2lvYmplY3QiOjMxfV0sNjQ6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1pbnRlZ2VyIiksbz1NYXRoLm1pbjt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGU+MD9vKG4oZSksOTAwNzE5OTI1NDc0MDk5MSk6MH19LHsiLi9fdG8taW50ZWdlciI6NjJ9XSw2NTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2RlZmluZWQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdChuKGUpKX19LHsiLi9fZGVmaW5lZCI6MTh9XSw2NjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2lzLW9iamVjdCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKCFuKGUpKXJldHVybiBlO3ZhciByLG87aWYodCYmImZ1bmN0aW9uIj09dHlwZW9mKHI9ZS50b1N0cmluZykmJiFuKG89ci5jYWxsKGUpKSlyZXR1cm4gbztpZigiZnVuY3Rpb24iPT10eXBlb2Yocj1lLnZhbHVlT2YpJiYhbihvPXIuY2FsbChlKSkpcmV0dXJuIG87aWYoIXQmJiJmdW5jdGlvbiI9PXR5cGVvZihyPWUudG9TdHJpbmcpJiYhbihvPXIuY2FsbChlKSkpcmV0dXJuIG87dGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKX19LHsiLi9faXMtb2JqZWN0IjozM31dLDY3OltmdW5jdGlvbihlLHQscil7dmFyIG49MCxvPU1hdGgucmFuZG9tKCk7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiJTeW1ib2woIi5jb25jYXQodm9pZCAwPT09ZT8iIjplLCIpXyIsKCsrbitvKS50b1N0cmluZygzNikpfX0se31dLDY4OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fc2hhcmVkIikoIndrcyIpLG89ZSgiLi9fdWlkIiksaT1lKCIuL19nbG9iYWwiKS5TeW1ib2wsYz0iZnVuY3Rpb24iPT10eXBlb2YgaSxzPXQuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbltlXXx8KG5bZV09YyYmaVtlXXx8KGM/aTpvKSgiU3ltYm9sLiIrZSkpfTtzLnN0b3JlPW59LHsiLi9fZ2xvYmFsIjoyNSwiLi9fc2hhcmVkIjo1NywiLi9fdWlkIjo2N31dLDY5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fY2xhc3NvZiIpLG89ZSgiLi9fd2tzIikoIml0ZXJhdG9yIiksaT1lKCIuL19pdGVyYXRvcnMiKTt0LmV4cG9ydHM9ZSgiLi9fY29yZSIpLmdldEl0ZXJhdG9yTWV0aG9kPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDAhPWU/ZVtvXXx8ZVsiQEBpdGVyYXRvciJdfHxpW24oZSldOnZvaWQgMH19LHsiLi9fY2xhc3NvZiI6MTQsIi4vX2NvcmUiOjE2LCIuL19pdGVyYXRvcnMiOjM5LCIuL193a3MiOjY4fV0sNzA6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi9fYWRkLXRvLXVuc2NvcGFibGVzIiksbz1lKCIuL19pdGVyLXN0ZXAiKSxpPWUoIi4vX2l0ZXJhdG9ycyIpLGM9ZSgiLi9fdG8taW9iamVjdCIpO3QuZXhwb3J0cz1lKCIuL19pdGVyLWRlZmluZSIpKEFycmF5LCJBcnJheSIsZnVuY3Rpb24oZSx0KXt0aGlzLl90PWMoZSksdGhpcy5faT0wLHRoaXMuX2s9dH0sZnVuY3Rpb24oKXt2YXIgZT10aGlzLl90LHQ9dGhpcy5fayxyPXRoaXMuX2krKztyZXR1cm4hZXx8cj49ZS5sZW5ndGg/KHRoaXMuX3Q9dm9pZCAwLG8oMSkpOiJrZXlzIj09dD9vKDAscik6InZhbHVlcyI9PXQ/bygwLGVbcl0pOm8oMCxbcixlW3JdXSl9LCJ2YWx1ZXMiKSxpLkFyZ3VtZW50cz1pLkFycmF5LG4oImtleXMiKSxuKCJ2YWx1ZXMiKSxuKCJlbnRyaWVzIil9LHsiLi9fYWRkLXRvLXVuc2NvcGFibGVzIjoxMCwiLi9faXRlci1kZWZpbmUiOjM2LCIuL19pdGVyLXN0ZXAiOjM4LCIuL19pdGVyYXRvcnMiOjM5LCIuL190by1pb2JqZWN0Ijo2M31dLDcxOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fZXhwb3J0Iik7bihuLlMrbi5GKiFlKCIuL19kZXNjcmlwdG9ycyIpLCJPYmplY3QiLHtkZWZpbmVQcm9wZXJ0eTplKCIuL19vYmplY3QtZHAiKS5mfSl9LHsiLi9fZGVzY3JpcHRvcnMiOjE5LCIuL19leHBvcnQiOjIyLCIuL19vYmplY3QtZHAiOjQzfV0sNzI6W2Z1bmN0aW9uKGUsdCxyKXt9LHt9XSw3MzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbixvLGksYz1lKCIuL19saWJyYXJ5Iikscz1lKCIuL19nbG9iYWwiKSx1PWUoIi4vX2N0eCIpLGE9ZSgiLi9fY2xhc3NvZiIpLGY9ZSgiLi9fZXhwb3J0IiksXz1lKCIuL19pcy1vYmplY3QiKSxsPShlKCIuL19hbi1vYmplY3QiKSxlKCIuL19hLWZ1bmN0aW9uIikpLGQ9ZSgiLi9fYW4taW5zdGFuY2UiKSxwPWUoIi4vX2Zvci1vZiIpLHY9KGUoIi4vX3NldC1wcm90byIpLnNldCxlKCIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIikpLHk9ZSgiLi9fdGFzayIpLnNldCxoPWUoIi4vX21pY3JvdGFzayIpKCksYj0iUHJvbWlzZSIsbT1zLlR5cGVFcnJvcixnPXMucHJvY2VzcyxqPXNbYl0sZz1zLnByb2Nlc3MseD0icHJvY2VzcyI9PWEoZyksdz1mdW5jdGlvbigpe30saz0hIWZ1bmN0aW9uKCl7dHJ5e3ZhciB0PWoucmVzb2x2ZSgxKSxyPSh0LmNvbnN0cnVjdG9yPXt9KVtlKCIuL193a3MiKSgic3BlY2llcyIpXT1mdW5jdGlvbihlKXtlKHcsdyl9O3JldHVybih4fHwiZnVuY3Rpb24iPT10eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50KSYmdC50aGVuKHcpaW5zdGFuY2VvZiByfWNhdGNoKG4pe319KCksTz1mdW5jdGlvbihlLHQpe3JldHVybiBlPT09dHx8ZT09PWomJnQ9PT1pfSxNPWZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiBfKGUpJiYiZnVuY3Rpb24iPT10eXBlb2YodD1lLnRoZW4pP3Q6ITF9LFA9ZnVuY3Rpb24oZSl7cmV0dXJuIE8oaixlKT9uZXcgUyhlKTpuZXcgbyhlKX0sUz1vPWZ1bmN0aW9uKGUpe3ZhciB0LHI7dGhpcy5wcm9taXNlPW5ldyBlKGZ1bmN0aW9uKGUsbil7aWYodm9pZCAwIT09dHx8dm9pZCAwIT09cil0aHJvdyBtKCJCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvciIpO3Q9ZSxyPW59KSx0aGlzLnJlc29sdmU9bCh0KSx0aGlzLnJlamVjdD1sKHIpfSxFPWZ1bmN0aW9uKGUpe3RyeXtlKCl9Y2F0Y2godCl7cmV0dXJue2Vycm9yOnR9fX0sVD1mdW5jdGlvbihlLHQpe2lmKCFlLl9uKXtlLl9uPSEwO3ZhciByPWUuX2M7aChmdW5jdGlvbigpe2Zvcih2YXIgbj1lLl92LG89MT09ZS5fcyxpPTAsYz1mdW5jdGlvbih0KXt2YXIgcixpLGM9bz90Lm9rOnQuZmFpbCxzPXQucmVzb2x2ZSx1PXQucmVqZWN0LGE9dC5kb21haW47dHJ5e2M/KG98fCgyPT1lLl9oJiZDKGUpLGUuX2g9MSksYz09PSEwP3I9bjooYSYmYS5lbnRlcigpLHI9YyhuKSxhJiZhLmV4aXQoKSkscj09PXQucHJvbWlzZT91KG0oIlByb21pc2UtY2hhaW4gY3ljbGUiKSk6KGk9TShyKSk/aS5jYWxsKHIscyx1KTpzKHIpKTp1KG4pfWNhdGNoKGYpe3UoZil9fTtyLmxlbmd0aD5pOyljKHJbaSsrXSk7ZS5fYz1bXSxlLl9uPSExLHQmJiFlLl9oJiZBKGUpfSl9fSxBPWZ1bmN0aW9uKGUpe3kuY2FsbChzLGZ1bmN0aW9uKCl7dmFyIHQscixuLG89ZS5fdjtpZihVKGUpJiYodD1FKGZ1bmN0aW9uKCl7eD9nLmVtaXQoInVuaGFuZGxlZFJlamVjdGlvbiIsbyxlKToocj1zLm9udW5oYW5kbGVkcmVqZWN0aW9uKT9yKHtwcm9taXNlOmUscmVhc29uOm99KToobj1zLmNvbnNvbGUpJiZuLmVycm9yJiZuLmVycm9yKCJVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24iLG8pfSksZS5faD14fHxVKGUpPzI6MSksZS5fYT12b2lkIDAsdCl0aHJvdyB0LmVycm9yfSl9LFU9ZnVuY3Rpb24oZSl7aWYoMT09ZS5faClyZXR1cm4hMTtmb3IodmFyIHQscj1lLl9hfHxlLl9jLG49MDtyLmxlbmd0aD5uOylpZih0PXJbbisrXSx0LmZhaWx8fCFVKHQucHJvbWlzZSkpcmV0dXJuITE7cmV0dXJuITB9LEM9ZnVuY3Rpb24oZSl7eS5jYWxsKHMsZnVuY3Rpb24oKXt2YXIgdDt4P2cuZW1pdCgicmVqZWN0aW9uSGFuZGxlZCIsZSk6KHQ9cy5vbnJlamVjdGlvbmhhbmRsZWQpJiZ0KHtwcm9taXNlOmUscmVhc29uOmUuX3Z9KX0pfSxSPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7dC5fZHx8KHQuX2Q9ITAsdD10Ll93fHx0LHQuX3Y9ZSx0Ll9zPTIsdC5fYXx8KHQuX2E9dC5fYy5zbGljZSgpKSxUKHQsITApKX0sTD1mdW5jdGlvbihlKXt2YXIgdCxyPXRoaXM7aWYoIXIuX2Qpe3IuX2Q9ITAscj1yLl93fHxyO3RyeXtpZihyPT09ZSl0aHJvdyBtKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOyh0PU0oZSkpP2goZnVuY3Rpb24oKXt2YXIgbj17X3c6cixfZDohMX07dHJ5e3QuY2FsbChlLHUoTCxuLDEpLHUoUixuLDEpKX1jYXRjaChvKXtSLmNhbGwobixvKX19KTooci5fdj1lLHIuX3M9MSxUKHIsITEpKX1jYXRjaChuKXtSLmNhbGwoe193OnIsX2Q6ITF9LG4pfX19O2t8fChqPWZ1bmN0aW9uKGUpe2QodGhpcyxqLGIsIl9oIiksbChlKSxuLmNhbGwodGhpcyk7dHJ5e2UodShMLHRoaXMsMSksdShSLHRoaXMsMSkpfWNhdGNoKHQpe1IuY2FsbCh0aGlzLHQpfX0sbj1mdW5jdGlvbihlKXt0aGlzLl9jPVtdLHRoaXMuX2E9dm9pZCAwLHRoaXMuX3M9MCx0aGlzLl9kPSExLHRoaXMuX3Y9dm9pZCAwLHRoaXMuX2g9MCx0aGlzLl9uPSExfSxuLnByb3RvdHlwZT1lKCIuL19yZWRlZmluZS1hbGwiKShqLnByb3RvdHlwZSx7dGhlbjpmdW5jdGlvbihlLHQpe3ZhciByPVAodih0aGlzLGopKTtyZXR1cm4gci5vaz0iZnVuY3Rpb24iPT10eXBlb2YgZT9lOiEwLHIuZmFpbD0iZnVuY3Rpb24iPT10eXBlb2YgdCYmdCxyLmRvbWFpbj14P2cuZG9tYWluOnZvaWQgMCx0aGlzLl9jLnB1c2gociksdGhpcy5fYSYmdGhpcy5fYS5wdXNoKHIpLHRoaXMuX3MmJlQodGhpcywhMSksci5wcm9taXNlfSwiY2F0Y2giOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnRoZW4odm9pZCAwLGUpfX0pLFM9ZnVuY3Rpb24oKXt2YXIgZT1uZXcgbjt0aGlzLnByb21pc2U9ZSx0aGlzLnJlc29sdmU9dShMLGUsMSksdGhpcy5yZWplY3Q9dShSLGUsMSl9KSxmKGYuRytmLlcrZi5GKiFrLHtQcm9taXNlOmp9KSxlKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpKGosYiksZSgiLi9fc2V0LXNwZWNpZXMiKShiKSxpPWUoIi4vX2NvcmUiKVtiXSxmKGYuUytmLkYqIWssYix7cmVqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0PVAodGhpcykscj10LnJlamVjdDtyZXR1cm4gcihlKSx0LnByb21pc2V9fSksZihmLlMrZi5GKihjfHwhayksYix7cmVzb2x2ZTpmdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgaiYmTyhlLmNvbnN0cnVjdG9yLHRoaXMpKXJldHVybiBlO3ZhciB0PVAodGhpcykscj10LnJlc29sdmU7cmV0dXJuIHIoZSksdC5wcm9taXNlfX0pLGYoZi5TK2YuRiohKGsmJmUoIi4vX2l0ZXItZGV0ZWN0IikoZnVuY3Rpb24oZSl7ai5hbGwoZSlbImNhdGNoIl0odyl9KSksYix7YWxsOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1QKHQpLG49ci5yZXNvbHZlLG89ci5yZWplY3QsaT1FKGZ1bmN0aW9uKCl7dmFyIHI9W10saT0wLGM9MTtwKGUsITEsZnVuY3Rpb24oZSl7dmFyIHM9aSsrLHU9ITE7ci5wdXNoKHZvaWQgMCksYysrLHQucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uKGUpe3V8fCh1PSEwLHJbc109ZSwtLWN8fG4ocikpfSxvKX0pLC0tY3x8bihyKX0pO3JldHVybiBpJiZvKGkuZXJyb3IpLHIucHJvbWlzZX0scmFjZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLHI9UCh0KSxuPXIucmVqZWN0LG89RShmdW5jdGlvbigpe3AoZSwhMSxmdW5jdGlvbihlKXt0LnJlc29sdmUoZSkudGhlbihyLnJlc29sdmUsbil9KX0pO3JldHVybiBvJiZuKG8uZXJyb3IpLHIucHJvbWlzZX19KX0seyIuL19hLWZ1bmN0aW9uIjo5LCIuL19hbi1pbnN0YW5jZSI6MTEsIi4vX2FuLW9iamVjdCI6MTIsIi4vX2NsYXNzb2YiOjE0LCIuL19jb3JlIjoxNiwiLi9fY3R4IjoxNywiLi9fZXhwb3J0IjoyMiwiLi9fZm9yLW9mIjoyNCwiLi9fZ2xvYmFsIjoyNSwiLi9faXMtb2JqZWN0IjozMywiLi9faXRlci1kZXRlY3QiOjM3LCIuL19saWJyYXJ5Ijo0MCwiLi9fbWljcm90YXNrIjo0MSwiLi9fcmVkZWZpbmUtYWxsIjo1MSwiLi9fc2V0LXByb3RvIjo1MywiLi9fc2V0LXNwZWNpZXMiOjU0LCIuL19zZXQtdG8tc3RyaW5nLXRhZyI6NTUsIi4vX3NwZWNpZXMtY29uc3RydWN0b3IiOjU4LCIuL190YXNrIjo2MCwiLi9fd2tzIjo2OH1dLDc0OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3ZhciBuPWUoIi4vX3N0cmluZy1hdCIpKCEwKTtlKCIuL19pdGVyLWRlZmluZSIpKFN0cmluZywiU3RyaW5nIixmdW5jdGlvbihlKXt0aGlzLl90PVN0cmluZyhlKSx0aGlzLl9pPTB9LGZ1bmN0aW9uKCl7dmFyIGUsdD10aGlzLl90LHI9dGhpcy5faTtyZXR1cm4gcj49dC5sZW5ndGg/e3ZhbHVlOnZvaWQgMCxkb25lOiEwfTooZT1uKHQsciksdGhpcy5faSs9ZS5sZW5ndGgse3ZhbHVlOmUsZG9uZTohMX0pfSl9LHsiLi9faXRlci1kZWZpbmUiOjM2LCIuL19zdHJpbmctYXQiOjU5fV0sNzU6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuL2VzNi5hcnJheS5pdGVyYXRvciIpO2Zvcih2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX2hpZGUiKSxpPWUoIi4vX2l0ZXJhdG9ycyIpLGM9ZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIikscz1bIk5vZGVMaXN0IiwiRE9NVG9rZW5MaXN0IiwiTWVkaWFMaXN0IiwiU3R5bGVTaGVldExpc3QiLCJDU1NSdWxlTGlzdCJdLHU9MDs1PnU7dSsrKXt2YXIgYT1zW3VdLGY9blthXSxfPWYmJmYucHJvdG90eXBlO18mJiFfW2NdJiZvKF8sYyxhKSxpW2FdPWkuQXJyYXl9fSx7Ii4vX2dsb2JhbCI6MjUsIi4vX2hpZGUiOjI3LCIuL19pdGVyYXRvcnMiOjM5LCIuL193a3MiOjY4LCIuL2VzNi5hcnJheS5pdGVyYXRvciI6NzB9XSw3NjpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCIuL2h5cGVydHktZGlzY292ZXJ5L0h5cGVydHlEaXNjb3ZlcnkiKSxpPW4obyk7clsiZGVmYXVsdCJdPWlbImRlZmF1bHQiXSx0LmV4cG9ydHM9clsiZGVmYXVsdCJdfSx7Ii4vaHlwZXJ0eS1kaXNjb3ZlcnkvSHlwZXJ0eURpc2NvdmVyeSI6Nzd9XSw3NzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLGk9bihvKSxjPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLHM9bihjKSx1PWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLGE9bih1KSxmPWUoIi4uL3V0aWxzL3V0aWxzIiksXz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxyKXsoMCxzWyJkZWZhdWx0Il0pKHRoaXMsZSk7dmFyIG49dGhpcztuLm1lc3NhZ2VCdXM9cixuLmRvbWFpbj0oMCxmLmRpdmlkZVVSTCkodCkuZG9tYWluLG4uZGlzY292ZXJ5VVJMPXR9cmV0dXJuKDAsYVsiZGVmYXVsdCJdKShlLFt7a2V5OiJkaXNjb3ZlckRhdGFPYmplY3RQZXJOYW1lIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMsbj12b2lkIDA7bj10P3Q6ci5kb21haW47dmFyIG89e3R5cGU6InJlYWQiLGZyb206ci5kaXNjb3ZlcnlVUkwsdG86ImRvbWFpbjovL3JlZ2lzdHJ5LiIrbisiLyIsYm9keTp7cmVzb3VyY2U6ImRhdGFPYmplY3Q6Ly8iK2V9fTtyZXR1cm4gbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbihlLHQpe3IubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShvLGZ1bmN0aW9uKHIpe3ZhciBuPXIuYm9keS52YWx1ZS51cmw7bj9lKG4pOnQoIkRhdGFPYmplY3QgbmFtZSBkb2VzIG5vdCBleGlzdCIpfSl9KX19LHtrZXk6ImRpc2NvdmVySHlwZXJ0eVBlclVzZXIiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcyxuPXZvaWQgMDtuPXQ/dDpyLmRvbWFpbjt2YXIgbz0idXNlcjovLyIrZS5zdWJzdHJpbmcoZS5pbmRleE9mKCJAIikrMSxlLmxlbmd0aCkrIi8iK2Uuc3Vic3RyaW5nKDAsZS5pbmRleE9mKCJAIikpLGM9e3R5cGU6InJlYWQiLGZyb206ci5kaXNjb3ZlcnlVUkwsdG86ImRvbWFpbjovL3JlZ2lzdHJ5LiIrbisiLyIsYm9keTp7cmVzb3VyY2U6b319O3JldHVybiBjb25zb2xlLmxvZygiTWVzc2FnZTogIixjLG4sbyksbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbih0LG4pe3IubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShjLGZ1bmN0aW9uKHIpe2NvbnNvbGUubG9nKCJtZXNzYWdlIHJlcGx5IixyKTt2YXIgbz12b2lkIDAsaT12b2lkIDAsYz12b2lkIDAscz1yLmJvZHkudmFsdWU7Zm9yKG8gaW4gcylpZih2b2lkIDAhPT1zW29dLmxhc3RNb2RpZmllZClpZih2b2lkIDA9PT1pKWk9bmV3IERhdGUoc1tvXS5sYXN0TW9kaWZpZWQpLGM9bztlbHNle3ZhciB1PW5ldyBEYXRlKHNbb10ubGFzdE1vZGlmaWVkKTtpLmdldFRpbWUoKTx1LmdldFRpbWUoKSYmKGk9dSxjPW8pfWNvbnNvbGUubG9nKCJMYXN0IEh5cGVydHk6ICIsYyxpKTt2YXIgYT1jO2lmKHZvaWQgMD09PWEpcmV0dXJuIG4oIlVzZXIgSHlwZXJ0eSBub3QgZm91bmQiKTt2YXIgZj17aWQ6ZSxkZXNjcmlwdG9yOnNbYV0uZGVzY3JpcHRvcixoeXBlcnR5VVJMOmF9O2NvbnNvbGUubG9nKCI9PT0+IGh5cGVydHlEaXNjb3ZlcnkgbWVzc2FnZUJ1bmRsZTogIixmKSx0KGYpfSl9KX19LHtrZXk6ImRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlciIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcj10aGlzLG49dm9pZCAwO249dD90OnIuZG9tYWluO3ZhciBvPSJ1c2VyOi8vIitlLnN1YnN0cmluZyhlLmluZGV4T2YoIkAiKSsxLGUubGVuZ3RoKSsiLyIrZS5zdWJzdHJpbmcoMCxlLmluZGV4T2YoIkAiKSksYz17dHlwZToicmVhZCIsZnJvbTpyLmRpc2NvdmVyeVVSTCx0bzoiZG9tYWluOi8vcmVnaXN0cnkuIituKyIvIixib2R5OntyZXNvdXJjZTpvfX07cmV0dXJuIGNvbnNvbGUubG9nKCJNZXNzYWdlIGRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlcjogIixjLG4sbyksbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbihlLHQpe3IubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShjLGZ1bmN0aW9uKHIpe2NvbnNvbGUubG9nKCJkaXNjb3Zlckh5cGVydGllc1BlclVzZXIgcmVwbHkiLHIpO3ZhciBuPXIuYm9keS52YWx1ZTtyZXR1cm4gbj92b2lkIGUobik6dCgiVXNlciBIeXBlcnR5IG5vdCBmb3VuZCIpfSl9KX19XSksZX0oKTtyWyJkZWZhdWx0Il09Xyx0LmV4cG9ydHM9clsiZGVmYXVsdCJdfSx7Ii4uL3V0aWxzL3V0aWxzIjo3OCwiYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UiOjMsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6NCwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjo1fV0sNzg6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1mdW5jdGlvbiBvKGUpe3ZhciB0PS8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpLHI9IiQxLCQyLCQzIixuPWUucmVwbGFjZSh0LHIpLnNwbGl0KCIsIik7blswXT09PWUmJihuWzBdPSJodHRwcyIsblsxXT1lKTt2YXIgbz17dHlwZTpuWzBdLGRvbWFpbjpuWzFdLGlkZW50aXR5Om5bMl19O3JldHVybiBvfWZ1bmN0aW9uIGkoZSl7cmV0dXJuIGU/SlNPTi5wYXJzZSgoMCxzWyJkZWZhdWx0Il0pKGUpKTp2b2lkIDB9T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO3ZhciBjPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSIpLHM9bihjKTtyLmRpdmlkZVVSTD1vLHIuZGVlcENsb25lPWl9LHsiYmFiZWwtcnVudGltZS9jb3JlLWpzL2pzb24vc3RyaW5naWZ5IjoxfV19LHt9LFs3Nl0pKDc2KX0pOwp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CihmdW5jdGlvbiAoZ2xvYmFsKXsKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovLyBEaXN0cmlidXRpb24gZmlsZSBmb3IgU3luY2hlci5qcyAKLy8gdmVyc2lvbjogMC4yLjAKCiFmdW5jdGlvbihlKXtpZigib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlKW1vZHVsZS5leHBvcnRzPWUoKTtlbHNlIGlmKCJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQpZGVmaW5lKFtdLGUpO2Vsc2V7dmFyIHQ7dD0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6InVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOiJ1bmRlZmluZWQiIT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMsdC5TeW5jaGVyPWUoKX19KGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uIGUodCxyLG4pe2Z1bmN0aW9uIG8ocyxhKXtpZighcltzXSl7aWYoIXRbc10pe3ZhciBjPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFhJiZjKXJldHVybiBjKHMsITApO2lmKGkpcmV0dXJuIGkocywhMCk7dmFyIHU9bmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIrcysiJyIpO3Rocm93IHUuY29kZT0iTU9EVUxFX05PVF9GT1VORCIsdX12YXIgbD1yW3NdPXtleHBvcnRzOnt9fTt0W3NdWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciByPXRbc11bMV1bZV07cmV0dXJuIG8ocj9yOmUpfSxsLGwuZXhwb3J0cyxlLHQscixuKX1yZXR1cm4gcltzXS5leHBvcnRzfWZvcih2YXIgaT0iZnVuY3Rpb24iPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxzPTA7czxuLmxlbmd0aDtzKyspbyhuW3NdKTtyZXR1cm4gb30oezE6W2Z1bmN0aW9uKGUsdCxyKXtPYmplY3Qub2JzZXJ2ZSYmIUFycmF5Lm9ic2VydmUmJmZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO3ZhciByPWUuZ2V0Tm90aWZpZXIsbj0icGVyZm9ybUNoYW5nZSIsbz0iX29yaWdpbmFsIixpPSJzcGxpY2UiLHM9e3B1c2g6ZnVuY3Rpb24gYyhlKXt2YXIgdD1hcmd1bWVudHMscz1jW29dLmFwcGx5KHRoaXMsdCk7cmV0dXJuIHIodGhpcylbbl0oaSxmdW5jdGlvbigpe3JldHVybntpbmRleDpzLXQubGVuZ3RoLGFkZGVkQ291bnQ6dC5sZW5ndGgscmVtb3ZlZDpbXX19KSxzfSx1bnNoaWZ0OmZ1bmN0aW9uIHUoZSl7dmFyIHQ9YXJndW1lbnRzLHM9dVtvXS5hcHBseSh0aGlzLHQpO3JldHVybiByKHRoaXMpW25dKGksZnVuY3Rpb24oKXtyZXR1cm57aW5kZXg6MCxhZGRlZENvdW50OnQubGVuZ3RoLHJlbW92ZWQ6W119fSksc30scG9wOmZ1bmN0aW9uIGwoKXt2YXIgZT10aGlzLmxlbmd0aCx0PWxbb10uY2FsbCh0aGlzKTtyZXR1cm4gdGhpcy5sZW5ndGghPT1lJiZyKHRoaXMpW25dKGksZnVuY3Rpb24oKXtyZXR1cm57aW5kZXg6dGhpcy5sZW5ndGgsYWRkZWRDb3VudDowLHJlbW92ZWQ6W3RdfX0sdGhpcyksdH0sc2hpZnQ6ZnVuY3Rpb24gZigpe3ZhciBlPXRoaXMubGVuZ3RoLHQ9ZltvXS5jYWxsKHRoaXMpO3JldHVybiB0aGlzLmxlbmd0aCE9PWUmJnIodGhpcylbbl0oaSxmdW5jdGlvbigpe3JldHVybntpbmRleDowLGFkZGVkQ291bnQ6MCxyZW1vdmVkOlt0XX19LHRoaXMpLHR9LHNwbGljZTpmdW5jdGlvbiBkKGUsdCl7dmFyIHM9YXJndW1lbnRzLGE9ZFtvXS5hcHBseSh0aGlzLHMpO3JldHVybihhLmxlbmd0aHx8cy5sZW5ndGg+MikmJnIodGhpcylbbl0oaSxmdW5jdGlvbigpe3JldHVybntpbmRleDplLGFkZGVkQ291bnQ6cy5sZW5ndGgtMixyZW1vdmVkOmF9fSx0aGlzKSxhfX07Zm9yKHZhciBhIGluIHMpc1thXVtvXT10LnByb3RvdHlwZVthXSx0LnByb3RvdHlwZVthXT1zW2FdO3Qub2JzZXJ2ZT1mdW5jdGlvbih0LHIpe3JldHVybiBlLm9ic2VydmUodCxyLFsiYWRkIiwidXBkYXRlIiwiZGVsZXRlIixpXSl9LHQudW5vYnNlcnZlPWUudW5vYnNlcnZlfShPYmplY3QsQXJyYXkpfSx7fV0sMjpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeSI6MTd9XSwzOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9jcmVhdGUiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZSI6MTh9XSw0OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHkiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6MTl9XSw1OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI6MjB9XSw2OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIiksX19lc01vZHVsZTohMH19LHsiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjoyMX1dLDc6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2tleXMiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2tleXMiOjIyfV0sODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZiI6MjN9XSw5OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL3Byb21pc2UiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vcHJvbWlzZSI6MjR9XSwxMDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIjoyNX1dLDExOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3IuX19lc01vZHVsZT0hMCxyWyJkZWZhdWx0Il09ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX19LHt9XSwxMjpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fXIuX19lc01vZHVsZT0hMDt2YXIgbz1lKCIuLi9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkiKSxpPW4obyk7clsiZGVmYXVsdCJdPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2Zvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKXt2YXIgbj10W3JdO24uZW51bWVyYWJsZT1uLmVudW1lcmFibGV8fCExLG4uY29uZmlndXJhYmxlPSEwLCJ2YWx1ZSJpbiBuJiYobi53cml0YWJsZT0hMCksKDAsaVsiZGVmYXVsdCJdKShlLG4ua2V5LG4pfX1yZXR1cm4gZnVuY3Rpb24odCxyLG4pe3JldHVybiByJiZlKHQucHJvdG90eXBlLHIpLG4mJmUodCxuKSx0fX0oKX0seyIuLi9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkiOjR9XSwxMzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpWyJkZWZhdWx0Il07clsiZGVmYXVsdCJdPWZ1bmN0aW9uKGUsdCxyKXtmb3IodmFyIG89ITA7bzspe3ZhciBpPWUscz10LGE9cjtvPSExLG51bGw9PT1pJiYoaT1GdW5jdGlvbi5wcm90b3R5cGUpO3ZhciBjPW4oaSxzKTtpZih2b2lkIDAhPT1jKXtpZigidmFsdWUiaW4gYylyZXR1cm4gYy52YWx1ZTt2YXIgdT1jLmdldDtpZih2b2lkIDA9PT11KXJldHVybjtyZXR1cm4gdS5jYWxsKGEpfXZhciBsPU9iamVjdC5nZXRQcm90b3R5cGVPZihpKTtpZihudWxsPT09bClyZXR1cm47ZT1sLHQ9cyxyPWEsbz0hMCxjPWw9dm9pZCAwfX0sci5fX2VzTW9kdWxlPSEwfSx7ImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjo1fV0sMTQ6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9jcmVhdGUiKVsiZGVmYXVsdCJdLG89ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mIilbImRlZmF1bHQiXTtyWyJkZWZhdWx0Il09ZnVuY3Rpb24oZSx0KXtpZigiZnVuY3Rpb24iIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiK3R5cGVvZiB0KTtlLnByb3RvdHlwZT1uKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSxlbnVtZXJhYmxlOiExLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19KSx0JiYobz9vKGUsdCk6ZS5fX3Byb3RvX189dCl9LHIuX19lc01vZHVsZT0hMH0seyJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2NyZWF0ZSI6MywiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mIjo4fV0sMTU6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1yLl9fZXNNb2R1bGU9ITA7dmFyIG89ZSgiLi4vaGVscGVycy90eXBlb2YiKSxpPW4obyk7clsiZGVmYXVsdCJdPWZ1bmN0aW9uKGUsdCl7aWYoIWUpdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTtyZXR1cm4hdHx8Im9iamVjdCIhPT0oInVuZGVmaW5lZCI9PXR5cGVvZiB0PyJ1bmRlZmluZWQiOigwLGlbImRlZmF1bHQiXSkodCkpJiYiZnVuY3Rpb24iIT10eXBlb2YgdD9lOnR9fSx7Ii4uL2hlbHBlcnMvdHlwZW9mIjoxNn1dLDE2OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3ZhciBuPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9zeW1ib2wiKVsiZGVmYXVsdCJdO3JbImRlZmF1bHQiXT1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5jb25zdHJ1Y3Rvcj09PW4/InN5bWJvbCI6dHlwZW9mIGV9LHIuX19lc01vZHVsZT0hMH0seyJiYWJlbC1ydW50aW1lL2NvcmUtanMvc3ltYm9sIjoxMH1dLDE3OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vLi4vbW9kdWxlcy8kLmNvcmUiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuKG4uSlNPTiYmbi5KU09OLnN0cmluZ2lmeXx8SlNPTi5zdHJpbmdpZnkpLmFwcGx5KEpTT04sYXJndW1lbnRzKX19LHsiLi4vLi4vbW9kdWxlcy8kLmNvcmUiOjMxfV0sMTg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLi8uLi9tb2R1bGVzLyQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jcmVhdGUoZSx0KX19LHsiLi4vLi4vbW9kdWxlcy8kIjo1Nn1dLDE5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vLi4vbW9kdWxlcy8kIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gbi5zZXREZXNjKGUsdCxyKX19LHsiLi4vLi4vbW9kdWxlcy8kIjo1Nn1dLDIwOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vLi4vbW9kdWxlcy8kIik7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpLHQuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybiBuLmdldERlc2MoZSx0KX19LHsiLi4vLi4vbW9kdWxlcy8kIjo1NiwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI6ODF9XSwyMTpbZnVuY3Rpb24oZSx0LHIpe2UoIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtcHJvdG90eXBlLW9mIiksdC5leHBvcnRzPWUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuT2JqZWN0LmdldFByb3RvdHlwZU9mfSx7Ii4uLy4uL21vZHVsZXMvJC5jb3JlIjozMSwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1wcm90b3R5cGUtb2YiOjgyfV0sMjI6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Qua2V5cyIpLHQuZXhwb3J0cz1lKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5rZXlzfSx7Ii4uLy4uL21vZHVsZXMvJC5jb3JlIjozMSwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmtleXMiOjgzfV0sMjM6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZiIpLHQuZXhwb3J0cz1lKCIuLi8uLi9tb2R1bGVzLyQuY29yZSIpLk9iamVjdC5zZXRQcm90b3R5cGVPZn0seyIuLi8uLi9tb2R1bGVzLyQuY29yZSI6MzEsIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mIjo4NH1dLDI0OltmdW5jdGlvbihlLHQscil7ZSgiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyIpLGUoIi4uL21vZHVsZXMvZXM2LnN0cmluZy5pdGVyYXRvciIpLGUoIi4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSIpLGUoIi4uL21vZHVsZXMvZXM2LnByb21pc2UiKSx0LmV4cG9ydHM9ZSgiLi4vbW9kdWxlcy8kLmNvcmUiKS5Qcm9taXNlfSx7Ii4uL21vZHVsZXMvJC5jb3JlIjozMSwiLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyI6ODUsIi4uL21vZHVsZXMvZXM2LnByb21pc2UiOjg2LCIuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IiOjg3LCIuLi9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUiOjg5fV0sMjU6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuLi8uLi9tb2R1bGVzL2VzNi5zeW1ib2wiKSxlKCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nIiksdC5leHBvcnRzPWUoIi4uLy4uL21vZHVsZXMvJC5jb3JlIikuU3ltYm9sfSx7Ii4uLy4uL21vZHVsZXMvJC5jb3JlIjozMSwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyI6ODUsIi4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCI6ODh9XSwyNjpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZigiZnVuY3Rpb24iIT10eXBlb2YgZSl0aHJvdyBUeXBlRXJyb3IoZSsiIGlzIG5vdCBhIGZ1bmN0aW9uISIpO3JldHVybiBlfX0se31dLDI3OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKCl7fX0se31dLDI4OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLmlzLW9iamVjdCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZighbihlKSl0aHJvdyBUeXBlRXJyb3IoZSsiIGlzIG5vdCBhbiBvYmplY3QhIik7cmV0dXJuIGV9fSx7Ii4vJC5pcy1vYmplY3QiOjQ5fV0sMjk6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuY29mIiksbz1lKCIuLyQud2tzIikoInRvU3RyaW5nVGFnIiksaT0iQXJndW1lbnRzIj09bihmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHN9KCkpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXt2YXIgdCxyLHM7cmV0dXJuIHZvaWQgMD09PWU/IlVuZGVmaW5lZCI6bnVsbD09PWU/Ik51bGwiOiJzdHJpbmciPT10eXBlb2Yocj0odD1PYmplY3QoZSkpW29dKT9yOmk/bih0KToiT2JqZWN0Ij09KHM9bih0KSkmJiJmdW5jdGlvbiI9PXR5cGVvZiB0LmNhbGxlZT8iQXJndW1lbnRzIjpzfX0seyIuLyQuY29mIjozMCwiLi8kLndrcyI6Nzh9XSwzMDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXt9LnRvU3RyaW5nO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbi5jYWxsKGUpLnNsaWNlKDgsLTEpfX0se31dLDMxOltmdW5jdGlvbihlLHQscil7dmFyIG49dC5leHBvcnRzPXt2ZXJzaW9uOiIxLjIuNiJ9OyJudW1iZXIiPT10eXBlb2YgX19lJiYoX19lPW4pfSx7fV0sMzI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuYS1mdW5jdGlvbiIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7aWYobihlKSx2b2lkIDA9PT10KXJldHVybiBlO3N3aXRjaChyKXtjYXNlIDE6cmV0dXJuIGZ1bmN0aW9uKHIpe3JldHVybiBlLmNhbGwodCxyKX07Y2FzZSAyOnJldHVybiBmdW5jdGlvbihyLG4pe3JldHVybiBlLmNhbGwodCxyLG4pfTtjYXNlIDM6cmV0dXJuIGZ1bmN0aW9uKHIsbixvKXtyZXR1cm4gZS5jYWxsKHQscixuLG8pfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0LGFyZ3VtZW50cyl9fX0seyIuLyQuYS1mdW5jdGlvbiI6MjZ9XSwzMzpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXtpZih2b2lkIDA9PWUpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIitlKTtyZXR1cm4gZX19LHt9XSwzNDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz0hZSgiLi8kLmZhaWxzIikoZnVuY3Rpb24oKXtyZXR1cm4gNyE9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCJhIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSkuYX0pfSx7Ii4vJC5mYWlscyI6Mzh9XSwzNTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5pcy1vYmplY3QiKSxvPWUoIi4vJC5nbG9iYWwiKS5kb2N1bWVudCxpPW4obykmJm4oby5jcmVhdGVFbGVtZW50KTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGk/by5jcmVhdGVFbGVtZW50KGUpOnt9fX0seyIuLyQuZ2xvYmFsIjo0MSwiLi8kLmlzLW9iamVjdCI6NDl9XSwzNjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXt2YXIgdD1uLmdldEtleXMoZSkscj1uLmdldFN5bWJvbHM7aWYocilmb3IodmFyIG8saT1yKGUpLHM9bi5pc0VudW0sYT0wO2kubGVuZ3RoPmE7KXMuY2FsbChlLG89aVthKytdKSYmdC5wdXNoKG8pO3JldHVybiB0fX0seyIuLyQiOjU2fV0sMzc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuZ2xvYmFsIiksbz1lKCIuLyQuY29yZSIpLGk9ZSgiLi8kLmN0eCIpLHM9InByb3RvdHlwZSIsYT1mdW5jdGlvbihlLHQscil7dmFyIGMsdSxsLGY9ZSZhLkYsZD1lJmEuRyxwPWUmYS5TLGI9ZSZhLlAsaD1lJmEuQix2PWUmYS5XLHk9ZD9vOm9bdF18fChvW3RdPXt9KSxfPWQ/bjpwP25bdF06KG5bdF18fHt9KVtzXTtkJiYocj10KTtmb3IoYyBpbiByKXU9IWYmJl8mJmMgaW4gXyx1JiZjIGluIHl8fChsPXU/X1tjXTpyW2NdLHlbY109ZCYmImZ1bmN0aW9uIiE9dHlwZW9mIF9bY10/cltjXTpoJiZ1P2kobCxuKTp2JiZfW2NdPT1sP2Z1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzIGluc3RhbmNlb2YgZT9uZXcgZSh0KTplKHQpfTtyZXR1cm4gdFtzXT1lW3NdLHR9KGwpOmImJiJmdW5jdGlvbiI9PXR5cGVvZiBsP2koRnVuY3Rpb24uY2FsbCxsKTpsLGImJigoeVtzXXx8KHlbc109e30pKVtjXT1sKSl9O2EuRj0xLGEuRz0yLGEuUz00LGEuUD04LGEuQj0xNixhLlc9MzIsdC5leHBvcnRzPWF9LHsiLi8kLmNvcmUiOjMxLCIuLyQuY3R4IjozMiwiLi8kLmdsb2JhbCI6NDF9XSwzODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlKXt0cnl7cmV0dXJuISFlKCl9Y2F0Y2godCl7cmV0dXJuITB9fX0se31dLDM5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLmN0eCIpLG89ZSgiLi8kLml0ZXItY2FsbCIpLGk9ZSgiLi8kLmlzLWFycmF5LWl0ZXIiKSxzPWUoIi4vJC5hbi1vYmplY3QiKSxhPWUoIi4vJC50by1sZW5ndGgiKSxjPWUoIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLHUpe3ZhciBsLGYsZCxwPWMoZSksYj1uKHIsdSx0PzI6MSksaD0wO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBwKXRocm93IFR5cGVFcnJvcihlKyIgaXMgbm90IGl0ZXJhYmxlISIpO2lmKGkocCkpZm9yKGw9YShlLmxlbmd0aCk7bD5oO2grKyl0P2IocyhmPWVbaF0pWzBdLGZbMV0pOmIoZVtoXSk7ZWxzZSBmb3IoZD1wLmNhbGwoZSk7IShmPWQubmV4dCgpKS5kb25lOylvKGQsYixmLnZhbHVlLHQpfX0seyIuLyQuYW4tb2JqZWN0IjoyOCwiLi8kLmN0eCI6MzIsIi4vJC5pcy1hcnJheS1pdGVyIjo0NywiLi8kLml0ZXItY2FsbCI6NTAsIi4vJC50by1sZW5ndGgiOjc1LCIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCI6Nzl9XSw0MDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC50by1pb2JqZWN0Iiksbz1lKCIuLyQiKS5nZXROYW1lcyxpPXt9LnRvU3RyaW5nLHM9Im9iamVjdCI9PXR5cGVvZiB3aW5kb3cmJk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzP09iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdyk6W10sYT1mdW5jdGlvbihlKXt0cnl7cmV0dXJuIG8oZSl9Y2F0Y2godCl7cmV0dXJuIHMuc2xpY2UoKX19O3QuZXhwb3J0cy5nZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHMmJiJbb2JqZWN0IFdpbmRvd10iPT1pLmNhbGwoZSk/YShlKTpvKG4oZSkpfX0seyIuLyQiOjU2LCIuLyQudG8taW9iamVjdCI6NzR9XSw0MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXQuZXhwb3J0cz0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93Lk1hdGg9PU1hdGg/d2luZG93OiJ1bmRlZmluZWQiIT10eXBlb2Ygc2VsZiYmc2VsZi5NYXRoPT1NYXRoP3NlbGY6RnVuY3Rpb24oInJldHVybiB0aGlzIikoKTsibnVtYmVyIj09dHlwZW9mIF9fZyYmKF9fZz1uKX0se31dLDQyOltmdW5jdGlvbihlLHQscil7dmFyIG49e30uaGFzT3duUHJvcGVydHk7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG4uY2FsbChlLHQpfX0se31dLDQzOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kIiksbz1lKCIuLyQucHJvcGVydHktZGVzYyIpO3QuZXhwb3J0cz1lKCIuLyQuZGVzY3JpcHRvcnMiKT9mdW5jdGlvbihlLHQscil7cmV0dXJuIG4uc2V0RGVzYyhlLHQsbygxLHIpKX06ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlW3RdPXIsZX19LHsiLi8kIjo1NiwiLi8kLmRlc2NyaXB0b3JzIjozNCwiLi8kLnByb3BlcnR5LWRlc2MiOjYxfV0sNDQ6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZSgiLi8kLmdsb2JhbCIpLmRvY3VtZW50JiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnR9LHsiLi8kLmdsb2JhbCI6NDF9XSw0NTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7dmFyIG49dm9pZCAwPT09cjtzd2l0Y2godC5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gbj9lKCk6ZS5jYWxsKHIpO2Nhc2UgMTpyZXR1cm4gbj9lKHRbMF0pOmUuY2FsbChyLHRbMF0pO2Nhc2UgMjpyZXR1cm4gbj9lKHRbMF0sdFsxXSk6ZS5jYWxsKHIsdFswXSx0WzFdKTtjYXNlIDM6cmV0dXJuIG4/ZSh0WzBdLHRbMV0sdFsyXSk6ZS5jYWxsKHIsdFswXSx0WzFdLHRbMl0pO2Nhc2UgNDpyZXR1cm4gbj9lKHRbMF0sdFsxXSx0WzJdLHRbM10pOmUuY2FsbChyLHRbMF0sdFsxXSx0WzJdLHRbM10pfXJldHVybiBlLmFwcGx5KHIsdCl9fSx7fV0sNDY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuY29mIik7dC5leHBvcnRzPU9iamVjdCgieiIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApP09iamVjdDpmdW5jdGlvbihlKXtyZXR1cm4iU3RyaW5nIj09bihlKT9lLnNwbGl0KCIiKTpPYmplY3QoZSl9fSx7Ii4vJC5jb2YiOjMwfV0sNDc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuaXRlcmF0b3JzIiksbz1lKCIuLyQud2tzIikoIml0ZXJhdG9yIiksaT1BcnJheS5wcm90b3R5cGU7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDAhPT1lJiYobi5BcnJheT09PWV8fGlbb109PT1lKX19LHsiLi8kLml0ZXJhdG9ycyI6NTUsIi4vJC53a3MiOjc4fV0sNDg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuY29mIik7dC5leHBvcnRzPUFycmF5LmlzQXJyYXl8fGZ1bmN0aW9uKGUpe3JldHVybiJBcnJheSI9PW4oZSl9fSx7Ii4vJC5jb2YiOjMwfV0sNDk6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIm9iamVjdCI9PXR5cGVvZiBlP251bGwhPT1lOiJmdW5jdGlvbiI9PXR5cGVvZiBlfX0se31dLDUwOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLmFuLW9iamVjdCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscixvKXt0cnl7cmV0dXJuIG8/dChuKHIpWzBdLHJbMV0pOnQocil9Y2F0Y2goaSl7dmFyIHM9ZVsicmV0dXJuIl07dGhyb3cgdm9pZCAwIT09cyYmbihzLmNhbGwoZSkpLGl9fX0seyIuLyQuYW4tb2JqZWN0IjoyOH1dLDUxOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3ZhciBuPWUoIi4vJCIpLG89ZSgiLi8kLnByb3BlcnR5LWRlc2MiKSxpPWUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpLHM9e307ZSgiLi8kLmhpZGUiKShzLGUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSksdC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtlLnByb3RvdHlwZT1uLmNyZWF0ZShzLHtuZXh0Om8oMSxyKX0pLGkoZSx0KyIgSXRlcmF0b3IiKX19LHsiLi8kIjo1NiwiLi8kLmhpZGUiOjQzLCIuLyQucHJvcGVydHktZGVzYyI6NjEsIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6NjcsIi4vJC53a3MiOjc4fV0sNTI6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi8kLmxpYnJhcnkiKSxvPWUoIi4vJC5leHBvcnQiKSxpPWUoIi4vJC5yZWRlZmluZSIpLHM9ZSgiLi8kLmhpZGUiKSxhPWUoIi4vJC5oYXMiKSxjPWUoIi4vJC5pdGVyYXRvcnMiKSx1PWUoIi4vJC5pdGVyLWNyZWF0ZSIpLGw9ZSgiLi8kLnNldC10by1zdHJpbmctdGFnIiksZj1lKCIuLyQiKS5nZXRQcm90byxkPWUoIi4vJC53a3MiKSgiaXRlcmF0b3IiKSxwPSEoW10ua2V5cyYmIm5leHQiaW5bXS5rZXlzKCkpLGI9IkBAaXRlcmF0b3IiLGg9ImtleXMiLHY9InZhbHVlcyIseT1mdW5jdGlvbigpe3JldHVybiB0aGlzfTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0LHIsXyxnLG0sail7dShyLHQsXyk7dmFyICQsTyx3PWZ1bmN0aW9uKGUpe2lmKCFwJiZlIGluIEUpcmV0dXJuIEVbZV07c3dpdGNoKGUpe2Nhc2UgaDpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyxlKX07Y2FzZSB2OnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgcih0aGlzLGUpfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyxlKX19LGs9dCsiIEl0ZXJhdG9yIix4PWc9PXYsQz0hMSxFPWUucHJvdG90eXBlLFM9RVtkXXx8RVtiXXx8ZyYmRVtnXSxUPVN8fHcoZyk7aWYoUyl7dmFyIE09ZihULmNhbGwobmV3IGUpKTtsKE0saywhMCksIW4mJmEoRSxiKSYmcyhNLGQseSkseCYmUy5uYW1lIT09diYmKEM9ITAsVD1mdW5jdGlvbigpe3JldHVybiBTLmNhbGwodGhpcyl9KX1pZihuJiYhanx8IXAmJiFDJiZFW2RdfHxzKEUsZCxUKSxjW3RdPVQsY1trXT15LGcpaWYoJD17dmFsdWVzOng/VDp3KHYpLGtleXM6bT9UOncoaCksZW50cmllczp4P3coImVudHJpZXMiKTpUfSxqKWZvcihPIGluICQpTyBpbiBFfHxpKEUsTywkW09dKTtlbHNlIG8oby5QK28uRioocHx8QyksdCwkKTtyZXR1cm4gJH19LHsiLi8kIjo1NiwiLi8kLmV4cG9ydCI6MzcsIi4vJC5oYXMiOjQyLCIuLyQuaGlkZSI6NDMsIi4vJC5pdGVyLWNyZWF0ZSI6NTEsIi4vJC5pdGVyYXRvcnMiOjU1LCIuLyQubGlicmFyeSI6NTgsIi4vJC5yZWRlZmluZSI6NjMsIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyI6NjcsIi4vJC53a3MiOjc4fV0sNTM6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQud2tzIikoIml0ZXJhdG9yIiksbz0hMTt0cnl7dmFyIGk9WzddW25dKCk7aVsicmV0dXJuIl09ZnVuY3Rpb24oKXtvPSEwfSxBcnJheS5mcm9tKGksZnVuY3Rpb24oKXt0aHJvdyAyfSl9Y2F0Y2gocyl7fXQuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKCF0JiYhbylyZXR1cm4hMTt2YXIgcj0hMTt0cnl7dmFyIGk9WzddLHM9aVtuXSgpO3MubmV4dD1mdW5jdGlvbigpe3I9ITB9LGlbbl09ZnVuY3Rpb24oKXtyZXR1cm4gc30sZShpKX1jYXRjaChhKXt9cmV0dXJuIHJ9fSx7Ii4vJC53a3MiOjc4fV0sNTQ6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm57dmFsdWU6dCxkb25lOiEhZX19fSx7fV0sNTU6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9e319LHt9XSw1NjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPU9iamVjdDt0LmV4cG9ydHM9e2NyZWF0ZTpuLmNyZWF0ZSxnZXRQcm90bzpuLmdldFByb3RvdHlwZU9mLGlzRW51bTp7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxnZXREZXNjOm4uZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLHNldERlc2M6bi5kZWZpbmVQcm9wZXJ0eSxzZXREZXNjczpuLmRlZmluZVByb3BlcnRpZXMsZ2V0S2V5czpuLmtleXMsZ2V0TmFtZXM6bi5nZXRPd25Qcm9wZXJ0eU5hbWVzLGdldFN5bWJvbHM6bi5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMsZWFjaDpbXS5mb3JFYWNofX0se31dLDU3OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kIiksbz1lKCIuLyQudG8taW9iamVjdCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2Zvcih2YXIgcixpPW8oZSkscz1uLmdldEtleXMoaSksYT1zLmxlbmd0aCxjPTA7YT5jOylpZihpW3I9c1tjKytdXT09PXQpcmV0dXJuIHJ9fSx7Ii4vJCI6NTYsIi4vJC50by1pb2JqZWN0Ijo3NH1dLDU4OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPSEwfSx7fV0sNTk6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbixvLGkscz1lKCIuLyQuZ2xvYmFsIiksYT1lKCIuLyQudGFzayIpLnNldCxjPXMuTXV0YXRpb25PYnNlcnZlcnx8cy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyLHU9cy5wcm9jZXNzLGw9cy5Qcm9taXNlLGY9InByb2Nlc3MiPT1lKCIuLyQuY29mIikodSksZD1mdW5jdGlvbigpe3ZhciBlLHQscjtmb3IoZiYmKGU9dS5kb21haW4pJiYodS5kb21haW49bnVsbCxlLmV4aXQoKSk7bjspdD1uLmRvbWFpbixyPW4uZm4sdCYmdC5lbnRlcigpLHIoKSx0JiZ0LmV4aXQoKSxuPW4ubmV4dDtvPXZvaWQgMCxlJiZlLmVudGVyKCl9O2lmKGYpaT1mdW5jdGlvbigpe3UubmV4dFRpY2soZCl9O2Vsc2UgaWYoYyl7dmFyIHA9MSxiPWRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCIiKTtuZXcgYyhkKS5vYnNlcnZlKGIse2NoYXJhY3RlckRhdGE6ITB9KSxpPWZ1bmN0aW9uKCl7Yi5kYXRhPXA9LXB9fWVsc2UgaT1sJiZsLnJlc29sdmU/ZnVuY3Rpb24oKXtsLnJlc29sdmUoKS50aGVuKGQpfTpmdW5jdGlvbigpe2EuY2FsbChzLGQpfTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7dmFyIHQ9e2ZuOmUsbmV4dDp2b2lkIDAsZG9tYWluOmYmJnUuZG9tYWlufTtvJiYoby5uZXh0PXQpLG58fChuPXQsaSgpKSxvPXR9fSx7Ii4vJC5jb2YiOjMwLCIuLyQuZ2xvYmFsIjo0MSwiLi8kLnRhc2siOjcyfV0sNjA6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuZXhwb3J0Iiksbz1lKCIuLyQuY29yZSIpLGk9ZSgiLi8kLmZhaWxzIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIHI9KG8uT2JqZWN0fHx7fSlbZV18fE9iamVjdFtlXSxzPXt9O3NbZV09dChyKSxuKG4uUytuLkYqaShmdW5jdGlvbigpe3IoMSl9KSwiT2JqZWN0IixzKX19LHsiLi8kLmNvcmUiOjMxLCIuLyQuZXhwb3J0IjozNywiLi8kLmZhaWxzIjozOH1dLDYxOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJue2VudW1lcmFibGU6ISgxJmUpLGNvbmZpZ3VyYWJsZTohKDImZSksd3JpdGFibGU6ISg0JmUpLHZhbHVlOnR9fX0se31dLDYyOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLnJlZGVmaW5lIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByIGluIHQpbihlLHIsdFtyXSk7cmV0dXJuIGV9fSx7Ii4vJC5yZWRlZmluZSI6NjN9XSw2MzpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1lKCIuLyQuaGlkZSIpfSx7Ii4vJC5oaWRlIjo0M31dLDY0OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPU9iamVjdC5pc3x8ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT09PXQ/MCE9PWV8fDEvZT09PTEvdDplIT1lJiZ0IT10fX0se31dLDY1OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kIikuZ2V0RGVzYyxvPWUoIi4vJC5pcy1vYmplY3QiKSxpPWUoIi4vJC5hbi1vYmplY3QiKSxzPWZ1bmN0aW9uKGUsdCl7aWYoaShlKSwhbyh0KSYmbnVsbCE9PXQpdGhyb3cgVHlwZUVycm9yKHQrIjogY2FuJ3Qgc2V0IGFzIHByb3RvdHlwZSEiKX07dC5leHBvcnRzPXtzZXQ6T2JqZWN0LnNldFByb3RvdHlwZU9mfHwoIl9fcHJvdG9fXyJpbnt9P2Z1bmN0aW9uKHQscixvKXt0cnl7bz1lKCIuLyQuY3R4IikoRnVuY3Rpb24uY2FsbCxuKE9iamVjdC5wcm90b3R5cGUsIl9fcHJvdG9fXyIpLnNldCwyKSxvKHQsW10pLHI9ISh0IGluc3RhbmNlb2YgQXJyYXkpfWNhdGNoKGkpe3I9ITB9cmV0dXJuIGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHMoZSx0KSxyP2UuX19wcm90b19fPXQ6byhlLHQpLGV9fSh7fSwhMSk6dm9pZCAwKSxjaGVjazpzfX0seyIuLyQiOjU2LCIuLyQuYW4tb2JqZWN0IjoyOCwiLi8kLmN0eCI6MzIsIi4vJC5pcy1vYmplY3QiOjQ5fV0sNjY6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi8kLmNvcmUiKSxvPWUoIi4vJCIpLGk9ZSgiLi8kLmRlc2NyaXB0b3JzIikscz1lKCIuLyQud2tzIikoInNwZWNpZXMiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7dmFyIHQ9bltlXTtpJiZ0JiYhdFtzXSYmby5zZXREZXNjKHQscyx7Y29uZmlndXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzfX0pfX0seyIuLyQiOjU2LCIuLyQuY29yZSI6MzEsIi4vJC5kZXNjcmlwdG9ycyI6MzQsIi4vJC53a3MiOjc4fV0sNjc6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQiKS5zZXREZXNjLG89ZSgiLi8kLmhhcyIpLGk9ZSgiLi8kLndrcyIpKCJ0b1N0cmluZ1RhZyIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7ZSYmIW8oZT1yP2U6ZS5wcm90b3R5cGUsaSkmJm4oZSxpLHtjb25maWd1cmFibGU6ITAsdmFsdWU6dH0pfX0seyIuLyQiOjU2LCIuLyQuaGFzIjo0MiwiLi8kLndrcyI6Nzh9XSw2ODpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5nbG9iYWwiKSxvPSJfX2NvcmUtanNfc2hhcmVkX18iLGk9bltvXXx8KG5bb109e30pO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaVtlXXx8KGlbZV09e30pfX0seyIuLyQuZ2xvYmFsIjo0MX1dLDY5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi8kLmFuLW9iamVjdCIpLG89ZSgiLi8kLmEtZnVuY3Rpb24iKSxpPWUoIi4vJC53a3MiKSgic3BlY2llcyIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3ZhciByLHM9bihlKS5jb25zdHJ1Y3RvcjtyZXR1cm4gdm9pZCAwPT09c3x8dm9pZCAwPT0ocj1uKHMpW2ldKT90Om8ocil9fSx7Ii4vJC5hLWZ1bmN0aW9uIjoyNiwiLi8kLmFuLW9iamVjdCI6MjgsIi4vJC53a3MiOjc4fV0sNzA6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0LHIpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IFR5cGVFcnJvcihyKyI6IHVzZSB0aGUgJ25ldycgb3BlcmF0b3IhIik7cmV0dXJuIGV9fSx7fV0sNzE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQudG8taW50ZWdlciIpLG89ZSgiLi8kLmRlZmluZWQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQscil7dmFyIGkscyxhPVN0cmluZyhvKHQpKSxjPW4ociksdT1hLmxlbmd0aDtyZXR1cm4gMD5jfHxjPj11P2U/IiI6dm9pZCAwOihpPWEuY2hhckNvZGVBdChjKSw1NTI5Nj5pfHxpPjU2MzE5fHxjKzE9PT11fHwocz1hLmNoYXJDb2RlQXQoYysxKSk8NTYzMjB8fHM+NTczNDM/ZT9hLmNoYXJBdChjKTppOmU/YS5zbGljZShjLGMrMik6KGktNTUyOTY8PDEwKSsocy01NjMyMCkrNjU1MzYpfX19LHsiLi8kLmRlZmluZWQiOjMzLCIuLyQudG8taW50ZWdlciI6NzN9XSw3MjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG8saSxzPWUoIi4vJC5jdHgiKSxhPWUoIi4vJC5pbnZva2UiKSxjPWUoIi4vJC5odG1sIiksdT1lKCIuLyQuZG9tLWNyZWF0ZSIpLGw9ZSgiLi8kLmdsb2JhbCIpLGY9bC5wcm9jZXNzLGQ9bC5zZXRJbW1lZGlhdGUscD1sLmNsZWFySW1tZWRpYXRlLGI9bC5NZXNzYWdlQ2hhbm5lbCxoPTAsdj17fSx5PSJvbnJlYWR5c3RhdGVjaGFuZ2UiLF89ZnVuY3Rpb24oKXt2YXIgZT0rdGhpcztpZih2Lmhhc093blByb3BlcnR5KGUpKXt2YXIgdD12W2VdO2RlbGV0ZSB2W2VdLHQoKX19LGc9ZnVuY3Rpb24oZSl7Xy5jYWxsKGUuZGF0YSl9O2QmJnB8fChkPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxyPTE7YXJndW1lbnRzLmxlbmd0aD5yOyl0LnB1c2goYXJndW1lbnRzW3IrK10pO3JldHVybiB2WysraF09ZnVuY3Rpb24oKXthKCJmdW5jdGlvbiI9PXR5cGVvZiBlP2U6RnVuY3Rpb24oZSksdCl9LG4oaCksaH0scD1mdW5jdGlvbihlKXtkZWxldGUgdltlXX0sInByb2Nlc3MiPT1lKCIuLyQuY29mIikoZik/bj1mdW5jdGlvbihlKXtmLm5leHRUaWNrKHMoXyxlLDEpKX06Yj8obz1uZXcgYixpPW8ucG9ydDIsby5wb3J0MS5vbm1lc3NhZ2U9ZyxuPXMoaS5wb3N0TWVzc2FnZSxpLDEpKTpsLmFkZEV2ZW50TGlzdGVuZXImJiJmdW5jdGlvbiI9PXR5cGVvZiBwb3N0TWVzc2FnZSYmIWwuaW1wb3J0U2NyaXB0cz8obj1mdW5jdGlvbihlKXtsLnBvc3RNZXNzYWdlKGUrIiIsIioiKX0sbC5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixnLCExKSk6bj15IGluIHUoInNjcmlwdCIpP2Z1bmN0aW9uKGUpe2MuYXBwZW5kQ2hpbGQodSgic2NyaXB0IikpW3ldPWZ1bmN0aW9uKCl7Yy5yZW1vdmVDaGlsZCh0aGlzKSxfLmNhbGwoZSl9fTpmdW5jdGlvbihlKXtzZXRUaW1lb3V0KHMoXyxlLDEpLDApfSksdC5leHBvcnRzPXtzZXQ6ZCxjbGVhcjpwfX0seyIuLyQuY29mIjozMCwiLi8kLmN0eCI6MzIsIi4vJC5kb20tY3JlYXRlIjozNSwiLi8kLmdsb2JhbCI6NDEsIi4vJC5odG1sIjo0NCwiLi8kLmludm9rZSI6NDV9XSw3MzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPU1hdGguY2VpbCxvPU1hdGguZmxvb3I7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBpc05hTihlPStlKT8wOihlPjA/bzpuKShlKX19LHt9XSw3NDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5pb2JqZWN0Iiksbz1lKCIuLyQuZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbihvKGUpKX19LHsiLi8kLmRlZmluZWQiOjMzLCIuLyQuaW9iamVjdCI6NDZ9XSw3NTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC50by1pbnRlZ2VyIiksbz1NYXRoLm1pbjt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGU+MD9vKG4oZSksOTAwNzE5OTI1NDc0MDk5MSk6MH19LHsiLi8kLnRvLWludGVnZXIiOjczfV0sNzY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQuZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KG4oZSkpfX0seyIuLyQuZGVmaW5lZCI6MzN9XSw3NzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPTAsbz1NYXRoLnJhbmRvbSgpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4iU3ltYm9sKCIuY29uY2F0KHZvaWQgMD09PWU/IiI6ZSwiKV8iLCgrK24rbykudG9TdHJpbmcoMzYpKX19LHt9XSw3ODpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5zaGFyZWQiKSgid2tzIiksbz1lKCIuLyQudWlkIiksaT1lKCIuLyQuZ2xvYmFsIikuU3ltYm9sO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbltlXXx8KG5bZV09aSYmaVtlXXx8KGl8fG8pKCJTeW1ib2wuIitlKSl9fSx7Ii4vJC5nbG9iYWwiOjQxLCIuLyQuc2hhcmVkIjo2OCwiLi8kLnVpZCI6Nzd9XSw3OTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5jbGFzc29mIiksbz1lKCIuLyQud2tzIikoIml0ZXJhdG9yIiksaT1lKCIuLyQuaXRlcmF0b3JzIik7dC5leHBvcnRzPWUoIi4vJC5jb3JlIikuZ2V0SXRlcmF0b3JNZXRob2Q9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMCE9ZT9lW29dfHxlWyJAQGl0ZXJhdG9yIl18fGlbbihlKV06dm9pZCAwfX0seyIuLyQuY2xhc3NvZiI6MjksIi4vJC5jb3JlIjozMSwiLi8kLml0ZXJhdG9ycyI6NTUsIi4vJC53a3MiOjc4fV0sODA6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi8kLmFkZC10by11bnNjb3BhYmxlcyIpLG89ZSgiLi8kLml0ZXItc3RlcCIpLGk9ZSgiLi8kLml0ZXJhdG9ycyIpLHM9ZSgiLi8kLnRvLWlvYmplY3QiKTt0LmV4cG9ydHM9ZSgiLi8kLml0ZXItZGVmaW5lIikoQXJyYXksIkFycmF5IixmdW5jdGlvbihlLHQpe3RoaXMuX3Q9cyhlKSx0aGlzLl9pPTAsdGhpcy5faz10fSxmdW5jdGlvbigpe3ZhciBlPXRoaXMuX3QsdD10aGlzLl9rLHI9dGhpcy5faSsrO3JldHVybiFlfHxyPj1lLmxlbmd0aD8odGhpcy5fdD12b2lkIDAsbygxKSk6ImtleXMiPT10P28oMCxyKToidmFsdWVzIj09dD9vKDAsZVtyXSk6bygwLFtyLGVbcl1dKX0sInZhbHVlcyIpLGkuQXJndW1lbnRzPWkuQXJyYXksbigia2V5cyIpLG4oInZhbHVlcyIpLG4oImVudHJpZXMiKX0seyIuLyQuYWRkLXRvLXVuc2NvcGFibGVzIjoyNywiLi8kLml0ZXItZGVmaW5lIjo1MiwiLi8kLml0ZXItc3RlcCI6NTQsIi4vJC5pdGVyYXRvcnMiOjU1LCIuLyQudG8taW9iamVjdCI6NzR9XSw4MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC50by1pb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIixmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCxyKXtyZXR1cm4gZShuKHQpLHIpfX0pfSx7Ii4vJC5vYmplY3Qtc2FwIjo2MCwiLi8kLnRvLWlvYmplY3QiOjc0fV0sODI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQudG8tb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgiZ2V0UHJvdG90eXBlT2YiLGZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZShuKHQpKX19KX0seyIuLyQub2JqZWN0LXNhcCI6NjAsIi4vJC50by1vYmplY3QiOjc2fV0sODM6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuLyQudG8tb2JqZWN0Iik7ZSgiLi8kLm9iamVjdC1zYXAiKSgia2V5cyIsZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBlKG4odCkpfX0pfSx7Ii4vJC5vYmplY3Qtc2FwIjo2MCwiLi8kLnRvLW9iamVjdCI6NzZ9XSw4NDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vJC5leHBvcnQiKTtuKG4uUywiT2JqZWN0Iix7c2V0UHJvdG90eXBlT2Y6ZSgiLi8kLnNldC1wcm90byIpLnNldH0pfSx7Ii4vJC5leHBvcnQiOjM3LCIuLyQuc2V0LXByb3RvIjo2NX1dLDg1OltmdW5jdGlvbihlLHQscil7fSx7fV0sODY6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG4sbz1lKCIuLyQiKSxpPWUoIi4vJC5saWJyYXJ5Iikscz1lKCIuLyQuZ2xvYmFsIiksYT1lKCIuLyQuY3R4IiksYz1lKCIuLyQuY2xhc3NvZiIpLHU9ZSgiLi8kLmV4cG9ydCIpLGw9ZSgiLi8kLmlzLW9iamVjdCIpLGY9ZSgiLi8kLmFuLW9iamVjdCIpLGQ9ZSgiLi8kLmEtZnVuY3Rpb24iKSxwPWUoIi4vJC5zdHJpY3QtbmV3IiksYj1lKCIuLyQuZm9yLW9mIiksaD1lKCIuLyQuc2V0LXByb3RvIikuc2V0LHY9ZSgiLi8kLnNhbWUtdmFsdWUiKSx5PWUoIi4vJC53a3MiKSgic3BlY2llcyIpLF89ZSgiLi8kLnNwZWNpZXMtY29uc3RydWN0b3IiKSxnPWUoIi4vJC5taWNyb3Rhc2siKSxtPSJQcm9taXNlIixqPXMucHJvY2VzcywkPSJwcm9jZXNzIj09YyhqKSxPPXNbbV0sdz1mdW5jdGlvbihlKXt2YXIgdD1uZXcgTyhmdW5jdGlvbigpe30pO3JldHVybiBlJiYodC5jb25zdHJ1Y3Rvcj1PYmplY3QpLE8ucmVzb2x2ZSh0KT09PXR9LGs9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe3ZhciByPW5ldyBPKGUpO3JldHVybiBoKHIsdC5wcm90b3R5cGUpLHJ9dmFyIHI9ITE7dHJ5e2lmKHI9TyYmTy5yZXNvbHZlJiZ3KCksaCh0LE8pLHQucHJvdG90eXBlPW8uY3JlYXRlKE8ucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6dH19KSx0LnJlc29sdmUoNSkudGhlbihmdW5jdGlvbigpe30paW5zdGFuY2VvZiB0fHwocj0hMSksciYmZSgiLi8kLmRlc2NyaXB0b3JzIikpe3ZhciBuPSExO08ucmVzb2x2ZShvLnNldERlc2Moe30sInRoZW4iLHtnZXQ6ZnVuY3Rpb24oKXtuPSEwfX0pKSxyPW59fWNhdGNoKGkpe3I9ITF9cmV0dXJuIHJ9KCkseD1mdW5jdGlvbihlLHQpe3JldHVybiBpJiZlPT09TyYmdD09PW4/ITA6dihlLHQpfSxDPWZ1bmN0aW9uKGUpe3ZhciB0PWYoZSlbeV07cmV0dXJuIHZvaWQgMCE9dD90OmV9LEU9ZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIGwoZSkmJiJmdW5jdGlvbiI9PXR5cGVvZih0PWUudGhlbik/dDohMX0sUz1mdW5jdGlvbihlKXt2YXIgdCxyO3RoaXMucHJvbWlzZT1uZXcgZShmdW5jdGlvbihlLG4pe2lmKHZvaWQgMCE9PXR8fHZvaWQgMCE9PXIpdGhyb3cgVHlwZUVycm9yKCJCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvciIpO3Q9ZSxyPW59KSx0aGlzLnJlc29sdmU9ZCh0KSx0aGlzLnJlamVjdD1kKHIpfSxUPWZ1bmN0aW9uKGUpe3RyeXtlKCl9Y2F0Y2godCl7cmV0dXJue2Vycm9yOnR9fX0sTT1mdW5jdGlvbihlLHQpe2lmKCFlLm4pe2Uubj0hMDt2YXIgcj1lLmM7ZyhmdW5jdGlvbigpe2Zvcih2YXIgbj1lLnYsbz0xPT1lLnMsaT0wLGE9ZnVuY3Rpb24odCl7dmFyIHIsaSxzPW8/dC5vazp0LmZhaWwsYT10LnJlc29sdmUsYz10LnJlamVjdDt0cnl7cz8ob3x8KGUuaD0hMCkscj1zPT09ITA/bjpzKG4pLHI9PT10LnByb21pc2U/YyhUeXBlRXJyb3IoIlByb21pc2UtY2hhaW4gY3ljbGUiKSk6KGk9RShyKSk/aS5jYWxsKHIsYSxjKTphKHIpKTpjKG4pfWNhdGNoKHUpe2ModSl9fTtyLmxlbmd0aD5pOylhKHJbaSsrXSk7ci5sZW5ndGg9MCxlLm49ITEsdCYmc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciB0LHIsbz1lLnA7TihvKSYmKCQ/ai5lbWl0KCJ1bmhhbmRsZWRSZWplY3Rpb24iLG4sbyk6KHQ9cy5vbnVuaGFuZGxlZHJlamVjdGlvbik/dCh7cHJvbWlzZTpvLHJlYXNvbjpufSk6KHI9cy5jb25zb2xlKSYmci5lcnJvciYmci5lcnJvcigiVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uIixuKSksZS5hPXZvaWQgMH0sMSl9KX19LE49ZnVuY3Rpb24oZSl7dmFyIHQscj1lLl9kLG49ci5hfHxyLmMsbz0wO2lmKHIuaClyZXR1cm4hMTtmb3IoO24ubGVuZ3RoPm87KWlmKHQ9bltvKytdLHQuZmFpbHx8IU4odC5wcm9taXNlKSlyZXR1cm4hMTtyZXR1cm4hMH0sUj1mdW5jdGlvbihlKXt2YXIgdD10aGlzO3QuZHx8KHQuZD0hMCx0PXQucnx8dCx0LnY9ZSx0LnM9Mix0LmE9dC5jLnNsaWNlKCksTSh0LCEwKSl9LEQ9ZnVuY3Rpb24oZSl7dmFyIHQscj10aGlzO2lmKCFyLmQpe3IuZD0hMCxyPXIucnx8cjt0cnl7aWYoci5wPT09ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7KHQ9RShlKSk/ZyhmdW5jdGlvbigpe3ZhciBuPXtyOnIsZDohMX07dHJ5e3QuY2FsbChlLGEoRCxuLDEpLGEoUixuLDEpKX1jYXRjaChvKXtSLmNhbGwobixvKX19KTooci52PWUsci5zPTEsTShyLCExKSl9Y2F0Y2gobil7Ui5jYWxsKHtyOnIsZDohMX0sbil9fX07a3x8KE89ZnVuY3Rpb24oZSl7ZChlKTt2YXIgdD10aGlzLl9kPXtwOnAodGhpcyxPLG0pLGM6W10sYTp2b2lkIDAsczowLGQ6ITEsdjp2b2lkIDAsaDohMSxuOiExfTt0cnl7ZShhKEQsdCwxKSxhKFIsdCwxKSl9Y2F0Y2gocil7Ui5jYWxsKHQscil9fSxlKCIuLyQucmVkZWZpbmUtYWxsIikoTy5wcm90b3R5cGUse3RoZW46ZnVuY3Rpb24oZSx0KXt2YXIgcj1uZXcgUyhfKHRoaXMsTykpLG49ci5wcm9taXNlLG89dGhpcy5fZDtyZXR1cm4gci5vaz0iZnVuY3Rpb24iPT10eXBlb2YgZT9lOiEwLHIuZmFpbD0iZnVuY3Rpb24iPT10eXBlb2YgdCYmdCxvLmMucHVzaChyKSxvLmEmJm8uYS5wdXNoKHIpLG8ucyYmTShvLCExKSxufSwiY2F0Y2giOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnRoZW4odm9pZCAwLGUpfX0pKSx1KHUuRyt1LlcrdS5GKiFrLHtQcm9taXNlOk99KSxlKCIuLyQuc2V0LXRvLXN0cmluZy10YWciKShPLG0pLGUoIi4vJC5zZXQtc3BlY2llcyIpKG0pLG49ZSgiLi8kLmNvcmUiKVttXSx1KHUuUyt1LkYqIWssbSx7cmVqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBTKHRoaXMpLHI9dC5yZWplY3Q7cmV0dXJuIHIoZSksdC5wcm9taXNlfX0pLHUodS5TK3UuRiooIWt8fHcoITApKSxtLHtyZXNvbHZlOmZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBPJiZ4KGUuY29uc3RydWN0b3IsdGhpcykpcmV0dXJuIGU7dmFyIHQ9bmV3IFModGhpcykscj10LnJlc29sdmU7cmV0dXJuIHIoZSksdC5wcm9taXNlfX0pLHUodS5TK3UuRiohKGsmJmUoIi4vJC5pdGVyLWRldGVjdCIpKGZ1bmN0aW9uKGUpe08uYWxsKGUpWyJjYXRjaCJdKGZ1bmN0aW9uKCl7fSl9KSksbSx7YWxsOmZ1bmN0aW9uKGUpe3ZhciB0PUModGhpcykscj1uZXcgUyh0KSxuPXIucmVzb2x2ZSxpPXIucmVqZWN0LHM9W10sYT1UKGZ1bmN0aW9uKCl7YihlLCExLHMucHVzaCxzKTt2YXIgcj1zLmxlbmd0aCxhPUFycmF5KHIpO3I/by5lYWNoLmNhbGwocyxmdW5jdGlvbihlLG8pe3ZhciBzPSExO3QucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uKGUpe3N8fChzPSEwLGFbb109ZSwtLXJ8fG4oYSkpfSxpKX0pOm4oYSl9KTtyZXR1cm4gYSYmaShhLmVycm9yKSxyLnByb21pc2V9LHJhY2U6ZnVuY3Rpb24oZSl7dmFyIHQ9Qyh0aGlzKSxyPW5ldyBTKHQpLG49ci5yZWplY3Qsbz1UKGZ1bmN0aW9uKCl7YihlLCExLGZ1bmN0aW9uKGUpe3QucmVzb2x2ZShlKS50aGVuKHIucmVzb2x2ZSxuKX0pfSk7cmV0dXJuIG8mJm4oby5lcnJvciksci5wcm9taXNlfX0pfSx7Ii4vJCI6NTYsIi4vJC5hLWZ1bmN0aW9uIjoyNiwiLi8kLmFuLW9iamVjdCI6MjgsIi4vJC5jbGFzc29mIjoyOSwiLi8kLmNvcmUiOjMxLCIuLyQuY3R4IjozMiwiLi8kLmRlc2NyaXB0b3JzIjozNCwiLi8kLmV4cG9ydCI6MzcsIi4vJC5mb3Itb2YiOjM5LCIuLyQuZ2xvYmFsIjo0MSwiLi8kLmlzLW9iamVjdCI6NDksIi4vJC5pdGVyLWRldGVjdCI6NTMsIi4vJC5saWJyYXJ5Ijo1OCwiLi8kLm1pY3JvdGFzayI6NTksIi4vJC5yZWRlZmluZS1hbGwiOjYyLCIuLyQuc2FtZS12YWx1ZSI6NjQsIi4vJC5zZXQtcHJvdG8iOjY1LCIuLyQuc2V0LXNwZWNpZXMiOjY2LCIuLyQuc2V0LXRvLXN0cmluZy10YWciOjY3LCIuLyQuc3BlY2llcy1jb25zdHJ1Y3RvciI6NjksIi4vJC5zdHJpY3QtbmV3Ijo3MCwiLi8kLndrcyI6Nzh9XSw4NzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCIuLyQuc3RyaW5nLWF0IikoITApO2UoIi4vJC5pdGVyLWRlZmluZSIpKFN0cmluZywiU3RyaW5nIixmdW5jdGlvbihlKXt0aGlzLl90PVN0cmluZyhlKSx0aGlzLl9pPTB9LGZ1bmN0aW9uKCl7dmFyIGUsdD10aGlzLl90LHI9dGhpcy5faTtyZXR1cm4gcj49dC5sZW5ndGg/e3ZhbHVlOnZvaWQgMCxkb25lOiEwfTooZT1uKHQsciksdGhpcy5faSs9ZS5sZW5ndGgse3ZhbHVlOmUsZG9uZTohMX0pfSl9LHsiLi8kLml0ZXItZGVmaW5lIjo1MiwiLi8kLnN0cmluZy1hdCI6NzF9XSw4ODpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCIuLyQiKSxvPWUoIi4vJC5nbG9iYWwiKSxpPWUoIi4vJC5oYXMiKSxzPWUoIi4vJC5kZXNjcmlwdG9ycyIpLGE9ZSgiLi8kLmV4cG9ydCIpLGM9ZSgiLi8kLnJlZGVmaW5lIiksdT1lKCIuLyQuZmFpbHMiKSxsPWUoIi4vJC5zaGFyZWQiKSxmPWUoIi4vJC5zZXQtdG8tc3RyaW5nLXRhZyIpLGQ9ZSgiLi8kLnVpZCIpLHA9ZSgiLi8kLndrcyIpLGI9ZSgiLi8kLmtleW9mIiksaD1lKCIuLyQuZ2V0LW5hbWVzIiksdj1lKCIuLyQuZW51bS1rZXlzIikseT1lKCIuLyQuaXMtYXJyYXkiKSxfPWUoIi4vJC5hbi1vYmplY3QiKSxnPWUoIi4vJC50by1pb2JqZWN0IiksbT1lKCIuLyQucHJvcGVydHktZGVzYyIpLGo9bi5nZXREZXNjLCQ9bi5zZXREZXNjLE89bi5jcmVhdGUsdz1oLmdldCxrPW8uU3ltYm9sLHg9by5KU09OLEM9eCYmeC5zdHJpbmdpZnksRT0hMSxTPXAoIl9oaWRkZW4iKSxUPW4uaXNFbnVtLE09bCgic3ltYm9sLXJlZ2lzdHJ5IiksTj1sKCJzeW1ib2xzIiksUj0iZnVuY3Rpb24iPT10eXBlb2YgayxEPU9iamVjdC5wcm90b3R5cGUsUD1zJiZ1KGZ1bmN0aW9uKCl7cmV0dXJuIDchPU8oJCh7fSwiYSIse2dldDpmdW5jdGlvbigpe3JldHVybiAkKHRoaXMsImEiLHt2YWx1ZTo3fSkuYX19KSkuYX0pP2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1qKEQsdCk7biYmZGVsZXRlIERbdF0sJChlLHQsciksbiYmZSE9PUQmJiQoRCx0LG4pfTokLEE9ZnVuY3Rpb24oZSl7dmFyIHQ9TltlXT1PKGsucHJvdG90eXBlKTtyZXR1cm4gdC5faz1lLHMmJkUmJlAoRCxlLHtjb25maWd1cmFibGU6ITAsc2V0OmZ1bmN0aW9uKHQpe2kodGhpcyxTKSYmaSh0aGlzW1NdLGUpJiYodGhpc1tTXVtlXT0hMSksUCh0aGlzLGUsbSgxLHQpKX19KSx0fSxMPWZ1bmN0aW9uKGUpe3JldHVybiJzeW1ib2wiPT10eXBlb2YgZX0sST1mdW5jdGlvbihlLHQscil7cmV0dXJuIHImJmkoTix0KT8oci5lbnVtZXJhYmxlPyhpKGUsUykmJmVbU11bdF0mJihlW1NdW3RdPSExKSxyPU8ocix7ZW51bWVyYWJsZTptKDAsITEpfSkpOihpKGUsUyl8fCQoZSxTLG0oMSx7fSkpLGVbU11bdF09ITApLFAoZSx0LHIpKTokKGUsdCxyKX0sRj1mdW5jdGlvbihlLHQpe18oZSk7Zm9yKHZhciByLG49dih0PWcodCkpLG89MCxpPW4ubGVuZ3RoO2k+bzspSShlLHI9bltvKytdLHRbcl0pO3JldHVybiBlfSxWPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQ/TyhlKTpGKE8oZSksdCl9LHo9ZnVuY3Rpb24oZSl7dmFyIHQ9VC5jYWxsKHRoaXMsZSk7cmV0dXJuIHR8fCFpKHRoaXMsZSl8fCFpKE4sZSl8fGkodGhpcyxTKSYmdGhpc1tTXVtlXT90OiEwfSxVPWZ1bmN0aW9uKGUsdCl7dmFyIHI9aihlPWcoZSksdCk7cmV0dXJuIXJ8fCFpKE4sdCl8fGkoZSxTKSYmZVtTXVt0XXx8KHIuZW51bWVyYWJsZT0hMCkscn0sSD1mdW5jdGlvbihlKXtmb3IodmFyIHQscj13KGcoZSkpLG49W10sbz0wO3IubGVuZ3RoPm87KWkoTix0PXJbbysrXSl8fHQ9PVN8fG4ucHVzaCh0KTtyZXR1cm4gbn0sQj1mdW5jdGlvbihlKXtmb3IodmFyIHQscj13KGcoZSkpLG49W10sbz0wO3IubGVuZ3RoPm87KWkoTix0PXJbbysrXSkmJm4ucHVzaChOW3RdKTtyZXR1cm4gbn0sSj1mdW5jdGlvbihlKXtpZih2b2lkIDAhPT1lJiYhTChlKSl7Zm9yKHZhciB0LHIsbj1bZV0sbz0xLGk9YXJndW1lbnRzO2kubGVuZ3RoPm87KW4ucHVzaChpW28rK10pO3JldHVybiB0PW5bMV0sImZ1bmN0aW9uIj09dHlwZW9mIHQmJihyPXQpLCFyJiZ5KHQpfHwodD1mdW5jdGlvbihlLHQpe3JldHVybiByJiYodD1yLmNhbGwodGhpcyxlLHQpKSxMKHQpP3ZvaWQgMDp0fSksblsxXT10LEMuYXBwbHkoeCxuKX19LFc9dShmdW5jdGlvbigpe3ZhciBlPWsoKTtyZXR1cm4iW251bGxdIiE9QyhbZV0pfHwie30iIT1DKHthOmV9KXx8Int9IiE9QyhPYmplY3QoZSkpfSk7Unx8KGs9ZnVuY3Rpb24oKXtpZihMKHRoaXMpKXRocm93IFR5cGVFcnJvcigiU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIik7cmV0dXJuIEEoZChhcmd1bWVudHMubGVuZ3RoPjA/YXJndW1lbnRzWzBdOnZvaWQgMCkpfSxjKGsucHJvdG90eXBlLCJ0b1N0cmluZyIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fa30pLEw9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBrfSxuLmNyZWF0ZT1WLG4uaXNFbnVtPXosbi5nZXREZXNjPVUsbi5zZXREZXNjPUksbi5zZXREZXNjcz1GLG4uZ2V0TmFtZXM9aC5nZXQ9SCxuLmdldFN5bWJvbHM9QixzJiYhZSgiLi8kLmxpYnJhcnkiKSYmYyhELCJwcm9wZXJ0eUlzRW51bWVyYWJsZSIseiwhMCkpO3ZhciBZPXsiZm9yIjpmdW5jdGlvbihlKXtyZXR1cm4gaShNLGUrPSIiKT9NW2VdOk1bZV09ayhlKX0sa2V5Rm9yOmZ1bmN0aW9uKGUpe3JldHVybiBiKE0sZSl9LHVzZVNldHRlcjpmdW5jdGlvbigpe0U9ITB9LHVzZVNpbXBsZTpmdW5jdGlvbigpe0U9ITF9fTtuLmVhY2guY2FsbCgiaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMiLnNwbGl0KCIsIiksZnVuY3Rpb24oZSl7dmFyIHQ9cChlKTtZW2VdPVI/dDpBKHQpfSksRT0hMCxhKGEuRythLlcse1N5bWJvbDprfSksYShhLlMsIlN5bWJvbCIsWSksYShhLlMrYS5GKiFSLCJPYmplY3QiLHtjcmVhdGU6VixkZWZpbmVQcm9wZXJ0eTpJLGRlZmluZVByb3BlcnRpZXM6RixnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6VSxnZXRPd25Qcm9wZXJ0eU5hbWVzOkgsZ2V0T3duUHJvcGVydHlTeW1ib2xzOkJ9KSx4JiZhKGEuUythLkYqKCFSfHxXKSwiSlNPTiIse3N0cmluZ2lmeTpKfSksZihrLCJTeW1ib2wiKSxmKE1hdGgsIk1hdGgiLCEwKSxmKG8uSlNPTiwiSlNPTiIsITApfSx7Ii4vJCI6NTYsIi4vJC5hbi1vYmplY3QiOjI4LCIuLyQuZGVzY3JpcHRvcnMiOjM0LCIuLyQuZW51bS1rZXlzIjozNiwiLi8kLmV4cG9ydCI6MzcsIi4vJC5mYWlscyI6MzgsIi4vJC5nZXQtbmFtZXMiOjQwLCIuLyQuZ2xvYmFsIjo0MSwiLi8kLmhhcyI6NDIsIi4vJC5pcy1hcnJheSI6NDgsIi4vJC5rZXlvZiI6NTcsIi4vJC5saWJyYXJ5Ijo1OCwiLi8kLnByb3BlcnR5LWRlc2MiOjYxLCIuLyQucmVkZWZpbmUiOjYzLCIuLyQuc2V0LXRvLXN0cmluZy10YWciOjY3LCIuLyQuc2hhcmVkIjo2OCwiLi8kLnRvLWlvYmplY3QiOjc0LCIuLyQudWlkIjo3NywiLi8kLndrcyI6Nzh9XSw4OTpbZnVuY3Rpb24oZSx0LHIpe2UoIi4vZXM2LmFycmF5Lml0ZXJhdG9yIik7dmFyIG49ZSgiLi8kLml0ZXJhdG9ycyIpO24uTm9kZUxpc3Q9bi5IVE1MQ29sbGVjdGlvbj1uLkFycmF5fSx7Ii4vJC5pdGVyYXRvcnMiOjU1LCIuL2VzNi5hcnJheS5pdGVyYXRvciI6ODB9XSw5MDpbZnVuY3Rpb24oZSx0LHIpe3dpbmRvdy5NdXRhdGlvbk9ic2VydmVyPXdpbmRvdy5NdXRhdGlvbk9ic2VydmVyfHx3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlcnx8ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlKXt0aGlzLmc9W10sdGhpcy5rPWV9ZnVuY3Rpb24gcihlKXshZnVuY3Rpb24gcigpe3ZhciBuPWUudGFrZVJlY29yZHMoKTtuLmxlbmd0aCYmZS5rKG4sZSksZS5mPXNldFRpbWVvdXQocix0Ll9wZXJpb2QpfSgpfWZ1bmN0aW9uIG4odCl7dmFyIHIsbj17dHlwZTpudWxsLHRhcmdldDpudWxsLGFkZGVkTm9kZXM6W10scmVtb3ZlZE5vZGVzOltdLHByZXZpb3VzU2libGluZzpudWxsLG5leHRTaWJsaW5nOm51bGwsYXR0cmlidXRlTmFtZTpudWxsLGF0dHJpYnV0ZU5hbWVzcGFjZTpudWxsLG9sZFZhbHVlOm51bGx9O2ZvcihyIGluIHQpbltyXSE9PWUmJnRbcl0hPT1lJiYobltyXT10W3JdKTtyZXR1cm4gbn1mdW5jdGlvbiBvKGUsdCl7dmFyIHI9YShlLHQpO3JldHVybiBmdW5jdGlvbihuKXt2YXIgbyxjPW4ubGVuZ3RoO3QuYSYmci5hJiZpKG4sZSxyLmEsdC5kKSwodC5ifHx0LmUpJiYobz1zKG4sZSxyLHQpKSwob3x8bi5sZW5ndGghPT1jKSYmKHI9YShlLHQpKX19ZnVuY3Rpb24gaSh0LHIsbyxpKXtmb3IodmFyIHMsYSxjPXt9LHU9ci5hdHRyaWJ1dGVzLGw9dS5sZW5ndGg7bC0tOylzPXVbbF0sYT1zLm5hbWUsaSYmaVthXT09PWV8fChzLnZhbHVlIT09b1thXSYmdC5wdXNoKG4oe3R5cGU6ImF0dHJpYnV0ZXMiLHRhcmdldDpyLGF0dHJpYnV0ZU5hbWU6YSxvbGRWYWx1ZTpvW2FdLGF0dHJpYnV0ZU5hbWVzcGFjZTpzLm5hbWVzcGFjZVVSSX0pKSxjW2FdPSEwKTtmb3IoYSBpbiBvKWNbYV18fHQucHVzaChuKHt0YXJnZXQ6cix0eXBlOiJhdHRyaWJ1dGVzIixhdHRyaWJ1dGVOYW1lOmEsb2xkVmFsdWU6b1thXX0pKX1mdW5jdGlvbiBzKHQscixvLHMpe2Z1bmN0aW9uIGEoZSxyLG8sYSxjKXt2YXIgbD1lLmxlbmd0aC0xO2M9LX4oKGwtYykvMik7Zm9yKHZhciBmLGQscDtwPWUucG9wKCk7KWY9b1twLmhdLGQ9YVtwLmldLHMuYiYmYyYmTWF0aC5hYnMocC5oLXAuaSk+PWwmJih0LnB1c2gobih7dHlwZToiY2hpbGRMaXN0Iix0YXJnZXQ6cixhZGRlZE5vZGVzOltmXSxyZW1vdmVkTm9kZXM6W2ZdLG5leHRTaWJsaW5nOmYubmV4dFNpYmxpbmcscHJldmlvdXNTaWJsaW5nOmYucHJldmlvdXNTaWJsaW5nfSkpLGMtLSkscy5hJiZkLmEmJmkodCxmLGQuYSxzLmQpLHMuYyYmMz09PWYubm9kZVR5cGUmJmYubm9kZVZhbHVlIT09ZC5jJiZ0LnB1c2gobih7dHlwZToiY2hhcmFjdGVyRGF0YSIsdGFyZ2V0OmZ9KSkscy5lJiZ1KGYsZCl9ZnVuY3Rpb24gdShyLG8pe2Zvcih2YXIgZCxwLGIsaCx2LHk9ci5jaGlsZE5vZGVzLF89by5iLGc9eS5sZW5ndGgsbT1fP18ubGVuZ3RoOjAsaj0wLCQ9MCxPPTA7Zz4kfHxtPk87KWg9eVskXSx2PShiPV9bT10pJiZiLmosaD09PXY/KHMuYSYmYi5hJiZpKHQsaCxiLmEscy5kKSxzLmMmJmIuYyE9PWUmJmgubm9kZVZhbHVlIT09Yi5jJiZ0LnB1c2gobih7dHlwZToiY2hhcmFjdGVyRGF0YSIsdGFyZ2V0Omh9KSkscCYmYShwLHIseSxfLGopLHMuZSYmKGguY2hpbGROb2Rlcy5sZW5ndGh8fGIuYiYmYi5iLmxlbmd0aCkmJnUoaCxiKSwkKyssTysrKToobD0hMCxkfHwoZD17fSxwPVtdKSxoJiYoZFtiPWMoaCldfHwoZFtiXT0hMCwtMT09PShiPWYoXyxoLE8sImoiKSk/cy5iJiYodC5wdXNoKG4oe3R5cGU6ImNoaWxkTGlzdCIsdGFyZ2V0OnIsYWRkZWROb2RlczpbaF0sbmV4dFNpYmxpbmc6aC5uZXh0U2libGluZyxwcmV2aW91c1NpYmxpbmc6aC5wcmV2aW91c1NpYmxpbmd9KSksaisrKTpwLnB1c2goe2g6JCxpOmJ9KSksJCsrKSx2JiZ2IT09eVskXSYmKGRbYj1jKHYpXXx8KGRbYl09ITAsLTE9PT0oYj1mKHksdiwkKSk/cy5iJiYodC5wdXNoKG4oe3R5cGU6ImNoaWxkTGlzdCIsdGFyZ2V0Om8uaixyZW1vdmVkTm9kZXM6W3ZdLG5leHRTaWJsaW5nOl9bTysxXSxwcmV2aW91c1NpYmxpbmc6X1tPLTFdfSkpLGotLSk6cC5wdXNoKHtoOmIsaTpPfSkpLE8rKykpO3AmJmEocCxyLHksXyxqKX12YXIgbDtyZXR1cm4gdShyLG8pLGx9ZnVuY3Rpb24gYShlLHQpe3ZhciByPSEwO3JldHVybiBmdW5jdGlvbiBuKGUpe3ZhciBvPXtqOmV9O3JldHVybiF0LmN8fDMhPT1lLm5vZGVUeXBlJiY4IT09ZS5ub2RlVHlwZT8odC5hJiZyJiYxPT09ZS5ub2RlVHlwZSYmKG8uYT1sKGUuYXR0cmlidXRlcyxmdW5jdGlvbihlLHIpe3JldHVybiB0LmQmJiF0LmRbci5uYW1lXXx8KGVbci5uYW1lXT1yLnZhbHVlKSxlfSkpLHImJih0LmJ8fHQuY3x8dC5hJiZ0LmUpJiYoby5iPXUoZS5jaGlsZE5vZGVzLG4pKSxyPXQuZSk6by5jPWUubm9kZVZhbHVlLG99KGUpfWZ1bmN0aW9uIGMoZSl7dHJ5e3JldHVybiBlLmlkfHwoZS5tb19pZD1lLm1vX2lkfHxkKyspfWNhdGNoKHQpe3RyeXtyZXR1cm4gZS5ub2RlVmFsdWV9Y2F0Y2gocil7cmV0dXJuIGQrK319fWZ1bmN0aW9uIHUoZSx0KXtmb3IodmFyIHI9W10sbj0wO248ZS5sZW5ndGg7bisrKXJbbl09dChlW25dLG4sZSk7cmV0dXJuIHJ9ZnVuY3Rpb24gbChlLHQpe2Zvcih2YXIgcj17fSxuPTA7bjxlLmxlbmd0aDtuKyspcj10KHIsZVtuXSxuLGUpO3JldHVybiByfWZ1bmN0aW9uIGYoZSx0LHIsbil7Zm9yKDtyPGUubGVuZ3RoO3IrKylpZigobj9lW3JdW25dOmVbcl0pPT09dClyZXR1cm4gcjtyZXR1cm4tMX10Ll9wZXJpb2Q9MzAsdC5wcm90b3R5cGU9e29ic2VydmU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49e2E6ISEodC5hdHRyaWJ1dGVzfHx0LmF0dHJpYnV0ZUZpbHRlcnx8dC5hdHRyaWJ1dGVPbGRWYWx1ZSksYjohIXQuY2hpbGRMaXN0LGU6ISF0LnN1YnRyZWUsYzohKCF0LmNoYXJhY3RlckRhdGEmJiF0LmNoYXJhY3RlckRhdGFPbGRWYWx1ZSl9LGk9dGhpcy5nLHM9MDtzPGkubGVuZ3RoO3MrKylpW3NdLm09PT1lJiZpLnNwbGljZShzLDEpO3QuYXR0cmlidXRlRmlsdGVyJiYobi5kPWwodC5hdHRyaWJ1dGVGaWx0ZXIsZnVuY3Rpb24oZSx0KXsKcmV0dXJuIGVbdF09ITAsZX0pKSxpLnB1c2goe206ZSxsOm8oZSxuKX0pLHRoaXMuZnx8cih0aGlzKX0sdGFrZVJlY29yZHM6ZnVuY3Rpb24oKXtmb3IodmFyIGU9W10sdD10aGlzLmcscj0wO3I8dC5sZW5ndGg7cisrKXRbcl0ubChlKTtyZXR1cm4gZX0sZGlzY29ubmVjdDpmdW5jdGlvbigpe3RoaXMuZz1bXSxjbGVhclRpbWVvdXQodGhpcy5mKSx0aGlzLmY9bnVsbH19O3ZhciBkPTE7cmV0dXJuIHR9KHZvaWQgMCl9LHt9XSw5MTpbZnVuY3Rpb24oZSx0LHIpe09iamVjdC5vYnNlcnZlfHxmdW5jdGlvbihlLHQscixuKXsidXNlIHN0cmljdCI7dmFyIG8saSxzPVsiYWRkIiwidXBkYXRlIiwiZGVsZXRlIiwicmVjb25maWd1cmUiLCJzZXRQcm90b3R5cGUiLCJwcmV2ZW50RXh0ZW5zaW9ucyJdLGE9dC5pc0FycmF5fHxmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PWUuY2FsbCh0KX19KGUucHJvdG90eXBlLnRvU3RyaW5nKSxjPXQucHJvdG90eXBlLmluZGV4T2Y/dC5pbmRleE9mfHxmdW5jdGlvbihlLHIsbil7cmV0dXJuIHQucHJvdG90eXBlLmluZGV4T2YuY2FsbChlLHIsbil9OmZ1bmN0aW9uKGUsdCxyKXtmb3IodmFyIG49cnx8MDtuPGUubGVuZ3RoO24rKylpZihlW25dPT09dClyZXR1cm4gbjtyZXR1cm4tMX0sdT1yLk1hcCE9PW4mJk1hcC5wcm90b3R5cGUuZm9yRWFjaD9mdW5jdGlvbigpe3JldHVybiBuZXcgTWFwfTpmdW5jdGlvbigpe3ZhciBlPVtdLHQ9W107cmV0dXJue3NpemU6MCxoYXM6ZnVuY3Rpb24odCl7cmV0dXJuIGMoZSx0KT4tMX0sZ2V0OmZ1bmN0aW9uKHIpe3JldHVybiB0W2MoZSxyKV19LHNldDpmdW5jdGlvbihyLG4pe3ZhciBvPWMoZSxyKTstMT09PW8/KGUucHVzaChyKSx0LnB1c2gobiksdGhpcy5zaXplKyspOnRbb109bn0sImRlbGV0ZSI6ZnVuY3Rpb24ocil7dmFyIG49YyhlLHIpO24+LTEmJihlLnNwbGljZShuLDEpLHQuc3BsaWNlKG4sMSksdGhpcy5zaXplLS0pfSxmb3JFYWNoOmZ1bmN0aW9uKHIpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXIuY2FsbChhcmd1bWVudHNbMV0sdFtuXSxlW25dLHRoaXMpfX19LGw9ZS5nZXRPd25Qcm9wZXJ0eU5hbWVzP2Z1bmN0aW9uKCl7dmFyIHQ9ZS5nZXRPd25Qcm9wZXJ0eU5hbWVzO3RyeXthcmd1bWVudHMuY2FsbGVlfWNhdGNoKHIpe3ZhciBuPSh0KGMpLmpvaW4oIiAiKSsiICIpLnJlcGxhY2UoL3Byb3RvdHlwZSB8bGVuZ3RoIHxuYW1lIC9nLCIiKS5zbGljZSgwLC0xKS5zcGxpdCgiICIpO24ubGVuZ3RoJiYodD1mdW5jdGlvbih0KXt2YXIgcj1lLmdldE93blByb3BlcnR5TmFtZXModCk7aWYoImZ1bmN0aW9uIj09dHlwZW9mIHQpZm9yKHZhciBvLGk9MDtpPG4ubGVuZ3RoOykobz1jKHIsbltpKytdKSk+LTEmJnIuc3BsaWNlKG8sMSk7cmV0dXJuIHJ9KX1yZXR1cm4gdH0oKTpmdW5jdGlvbih0KXt2YXIgcixuLG89W107aWYoImhhc093blByb3BlcnR5ImluIHQpZm9yKHIgaW4gdCl0Lmhhc093blByb3BlcnR5KHIpJiZvLnB1c2gocik7ZWxzZXtuPWUuaGFzT3duUHJvcGVydHk7Zm9yKHIgaW4gdCluLmNhbGwodCxyKSYmby5wdXNoKHIpfXJldHVybiBhKHQpJiZvLnB1c2goImxlbmd0aCIpLG99LGY9ZS5nZXRQcm90b3R5cGVPZixkPWUuZGVmaW5lUHJvcGVydGllcyYmZS5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IscD1yLnJlcXVlc3RBbmltYXRpb25GcmFtZXx8ci53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKCl7dmFyIGU9K25ldyBEYXRlLHQ9ZTtyZXR1cm4gZnVuY3Rpb24ocil7cmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtyKCh0PStuZXcgRGF0ZSktZSl9LDE3KX19KCksYj1mdW5jdGlvbihlLHQscil7dmFyIG49by5nZXQoZSk7bj8odihuLGUpLG0oZSxuLHQscikpOihuPWgoZSksbShlLG4sdCxyKSwxPT09by5zaXplJiZwKHkpKX0saD1mdW5jdGlvbih0LHIpe3ZhciBuLGk9bCh0KSxzPVtdLGE9MCxyPXtoYW5kbGVyczp1KCksZnJvemVuOmUuaXNGcm96ZW4/ZS5pc0Zyb3plbih0KTohMSxleHRlbnNpYmxlOmUuaXNFeHRlbnNpYmxlP2UuaXNFeHRlbnNpYmxlKHQpOiEwLHByb3RvOmYmJmYodCkscHJvcGVydGllczppLHZhbHVlczpzLG5vdGlmaWVyOmcodCxyKX07aWYoZClmb3Iobj1yLmRlc2NyaXB0b3JzPVtdO2E8aS5sZW5ndGg7KW5bYV09ZCh0LGlbYV0pLHNbYV09dFtpW2ErK11dO2Vsc2UgZm9yKDthPGkubGVuZ3RoOylzW2FdPXRbaVthKytdXTtyZXR1cm4gby5zZXQodCxyKSxyfSx2PWZ1bmN0aW9uKCl7dmFyIHQ9ZD9mdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPXQucHJvcGVydGllc1tyXSxzPWVbaV0sYT10LnZhbHVlc1tyXSxjPXQuZGVzY3JpcHRvcnNbcl07InZhbHVlImluIG8mJihhPT09cz8wPT09YSYmMS9hIT09MS9zOmE9PT1hfHxzPT09cykmJihqKGUsdCx7bmFtZTppLHR5cGU6InVwZGF0ZSIsb2JqZWN0OmUsb2xkVmFsdWU6YX0sbiksdC52YWx1ZXNbcl09cyksIWMuY29uZmlndXJhYmxlfHxvLmNvbmZpZ3VyYWJsZSYmby53cml0YWJsZT09PWMud3JpdGFibGUmJm8uZW51bWVyYWJsZT09PWMuZW51bWVyYWJsZSYmby5nZXQ9PT1jLmdldCYmby5zZXQ9PT1jLnNldHx8KGooZSx0LHtuYW1lOmksdHlwZToicmVjb25maWd1cmUiLG9iamVjdDplLG9sZFZhbHVlOmF9LG4pLHQuZGVzY3JpcHRvcnNbcl09byl9OmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPXQucHJvcGVydGllc1tyXSxpPWVbb10scz10LnZhbHVlc1tyXTsocz09PWk/MD09PXMmJjEvcyE9PTEvaTpzPT09c3x8aT09PWkpJiYoaihlLHQse25hbWU6byx0eXBlOiJ1cGRhdGUiLG9iamVjdDplLG9sZFZhbHVlOnN9LG4pLHQudmFsdWVzW3JdPWkpfSxyPWQ/ZnVuY3Rpb24oZSxyLG4sbyxpKXtmb3IodmFyIHMsYT1yLmxlbmd0aDtuJiZhLS07KW51bGwhPT1yW2FdJiYocz1kKGUsclthXSksbi0tLHM/dChlLG8sYSxpLHMpOihqKGUsbyx7bmFtZTpyW2FdLHR5cGU6ImRlbGV0ZSIsb2JqZWN0OmUsb2xkVmFsdWU6by52YWx1ZXNbYV19LGkpLG8ucHJvcGVydGllcy5zcGxpY2UoYSwxKSxvLnZhbHVlcy5zcGxpY2UoYSwxKSxvLmRlc2NyaXB0b3JzLnNwbGljZShhLDEpKSl9OmZ1bmN0aW9uKGUsdCxyLG4sbyl7Zm9yKHZhciBpPXQubGVuZ3RoO3ImJmktLTspbnVsbCE9PXRbaV0mJihqKGUsbix7bmFtZTp0W2ldLHR5cGU6ImRlbGV0ZSIsb2JqZWN0OmUsb2xkVmFsdWU6bi52YWx1ZXNbaV19LG8pLG4ucHJvcGVydGllcy5zcGxpY2UoaSwxKSxuLnZhbHVlcy5zcGxpY2UoaSwxKSxyLS0pfTtyZXR1cm4gZnVuY3Rpb24obixvLGkpe2lmKG4uaGFuZGxlcnMuc2l6ZSYmIW4uZnJvemVuKXt2YXIgcyxhLHUscCxiLGgsdix5LF89bi52YWx1ZXMsZz1uLmRlc2NyaXB0b3JzLG09MDtpZihuLmV4dGVuc2libGUpaWYocz1uLnByb3BlcnRpZXMuc2xpY2UoKSxhPXMubGVuZ3RoLHU9bChvKSxnKXtmb3IoO208dS5sZW5ndGg7KWI9dVttKytdLHA9YyhzLGIpLHk9ZChvLGIpLC0xPT09cD8oaihvLG4se25hbWU6Yix0eXBlOiJhZGQiLG9iamVjdDpvfSxpKSxuLnByb3BlcnRpZXMucHVzaChiKSxfLnB1c2gob1tiXSksZy5wdXNoKHkpKTooc1twXT1udWxsLGEtLSx0KG8sbixwLGkseSkpO3IobyxzLGEsbixpKSxlLmlzRXh0ZW5zaWJsZShvKXx8KG4uZXh0ZW5zaWJsZT0hMSxqKG8sbix7dHlwZToicHJldmVudEV4dGVuc2lvbnMiLG9iamVjdDpvfSxpKSxuLmZyb3plbj1lLmlzRnJvemVuKG8pKX1lbHNle2Zvcig7bTx1Lmxlbmd0aDspYj11W20rK10scD1jKHMsYiksaD1vW2JdLC0xPT09cD8oaihvLG4se25hbWU6Yix0eXBlOiJhZGQiLG9iamVjdDpvfSxpKSxuLnByb3BlcnRpZXMucHVzaChiKSxfLnB1c2goaCkpOihzW3BdPW51bGwsYS0tLHQobyxuLHAsaSkpO3IobyxzLGEsbixpKX1lbHNlIGlmKCFuLmZyb3plbil7Zm9yKDttPHMubGVuZ3RoO20rKyliPXNbbV0sdChvLG4sbSxpLGQobyxiKSk7ZS5pc0Zyb3plbihvKSYmKG4uZnJvemVuPSEwKX1mJiYodj1mKG8pLHYhPT1uLnByb3RvJiYoaihvLG4se3R5cGU6InNldFByb3RvdHlwZSIsbmFtZToiX19wcm90b19fIixvYmplY3Q6byxvbGRWYWx1ZTpuLnByb3RvfSksbi5wcm90bz12KSl9fX0oKSx5PWZ1bmN0aW9uKCl7by5zaXplJiYoby5mb3JFYWNoKHYpLGkuZm9yRWFjaChfKSxwKHkpKX0sXz1mdW5jdGlvbihlLHQpe3ZhciByPWUuY2hhbmdlUmVjb3JkcztyLmxlbmd0aCYmKGUuY2hhbmdlUmVjb3Jkcz1bXSx0KHIpKX0sZz1mdW5jdGlvbihlLHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPDImJih0PW8uZ2V0KGUpKSx0JiZ0Lm5vdGlmaWVyfHx7bm90aWZ5OmZ1bmN0aW9uKHQpe3QudHlwZTt2YXIgcj1vLmdldChlKTtpZihyKXt2YXIgbixpPXtvYmplY3Q6ZX07Zm9yKG4gaW4gdCkib2JqZWN0IiE9PW4mJihpW25dPXRbbl0pO2ooZSxyLGkpfX0scGVyZm9ybUNoYW5nZTpmdW5jdGlvbih0LHIpe2lmKCJzdHJpbmciIT10eXBlb2YgdCl0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIG5vbi1zdHJpbmcgY2hhbmdlVHlwZSIpO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiByKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBwZXJmb3JtIG5vbi1mdW5jdGlvbiIpO3ZhciBpLHMsYT1vLmdldChlKSxjPWFyZ3VtZW50c1syXSx1PWM9PT1uP3IoKTpyLmNhbGwoYyk7aWYoYSYmdihhLGUsdCksYSYmdSYmIm9iamVjdCI9PXR5cGVvZiB1KXtzPXtvYmplY3Q6ZSx0eXBlOnR9O2ZvcihpIGluIHUpIm9iamVjdCIhPT1pJiYidHlwZSIhPT1pJiYoc1tpXT11W2ldKTtqKGUsYSxzKX19fX0sbT1mdW5jdGlvbihlLHQscixuKXt2YXIgbz1pLmdldChyKTtvfHxpLnNldChyLG89e29ic2VydmVkOnUoKSxjaGFuZ2VSZWNvcmRzOltdfSksby5vYnNlcnZlZC5zZXQoZSx7YWNjZXB0TGlzdDpuLnNsaWNlKCksZGF0YTp0fSksdC5oYW5kbGVycy5zZXQocixvKX0saj1mdW5jdGlvbihlLHQscixuKXt0LmhhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIG89dC5vYnNlcnZlZC5nZXQoZSkuYWNjZXB0TGlzdDsoInN0cmluZyIhPXR5cGVvZiBufHwtMT09PWMobyxuKSkmJmMobyxyLnR5cGUpPi0xJiZ0LmNoYW5nZVJlY29yZHMucHVzaChyKX0pfTtvPXUoKSxpPXUoKSxlLm9ic2VydmU9ZnVuY3Rpb24odCxyLG8pe2lmKCF0fHwib2JqZWN0IiE9dHlwZW9mIHQmJiJmdW5jdGlvbiIhPXR5cGVvZiB0KXRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBvYnNlcnZlIG5vbi1vYmplY3QiKTtpZigiZnVuY3Rpb24iIT10eXBlb2Ygcil0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3Qub2JzZXJ2ZSBjYW5ub3QgZGVsaXZlciB0byBub24tZnVuY3Rpb24iKTtpZihlLmlzRnJvemVuJiZlLmlzRnJvemVuKHIpKXRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5vYnNlcnZlIGNhbm5vdCBkZWxpdmVyIHRvIGEgZnJvemVuIGZ1bmN0aW9uIG9iamVjdCIpO2lmKG89PT1uKW89cztlbHNlIGlmKCFvfHwib2JqZWN0IiE9dHlwZW9mIG8pdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhpcmQgYXJndW1lbnQgdG8gT2JqZWN0Lm9ic2VydmUgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzLiIpO3JldHVybiBiKHQscixvKSx0fSxlLnVub2JzZXJ2ZT1mdW5jdGlvbihlLHQpe2lmKG51bGw9PT1lfHwib2JqZWN0IiE9dHlwZW9mIGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlKXRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC51bm9ic2VydmUgY2Fubm90IHVub2JzZXJ2ZSBub24tb2JqZWN0Iik7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcigiT2JqZWN0LnVub2JzZXJ2ZSBjYW5ub3QgZGVsaXZlciB0byBub24tZnVuY3Rpb24iKTt2YXIgcixuPWkuZ2V0KHQpO3JldHVybiBuJiYocj1uLm9ic2VydmVkLmdldChlKSkmJihuLm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24oZSx0KXt2KGUuZGF0YSx0KX0pLHAoZnVuY3Rpb24oKXtfKG4sdCl9KSwxPT09bi5vYnNlcnZlZC5zaXplJiZuLm9ic2VydmVkLmhhcyhlKT9pWyJkZWxldGUiXSh0KTpuLm9ic2VydmVkWyJkZWxldGUiXShlKSwxPT09ci5kYXRhLmhhbmRsZXJzLnNpemU/b1siZGVsZXRlIl0oZSk6ci5kYXRhLmhhbmRsZXJzWyJkZWxldGUiXSh0KSksZX0sZS5nZXROb3RpZmllcj1mdW5jdGlvbih0KXtpZihudWxsPT09dHx8Im9iamVjdCIhPXR5cGVvZiB0JiYiZnVuY3Rpb24iIT10eXBlb2YgdCl0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3QuZ2V0Tm90aWZpZXIgY2Fubm90IGdldE5vdGlmaWVyIG5vbi1vYmplY3QiKTtyZXR1cm4gZS5pc0Zyb3plbiYmZS5pc0Zyb3plbih0KT9udWxsOmcodCl9LGUuZGVsaXZlckNoYW5nZVJlY29yZHM9ZnVuY3Rpb24oZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFR5cGVFcnJvcigiT2JqZWN0LmRlbGl2ZXJDaGFuZ2VSZWNvcmRzIGNhbm5vdCBkZWxpdmVyIHRvIG5vbi1mdW5jdGlvbiIpO3ZhciB0PWkuZ2V0KGUpO3QmJih0Lm9ic2VydmVkLmZvckVhY2goZnVuY3Rpb24oZSx0KXt2KGUuZGF0YSx0KX0pLF8odCxlKSl9fShPYmplY3QsQXJyYXksdGhpcyl9LHt9XSw5MjpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSxyLkRhdGFPYmplY3RPYnNlcnZlcj1yLkRhdGFPYmplY3RSZXBvcnRlcj1yLlN5bmNoZXI9dm9pZCAwLGUoIm11dGF0aW9ub2JzZXJ2ZXItc2hpbSIpLGUoIm9iamVjdC5vYnNlcnZlIiksZSgiYXJyYXkub2JzZXJ2ZSIpO3ZhciBvPWUoIi4vc3luY2hlci9TeW5jaGVyIiksaT1uKG8pLHM9ZSgiLi9zeW5jaGVyL0RhdGFPYmplY3RSZXBvcnRlciIpLGE9bihzKSxjPWUoIi4vc3luY2hlci9EYXRhT2JqZWN0T2JzZXJ2ZXIiKSx1PW4oYyk7ci5TeW5jaGVyPWlbImRlZmF1bHQiXSxyLkRhdGFPYmplY3RSZXBvcnRlcj1hWyJkZWZhdWx0Il0sci5EYXRhT2JqZWN0T2JzZXJ2ZXI9dVsiZGVmYXVsdCJdfSx7Ii4vc3luY2hlci9EYXRhT2JqZWN0T2JzZXJ2ZXIiOjk1LCIuL3N5bmNoZXIvRGF0YU9iamVjdFJlcG9ydGVyIjo5NiwiLi9zeW5jaGVyL1N5bmNoZXIiOjk5LCJhcnJheS5vYnNlcnZlIjoxLCJtdXRhdGlvbm9ic2VydmVyLXNoaW0iOjkwLCJvYmplY3Qub2JzZXJ2ZSI6OTF9XSw5MzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLGk9bihvKSxzPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cyIpLGE9bihzKSxjPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLHU9bihjKSxsPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLGY9bihsKSxkPWUoIi4vU3luY09iamVjdCIpLHA9bihkKSxiPWUoIi4vRGF0YU9iamVjdENoaWxkIiksaD1uKGIpLHY9ZSgiLi4vdXRpbHMvdXRpbHMuanMiKSx5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LHIsbixvLGkscyl7KDAsdVsiZGVmYXVsdCJdKSh0aGlzLGUpO3ZhciBhPXRoaXM7YS5fc3luY2hlcj10LGEuX3VybD1yLGEuX3NjaGVtYT1uLGEuX3N0YXR1cz1vLGEuX3N5bmNPYmo9bmV3IHBbImRlZmF1bHQiXShpKSxhLl9jaGlsZHJlbnM9cyxhLl92ZXJzaW9uPTAsYS5fY2hpbGRJZD0wLGEuX2NoaWxkcmVuT2JqZWN0cz17fSxhLl9jaGlsZHJlbkxpc3RlbmVycz1bXSxhLl9vd25lcj10Ll9vd25lcixhLl9idXM9dC5fYnVzfXJldHVybigwLGZbImRlZmF1bHQiXSkoZSxbe2tleToiX2FsbG9jYXRlTGlzdGVuZXJzIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLHI9dC5fdXJsKyIvY2hpbGRyZW4vIjt0Ll9jaGlsZHJlbnMmJnQuX2NoaWxkcmVucy5mb3JFYWNoKGZ1bmN0aW9uKG4pe3ZhciBvPXIrbixpPXQuX2J1cy5hZGRMaXN0ZW5lcihvLGZ1bmN0aW9uKHIpe2lmKHIuZnJvbSE9PWUuX293bmVyKXN3aXRjaChjb25zb2xlLmxvZygiRGF0YU9iamVjdC1DaGlsZHJlbi1SQ1Y6ICIsciksci50eXBlKXtjYXNlImNyZWF0ZSI6dC5fb25DaGlsZENyZWF0ZShyKTticmVhaztjYXNlImRlbGV0ZSI6Y29uc29sZS5sb2cocik7YnJlYWs7ZGVmYXVsdDp0Ll9jaGFuZ2VDaGlsZHJlbihyKX19KTt0Ll9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGkpfSl9fSx7a2V5OiJfcmVsZWFzZUxpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2UuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5yZW1vdmUoKX0pLCgwLGFbImRlZmF1bHQiXSkoZS5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2UuX2NoaWxkcmVuT2JqZWN0c1t0XS5fcmVsZWFzZUxpc3RlbmVycygpfSl9fSx7a2V5OiJwYXVzZSIsdmFsdWU6ZnVuY3Rpb24oKXt0aHJvdyJOb3QgaW1wbGVtZW50ZWQifX0se2tleToicmVzdW1lIix2YWx1ZTpmdW5jdGlvbigpe3Rocm93Ik5vdCBpbXBsZW1lbnRlZCJ9fSx7a2V5OiJzdG9wIix2YWx1ZTpmdW5jdGlvbigpe3Rocm93Ik5vdCBpbXBsZW1lbnRlZCJ9fSx7a2V5OiJhZGRDaGlsZCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcj10aGlzO3IuX2NoaWxkSWQrKzt2YXIgbj1yLl9vd25lcisiIyIrci5fY2hpbGRJZCxvPXIuX3VybCsiL2NoaWxkcmVuLyIrZSxzPXt0eXBlOiJjcmVhdGUiLGZyb206ci5fb3duZXIsdG86byxib2R5OntyZXNvdXJjZTpuLHZhbHVlOnR9fTtyZXR1cm4gbmV3IGlbImRlZmF1bHQiXShmdW5jdGlvbihlKXt2YXIgaT1yLl9idXMucG9zdE1lc3NhZ2Uocyk7Y29uc29sZS5sb2coImNyZWF0ZS1yZXBvcnRlci1jaGlsZCggIityLl9vd25lcisiICk6ICIscyk7dmFyIGE9bmV3IGhbImRlZmF1bHQiXShyLG4sdCxyLl9vd25lcixpKTthLm9uQ2hhbmdlKGZ1bmN0aW9uKGUpe3IuX29uQ2hhbmdlKGUse3BhdGg6byxjaGlsZElkOm59KX0pLHIuX2NoaWxkcmVuT2JqZWN0c1tuXT1hLGUoYSl9KX19LHtrZXk6Im9uQWRkQ2hpbGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyPWV9fSx7a2V5OiJfb25DaGlsZENyZWF0ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPWUuYm9keS5yZXNvdXJjZTtjb25zb2xlLmxvZygiY3JlYXRlLW9ic2VydmVyLWNoaWxkKCAiK3QuX293bmVyKyIgKTogIixlKTt2YXIgbj1uZXcgaFsiZGVmYXVsdCJdKHQscixlLmJvZHkudmFsdWUpO3QuX2NoaWxkcmVuT2JqZWN0c1tyXT1uLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0Ll9idXMucG9zdE1lc3NhZ2Uoe2lkOmUuaWQsdHlwZToicmVzcG9uc2UiLGZyb206ZS50byx0bzplLmZyb20sYm9keTp7Y29kZToyMDAsc291cmNlOnQuX293bmVyfX0pfSk7dmFyIG89e3R5cGU6ZS50eXBlLGZyb206ZS5mcm9tLHVybDplLnRvLHZhbHVlOmUuYm9keS52YWx1ZSxjaGlsZElkOnIsaWRlbnRpdHk6ZS5ib2R5LmlkZW50aXR5fTt0Ll9vbkFkZENoaWxkcmVuSGFuZGxlciYmKGNvbnNvbGUubG9nKCJBREQtQ0hJTERSRU4tRVZFTlQ6ICIsbyksdC5fb25BZGRDaGlsZHJlbkhhbmRsZXIobykpfX0se2tleToiX29uQ2hhbmdlIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXM7aWYoci5fdmVyc2lvbisrLCJvbiI9PT1yLl9zdGF0dXMpe3ZhciBuPXt0eXBlOiJ1cGRhdGUiLGZyb206ci5fdXJsLHRvOnIuX3VybCsiL2NoYW5nZXMiLGJvZHk6e3ZlcnNpb246ci5fdmVyc2lvbixzb3VyY2U6ci5fb3duZXIsYXR0cmlidXRlOmUuZmllbGR9fTtlLm9UeXBlPT09ZC5PYmplY3RUeXBlLk9CSkVDVD9lLmNUeXBlIT09ZC5DaGFuZ2VUeXBlLlJFTU9WRSYmKG4uYm9keS52YWx1ZT1lLmRhdGEpOihuLmJvZHkuYXR0cmlidXRlVHlwZT1lLm9UeXBlLG4uYm9keS52YWx1ZT1lLmRhdGEsZS5jVHlwZSE9PWQuQ2hhbmdlVHlwZS5VUERBVEUmJihuLmJvZHkub3BlcmF0aW9uPWUuY1R5cGUpKSx0JiYobi50bz10LnBhdGgsbi5ib2R5LnJlc291cmNlPXQuY2hpbGRJZCksci5fYnVzLnBvc3RNZXNzYWdlKG4pfX19LHtrZXk6Il9jaGFuZ2VPYmplY3QiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcztpZihyLl92ZXJzaW9uKzE9PT10LmJvZHkudmVyc2lvbil7ci5fdmVyc2lvbisrO3ZhciBuPXQuYm9keS5hdHRyaWJ1dGUsbz0oMCx2LmRlZXBDbG9uZSkodC5ib2R5LnZhbHVlKSxpPWUuZmluZEJlZm9yZShuKTtpZih0LmJvZHkuYXR0cmlidXRlVHlwZT09PWQuT2JqZWN0VHlwZS5BUlJBWSlpZih0LmJvZHkub3BlcmF0aW9uPT09ZC5DaGFuZ2VUeXBlLkFERCl7dmFyIHM9aS5vYmosYT1pLmxhc3Q7QXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShzLFthLDBdLmNvbmNhdChvKSl9ZWxzZSBpZih0LmJvZHkub3BlcmF0aW9uPT09ZC5DaGFuZ2VUeXBlLlJFTU9WRSl7dmFyIGM9aS5vYmosdT1pLmxhc3Q7Yy5zcGxpY2UodSxvKX1lbHNlIGkub2JqW2kubGFzdF09bztlbHNlIHQuYm9keS52YWx1ZT9pLm9ialtpLmxhc3RdPW86ZGVsZXRlIGkub2JqW2kubGFzdF19ZWxzZSBjb25zb2xlLmxvZygiVU5TWU5DSFJPTklaRUQgVkVSU0lPTjogKGRhdGEgPT4gIityLl92ZXJzaW9uKyIsIG1zZyA9PiAiK3QuYm9keS52ZXJzaW9uKyIpIil9fSx7a2V5OiJfY2hhbmdlQ2hpbGRyZW4iLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7Y29uc29sZS5sb2coIkNoYW5nZSBjaGlsZHJlbjogIix0Ll9vd25lcixlKTt2YXIgcj1lLmJvZHkucmVzb3VyY2Usbj10Ll9jaGlsZHJlbk9iamVjdHNbcl07bj90Ll9jaGFuZ2VPYmplY3Qobi5fc3luY09iaixlKTpjb25zb2xlLmxvZygiTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAiLHIpfX0se2tleToidXJsIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdXJsfX0se2tleToic2NoZW1hIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NoZW1hfX0se2tleToic3RhdHVzIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhdHVzfX0se2tleToiZGF0YSIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N5bmNPYmouZGF0YX19LHtrZXk6ImNoaWxkcmVucyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NoaWxkcmVuT2JqZWN0c319XSksZX0oKTtyWyJkZWZhdWx0Il09eSx0LmV4cG9ydHM9clsiZGVmYXVsdCJdfSx7Ii4uL3V0aWxzL3V0aWxzLmpzIjoxMDAsIi4vRGF0YU9iamVjdENoaWxkIjo5NCwiLi9TeW5jT2JqZWN0Ijo5OCwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjo3LCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSI6OSwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjoxMSwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjoxMn1dLDk0OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO3ZhciBvPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLGk9bihvKSxzPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLGE9bihzKSxjPWUoIi4vU3luY09iamVjdCIpLHU9bihjKSxsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LHIsbixvLHMpeygwLGlbImRlZmF1bHQiXSkodGhpcyxlKTt2YXIgYT10aGlzO2EuX3BhcmVudD10LGEuX2NoaWxkSWQ9cixhLl9vd25lcj1vLGEuX21zZ0lkPXMsYS5fc3luY09iaj1uZXcgdVsiZGVmYXVsdCJdKG4pLGEuX2J1cz10Ll9idXMsYS5fYWxsb2NhdGVMaXN0ZW5lcnMoKX1yZXR1cm4oMCxhWyJkZWZhdWx0Il0pKGUsW3trZXk6Il9hbGxvY2F0ZUxpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2UuX293bmVyJiYoZS5fbGlzdGVuZXI9ZS5fYnVzLmFkZExpc3RlbmVyKGUuX293bmVyLGZ1bmN0aW9uKHQpeyJyZXNwb25zZSI9PT10LnR5cGUmJnQuaWQ9PT1lLl9tc2dJZCYmKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZToiLHQpLGUuX29uUmVzcG9uc2UodCkpfSkpfX0se2tleToiX3JlbGVhc2VMaXN0ZW5lcnMiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztlLl9saXN0ZW5lciYmZS5fbGlzdGVuZXIucmVtb3ZlKCl9fSx7a2V5OiJkZWxldGUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztkZWxldGUgZS5fcGFyZW50Ll9jaGlsZHJlbltlLl9jaGlsZElkXSxlLl9yZWxlYXNlTGlzdGVuZXJzKCl9fSx7a2V5OiJvbkNoYW5nZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uKHQpe2UodCl9KX19LHtrZXk6Im9uUmVzcG9uc2UiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyPWV9fSx7a2V5OiJfb25SZXNwb25zZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPXt0eXBlOmUudHlwZSx1cmw6ZS5ib2R5LnNvdXJjZSxjb2RlOmUuYm9keS5jb2RlfTt0Ll9vblJlc3BvbnNlSGFuZGxlciYmdC5fb25SZXNwb25zZUhhbmRsZXIocil9fSx7a2V5OiJjaGlsZElkIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2hpbGRJZH19LHtrZXk6ImRhdGEiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zeW5jT2JqLmRhdGF9fV0pLGV9KCk7clsiZGVmYXVsdCJdPWwsdC5leHBvcnRzPXJbImRlZmF1bHQiXX0seyIuL1N5bmNPYmplY3QiOjk4LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjEyfV0sOTU6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSk7dmFyIG89ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksaT1uKG8pLHM9ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIiksYT1uKHMpLGM9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksdT1uKGMpLGw9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksZj1uKGwpLGQ9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iKSxwPW4oZCksYj1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IiksaD1uKGIpLHY9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIikseT1uKHYpLF89ZSgiLi9EYXRhT2JqZWN0IiksZz1uKF8pLG09ZSgiLi9EYXRhT2JqZWN0Q2hpbGQiKSxqPW4obSksJD17QU5ZOiJhbnkiLFNUQVJUOiJzdGFydCIsRVhBQ1Q6ImV4YWN0In0sTz1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUscixuLG8scyxjLGwpeygwLHVbImRlZmF1bHQiXSkodGhpcyx0KTt2YXIgZj0oMCxwWyJkZWZhdWx0Il0pKHRoaXMsKDAsYVsiZGVmYXVsdCJdKSh0KS5jYWxsKHRoaXMsZSxyLG4sbyxzLmRhdGEsYykpLGQ9ZjtyZXR1cm4gZC5fdmVyc2lvbj1sLGQuX2ZpbHRlcnM9e30sZC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uKGUpe2QuX29uRmlsdGVyKGUpfSksKDAsaVsiZGVmYXVsdCJdKShzLmNoaWxkcmVucykuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1zLmNoaWxkcmVuc1tlXTtkLl9jaGlsZHJlbk9iamVjdHNbZV09bmV3IGpbImRlZmF1bHQiXShkLGUsdCl9KSxkLl9hbGxvY2F0ZUxpc3RlbmVycygpLGZ9cmV0dXJuKDAseVsiZGVmYXVsdCJdKSh0LGUpLCgwLGZbImRlZmF1bHQiXSkodCxbe2tleToiX2FsbG9jYXRlTGlzdGVuZXJzIix2YWx1ZTpmdW5jdGlvbigpeygwLGhbImRlZmF1bHQiXSkoKDAsYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksIl9hbGxvY2F0ZUxpc3RlbmVycyIsdGhpcykuY2FsbCh0aGlzKTt2YXIgZT10aGlzO2UuX2NoYW5nZUxpc3RlbmVyPWUuX2J1cy5hZGRMaXN0ZW5lcihlLl91cmwrIi9jaGFuZ2VzIixmdW5jdGlvbih0KXsidXBkYXRlIj09PXQudHlwZSYmKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0T2JzZXJ2ZXItIitlLl91cmwrIi1SQ1Y6ICIsdCksZS5fY2hhbmdlT2JqZWN0KGUuX3N5bmNPYmosdCkpfSl9fSx7a2V5OiJfcmVsZWFzZUxpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXsoMCxoWyJkZWZhdWx0Il0pKCgwLGFbImRlZmF1bHQiXSkodC5wcm90b3R5cGUpLCJfcmVsZWFzZUxpc3RlbmVycyIsdGhpcykuY2FsbCh0aGlzKTt2YXIgZT10aGlzO2UuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpfX0se2tleToiZGVsZXRlIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7ZS5fcmVsZWFzZUxpc3RlbmVycygpLGRlbGV0ZSBlLl9zeW5jaGVyLl9vYnNlcnZlcnNbZS5fdXJsXX19LHtrZXk6InVuc3Vic2NyaWJlIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD17dHlwZToidW5zdWJzY3JpYmUiLGZyb206ZS5fb3duZXIsdG86ZS5fc3luY2hlci5fc3ViVVJMLGJvZHk6e3Jlc291cmNlOmUuX3VybH19O2UuX2J1cy5wb3N0TWVzc2FnZSh0LGZ1bmN0aW9uKHQpe2NvbnNvbGUubG9nKCJEYXRhT2JqZWN0T2JzZXJ2ZXItVU5TVUJTQ1JJQkU6ICIsdCksMjAwPT09dC5ib2R5LmNvZGUmJihlLl9yZWxlYXNlTGlzdGVuZXJzKCksZGVsZXRlIGUuX3N5bmNoZXIuX29ic2VydmVyc1tlLl91cmxdKX0pfX0se2tleToib25DaGFuZ2UiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9ZSxuPXt0eXBlOiQuRVhBQ1QsY2FsbGJhY2s6dH0sbz1lLmluZGV4T2YoIioiKTtvPT09ZS5sZW5ndGgtMSYmKDA9PT1vP24udHlwZT0kLkFOWToobi50eXBlPSQuU1RBUlQscj1lLnN1YnN0cigwLGUubGVuZ3RoLTEpKSksdGhpcy5fZmlsdGVyc1tyXT1ufX0se2tleToiX29uRmlsdGVyIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzOygwLGlbImRlZmF1bHQiXSkodC5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbihyKXt2YXIgbj10Ll9maWx0ZXJzW3JdO24udHlwZT09PSQuQU5ZP24uY2FsbGJhY2soZSk6bi50eXBlPT09JC5TVEFSVD8wPT09ZS5maWVsZC5pbmRleE9mKHIpJiZuLmNhbGxiYWNrKGUpOm4udHlwZT09PSQuRVhBQ1QmJmUuZmllbGQ9PT1yJiZuLmNhbGxiYWNrKGUpfSl9fV0pLHR9KGdbImRlZmF1bHQiXSk7clsiZGVmYXVsdCJdPU8sdC5leHBvcnRzPXJbImRlZmF1bHQiXX0seyIuL0RhdGFPYmplY3QiOjkzLCIuL0RhdGFPYmplY3RDaGlsZCI6OTQsImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiI6NiwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjo3LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjEyLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IjoxMywiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIjoxNCwiYmFiZWwtcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOjE1fV0sOTY6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSk7dmFyIG89ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksaT1uKG8pLHM9ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIiksYT1uKHMpLGM9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksdT1uKGMpLGw9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksZj1uKGwpLGQ9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iKSxwPW4oZCksYj1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0IiksaD1uKGIpLHY9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIikseT1uKHYpLF89ZSgiLi9EYXRhT2JqZWN0IiksZz1uKF8pLG09ZSgiLi4vdXRpbHMvdXRpbHMuanMiKSxqPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSxyLG4sbyxpLHMpeygwLHVbImRlZmF1bHQiXSkodGhpcyx0KTt2YXIgYz0oMCxwWyJkZWZhdWx0Il0pKHRoaXMsKDAsYVsiZGVmYXVsdCJdKSh0KS5jYWxsKHRoaXMsZSxyLG4sbyxpLHMpKSxsPWM7cmV0dXJuIGwuX3N1YnNjcmlwdGlvbnM9e30sbC5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uKGUpe2NvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItIityKyItU0VORDogIixlKSxsLl9vbkNoYW5nZShlKX0pLGwuX2FsbG9jYXRlTGlzdGVuZXJzKCksY31yZXR1cm4oMCx5WyJkZWZhdWx0Il0pKHQsZSksKDAsZlsiZGVmYXVsdCJdKSh0LFt7a2V5OiJfYWxsb2NhdGVMaXN0ZW5lcnMiLHZhbHVlOmZ1bmN0aW9uKCl7KDAsaFsiZGVmYXVsdCJdKSgoMCxhWyJkZWZhdWx0Il0pKHQucHJvdG90eXBlKSwiX2FsbG9jYXRlTGlzdGVuZXJzIix0aGlzKS5jYWxsKHRoaXMpO3ZhciBlPXRoaXM7ZS5fcmVzcG9uc2VMaXN0ZW5lcj1lLl9idXMuYWRkTGlzdGVuZXIoZS5fdXJsLGZ1bmN0aW9uKHQpeyJyZXNwb25zZSI9PT10LnR5cGUmJmUuX29uUmVzcG9uc2UodCl9KX19LHtrZXk6Il9yZWxlYXNlTGlzdGVuZXJzIix2YWx1ZTpmdW5jdGlvbigpeygwLGhbImRlZmF1bHQiXSkoKDAsYVsiZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksIl9yZWxlYXNlTGlzdGVuZXJzIix0aGlzKS5jYWxsKHRoaXMpO3ZhciBlPXRoaXM7ZS5fcmVzcG9uc2VMaXN0ZW5lci5yZW1vdmUoKX19LHtrZXk6Imludml0ZU9ic2VydmVycyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPXt0eXBlOiJjcmVhdGUiLGZyb206dC5fc3luY2hlci5fb3duZXIsdG86dC5fc3luY2hlci5fc3ViVVJMLGJvZHk6e3Jlc291cmNlOnQuX3VybCxzY2hlbWE6dC5fc2NoZW1hLHZhbHVlOnQuX3N5bmNPYmouZGF0YSxhdXRob3Jpc2U6ZX19O3QuX2J1cy5wb3N0TWVzc2FnZShyKX19LHtrZXk6ImRlbGV0ZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9e3R5cGU6ImRlbGV0ZSIsZnJvbTplLl9vd25lcix0bzplLl9zeW5jaGVyLl9zdWJVUkwsYm9keTp7cmVzb3VyY2U6ZS5fdXJsfX07ZS5fYnVzLnBvc3RNZXNzYWdlKHQsZnVuY3Rpb24odCl7Y29uc29sZS5sb2coIkRhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICIsdCksMjAwPT09dC5ib2R5LmNvZGUmJihlLl9yZWxlYXNlTGlzdGVuZXJzKCksZGVsZXRlIGUuX3N5bmNoZXIuX3JlcG9ydGVyc1tlLl91cmxdKX0pfX0se2tleToib25TdWJzY3JpcHRpb24iLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcj1lfX0se2tleToib25SZXNwb25zZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fb25SZXNwb25zZUhhbmRsZXI9ZX19LHtrZXk6Il9vbkZvcndhcmQiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7c3dpdGNoKGNvbnNvbGUubG9nKCJEYXRhT2JqZWN0UmVwb3J0ZXItUkNWOiAiLGUpLGUuYm9keS50eXBlKXtjYXNlInN1YnNjcmliZSI6dC5fb25TdWJzY3JpYmUoZSk7YnJlYWs7Y2FzZSJ1bnN1YnNjcmliZSI6dC5fb25VblN1YnNjcmliZShlKX19fSx7a2V5OiJfb25TdWJzY3JpYmUiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1lLmJvZHkuZnJvbSxuPXt0eXBlOmUuYm9keS50eXBlLHVybDpyLGFjY2VwdDpmdW5jdGlvbigpe3ZhciBuPXt1cmw6cixzdGF0dXM6Im9uIn07dC5fc3Vic2NyaXB0aW9uc1tyXT1uO3ZhciBvPXt9O3JldHVybigwLGlbImRlZmF1bHQiXSkodC5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciByPXQuX2NoaWxkcmVuT2JqZWN0c1tlXS5kYXRhO29bZV09KDAsbS5kZWVwQ2xvbmUpKHIpfSksdC5fYnVzLnBvc3RNZXNzYWdlKHtpZDplLmlkLHR5cGU6InJlc3BvbnNlIixmcm9tOmUudG8sdG86ZS5mcm9tLGJvZHk6e2NvZGU6MjAwLHNjaGVtYTp0Ll9zY2hlbWEsdmVyc2lvbjp0Ll92ZXJzaW9uLHZhbHVlOntkYXRhOigwLG0uZGVlcENsb25lKSh0LmRhdGEpLGNoaWxkcmVuczpvfX19KSxufSxyZWplY3Q6ZnVuY3Rpb24ocil7dC5fYnVzLnBvc3RNZXNzYWdlKHtpZDplLmlkLHR5cGU6InJlc3BvbnNlIixmcm9tOmUudG8sdG86ZS5mcm9tLGJvZHk6e2NvZGU6NDAzLGRlc2M6cn19KX19O3QuX29uU3Vic2NyaXB0aW9uSGFuZGxlciYmKGNvbnNvbGUubG9nKCJTVUJTQ1JJUFRJT04tRVZFTlQ6ICIsbiksdC5fb25TdWJzY3JpcHRpb25IYW5kbGVyKG4pKX19LHtrZXk6Il9vblVuU3Vic2NyaWJlIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLHI9ZS5ib2R5LmZyb20sbj10Ll9zdWJzY3JpcHRpb25zW3JdO2RlbGV0ZSB0Ll9zdWJzY3JpcHRpb25zW3JdO3ZhciBvPXt0eXBlOmUuYm9keS50eXBlLHVybDpyLG9iamVjdDpufTt0Ll9vblN1YnNjcmlwdGlvbkhhbmRsZXImJihjb25zb2xlLmxvZygiVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAiLG8pLHQuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihvKSl9fSx7a2V5OiJfb25SZXNwb25zZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPXt0eXBlOmUudHlwZSx1cmw6ZS5mcm9tLGNvZGU6ZS5ib2R5LmNvZGV9O3QuX29uUmVzcG9uc2VIYW5kbGVyJiYoY29uc29sZS5sb2coIlJFU1BPTlNFLUVWRU5UOiAiLHIpLHQuX29uUmVzcG9uc2VIYW5kbGVyKHIpKX19LHtrZXk6InN1YnNjcmlwdGlvbnMiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zfX1dKSx0fShnWyJkZWZhdWx0Il0pO3JbImRlZmF1bHQiXT1qLHQuZXhwb3J0cz1yWyJkZWZhdWx0Il19LHsiLi4vdXRpbHMvdXRpbHMuanMiOjEwMCwiLi9EYXRhT2JqZWN0Ijo5MywiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mIjo2LCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiOjcsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6MTEsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI6MTIsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9nZXQiOjEzLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiOjE0LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI6MTV9XSw5NzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siKSxpPW4obykscz1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSxhPW4ocyksYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxyLG4sbyl7KDAsaVsiZGVmYXVsdCJdKSh0aGlzLGUpO3ZhciBzPXRoaXM7cy5fb3duZXI9dCxzLl91cmw9cixzLl9idXM9bixzLl9jaGlsZHJlbj1vLHMuX2NoYW5nZXM9W10scy5fYWxsb2NhdGVMaXN0ZW5lcnMoKX1yZXR1cm4oMCxhWyJkZWZhdWx0Il0pKGUsW3trZXk6Il9hbGxvY2F0ZUxpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2UuX2xpc3RlbmVyPWUuX2J1cy5hZGRMaXN0ZW5lcihlLl91cmwsZnVuY3Rpb24odCl7Y29uc29sZS5sb2coIkRhdGFQcm92aXNpb25hbC0iK2UuX3VybCsiLVJDVjogIix0KSxlLl9jaGFuZ2VzLnB1c2godCl9KX19LHtrZXk6Il9yZWxlYXNlTGlzdGVuZXJzIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7ZS5fbGlzdGVuZXIucmVtb3ZlKCl9fSx7a2V5OiJhcHBseSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpczt0Ll9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24odCl7ZS5fY2hhbmdlT2JqZWN0KGUuX3N5bmNPYmosdCl9KX19LHtrZXk6ImNoaWxkcmVuIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2hpbGRyZW59fV0pLGV9KCk7clsiZGVmYXVsdCJdPWMsdC5leHBvcnRzPXJbImRlZmF1bHQiXX0seyJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjEyfV0sOTg6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksci5PYmplY3RUeXBlPXIuQ2hhbmdlVHlwZT12b2lkIDA7dmFyIG89ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIiksaT1uKG8pLHM9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIiksYT1uKHMpLGM9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIiksdT1uKGMpLGw9ZSgiLi4vdXRpbHMvdXRpbHMuanMiKSxmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXsoMCxhWyJkZWZhdWx0Il0pKHRoaXMsZSk7dmFyIHI9dGhpcztyLl9vYnNlcnZlcnM9W10sci5fZmlsdGVycz17fSx0P3IuX2RhdGE9KDAsbC5kZWVwQ2xvbmUpKHQpOnIuX2RhdGE9e30sci5faW50ZXJuYWxPYnNlcnZlKG5ldyBkLHIuX2RhdGEpfXJldHVybigwLHVbImRlZmF1bHQiXSkoZSxbe2tleToib2JzZXJ2ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fb2JzZXJ2ZXJzLnB1c2goZSl9fSx7a2V5OiJmaW5kIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnNwbGl0KCIuIik7cmV0dXJuIHRoaXMuX2ZpbmRXaXRoU3BsaXQodCl9fSx7a2V5OiJmaW5kQmVmb3JlIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD17fSxyPWUuc3BsaXQoIi4iKTtyZXR1cm4gdC5sYXN0PXIucG9wKCksdC5vYmo9dGhpcy5fZmluZFdpdGhTcGxpdChyKSx0fX0se2tleToiX2ZpbmRXaXRoU3BsaXQiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2RhdGE7cmV0dXJuIGUuZm9yRWFjaChmdW5jdGlvbihlKXt0PXRbZV19KSx0fX0se2tleToiX2ZpcmVFdmVudCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dChlKX0pfX0se2tleToiX2lzT2JzZXJ2YWJsZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY29uc3RydWN0b3I9PT1PYmplY3R8fGUuY29uc3RydWN0b3I9PT1BcnJheX19LHtrZXk6Il9pbnRlcm5hbE9ic2VydmUiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcztpZihyLl9pc09ic2VydmFibGUodCkpe3ZhciBuPWZ1bmN0aW9uKHQpe3IuX29uQ2hhbmdlcyhlLHQpfTtpZih0LmNvbnN0cnVjdG9yPT09T2JqZWN0KXtPYmplY3Qub2JzZXJ2ZSh0LG4pO2Zvcih2YXIgbyBpbiB0KXIuX2lzT2JzZXJ2YWJsZSh0W29dKSYmci5faW50ZXJuYWxPYnNlcnZlKGVbIm5ldyJdKG8pLHRbb10pfWVsc2UgaWYodC5jb25zdHJ1Y3Rvcj09PUFycmF5KXtBcnJheS5vYnNlcnZlKHQsbik7Zm9yKHZhciBpIGluIHQpaWYoci5faXNPYnNlcnZhYmxlKHRbaV0pKXt2YXIgcz1lWyJuZXciXShuZXcgcCh0W2ldLGkpKTtyLl9pbnRlcm5hbE9ic2VydmUocyx0W2ldKX19fX19LHtrZXk6Il9vbkNoYW5nZXMiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcztmb3IodmFyIG4gaW4gdCl7dmFyIG89dFtuXS5vYmplY3QsaT12b2lkIDA7aWYoby5jb25zdHJ1Y3Rvcj09PU9iamVjdCYmKGk9aC5PQkpFQ1QpLG8uY29uc3RydWN0b3I9PT1BcnJheSYmKGk9aC5BUlJBWSksInNwbGljZSI9PT10W25dLnR5cGUpIWZ1bmN0aW9uKCl7dmFyIHM9dFtuXS5pbmRleCxhPWVbIm5ldyJdKCIiK3MpLGM9YS50b1N0cmluZygpLHU9dFtuXS5yZW1vdmVkLmxlbmd0aDtpZigwIT09dSl7dmFyIGY9dFtuXS5yZW1vdmVkO2YuZm9yRWFjaChmdW5jdGlvbih0LG4pe3IuX2lzT2JzZXJ2YWJsZSh0KSYmZS5yZW1vdmVJbmRleChzK24pfSksci5fZmlyZUV2ZW50KHtjVHlwZTpiLlJFTU9WRSxvVHlwZTppLGZpZWxkOmMsZGF0YTp1fSl9dmFyIGQ9dFtuXS5hZGRlZENvdW50O2lmKDAhPT1kKXt2YXIgaD1vLnNsaWNlKHMscytkKTtoLmZvckVhY2goZnVuY3Rpb24odCxuKXtpZihyLl9pc09ic2VydmFibGUodCkpe3ZhciBvPWVbIm5ldyJdKG5ldyBwKHQscytuKSk7ci5faW50ZXJuYWxPYnNlcnZlKG8sdCl9fSksci5fZmlyZUV2ZW50KHtjVHlwZTpiLkFERCxvVHlwZTppLGZpZWxkOmMsZGF0YTooMCxsLmRlZXBDbG9uZSkoaCl9KX1zIT09by5sZW5ndGgtMSYmZS5yZUluZGV4RnJvbShvKX0oKTtlbHNle3ZhciBzPWVbIm5ldyJdKHRbbl0ubmFtZSksYT1zLnRvU3RyaW5nKCk7aWYoLTEhPT1hLmluZGV4T2YoIlN5bWJvbCIpKWNvbnRpbnVlO3ZhciBjPW9bdFtuXS5uYW1lXTsidXBkYXRlIj09PXRbbl0udHlwZSYmdGhpcy5fZmlyZUV2ZW50KHtjVHlwZTpiLlVQREFURSxvVHlwZTppLGZpZWxkOmEsZGF0YTooMCxsLmRlZXBDbG9uZSkoYyl9KSwiYWRkIj09PXRbbl0udHlwZSYmKHRoaXMuX2ludGVybmFsT2JzZXJ2ZShzLGMpLHRoaXMuX2ZpcmVFdmVudCh7Y1R5cGU6Yi5BREQsb1R5cGU6aSxmaWVsZDphLGRhdGE6KDAsbC5kZWVwQ2xvbmUpKGMpfSkpLCJkZWxldGUiPT09dFtuXS50eXBlJiZ0aGlzLl9maXJlRXZlbnQoe2NUeXBlOmIuUkVNT1ZFLG9UeXBlOmksZmllbGQ6YX0pfX19fSx7a2V5OiJkYXRhIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGF0YX19XSksZX0oKSxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpeygwLGFbImRlZmF1bHQiXSkodGhpcyxlKSx0aGlzLl9wYXRoPVtdLHRoaXMuX29ic2VydmFibGVzPXt9fXJldHVybigwLHVbImRlZmF1bHQiXSkoZSxbe2tleToicmVtb3ZlSW5kZXgiLHZhbHVlOmZ1bmN0aW9uKGUpe2RlbGV0ZSB0aGlzLl9vYnNlcnZhYmxlc1tlXX19LHtrZXk6InJlSW5kZXhGcm9tIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzOygwLGlbImRlZmF1bHQiXSkodGhpcy5fb2JzZXJ2YWJsZXMpLmZvckVhY2goZnVuY3Rpb24ocil7dmFyIG49dC5fb2JzZXJ2YWJsZXNbcl0sbz1lLmluZGV4T2Yobi5vYmopO24uaWR4IT1vJiYobi5pZHg9byxkZWxldGUgdC5fb2JzZXJ2YWJsZXNbcl0sdC5fb2JzZXJ2YWJsZXNbb109bil9KX19LHtrZXk6Im5ldyIsdmFsdWU6ZnVuY3Rpb24oZSl7ZS5jb25zdHJ1Y3Rvcj09cCYmKHRoaXMuX29ic2VydmFibGVzW2UuaWR4XT1lKTt2YXIgdD10aGlzLmNsb25lKCk7cmV0dXJuIHQuX3BhdGgucHVzaChlKSx0fX0se2tleToiY2xvbmUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IGU7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbihlKXt0Ll9wYXRoLnB1c2goZSl9KSx0fX0se2tleToidG9TdHJpbmciLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9IiI7cmV0dXJuIHRoaXMuX3BhdGguZm9yRWFjaChmdW5jdGlvbih0LHIpezA9PT1yP2U9dC50b1N0cmluZygpOmUrPSIuIit0LnRvU3RyaW5nKCl9KSxlfX1dKSxlfSgpLHA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQscil7KDAsYVsiZGVmYXVsdCJdKSh0aGlzLGUpLHRoaXMub2JqPXQsdGhpcy5pZHg9cn1yZXR1cm4oMCx1WyJkZWZhdWx0Il0pKGUsW3trZXk6InRvU3RyaW5nIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlkeC50b1N0cmluZygpfX1dKSxlfSgpLGI9ci5DaGFuZ2VUeXBlPXtVUERBVEU6InVwZGF0ZSIsQUREOiJhZGQiLFJFTU9WRToicmVtb3ZlIn0saD1yLk9iamVjdFR5cGU9e09CSkVDVDoib2JqZWN0IixBUlJBWToiYXJyYXkifTtyWyJkZWZhdWx0Il09Zn0seyIuLi91dGlscy91dGlscy5qcyI6MTAwLCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiOjcsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6MTEsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI6MTJ9XSw5OTpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZSIpLGk9bihvKSxzPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLGE9bihzKSxjPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLHU9bihjKSxsPWUoIi4vRGF0YU9iamVjdFJlcG9ydGVyIiksZj1uKGwpLGQ9ZSgiLi9EYXRhT2JqZWN0T2JzZXJ2ZXIiKSxwPW4oZCksYj1lKCIuL0RhdGFQcm92aXNpb25hbCIpLGg9bihiKSx2PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LHIsbil7KDAsYVsiZGVmYXVsdCJdKSh0aGlzLGUpO3ZhciBvPXRoaXM7by5fb3duZXI9dCxvLl9idXM9cixvLl9zdWJVUkw9bi5ydW50aW1lVVJMKyIvc20iLG8uX3JlcG9ydGVycz17fSxvLl9vYnNlcnZlcnM9e30sby5fcHJvdmlzaW9uYWxzPXt9LHIuYWRkTGlzdGVuZXIodCxmdW5jdGlvbihlKXtpZihlLmZyb20hPT10KXN3aXRjaChjb25zb2xlLmxvZygiU3luY2hlci1SQ1Y6ICIsZSksZS50eXBlKXtjYXNlImZvcndhcmQiOm8uX29uRm9yd2FyZChlKTticmVhaztjYXNlImNyZWF0ZSI6by5fb25SZW1vdGVDcmVhdGUoZSk7YnJlYWs7Y2FzZSJkZWxldGUiOm8uX29uUmVtb3RlRGVsZXRlKGUpfX0pfXJldHVybigwLHVbImRlZmF1bHQiXSkoZSxbe2tleToiY3JlYXRlIix2YWx1ZTpmdW5jdGlvbihlLHQscil7dmFyIG49dGhpcztyLnJlcG9ydGVyPW4uX293bmVyLHIuc2NoZW1hPWU7dmFyIG89e3R5cGU6ImNyZWF0ZSIsZnJvbTpuLl9vd25lcix0bzpuLl9zdWJVUkwsYm9keTp7c2NoZW1hOmUsdmFsdWU6cixhdXRob3Jpc2U6dH19O3JldHVybiBuZXcgaVsiZGVmYXVsdCJdKGZ1bmN0aW9uKHQsaSl7bi5fYnVzLnBvc3RNZXNzYWdlKG8sZnVuY3Rpb24obyl7aWYoY29uc29sZS5sb2coImNyZWF0ZS1yZXNwb25zZTogIixvKSwyMDA9PT1vLmJvZHkuY29kZSl7dmFyIHM9by5ib2R5LnJlc291cmNlLGE9bmV3IGZbImRlZmF1bHQiXShuLHMsZSwib24iLHIsby5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTtuLl9yZXBvcnRlcnNbc109YSx0KGEpfWVsc2UgaShvLmJvZHkuZGVzYyl9KX0pfX0se2tleToic3Vic2NyaWJlIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMsbj17dHlwZToic3Vic2NyaWJlIixmcm9tOnIuX293bmVyLHRvOnIuX3N1YlVSTCxib2R5OntzY2hlbWE6ZSxyZXNvdXJjZTp0fX07cmV0dXJuIG5ldyBpWyJkZWZhdWx0Il0oZnVuY3Rpb24obyxpKXtyLl9idXMucG9zdE1lc3NhZ2UobixmdW5jdGlvbihuKXtjb25zb2xlLmxvZygic3Vic2NyaWJlLXJlc3BvbnNlOiAiLG4pO3ZhciBzPXIuX3Byb3Zpc2lvbmFsc1t0XTtpZihkZWxldGUgci5fcHJvdmlzaW9uYWxzW3RdLHMmJnMuX3JlbGVhc2VMaXN0ZW5lcnMoKSxuLmJvZHkuY29kZTwyMDApcz1uZXcgaFsiZGVmYXVsdCJdKHIuX293bmVyLHQsci5fYnVzLG4uYm9keS5jaGlsZHJlblJlc291cmNlcyksci5fcHJvdmlzaW9uYWxzW3RdPXM7ZWxzZSBpZigyMDA9PT1uLmJvZHkuY29kZSl7dmFyIGE9bmV3IHBbImRlZmF1bHQiXShyLHQsZSwib24iLG4uYm9keS52YWx1ZSxzLmNoaWxkcmVuLG4uYm9keS52ZXJzaW9uKTtyLl9vYnNlcnZlcnNbdF09YSxvKGEpLHMuYXBwbHkoYSl9ZWxzZSBpKG4uYm9keS5kZXNjKX0pfSl9fSx7a2V5OiJvbk5vdGlmaWNhdGlvbiIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyPWV9fSx7a2V5OiJfb25Gb3J3YXJkIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLHI9dC5fcmVwb3J0ZXJzW2UuYm9keS50b107ci5fb25Gb3J3YXJkKGUpfX0se2tleToiX29uUmVtb3RlQ3JlYXRlIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLHI9ZS5mcm9tLnNsaWNlKDAsLTEzKSxuPXt0eXBlOmUudHlwZSxmcm9tOmUuYm9keS5zb3VyY2UsdXJsOnIsc2NoZW1hOmUuYm9keS5zY2hlbWEsdmFsdWU6ZS5ib2R5LnZhbHVlLGlkZW50aXR5OmUuYm9keS5pZGVudGl0eSxhY2s6ZnVuY3Rpb24ocil7dmFyIG49MjAwO3ImJihuPXIpLHQuX2J1cy5wb3N0TWVzc2FnZSh7aWQ6ZS5pZCx0eXBlOiJyZXNwb25zZSIsZnJvbTplLnRvLHRvOmUuZnJvbSxib2R5Ontjb2RlOm59fSl9fTt0Ll9vbk5vdGlmaWNhdGlvbkhhbmRsZXImJihjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLG4pLHQuX29uTm90aWZpY2F0aW9uSGFuZGxlcihuKSl9fSx7a2V5OiJfb25SZW1vdGVEZWxldGUiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1lLmJvZHkucmVzb3VyY2Usbj10Ll9vYnNlcnZlcnNbcl07aWYobil7dmFyIG89e3R5cGU6ZS50eXBlLHVybDpyLGlkZW50aXR5OmUuYm9keS5pZGVudGl0eSxhY2s6ZnVuY3Rpb24ocil7dmFyIG89MjAwO3ImJihvPXIpLDIwMD09PW8mJm5bImRlbGV0ZSJdKCksdC5fYnVzLnBvc3RNZXNzYWdlKHtpZDplLmlkLHR5cGU6InJlc3BvbnNlIixmcm9tOmUudG8sdG86ZS5mcm9tLGJvZHk6e2NvZGU6byxzb3VyY2U6dC5fb3duZXJ9fSl9fTt0Ll9vbk5vdGlmaWNhdGlvbkhhbmRsZXImJihjb25zb2xlLmxvZygiTk9USUZJQ0FUSU9OLUVWRU5UOiAiLG8pLHQuX29uTm90aWZpY2F0aW9uSGFuZGxlcihvKSl9ZWxzZSB0Ll9idXMucG9zdE1lc3NhZ2Uoe2lkOmUuaWQsdHlwZToicmVzcG9uc2UiLGZyb206ZS50byx0bzplLmZyb20sYm9keTp7Y29kZTo0MDQsc291cmNlOnQuX293bmVyfX0pfX0se2tleToib3duZXIiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vd25lcn19LHtrZXk6InJlcG9ydGVycyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlcG9ydGVyc319LHtrZXk6Im9ic2VydmVycyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29ic2VydmVyc319XSksZX0oKTtyWyJkZWZhdWx0Il09dix0LmV4cG9ydHM9clsiZGVmYXVsdCJdfSx7Ii4vRGF0YU9iamVjdE9ic2VydmVyIjo5NSwiLi9EYXRhT2JqZWN0UmVwb3J0ZXIiOjk2LCIuL0RhdGFQcm92aXNpb25hbCI6OTcsImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlIjo5LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjEyfV0sMTAwOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19ZnVuY3Rpb24gbyhlKXt2YXIgdD0vKFthLXpBLVotXSopOlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naSxyPSIkMSwkMiwkMyIsbj1lLnJlcGxhY2UodCxyKS5zcGxpdCgiLCIpO25bMF09PT1lJiYoblswXT0iaHR0cHMiLG5bMV09ZSk7dmFyIG89e3R5cGU6blswXSxkb21haW46blsxXSxpZGVudGl0eTpuWzJdfTtyZXR1cm4gb31mdW5jdGlvbiBpKGUpe3JldHVybiBlP0pTT04ucGFyc2UoKDAsYVsiZGVmYXVsdCJdKShlKSk6dm9pZCAwfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgcz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvanNvbi9zdHJpbmdpZnkiKSxhPW4ocyk7ci5kaXZpZGVVUkw9byxyLmRlZXBDbG9uZT1pfSx7ImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeSI6Mn1dfSx7fSxbOTJdKSg5Mil9KTsKfSkuY2FsbCh0aGlzLHR5cGVvZiBnbG9iYWwgIT09ICJ1bmRlZmluZWQiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDoge30pCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KCi8qIE1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlc2Ugb3B0aW9ucyBhdCBqc2hpbnQuY29tL2RvY3Mvb3B0aW9ucyAqLwovKiBqc2hpbnQgYnJvd3NlcjogdHJ1ZSwgY2FtZWxjYXNlOiB0cnVlLCBjdXJseTogdHJ1ZSwgZGV2ZWw6IHRydWUsCiAgIGVxZXFlcTogdHJ1ZSwgZm9yaW46IGZhbHNlLCBnbG9iYWxzdHJpY3Q6IHRydWUsIG5vZGU6IHRydWUsCiAgIHF1b3RtYXJrOiBzaW5nbGUsIHVuZGVmOiB0cnVlLCB1bnVzZWQ6IHN0cmljdCAqLwovKiBnbG9iYWwgbW96UlRDSWNlQ2FuZGlkYXRlLCBtb3pSVENQZWVyQ29ubmVjdGlvbiwgUHJvbWlzZSwKbW96UlRDU2Vzc2lvbkRlc2NyaXB0aW9uLCB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbiwgTWVkaWFTdHJlYW1UcmFjaywKTWVkaWFTdHJlYW0sIFJUQ0ljZUdhdGhlcmVyLCBSVENJY2VUcmFuc3BvcnQsIFJUQ0R0bHNUcmFuc3BvcnQsClJUQ1J0cFNlbmRlciwgUlRDUnRwUmVjZWl2ZXIqLwovKiBleHBvcnRlZCB0cmFjZSxyZXF1ZXN0VXNlck1lZGlhICovCgondXNlIHN0cmljdCc7Cgp2YXIgZ2V0VXNlck1lZGlhID0gbnVsbDsKdmFyIGF0dGFjaE1lZGlhU3RyZWFtID0gbnVsbDsKdmFyIHJlYXR0YWNoTWVkaWFTdHJlYW0gPSBudWxsOwp2YXIgd2VicnRjRGV0ZWN0ZWRCcm93c2VyID0gbnVsbDsKdmFyIHdlYnJ0Y0RldGVjdGVkVmVyc2lvbiA9IG51bGw7CnZhciB3ZWJydGNNaW5pbXVtVmVyc2lvbiA9IG51bGw7CnZhciB3ZWJydGNVdGlscyA9IHsKICBsb2c6IGZ1bmN0aW9uKCkgewogICAgLy8gc3VwcHJlc3MgY29uc29sZS5sb2cgb3V0cHV0IHdoZW4gYmVpbmcgaW5jbHVkZWQgYXMgYSBtb2R1bGUuCiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgfHwKICAgICAgICB0eXBlb2YgcmVxdWlyZSA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7CiAgfSwKICBleHRyYWN0VmVyc2lvbjogZnVuY3Rpb24odWFzdHJpbmcsIGV4cHIsIHBvcykgewogICAgdmFyIG1hdGNoID0gdWFzdHJpbmcubWF0Y2goZXhwcik7CiAgICByZXR1cm4gbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID49IHBvcyAmJiBwYXJzZUludChtYXRjaFtwb3NdLCAxMCk7CiAgfQp9OwoKZnVuY3Rpb24gdHJhY2UodGV4dCkgewogIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCBmb3IgbG9nZ2luZy4KICBpZiAodGV4dFt0ZXh0Lmxlbmd0aCAtIDFdID09PSAnXG4nKSB7CiAgICB0ZXh0ID0gdGV4dC5zdWJzdHJpbmcoMCwgdGV4dC5sZW5ndGggLSAxKTsKICB9CiAgaWYgKHdpbmRvdy5wZXJmb3JtYW5jZSkgewogICAgdmFyIG5vdyA9ICh3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgLyAxMDAwKS50b0ZpeGVkKDMpOwogICAgd2VicnRjVXRpbHMubG9nKG5vdyArICc6ICcgKyB0ZXh0KTsKICB9IGVsc2UgewogICAgd2VicnRjVXRpbHMubG9nKHRleHQpOwogIH0KfQoKaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7CiAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmCiAgICAhKCdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgIC8vIFNoaW0gdGhlIHNyY09iamVjdCBwcm9wZXJ0eSwgb25jZSwgd2hlbiBIVE1MTWVkaWFFbGVtZW50IGlzIGZvdW5kLgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAvLyBJZiBwcmVmaXhlZCBzcmNPYmplY3QgcHJvcGVydHkgZXhpc3RzLCByZXR1cm4gaXQuCiAgICAgICAgLy8gT3RoZXJ3aXNlIHVzZSB0aGUgc2hpbW1lZCBwcm9wZXJ0eSwgX3NyY09iamVjdAogICAgICAgIHJldHVybiAnbW96U3JjT2JqZWN0JyBpbiB0aGlzID8gdGhpcy5tb3pTcmNPYmplY3QgOiB0aGlzLl9zcmNPYmplY3Q7CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgaWYgKCdtb3pTcmNPYmplY3QnIGluIHRoaXMpIHsKICAgICAgICAgIHRoaXMubW96U3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBVc2UgX3NyY09iamVjdCBhcyBhIHByaXZhdGUgcHJvcGVydHkgZm9yIHRoaXMgc2hpbQogICAgICAgICAgdGhpcy5fc3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgICAgLy8gVE9ETzogcmV2b2tlT2JqZWN0VXJsKHRoaXMuc3JjKSB3aGVuICFzdHJlYW0gdG8gcmVsZWFzZSByZXNvdXJjZXM/CiAgICAgICAgICB0aGlzLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0KICAvLyBQcm94eSBleGlzdGluZyBnbG9iYWxzCiAgZ2V0VXNlck1lZGlhID0gd2luZG93Lm5hdmlnYXRvciAmJiB3aW5kb3cubmF2aWdhdG9yLmdldFVzZXJNZWRpYTsKfQoKLy8gQXR0YWNoIGEgbWVkaWEgc3RyZWFtIHRvIGFuIGVsZW1lbnQuCmF0dGFjaE1lZGlhU3RyZWFtID0gZnVuY3Rpb24oZWxlbWVudCwgc3RyZWFtKSB7CiAgZWxlbWVudC5zcmNPYmplY3QgPSBzdHJlYW07Cn07CgpyZWF0dGFjaE1lZGlhU3RyZWFtID0gZnVuY3Rpb24odG8sIGZyb20pIHsKICB0by5zcmNPYmplY3QgPSBmcm9tLnNyY09iamVjdDsKfTsKCmlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhd2luZG93Lm5hdmlnYXRvcikgewogIHdlYnJ0Y1V0aWxzLmxvZygnVGhpcyBkb2VzIG5vdCBhcHBlYXIgdG8gYmUgYSBicm93c2VyJyk7CiAgd2VicnRjRGV0ZWN0ZWRCcm93c2VyID0gJ25vdCBhIGJyb3dzZXInOwp9IGVsc2UgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHsKICB3ZWJydGNVdGlscy5sb2coJ1RoaXMgYXBwZWFycyB0byBiZSBGaXJlZm94Jyk7CgogIHdlYnJ0Y0RldGVjdGVkQnJvd3NlciA9ICdmaXJlZm94JzsKCiAgLy8gdGhlIGRldGVjdGVkIGZpcmVmb3ggdmVyc2lvbi4KICB3ZWJydGNEZXRlY3RlZFZlcnNpb24gPSB3ZWJydGNVdGlscy5leHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LAogICAgICAvRmlyZWZveFwvKFswLTldKylcLi8sIDEpOwoKICAvLyB0aGUgbWluaW11bSBmaXJlZm94IHZlcnNpb24gc3RpbGwgc3VwcG9ydGVkIGJ5IGFkYXB0ZXIuCiAgd2VicnRjTWluaW11bVZlcnNpb24gPSAzMTsKCiAgLy8gU2hpbSBmb3IgUlRDUGVlckNvbm5lY3Rpb24gb24gb2xkZXIgdmVyc2lvbnMuCiAgaWYgKCF3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24pIHsKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7CiAgICAgIGlmICh3ZWJydGNEZXRlY3RlZFZlcnNpb24gPCAzOCkgewogICAgICAgIC8vIC51cmxzIGlzIG5vdCBzdXBwb3J0ZWQgaW4gRkYgPCAzOC4KICAgICAgICAvLyBjcmVhdGUgUlRDSWNlU2VydmVycyB3aXRoIGEgc2luZ2xlIHVybC4KICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykgewogICAgICAgICAgdmFyIG5ld0ljZVNlcnZlcnMgPSBbXTsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGNDb25maWcuaWNlU2VydmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTsKICAgICAgICAgICAgaWYgKHNlcnZlci5oYXNPd25Qcm9wZXJ0eSgndXJscycpKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZXJ2ZXIudXJscy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgdmFyIG5ld1NlcnZlciA9IHsKICAgICAgICAgICAgICAgICAgdXJsOiBzZXJ2ZXIudXJsc1tqXQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXIudXJsc1tqXS5pbmRleE9mKCd0dXJuJykgPT09IDApIHsKICAgICAgICAgICAgICAgICAgbmV3U2VydmVyLnVzZXJuYW1lID0gc2VydmVyLnVzZXJuYW1lOwogICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIuY3JlZGVudGlhbCA9IHNlcnZlci5jcmVkZW50aWFsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKG5ld1NlcnZlcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG5ld0ljZVNlcnZlcnMucHVzaChwY0NvbmZpZy5pY2VTZXJ2ZXJzW2ldKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcGNDb25maWcuaWNlU2VydmVycyA9IG5ld0ljZVNlcnZlcnM7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBuZXcgbW96UlRDUGVlckNvbm5lY3Rpb24ocGNDb25maWcsIHBjQ29uc3RyYWludHMpOyAvLyBqc2NzOmlnbm9yZSByZXF1aXJlQ2FwaXRhbGl6ZWRDb25zdHJ1Y3RvcnMKICAgIH07CiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlID0gbW96UlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlOwoKICAgIC8vIHdyYXAgc3RhdGljIG1ldGhvZHMuIEN1cnJlbnRseSBqdXN0IGdlbmVyYXRlQ2VydGlmaWNhdGUuCiAgICBpZiAobW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLCAnZ2VuZXJhdGVDZXJ0aWZpY2F0ZScsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgICAgICAgcmV0dXJuIG1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGUuYXBwbHkobnVsbCwKICAgICAgICAgICAgICAgIGFyZ3VtZW50cyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gbW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBtb3pSVENTZXNzaW9uRGVzY3JpcHRpb247CiAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gbW96UlRDSWNlQ2FuZGlkYXRlOwogIH0KCiAgLy8gZ2V0VXNlck1lZGlhIGNvbnN0cmFpbnRzIHNoaW0uCiAgZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgdmFyIGNvbnN0cmFpbnRzVG9GRjM3ID0gZnVuY3Rpb24oYykgewogICAgICBpZiAodHlwZW9mIGMgIT09ICdvYmplY3QnIHx8IGMucmVxdWlyZSkgewogICAgICAgIHJldHVybiBjOwogICAgICB9CiAgICAgIHZhciByZXF1aXJlID0gW107CiAgICAgIE9iamVjdC5rZXlzKGMpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7CiAgICAgICAgaWYgKGtleSA9PT0gJ3JlcXVpcmUnIHx8IGtleSA9PT0gJ2FkdmFuY2VkJyB8fCBrZXkgPT09ICdtZWRpYVNvdXJjZScpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdmFyIHIgPSBjW2tleV0gPSAodHlwZW9mIGNba2V5XSA9PT0gJ29iamVjdCcpID8KICAgICAgICAgICAgY1trZXldIDoge2lkZWFsOiBjW2tleV19OwogICAgICAgIGlmIChyLm1pbiAhPT0gdW5kZWZpbmVkIHx8CiAgICAgICAgICAgIHIubWF4ICE9PSB1bmRlZmluZWQgfHwgci5leGFjdCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXF1aXJlLnB1c2goa2V5KTsKICAgICAgICB9CiAgICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgaWYgKHR5cGVvZiByLmV4YWN0ID09PSAnbnVtYmVyJykgewogICAgICAgICAgICByLm1pbiA9IHIubWF4ID0gci5leGFjdDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNba2V5XSA9IHIuZXhhY3Q7CiAgICAgICAgICB9CiAgICAgICAgICBkZWxldGUgci5leGFjdDsKICAgICAgICB9CiAgICAgICAgaWYgKHIuaWRlYWwgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgYy5hZHZhbmNlZCA9IGMuYWR2YW5jZWQgfHwgW107CiAgICAgICAgICB2YXIgb2MgPSB7fTsKICAgICAgICAgIGlmICh0eXBlb2Ygci5pZGVhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgb2Nba2V5XSA9IHttaW46IHIuaWRlYWwsIG1heDogci5pZGVhbH07CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBvY1trZXldID0gci5pZGVhbDsKICAgICAgICAgIH0KICAgICAgICAgIGMuYWR2YW5jZWQucHVzaChvYyk7CiAgICAgICAgICBkZWxldGUgci5pZGVhbDsKICAgICAgICAgIGlmICghT2JqZWN0LmtleXMocikubGVuZ3RoKSB7CiAgICAgICAgICAgIGRlbGV0ZSBjW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgICAgaWYgKHJlcXVpcmUubGVuZ3RoKSB7CiAgICAgICAgYy5yZXF1aXJlID0gcmVxdWlyZTsKICAgICAgfQogICAgICByZXR1cm4gYzsKICAgIH07CiAgICBpZiAod2VicnRjRGV0ZWN0ZWRWZXJzaW9uIDwgMzgpIHsKICAgICAgd2VicnRjVXRpbHMubG9nKCdzcGVjOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgICAgaWYgKGNvbnN0cmFpbnRzLmF1ZGlvKSB7CiAgICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvRkYzNyhjb25zdHJhaW50cy5hdWRpbyk7CiAgICAgIH0KICAgICAgaWYgKGNvbnN0cmFpbnRzLnZpZGVvKSB7CiAgICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvRkYzNyhjb25zdHJhaW50cy52aWRlbyk7CiAgICAgIH0KICAgICAgd2VicnRjVXRpbHMubG9nKCdmZjM3OiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgIH0KICAgIHJldHVybiBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIG9uRXJyb3IpOwogIH07CgogIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgPSBnZXRVc2VyTWVkaWE7CgogIC8vIFNoaW0gZm9yIG1lZGlhRGV2aWNlcyBvbiBvbGRlciB2ZXJzaW9ucy4KICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7Z2V0VXNlck1lZGlhOiByZXF1ZXN0VXNlck1lZGlhLAogICAgICBhZGRFdmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHsgfSwKICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24oKSB7IH0KICAgIH07CiAgfQogIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9CiAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyB8fCBmdW5jdGlvbigpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgIHZhciBpbmZvcyA9IFsKICAgICAgICB7a2luZDogJ2F1ZGlvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfSwKICAgICAgICB7a2luZDogJ3ZpZGVvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfQogICAgICBdOwogICAgICByZXNvbHZlKGluZm9zKTsKICAgIH0pOwogIH07CgogIGlmICh3ZWJydGNEZXRlY3RlZFZlcnNpb24gPCA0MSkgewogICAgLy8gV29yayBhcm91bmQgaHR0cDovL2J1Z3ppbC5sYS8xMTY5NjY1CiAgICB2YXIgb3JnRW51bWVyYXRlRGV2aWNlcyA9CiAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzLmJpbmQobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyk7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIG9yZ0VudW1lcmF0ZURldmljZXMoKS50aGVuKHVuZGVmaW5lZCwgZnVuY3Rpb24oZSkgewogICAgICAgIGlmIChlLm5hbWUgPT09ICdOb3RGb3VuZEVycm9yJykgewogICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgIH0KICAgICAgICB0aHJvdyBlOwogICAgICB9KTsKICAgIH07CiAgfQp9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEgJiYgd2luZG93LndlYmtpdFJUQ1BlZXJDb25uZWN0aW9uKSB7CiAgd2VicnRjVXRpbHMubG9nKCdUaGlzIGFwcGVhcnMgdG8gYmUgQ2hyb21lJyk7CgogIHdlYnJ0Y0RldGVjdGVkQnJvd3NlciA9ICdjaHJvbWUnOwoKICAvLyB0aGUgZGV0ZWN0ZWQgY2hyb21lIHZlcnNpb24uCiAgd2VicnRjRGV0ZWN0ZWRWZXJzaW9uID0gd2VicnRjVXRpbHMuZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgL0Nocm9tKGV8aXVtKVwvKFswLTldKylcLi8sIDIpOwoKICAvLyB0aGUgbWluaW11bSBjaHJvbWUgdmVyc2lvbiBzdGlsbCBzdXBwb3J0ZWQgYnkgYWRhcHRlci4KICB3ZWJydGNNaW5pbXVtVmVyc2lvbiA9IDM4OwoKICAvLyBUaGUgUlRDUGVlckNvbm5lY3Rpb24gb2JqZWN0LgogIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7CiAgICAvLyBUcmFuc2xhdGUgaWNlVHJhbnNwb3J0UG9saWN5IHRvIGljZVRyYW5zcG9ydHMsCiAgICAvLyBzZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD00ODY5CiAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgIHBjQ29uZmlnLmljZVRyYW5zcG9ydHMgPSBwY0NvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3k7CiAgICB9CgogICAgdmFyIHBjID0gbmV3IHdlYmtpdFJUQ1BlZXJDb25uZWN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKTsgLy8ganNjczppZ25vcmUgcmVxdWlyZUNhcGl0YWxpemVkQ29uc3RydWN0b3JzCiAgICB2YXIgb3JpZ0dldFN0YXRzID0gcGMuZ2V0U3RhdHMuYmluZChwYyk7CiAgICBwYy5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsgLy8ganNoaW50IGlnbm9yZTogbGluZQogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzOwoKICAgICAgLy8gSWYgc2VsZWN0b3IgaXMgYSBmdW5jdGlvbiB0aGVuIHdlIGFyZSBpbiB0aGUgb2xkIHN0eWxlIHN0YXRzIHNvIGp1c3QKICAgICAgLy8gcGFzcyBiYWNrIHRoZSBvcmlnaW5hbCBnZXRTdGF0cyBmb3JtYXQgdG8gYXZvaWQgYnJlYWtpbmcgb2xkIHVzZXJzLgogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgdHlwZW9mIHNlbGVjdG9yID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cyhzZWxlY3Rvciwgc3VjY2Vzc0NhbGxiYWNrKTsKICAgICAgfQoKICAgICAgdmFyIGZpeENocm9tZVN0YXRzID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICB2YXIgc3RhbmRhcmRSZXBvcnQgPSB7fTsKICAgICAgICB2YXIgcmVwb3J0cyA9IHJlc3BvbnNlLnJlc3VsdCgpOwogICAgICAgIHJlcG9ydHMuZm9yRWFjaChmdW5jdGlvbihyZXBvcnQpIHsKICAgICAgICAgIHZhciBzdGFuZGFyZFN0YXRzID0gewogICAgICAgICAgICBpZDogcmVwb3J0LmlkLAogICAgICAgICAgICB0aW1lc3RhbXA6IHJlcG9ydC50aW1lc3RhbXAsCiAgICAgICAgICAgIHR5cGU6IHJlcG9ydC50eXBlCiAgICAgICAgICB9OwogICAgICAgICAgcmVwb3J0Lm5hbWVzKCkuZm9yRWFjaChmdW5jdGlvbihuYW1lKSB7CiAgICAgICAgICAgIHN0YW5kYXJkU3RhdHNbbmFtZV0gPSByZXBvcnQuc3RhdChuYW1lKTsKICAgICAgICAgIH0pOwogICAgICAgICAgc3RhbmRhcmRSZXBvcnRbc3RhbmRhcmRTdGF0cy5pZF0gPSBzdGFuZGFyZFN0YXRzOwogICAgICAgIH0pOwoKICAgICAgICByZXR1cm4gc3RhbmRhcmRSZXBvcnQ7CiAgICAgIH07CgogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAyKSB7CiAgICAgICAgdmFyIHN1Y2Nlc3NDYWxsYmFja1dyYXBwZXIgPSBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgYXJnc1sxXShmaXhDaHJvbWVTdGF0cyhyZXNwb25zZSkpOwogICAgICAgIH07CgogICAgICAgIHJldHVybiBvcmlnR2V0U3RhdHMuYXBwbHkodGhpcywgW3N1Y2Nlc3NDYWxsYmFja1dyYXBwZXIsIGFyZ3VtZW50c1swXV0pOwogICAgICB9CgogICAgICAvLyBwcm9taXNlLXN1cHBvcnQKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMSAmJiBzZWxlY3RvciA9PT0gbnVsbCkgewogICAgICAgICAgb3JpZ0dldFN0YXRzLmFwcGx5KHNlbGYsIFsKICAgICAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgcmVzb2x2ZS5hcHBseShudWxsLCBbZml4Q2hyb21lU3RhdHMocmVzcG9uc2UpXSk7CiAgICAgICAgICAgICAgfSwgcmVqZWN0XSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9yaWdHZXRTdGF0cy5hcHBseShzZWxmLCBbcmVzb2x2ZSwgcmVqZWN0XSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CgogICAgcmV0dXJuIHBjOwogIH07CiAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSA9IHdlYmtpdFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZTsKCiAgLy8gd3JhcCBzdGF0aWMgbWV0aG9kcy4gQ3VycmVudGx5IGp1c3QgZ2VuZXJhdGVDZXJ0aWZpY2F0ZS4KICBpZiAod2Via2l0UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgICAgIHJldHVybiB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlLmFwcGx5KG51bGwsCiAgICAgICAgICAgICAgYXJndW1lbnRzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHdlYmtpdFJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CgogIC8vIGFkZCBwcm9taXNlIHN1cHBvcnQKICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICB2YXIgbmF0aXZlTWV0aG9kID0gd2Via2l0UlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF07CiAgICB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMSB8fCAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJgogICAgICAgICAgdHlwZW9mKGFyZ3VtZW50c1swXSkgPT09ICdvYmplY3QnKSkgewogICAgICAgIHZhciBvcHRzID0gYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZDsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICBuYXRpdmVNZXRob2QuYXBwbHkoc2VsZiwgW3Jlc29sdmUsIHJlamVjdCwgb3B0c10pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgfTsKICB9KTsKCiAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywKICAgICAgJ2FkZEljZUNhbmRpZGF0ZSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICB2YXIgbmF0aXZlTWV0aG9kID0gd2Via2l0UlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF07CiAgICB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFthcmdzWzBdLAogICAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID49IDIpIHsKICAgICAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgW10pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgICAgcmVqZWN0KGVycik7CiAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID49IDMpIHsKICAgICAgICAgICAgICAgIGFyZ3NbMl0uYXBwbHkobnVsbCwgW2Vycl0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfV0KICAgICAgICAgICk7CiAgICAgIH0pOwogICAgfTsKICB9KTsKCiAgLy8gZ2V0VXNlck1lZGlhIGNvbnN0cmFpbnRzIHNoaW0uCiAgdmFyIGNvbnN0cmFpbnRzVG9DaHJvbWUgPSBmdW5jdGlvbihjKSB7CiAgICBpZiAodHlwZW9mIGMgIT09ICdvYmplY3QnIHx8IGMubWFuZGF0b3J5IHx8IGMub3B0aW9uYWwpIHsKICAgICAgcmV0dXJuIGM7CiAgICB9CiAgICB2YXIgY2MgPSB7fTsKICAgIE9iamVjdC5rZXlzKGMpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7CiAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciByID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/IGNba2V5XSA6IHtpZGVhbDogY1trZXldfTsKICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygci5leGFjdCA9PT0gJ251bWJlcicpIHsKICAgICAgICByLm1pbiA9IHIubWF4ID0gci5leGFjdDsKICAgICAgfQogICAgICB2YXIgb2xkbmFtZSA9IGZ1bmN0aW9uKHByZWZpeCwgbmFtZSkgewogICAgICAgIGlmIChwcmVmaXgpIHsKICAgICAgICAgIHJldHVybiBwcmVmaXggKyBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIChuYW1lID09PSAnZGV2aWNlSWQnKSA/ICdzb3VyY2VJZCcgOiBuYW1lOwogICAgICB9OwogICAgICBpZiAoci5pZGVhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY2Mub3B0aW9uYWwgPSBjYy5vcHRpb25hbCB8fCBbXTsKICAgICAgICB2YXIgb2MgPSB7fTsKICAgICAgICBpZiAodHlwZW9mIHIuaWRlYWwgPT09ICdudW1iZXInKSB7CiAgICAgICAgICBvY1tvbGRuYW1lKCdtaW4nLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICAgIG9jID0ge307CiAgICAgICAgICBvY1tvbGRuYW1lKCdtYXgnLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgb2Nbb2xkbmFtZSgnJywga2V5KV0gPSByLmlkZWFsOwogICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgIT09ICdudW1iZXInKSB7CiAgICAgICAgY2MubWFuZGF0b3J5ID0gY2MubWFuZGF0b3J5IHx8IHt9OwogICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lKCcnLCBrZXkpXSA9IHIuZXhhY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgWydtaW4nLCAnbWF4J10uZm9yRWFjaChmdW5jdGlvbihtaXgpIHsKICAgICAgICAgIGlmIChyW21peF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lKG1peCwga2V5KV0gPSByW21peF07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogICAgaWYgKGMuYWR2YW5jZWQpIHsKICAgICAgY2Mub3B0aW9uYWwgPSAoY2Mub3B0aW9uYWwgfHwgW10pLmNvbmNhdChjLmFkdmFuY2VkKTsKICAgIH0KICAgIHJldHVybiBjYzsKICB9OwoKICBnZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKSB7CiAgICBpZiAoY29uc3RyYWludHMuYXVkaW8pIHsKICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvQ2hyb21lKGNvbnN0cmFpbnRzLmF1ZGlvKTsKICAgIH0KICAgIGlmIChjb25zdHJhaW50cy52aWRlbykgewogICAgICBjb25zdHJhaW50cy52aWRlbyA9IGNvbnN0cmFpbnRzVG9DaHJvbWUoY29uc3RyYWludHMudmlkZW8pOwogICAgfQogICAgd2VicnRjVXRpbHMubG9nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgcmV0dXJuIG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEoY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcik7CiAgfTsKICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZ2V0VXNlck1lZGlhOwoKICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7Z2V0VXNlck1lZGlhOiByZXF1ZXN0VXNlck1lZGlhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhdGVEZXZpY2VzOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHsKICAgICAgICB2YXIga2luZHMgPSB7YXVkaW86ICdhdWRpb2lucHV0JywgdmlkZW86ICd2aWRlb2lucHV0J307CiAgICAgICAgcmV0dXJuIE1lZGlhU3RyZWFtVHJhY2suZ2V0U291cmNlcyhmdW5jdGlvbihkZXZpY2VzKSB7CiAgICAgICAgICByZXNvbHZlKGRldmljZXMubWFwKGZ1bmN0aW9uKGRldmljZSkgewogICAgICAgICAgICByZXR1cm4ge2xhYmVsOiBkZXZpY2UubGFiZWwsCiAgICAgICAgICAgICAgICAgICAga2luZDoga2luZHNbZGV2aWNlLmtpbmRdLAogICAgICAgICAgICAgICAgICAgIGRldmljZUlkOiBkZXZpY2UuaWQsCiAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJyd9OwogICAgICAgICAgfSkpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH19OwogIH0KCiAgLy8gQSBzaGltIGZvciBnZXRVc2VyTWVkaWEgbWV0aG9kIG9uIHRoZSBtZWRpYURldmljZXMgb2JqZWN0LgogIC8vIFRPRE8oS2FwdGVuSmFuc3NvbikgcmVtb3ZlIG9uY2UgaW1wbGVtZW50ZWQgaW4gQ2hyb21lIHN0YWJsZS4KICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKSB7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICAgIHJldHVybiByZXF1ZXN0VXNlck1lZGlhKGNvbnN0cmFpbnRzKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIC8vIEV2ZW4gdGhvdWdoIENocm9tZSA0NSBoYXMgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcyBhbmQgYSBnZXRVc2VyTWVkaWEKICAgIC8vIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYSBQcm9taXNlLCBpdCBkb2VzIG5vdCBhY2NlcHQgc3BlYy1zdHlsZQogICAgLy8gY29uc3RyYWludHMuCiAgICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLgogICAgICAgIGJpbmQobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyk7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSA9IGZ1bmN0aW9uKGMpIHsKICAgICAgd2VicnRjVXRpbHMubG9nKCdzcGVjOiAgICcgKyBKU09OLnN0cmluZ2lmeShjKSk7IC8vIHdoaXRlc3BhY2UgZm9yIGFsaWdubWVudAogICAgICBjLmF1ZGlvID0gY29uc3RyYWludHNUb0Nocm9tZShjLmF1ZGlvKTsKICAgICAgYy52aWRlbyA9IGNvbnN0cmFpbnRzVG9DaHJvbWUoYy52aWRlbyk7CiAgICAgIHdlYnJ0Y1V0aWxzLmxvZygnY2hyb21lOiAnICsgSlNPTi5zdHJpbmdpZnkoYykpOwogICAgICByZXR1cm4gb3JpZ0dldFVzZXJNZWRpYShjKTsKICAgIH07CiAgfQoKICAvLyBEdW1teSBkZXZpY2VjaGFuZ2UgZXZlbnQgbWV0aG9kcy4KICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuCiAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmFkZEV2ZW50TGlzdGVuZXIgPT09ICd1bmRlZmluZWQnKSB7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbigpIHsKICAgICAgd2VicnRjVXRpbHMubG9nKCdEdW1teSBtZWRpYURldmljZXMuYWRkRXZlbnRMaXN0ZW5lciBjYWxsZWQuJyk7CiAgICB9OwogIH0KICBpZiAodHlwZW9mIG5hdmlnYXRvci5tZWRpYURldmljZXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uKCkgewogICAgICB3ZWJydGNVdGlscy5sb2coJ0R1bW15IG1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQoKICAvLyBBdHRhY2ggYSBtZWRpYSBzdHJlYW0gdG8gYW4gZWxlbWVudC4KICBhdHRhY2hNZWRpYVN0cmVhbSA9IGZ1bmN0aW9uKGVsZW1lbnQsIHN0cmVhbSkgewogICAgaWYgKHdlYnJ0Y0RldGVjdGVkVmVyc2lvbiA+PSA0MykgewogICAgICBlbGVtZW50LnNyY09iamVjdCA9IHN0cmVhbTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIGVsZW1lbnQuc3JjICE9PSAndW5kZWZpbmVkJykgewogICAgICBlbGVtZW50LnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgIH0gZWxzZSB7CiAgICAgIHdlYnJ0Y1V0aWxzLmxvZygnRXJyb3IgYXR0YWNoaW5nIHN0cmVhbSB0byBlbGVtZW50LicpOwogICAgfQogIH07CiAgcmVhdHRhY2hNZWRpYVN0cmVhbSA9IGZ1bmN0aW9uKHRvLCBmcm9tKSB7CiAgICBpZiAod2VicnRjRGV0ZWN0ZWRWZXJzaW9uID49IDQzKSB7CiAgICAgIHRvLnNyY09iamVjdCA9IGZyb20uc3JjT2JqZWN0OwogICAgfSBlbHNlIHsKICAgICAgdG8uc3JjID0gZnJvbS5zcmM7CiAgICB9CiAgfTsKCn0gZWxzZSBpZiAobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyAmJiBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKAogICAgL0VkZ2VcLyhcZCspLihcZCspJC8pKSB7CiAgd2VicnRjVXRpbHMubG9nKCdUaGlzIGFwcGVhcnMgdG8gYmUgRWRnZScpOwogIHdlYnJ0Y0RldGVjdGVkQnJvd3NlciA9ICdlZGdlJzsKCiAgd2VicnRjRGV0ZWN0ZWRWZXJzaW9uID0gd2VicnRjVXRpbHMuZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgL0VkZ2VcLyhcZCspLihcZCspJC8sIDIpOwoKICAvLyBUaGUgbWluaW11bSB2ZXJzaW9uIHN0aWxsIHN1cHBvcnRlZCBieSBhZGFwdGVyLgogIC8vIFRoaXMgaXMgdGhlIGJ1aWxkIG51bWJlciBmb3IgRWRnZS4KICB3ZWJydGNNaW5pbXVtVmVyc2lvbiA9IDEwNTQ3OwoKICBpZiAod2luZG93LlJUQ0ljZUdhdGhlcmVyKSB7CiAgICAvLyBHZW5lcmF0ZSBhbiBhbHBoYW51bWVyaWMgaWRlbnRpZmllciBmb3IgY25hbWUgb3IgbWlkcy4KICAgIC8vIFRPRE86IHVzZSBVVUlEcyBpbnN0ZWFkPyBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9qZWQvOTgyODgzCiAgICB2YXIgZ2VuZXJhdGVJZGVudGlmaWVyID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgMTApOwogICAgfTsKCiAgICAvLyBUaGUgUlRDUCBDTkFNRSB1c2VkIGJ5IGFsbCBwZWVyY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBKUy4KICAgIHZhciBsb2NhbENOYW1lID0gZ2VuZXJhdGVJZGVudGlmaWVyKCk7CgogICAgLy8gU0RQIGhlbHBlcnMgLSB0byBiZSBtb3ZlZCBpbnRvIHNlcGFyYXRlIG1vZHVsZS4KICAgIHZhciBTRFBVdGlscyA9IHt9OwoKICAgIC8vIFNwbGl0cyBTRFAgaW50byBsaW5lcywgZGVhbGluZyB3aXRoIGJvdGggQ1JMRiBhbmQgTEYuCiAgICBTRFBVdGlscy5zcGxpdExpbmVzID0gZnVuY3Rpb24oYmxvYikgewogICAgICByZXR1cm4gYmxvYi50cmltKCkuc3BsaXQoJ1xuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgICByZXR1cm4gbGluZS50cmltKCk7CiAgICAgIH0pOwogICAgfTsKCiAgICAvLyBTcGxpdHMgU0RQIGludG8gc2Vzc2lvbnBhcnQgYW5kIG1lZGlhc2VjdGlvbnMuIEVuc3VyZXMgQ1JMRi4KICAgIFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7CiAgICAgIHZhciBwYXJ0cyA9IGJsb2Iuc3BsaXQoJ1xyXG5tPScpOwogICAgICByZXR1cm4gcGFydHMubWFwKGZ1bmN0aW9uKHBhcnQsIGluZGV4KSB7CiAgICAgICAgcmV0dXJuIChpbmRleCA+IDAgPyAnbT0nICsgcGFydCA6IHBhcnQpLnRyaW0oKSArICdcclxuJzsKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIFJldHVybnMgbGluZXMgdGhhdCBzdGFydCB3aXRoIGEgY2VydGFpbiBwcmVmaXguCiAgICBTRFBVdGlscy5tYXRjaFByZWZpeCA9IGZ1bmN0aW9uKGJsb2IsIHByZWZpeCkgewogICAgICByZXR1cm4gU0RQVXRpbHMuc3BsaXRMaW5lcyhibG9iKS5maWx0ZXIoZnVuY3Rpb24obGluZSkgewogICAgICAgIHJldHVybiBsaW5lLmluZGV4T2YocHJlZml4KSA9PT0gMDsKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIFBhcnNlcyBhbiBJQ0UgY2FuZGlkYXRlIGxpbmUuIFNhbXBsZSBpbnB1dDoKICAgIC8vIGNhbmRpZGF0ZTo3MDI3ODYzNTAgMiB1ZHAgNDE4MTk5MDIgOC44LjguOCA2MDc2OSB0eXAgcmVsYXkgcmFkZHIgOC44LjguOCBycG9ydCA1NTk5NiIKICAgIFNEUFV0aWxzLnBhcnNlQ2FuZGlkYXRlID0gZnVuY3Rpb24obGluZSkgewogICAgICB2YXIgcGFydHM7CiAgICAgIC8vIFBhcnNlIGJvdGggdmFyaWFudHMuCiAgICAgIGlmIChsaW5lLmluZGV4T2YoJ2E9Y2FuZGlkYXRlOicpID09PSAwKSB7CiAgICAgICAgcGFydHMgPSBsaW5lLnN1YnN0cmluZygxMikuc3BsaXQoJyAnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwYXJ0cyA9IGxpbmUuc3Vic3RyaW5nKDEwKS5zcGxpdCgnICcpOwogICAgICB9CgogICAgICB2YXIgY2FuZGlkYXRlID0gewogICAgICAgIGZvdW5kYXRpb246IHBhcnRzWzBdLAogICAgICAgIGNvbXBvbmVudDogcGFydHNbMV0sCiAgICAgICAgcHJvdG9jb2w6IHBhcnRzWzJdLnRvTG93ZXJDYXNlKCksCiAgICAgICAgcHJpb3JpdHk6IHBhcnNlSW50KHBhcnRzWzNdLCAxMCksCiAgICAgICAgaXA6IHBhcnRzWzRdLAogICAgICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzVdLCAxMCksCiAgICAgICAgLy8gc2tpcCBwYXJ0c1s2XSA9PSAndHlwJwogICAgICAgIHR5cGU6IHBhcnRzWzddCiAgICAgIH07CgogICAgICBmb3IgKHZhciBpID0gODsgaSA8IHBhcnRzLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgc3dpdGNoIChwYXJ0c1tpXSkgewogICAgICAgICAgY2FzZSAncmFkZHInOgogICAgICAgICAgICBjYW5kaWRhdGUucmVsYXRlZEFkZHJlc3MgPSBwYXJ0c1tpICsgMV07CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAncnBvcnQnOgogICAgICAgICAgICBjYW5kaWRhdGUucmVsYXRlZFBvcnQgPSBwYXJzZUludChwYXJ0c1tpICsgMV0sIDEwKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICd0Y3B0eXBlJzoKICAgICAgICAgICAgY2FuZGlkYXRlLnRjcFR5cGUgPSBwYXJ0c1tpICsgMV07CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgZGVmYXVsdDogLy8gVW5rbm93biBleHRlbnNpb25zIGFyZSBzaWxlbnRseSBpZ25vcmVkLgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGNhbmRpZGF0ZTsKICAgIH07CgogICAgLy8gVHJhbnNsYXRlcyBhIGNhbmRpZGF0ZSBvYmplY3QgaW50byBTRFAgY2FuZGlkYXRlIGF0dHJpYnV0ZS4KICAgIFNEUFV0aWxzLndyaXRlQ2FuZGlkYXRlID0gZnVuY3Rpb24oY2FuZGlkYXRlKSB7CiAgICAgIHZhciBzZHAgPSBbXTsKICAgICAgc2RwLnB1c2goY2FuZGlkYXRlLmZvdW5kYXRpb24pOwogICAgICBzZHAucHVzaChjYW5kaWRhdGUuY29tcG9uZW50KTsKICAgICAgc2RwLnB1c2goY2FuZGlkYXRlLnByb3RvY29sLnRvVXBwZXJDYXNlKCkpOwogICAgICBzZHAucHVzaChjYW5kaWRhdGUucHJpb3JpdHkpOwogICAgICBzZHAucHVzaChjYW5kaWRhdGUuaXApOwogICAgICBzZHAucHVzaChjYW5kaWRhdGUucG9ydCk7CgogICAgICB2YXIgdHlwZSA9IGNhbmRpZGF0ZS50eXBlOwogICAgICBzZHAucHVzaCgndHlwJyk7CiAgICAgIHNkcC5wdXNoKHR5cGUpOwogICAgICBpZiAodHlwZSAhPT0gJ2hvc3QnICYmIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyAmJgogICAgICAgICAgY2FuZGlkYXRlLnJlbGF0ZWRQb3J0KSB7CiAgICAgICAgc2RwLnB1c2goJ3JhZGRyJyk7CiAgICAgICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzKTsgLy8gd2FzOiByZWxBZGRyCiAgICAgICAgc2RwLnB1c2goJ3Jwb3J0Jyk7CiAgICAgICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRQb3J0KTsgLy8gd2FzOiByZWxQb3J0CiAgICAgIH0KICAgICAgaWYgKGNhbmRpZGF0ZS50Y3BUeXBlICYmIGNhbmRpZGF0ZS5wcm90b2NvbC50b0xvd2VyQ2FzZSgpID09PSAndGNwJykgewogICAgICAgIHNkcC5wdXNoKCd0Y3B0eXBlJyk7CiAgICAgICAgc2RwLnB1c2goY2FuZGlkYXRlLnRjcFR5cGUpOwogICAgICB9CiAgICAgIHJldHVybiAnY2FuZGlkYXRlOicgKyBzZHAuam9pbignICcpOwogICAgfTsKCiAgICAvLyBQYXJzZXMgYW4gcnRwbWFwIGxpbmUsIHJldHVybnMgUlRDUnRwQ29kZGVjUGFyYW1ldGVycy4gU2FtcGxlIGlucHV0OgogICAgLy8gYT1ydHBtYXA6MTExIG9wdXMvNDgwMDAvMgogICAgU0RQVXRpbHMucGFyc2VSdHBNYXAgPSBmdW5jdGlvbihsaW5lKSB7CiAgICAgIHZhciBwYXJ0cyA9IGxpbmUuc3Vic3RyKDkpLnNwbGl0KCcgJyk7CiAgICAgIHZhciBwYXJzZWQgPSB7CiAgICAgICAgcGF5bG9hZFR5cGU6IHBhcnNlSW50KHBhcnRzLnNoaWZ0KCksIDEwKSAvLyB3YXM6IGlkCiAgICAgIH07CgogICAgICBwYXJ0cyA9IHBhcnRzWzBdLnNwbGl0KCcvJyk7CgogICAgICBwYXJzZWQubmFtZSA9IHBhcnRzWzBdOwogICAgICBwYXJzZWQuY2xvY2tSYXRlID0gcGFyc2VJbnQocGFydHNbMV0sIDEwKTsgLy8gd2FzOiBjbG9ja3JhdGUKICAgICAgcGFyc2VkLm51bUNoYW5uZWxzID0gcGFydHMubGVuZ3RoID09PSAzID8gcGFyc2VJbnQocGFydHNbMl0sIDEwKSA6IDE7IC8vIHdhczogY2hhbm5lbHMKICAgICAgcmV0dXJuIHBhcnNlZDsKICAgIH07CgogICAgLy8gR2VuZXJhdGUgYW4gYT1ydHBtYXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuCiAgICBTRFBVdGlscy53cml0ZVJ0cE1hcCA9IGZ1bmN0aW9uKGNvZGVjKSB7CiAgICAgIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlOwogICAgICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHB0ID0gY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGU7CiAgICAgIH0KICAgICAgcmV0dXJuICdhPXJ0cG1hcDonICsgcHQgKyAnICcgKyBjb2RlYy5uYW1lICsgJy8nICsgY29kZWMuY2xvY2tSYXRlICsKICAgICAgICAgIChjb2RlYy5udW1DaGFubmVscyAhPT0gMSA/ICcvJyArIGNvZGVjLm51bUNoYW5uZWxzIDogJycpICsgJ1xyXG4nOwogICAgfTsKCiAgICAvLyBQYXJzZXMgYW4gZnRtcCBsaW5lLCByZXR1cm5zIGRpY3Rpb25hcnkuIFNhbXBsZSBpbnB1dDoKICAgIC8vIGE9Zm10cDo5NiB2YnI9b247Y25nPW9uCiAgICAvLyBBbHNvIGRlYWxzIHdpdGggdmJyPW9uOyBjbmc9b24KICAgIFNEUFV0aWxzLnBhcnNlRm10cCA9IGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgdmFyIHBhcnNlZCA9IHt9OwogICAgICB2YXIga3Y7CiAgICAgIHZhciBwYXJ0cyA9IGxpbmUuc3Vic3RyKGxpbmUuaW5kZXhPZignICcpICsgMSkuc3BsaXQoJzsnKTsKICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwYXJ0cy5sZW5ndGg7IGorKykgewogICAgICAgIGt2ID0gcGFydHNbal0udHJpbSgpLnNwbGl0KCc9Jyk7CiAgICAgICAgcGFyc2VkW2t2WzBdLnRyaW0oKV0gPSBrdlsxXTsKICAgICAgfQogICAgICByZXR1cm4gcGFyc2VkOwogICAgfTsKCiAgICAvLyBHZW5lcmF0ZXMgYW4gYT1mdG1wIGxpbmUgZnJvbSBSVENSdHBDb2RlY0NhcGFiaWxpdHkgb3IgUlRDUnRwQ29kZWNQYXJhbWV0ZXJzLgogICAgU0RQVXRpbHMud3JpdGVGdG1wID0gZnVuY3Rpb24oY29kZWMpIHsKICAgICAgdmFyIGxpbmUgPSAnJzsKICAgICAgdmFyIHB0ID0gY29kZWMucGF5bG9hZFR5cGU7CiAgICAgIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICAgICAgfQogICAgICBpZiAoY29kZWMucGFyYW1ldGVycyAmJiBjb2RlYy5wYXJhbWV0ZXJzLmxlbmd0aCkgewogICAgICAgIHZhciBwYXJhbXMgPSBbXTsKICAgICAgICBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtKSB7CiAgICAgICAgICBwYXJhbXMucHVzaChwYXJhbSArICc9JyArIGNvZGVjLnBhcmFtZXRlcnNbcGFyYW1dKTsKICAgICAgICB9KTsKICAgICAgICBsaW5lICs9ICdhPWZtdHA6JyArIHB0ICsgJyAnICsgcGFyYW1zLmpvaW4oJzsnKSArICdcclxuJzsKICAgICAgfQogICAgICByZXR1cm4gbGluZTsKICAgIH07CgogICAgLy8gUGFyc2VzIGFuIHJ0Y3AtZmIgbGluZSwgcmV0dXJucyBSVENQUnRjcEZlZWRiYWNrIG9iamVjdC4gU2FtcGxlIGlucHV0OgogICAgLy8gYT1ydGNwLWZiOjk4IG5hY2sgcnBzaQogICAgU0RQVXRpbHMucGFyc2VSdGNwRmIgPSBmdW5jdGlvbihsaW5lKSB7CiAgICAgIHZhciBwYXJ0cyA9IGxpbmUuc3Vic3RyKGxpbmUuaW5kZXhPZignICcpICsgMSkuc3BsaXQoJyAnKTsKICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiBwYXJ0cy5zaGlmdCgpLAogICAgICAgIHBhcmFtZXRlcjogcGFydHMuam9pbignICcpCiAgICAgIH07CiAgICB9OwogICAgLy8gR2VuZXJhdGUgYT1ydGNwLWZiIGxpbmVzIGZyb20gUlRDUnRwQ29kZWNDYXBhYmlsaXR5IG9yIFJUQ1J0cENvZGVjUGFyYW1ldGVycy4KICAgIFNEUFV0aWxzLndyaXRlUnRjcEZiID0gZnVuY3Rpb24oY29kZWMpIHsKICAgICAgdmFyIGxpbmVzID0gJyc7CiAgICAgIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlOwogICAgICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHB0ID0gY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGU7CiAgICAgIH0KICAgICAgaWYgKGNvZGVjLnJ0Y3BGZWVkYmFjayAmJiBjb2RlYy5ydGNwRmVlZGJhY2subGVuZ3RoKSB7CiAgICAgICAgLy8gRklYTUU6IHNwZWNpYWwgaGFuZGxpbmcgZm9yIHRyci1pbnQ/CiAgICAgICAgY29kZWMucnRjcEZlZWRiYWNrLmZvckVhY2goZnVuY3Rpb24oZmIpIHsKICAgICAgICAgIGxpbmVzICs9ICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnICsgZmIudHlwZSArICcgJyArIGZiLnBhcmFtZXRlciArCiAgICAgICAgICAgICAgJ1xyXG4nOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBsaW5lczsKICAgIH07CgogICAgLy8gUGFyc2VzIGFuIFJGQyA1NTc2IHNzcmMgbWVkaWEgYXR0cmlidXRlLiBTYW1wbGUgaW5wdXQ6CiAgICAvLyBhPXNzcmM6MzczNTkyODU1OSBjbmFtZTpzb21ldGhpbmcKICAgIFNEUFV0aWxzLnBhcnNlU3NyY01lZGlhID0gZnVuY3Rpb24obGluZSkgewogICAgICB2YXIgc3AgPSBsaW5lLmluZGV4T2YoJyAnKTsKICAgICAgdmFyIHBhcnRzID0gewogICAgICAgIHNzcmM6IGxpbmUuc3Vic3RyKDcsIHNwIC0gNyksCiAgICAgIH07CiAgICAgIHZhciBjb2xvbiA9IGxpbmUuaW5kZXhPZignOicsIHNwKTsKICAgICAgaWYgKGNvbG9uID4gLTEpIHsKICAgICAgICBwYXJ0cy5hdHRyaWJ1dGUgPSBsaW5lLnN1YnN0cihzcCArIDEsIGNvbG9uIC0gc3AgLSAxKTsKICAgICAgICBwYXJ0cy52YWx1ZSA9IGxpbmUuc3Vic3RyKGNvbG9uICsgMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxKTsKICAgICAgfQogICAgICByZXR1cm4gcGFydHM7CiAgICB9OwoKICAgIC8vIEV4dHJhY3RzIERUTFMgcGFyYW1ldGVycyBmcm9tIFNEUCBtZWRpYSBzZWN0aW9uIG9yIHNlc3Npb25wYXJ0LgogICAgLy8gRklYTUU6IGZvciBjb25zaXN0ZW5jeSB3aXRoIG90aGVyIGZ1bmN0aW9ucyB0aGlzIHNob3VsZCBvbmx5CiAgICAvLyAgIGdldCB0aGUgZmluZ2VycHJpbnQgbGluZSBhcyBpbnB1dC4gU2VlIGFsc28gZ2V0SWNlUGFyYW1ldGVycy4KICAgIFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogICAgICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7CiAgICAgIGxpbmVzID0gbGluZXMuY29uY2F0KFNEUFV0aWxzLnNwbGl0TGluZXMoc2Vzc2lvbnBhcnQpKTsgLy8gU2VhcmNoIGluIHNlc3Npb24gcGFydCwgdG9vLgogICAgICB2YXIgZnBMaW5lID0gbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgICByZXR1cm4gbGluZS5pbmRleE9mKCdhPWZpbmdlcnByaW50OicpID09PSAwOwogICAgICB9KVswXS5zdWJzdHIoMTQpOwogICAgICAvLyBOb3RlOiBhPXNldHVwIGxpbmUgaXMgaWdub3JlZCBzaW5jZSB3ZSB1c2UgdGhlICdhdXRvJyByb2xlLgogICAgICB2YXIgZHRsc1BhcmFtZXRlcnMgPSB7CiAgICAgICAgcm9sZTogJ2F1dG8nLAogICAgICAgIGZpbmdlcnByaW50czogW3sKICAgICAgICAgIGFsZ29yaXRobTogZnBMaW5lLnNwbGl0KCcgJylbMF0sCiAgICAgICAgICB2YWx1ZTogZnBMaW5lLnNwbGl0KCcgJylbMV0KICAgICAgICB9XQogICAgICB9OwogICAgICByZXR1cm4gZHRsc1BhcmFtZXRlcnM7CiAgICB9OwoKICAgIC8vIFNlcmlhbGl6ZXMgRFRMUyBwYXJhbWV0ZXJzIHRvIFNEUC4KICAgIFNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMsIHNldHVwVHlwZSkgewogICAgICB2YXIgc2RwID0gJ2E9c2V0dXA6JyArIHNldHVwVHlwZSArICdcclxuJzsKICAgICAgcGFyYW1zLmZpbmdlcnByaW50cy5mb3JFYWNoKGZ1bmN0aW9uKGZwKSB7CiAgICAgICAgc2RwICs9ICdhPWZpbmdlcnByaW50OicgKyBmcC5hbGdvcml0aG0gKyAnICcgKyBmcC52YWx1ZSArICdcclxuJzsKICAgICAgfSk7CiAgICAgIHJldHVybiBzZHA7CiAgICB9OwogICAgLy8gUGFyc2VzIElDRSBpbmZvcm1hdGlvbiBmcm9tIFNEUCBtZWRpYSBzZWN0aW9uIG9yIHNlc3Npb25wYXJ0LgogICAgLy8gRklYTUU6IGZvciBjb25zaXN0ZW5jeSB3aXRoIG90aGVyIGZ1bmN0aW9ucyB0aGlzIHNob3VsZCBvbmx5CiAgICAvLyAgIGdldCB0aGUgaWNlLXVmcmFnIGFuZCBpY2UtcHdkIGxpbmVzIGFzIGlucHV0LgogICAgU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2Vzc2lvbnBhcnQpIHsKICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICBsaW5lcyA9IGxpbmVzLmNvbmNhdChTRFBVdGlscy5zcGxpdExpbmVzKHNlc3Npb25wYXJ0KSk7IC8vIFNlYXJjaCBpbiBzZXNzaW9uIHBhcnQsIHRvby4KICAgICAgdmFyIGljZVBhcmFtZXRlcnMgPSB7CiAgICAgICAgdXNlcm5hbWVGcmFnbWVudDogbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgICAgIHJldHVybiBsaW5lLmluZGV4T2YoJ2E9aWNlLXVmcmFnOicpID09PSAwOwogICAgICAgIH0pWzBdLnN1YnN0cigxMiksCiAgICAgICAgcGFzc3dvcmQ6IGxpbmVzLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICAgICAgICByZXR1cm4gbGluZS5pbmRleE9mKCdhPWljZS1wd2Q6JykgPT09IDA7CiAgICAgICAgfSlbMF0uc3Vic3RyKDEwKQogICAgICB9OwogICAgICByZXR1cm4gaWNlUGFyYW1ldGVyczsKICAgIH07CgogICAgLy8gU2VyaWFsaXplcyBJQ0UgcGFyYW1ldGVycyB0byBTRFAuCiAgICBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMpIHsKICAgICAgcmV0dXJuICdhPWljZS11ZnJhZzonICsgcGFyYW1zLnVzZXJuYW1lRnJhZ21lbnQgKyAnXHJcbicgKwogICAgICAgICAgJ2E9aWNlLXB3ZDonICsgcGFyYW1zLnBhc3N3b3JkICsgJ1xyXG4nOwogICAgfTsKCiAgICAvLyBQYXJzZXMgdGhlIFNEUCBtZWRpYSBzZWN0aW9uIGFuZCByZXR1cm5zIFJUQ1J0cFBhcmFtZXRlcnMuCiAgICBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHsKICAgICAgdmFyIGRlc2NyaXB0aW9uID0gewogICAgICAgIGNvZGVjczogW10sCiAgICAgICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICAgICAgZmVjTWVjaGFuaXNtczogW10sCiAgICAgICAgcnRjcDogW10KICAgICAgfTsKICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICB2YXIgbWxpbmUgPSBsaW5lc1swXS5zcGxpdCgnICcpOwogICAgICBmb3IgKHZhciBpID0gMzsgaSA8IG1saW5lLmxlbmd0aDsgaSsrKSB7IC8vIGZpbmQgYWxsIGNvZGVjcyBmcm9tIG1saW5lWzMuLl0KICAgICAgICB2YXIgcHQgPSBtbGluZVtpXTsKICAgICAgICB2YXIgcnRwbWFwbGluZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0cG1hcDonICsgcHQgKyAnICcpWzBdOwogICAgICAgIGlmIChydHBtYXBsaW5lKSB7CiAgICAgICAgICB2YXIgY29kZWMgPSBTRFBVdGlscy5wYXJzZVJ0cE1hcChydHBtYXBsaW5lKTsKICAgICAgICAgIHZhciBmbXRwcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgICAgIG1lZGlhU2VjdGlvbiwgJ2E9Zm10cDonICsgcHQgKyAnICcpOwogICAgICAgICAgLy8gT25seSB0aGUgZmlyc3QgYT1mbXRwOjxwdD4gaXMgY29uc2lkZXJlZC4KICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnMgPSBmbXRwcy5sZW5ndGggPyBTRFBVdGlscy5wYXJzZUZtdHAoZm10cHNbMF0pIDoge307CiAgICAgICAgICBjb2RlYy5ydGNwRmVlZGJhY2sgPSBTRFBVdGlscy5tYXRjaFByZWZpeCgKICAgICAgICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnKQogICAgICAgICAgICAubWFwKFNEUFV0aWxzLnBhcnNlUnRjcEZiKTsKICAgICAgICAgIGRlc2NyaXB0aW9uLmNvZGVjcy5wdXNoKGNvZGVjKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gRklYTUU6IHBhcnNlIGhlYWRlckV4dGVuc2lvbnMsIGZlY01lY2hhbmlzbXMgYW5kIHJ0Y3AuCiAgICAgIHJldHVybiBkZXNjcmlwdGlvbjsKICAgIH07CgogICAgLy8gR2VuZXJhdGVzIHBhcnRzIG9mIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBkZXNjcmliaW5nIHRoZSBjYXBhYmlsaXRpZXMgLyBwYXJhbWV0ZXJzLgogICAgU0RQVXRpbHMud3JpdGVSdHBEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGtpbmQsIGNhcHMpIHsKICAgICAgdmFyIHNkcCA9ICcnOwoKICAgICAgLy8gQnVpbGQgdGhlIG1saW5lLgogICAgICBzZHAgKz0gJ209JyArIGtpbmQgKyAnICc7CiAgICAgIHNkcCArPSBjYXBzLmNvZGVjcy5sZW5ndGggPiAwID8gJzknIDogJzAnOyAvLyByZWplY3QgaWYgbm8gY29kZWNzLgogICAgICBzZHAgKz0gJyBVRFAvVExTL1JUUC9TQVZQRiAnOwogICAgICBzZHAgKz0gY2Fwcy5jb2RlY3MubWFwKGZ1bmN0aW9uKGNvZGVjKSB7CiAgICAgICAgaWYgKGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHJldHVybiBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvZGVjLnBheWxvYWRUeXBlOwogICAgICB9KS5qb2luKCcgJykgKyAnXHJcbic7CgogICAgICBzZHAgKz0gJ2M9SU4gSVA0IDAuMC4wLjBcclxuJzsKICAgICAgc2RwICs9ICdhPXJ0Y3A6OSBJTiBJUDQgMC4wLjAuMFxyXG4nOwoKICAgICAgLy8gQWRkIGE9cnRwbWFwIGxpbmVzIGZvciBlYWNoIGNvZGVjLiBBbHNvIGZtdHAgYW5kIHJ0Y3AtZmIuCiAgICAgIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgICAgICBzZHAgKz0gU0RQVXRpbHMud3JpdGVSdHBNYXAoY29kZWMpOwogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUZ0bXAoY29kZWMpOwogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZVJ0Y3BGYihjb2RlYyk7CiAgICAgIH0pOwogICAgICAvLyBGSVhNRTogYWRkIGhlYWRlckV4dGVuc2lvbnMsIGZlY01lY2hhbmlzbcWfIGFuZCBydGNwLgogICAgICBzZHAgKz0gJ2E9cnRjcC1tdXhcclxuJzsKICAgICAgcmV0dXJuIHNkcDsKICAgIH07CgogICAgU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgLy8gRklYTUU6IHNlc3MtaWQgc2hvdWxkIGJlIGFuIE5UUCB0aW1lc3RhbXAuCiAgICAgIHJldHVybiAndj0wXHJcbicgKwogICAgICAgICAgJ289dGhpc2lzYWRhcHRlcm9ydGMgODE2OTYzOTkxNTY0Njk0MzEzNyAyIElOIElQNCAxMjcuMC4wLjFcclxuJyArCiAgICAgICAgICAncz0tXHJcbicgKwogICAgICAgICAgJ3Q9MCAwXHJcbic7CiAgICB9OwoKICAgIFNEUFV0aWxzLndyaXRlTWVkaWFTZWN0aW9uID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsIGNhcHMsIHR5cGUsIHN0cmVhbSkgewogICAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVSdHBEZXNjcmlwdGlvbih0cmFuc2NlaXZlci5raW5kLCBjYXBzKTsKCiAgICAgIC8vIE1hcCBJQ0UgcGFyYW1ldGVycyAodWZyYWcsIHB3ZCkgdG8gU0RQLgogICAgICBzZHAgKz0gU0RQVXRpbHMud3JpdGVJY2VQYXJhbWV0ZXJzKAogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIuZ2V0TG9jYWxQYXJhbWV0ZXJzKCkpOwoKICAgICAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuCiAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUR0bHNQYXJhbWV0ZXJzKAogICAgICAgICAgdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydC5nZXRMb2NhbFBhcmFtZXRlcnMoKSwKICAgICAgICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiAnYWN0aXZlJyk7CgogICAgICBzZHAgKz0gJ2E9bWlkOicgKyB0cmFuc2NlaXZlci5taWQgKyAnXHJcbic7CgogICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7CiAgICAgICAgc2RwICs9ICdhPXNlbmRyZWN2XHJcbic7CiAgICAgIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgc2RwICs9ICdhPXNlbmRvbmx5XHJcbic7CiAgICAgIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgICAgICBzZHAgKz0gJ2E9cmVjdm9ubHlcclxuJzsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcclxuJzsKICAgICAgfQoKICAgICAgLy8gRklYTUU6IGZvciBSVFggdGhlcmUgbWlnaHQgYmUgbXVsdGlwbGUgU1NSQ3MuIE5vdCBpbXBsZW1lbnRlZCBpbiBFZGdlIHlldC4KICAgICAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikgewogICAgICAgIHZhciBtc2lkID0gJ21zaWQ6JyArIHN0cmVhbS5pZCArICcgJyArCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFNlbmRlci50cmFjay5pZCArICdcclxuJzsKICAgICAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7CiAgICAgICAgc2RwICs9ICdhPXNzcmM6JyArIHRyYW5zY2VpdmVyLnNlbmRTc3JjICsgJyAnICsgbXNpZDsKICAgICAgfQogICAgICAvLyBGSVhNRTogdGhpcyBzaG91bGQgYmUgd3JpdHRlbiBieSB3cml0ZVJ0cERlc2NyaXB0aW9uLgogICAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZFNzcmMgKyAnIGNuYW1lOicgKwogICAgICAgICAgbG9jYWxDTmFtZSArICdcclxuJzsKICAgICAgcmV0dXJuIHNkcDsKICAgIH07CgogICAgLy8gR2V0cyB0aGUgZGlyZWN0aW9uIGZyb20gdGhlIG1lZGlhU2VjdGlvbiBvciB0aGUgc2Vzc2lvbnBhcnQuCiAgICBTRFBVdGlscy5nZXREaXJlY3Rpb24gPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7CiAgICAgIC8vIExvb2sgZm9yIHNlbmRyZWN2LCBzZW5kb25seSwgcmVjdm9ubHksIGluYWN0aXZlLCBkZWZhdWx0IHRvIHNlbmRyZWN2LgogICAgICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzd2l0Y2ggKGxpbmVzW2ldKSB7CiAgICAgICAgICBjYXNlICdhPXNlbmRyZWN2JzoKICAgICAgICAgIGNhc2UgJ2E9c2VuZG9ubHknOgogICAgICAgICAgY2FzZSAnYT1yZWN2b25seSc6CiAgICAgICAgICBjYXNlICdhPWluYWN0aXZlJzoKICAgICAgICAgICAgcmV0dXJuIGxpbmVzW2ldLnN1YnN0cigyKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHNlc3Npb25wYXJ0KSB7CiAgICAgICAgcmV0dXJuIFNEUFV0aWxzLmdldERpcmVjdGlvbihzZXNzaW9ucGFydCk7CiAgICAgIH0KICAgICAgcmV0dXJuICdzZW5kcmVjdic7CiAgICB9OwoKICAgIC8vIE9SVEMgZGVmaW5lcyBhbiBSVENJY2VDYW5kaWRhdGUgb2JqZWN0IGJ1dCBubyBjb25zdHJ1Y3Rvci4KICAgIC8vIE5vdCBpbXBsZW1lbnRlZCBpbiBFZGdlLgogICAgaWYgKCF3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlKSB7CiAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSBmdW5jdGlvbihhcmdzKSB7CiAgICAgICAgcmV0dXJuIGFyZ3M7CiAgICAgIH07CiAgICB9CiAgICAvLyBPUlRDIGRvZXMgbm90IGhhdmUgYSBzZXNzaW9uIGRlc2NyaXB0aW9uIG9iamVjdCBidXQKICAgIC8vIG90aGVyIGJyb3dzZXJzIChpLmUuIENocm9tZSkgdGhhdCB3aWxsIHN1cHBvcnQgYm90aCBQQyBhbmQgT1JUQwogICAgLy8gaW4gdGhlIGZ1dHVyZSBtaWdodCBoYXZlIHRoaXMgZGVmaW5lZCBhbHJlYWR5LgogICAgaWYgKCF3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBmdW5jdGlvbihhcmdzKSB7CiAgICAgICAgcmV0dXJuIGFyZ3M7CiAgICAgIH07CiAgICB9CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIHRoaXMub25pY2VjYW5kaWRhdGUgPSBudWxsOwogICAgICB0aGlzLm9uYWRkc3RyZWFtID0gbnVsbDsKICAgICAgdGhpcy5vbnJlbW92ZXN0cmVhbSA9IG51bGw7CiAgICAgIHRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UgPSBudWxsOwogICAgICB0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWQgPSBudWxsOwogICAgICB0aGlzLm9uZGF0YWNoYW5uZWwgPSBudWxsOwoKICAgICAgdGhpcy5sb2NhbFN0cmVhbXMgPSBbXTsKICAgICAgdGhpcy5yZW1vdGVTdHJlYW1zID0gW107CiAgICAgIHRoaXMuZ2V0TG9jYWxTdHJlYW1zID0gZnVuY3Rpb24oKSB7IHJldHVybiBzZWxmLmxvY2FsU3RyZWFtczsgfTsKICAgICAgdGhpcy5nZXRSZW1vdGVTdHJlYW1zID0gZnVuY3Rpb24oKSB7IHJldHVybiBzZWxmLnJlbW90ZVN0cmVhbXM7IH07CgogICAgICB0aGlzLmxvY2FsRGVzY3JpcHRpb24gPSBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHsKICAgICAgICB0eXBlOiAnJywKICAgICAgICBzZHA6ICcnCiAgICAgIH0pOwogICAgICB0aGlzLnJlbW90ZURlc2NyaXB0aW9uID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJycsCiAgICAgICAgc2RwOiAnJwogICAgICB9KTsKICAgICAgdGhpcy5zaWduYWxpbmdTdGF0ZSA9ICdzdGFibGUnOwogICAgICB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnOwoKICAgICAgdGhpcy5pY2VPcHRpb25zID0gewogICAgICAgIGdhdGhlclBvbGljeTogJ2FsbCcsCiAgICAgICAgaWNlU2VydmVyczogW10KICAgICAgfTsKICAgICAgaWYgKGNvbmZpZyAmJiBjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgICAgc3dpdGNoIChjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgICAgICBjYXNlICdhbGwnOgogICAgICAgICAgY2FzZSAncmVsYXknOgogICAgICAgICAgICB0aGlzLmljZU9wdGlvbnMuZ2F0aGVyUG9saWN5ID0gY29uZmlnLmljZVRyYW5zcG9ydFBvbGljeTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdub25lJzoKICAgICAgICAgICAgLy8gRklYTUU6IHJlbW92ZSBvbmNlIGltcGxlbWVudGF0aW9uIGFuZCBzcGVjIGhhdmUgYWRkZWQgdGhpcy4KICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaWNlVHJhbnNwb3J0UG9saWN5ICJub25lIiBub3Qgc3VwcG9ydGVkJyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmljZVNlcnZlcnMpIHsKICAgICAgICAvLyBFZGdlIGRvZXMgbm90IGxpa2UKICAgICAgICAvLyAxKSBzdHVuOgogICAgICAgIC8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcAogICAgICAgIC8vIDMpIGFuIGFycmF5IG9mIHVybHMKICAgICAgICBjb25maWcuaWNlU2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uKHNlcnZlcikgewogICAgICAgICAgaWYgKHNlcnZlci51cmxzKSB7CiAgICAgICAgICAgIHZhciB1cmw7CiAgICAgICAgICAgIGlmICh0eXBlb2Yoc2VydmVyLnVybHMpID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgIHVybCA9IHNlcnZlci51cmxzOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHVybCA9IHNlcnZlci51cmxzWzBdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh1cmwuaW5kZXhPZigndHJhbnNwb3J0PXVkcCcpICE9PSAtMSkgewogICAgICAgICAgICAgIHNlbGYuaWNlU2VydmVycy5wdXNoKHsKICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBzZXJ2ZXIudXNlcm5hbWUsCiAgICAgICAgICAgICAgICBjcmVkZW50aWFsOiBzZXJ2ZXIuY3JlZGVudGlhbCwKICAgICAgICAgICAgICAgIHVybHM6IHVybAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIC8vIHBlci10cmFjayBpY2VHYXRoZXJzLCBpY2VUcmFuc3BvcnRzLCBkdGxzVHJhbnNwb3J0cywgcnRwU2VuZGVycywgLi4uCiAgICAgIC8vIGV2ZXJ5dGhpbmcgdGhhdCBpcyBuZWVkZWQgdG8gZGVzY3JpYmUgYSBTRFAgbS1saW5lLgogICAgICB0aGlzLnRyYW5zY2VpdmVycyA9IFtdOwoKICAgICAgLy8gc2luY2UgdGhlIGljZUdhdGhlcmVyIGlzIGN1cnJlbnRseSBjcmVhdGVkIGluIGNyZWF0ZU9mZmVyIGJ1dCB3ZQogICAgICAvLyBtdXN0IG5vdCBlbWl0IGNhbmRpZGF0ZXMgdW50aWwgYWZ0ZXIgc2V0TG9jYWxEZXNjcmlwdGlvbiB3ZSBidWZmZXIKICAgICAgLy8gdGhlbSBpbiB0aGlzIGFycmF5LgogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIgPSBbXTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fZW1pdEJ1ZmZlcmVkQ2FuZGlkYXRlcyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIC8vIEZJWE1FOiBuZWVkIHRvIGFwcGx5IGljZSBjYW5kaWRhdGVzIGluIGEgd2F5IHdoaWNoIGlzIGFzeW5jIGJ1dCBpbi1vcmRlcgogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIuZm9yRWFjaChmdW5jdGlvbihldmVudCkgewogICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICBzZWxmLm9uaWNlY2FuZGlkYXRlKGV2ZW50KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIgPSBbXTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgLy8gQ2xvbmUgaXMgbmVjZXNzYXJ5IGZvciBsb2NhbCBkZW1vcyBtb3N0bHksIGF0dGFjaGluZyBkaXJlY3RseQogICAgICAvLyB0byB0d28gZGlmZmVyZW50IHNlbmRlcnMgZG9lcyBub3Qgd29yayAoYnVpbGQgMTA1NDcpLgogICAgICB0aGlzLmxvY2FsU3RyZWFtcy5wdXNoKHN0cmVhbS5jbG9uZSgpKTsKICAgICAgdGhpcy5fbWF5YmVGaXJlTmVnb3RpYXRpb25OZWVkZWQoKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgdmFyIGlkeCA9IHRoaXMubG9jYWxTdHJlYW1zLmluZGV4T2Yoc3RyZWFtKTsKICAgICAgaWYgKGlkeCA+IC0xKSB7CiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXMuc3BsaWNlKGlkeCwgMSk7CiAgICAgICAgdGhpcy5fbWF5YmVGaXJlTmVnb3RpYXRpb25OZWVkZWQoKTsKICAgICAgfQogICAgfTsKCiAgICAvLyBEZXRlcm1pbmVzIHRoZSBpbnRlcnNlY3Rpb24gb2YgbG9jYWwgYW5kIHJlbW90ZSBjYXBhYmlsaXRpZXMuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9nZXRDb21tb25DYXBhYmlsaXRpZXMgPQogICAgICAgIGZ1bmN0aW9uKGxvY2FsQ2FwYWJpbGl0aWVzLCByZW1vdGVDYXBhYmlsaXRpZXMpIHsKICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHsKICAgICAgICBjb2RlY3M6IFtdLAogICAgICAgIGhlYWRlckV4dGVuc2lvbnM6IFtdLAogICAgICAgIGZlY01lY2hhbmlzbXM6IFtdCiAgICAgIH07CiAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzLmNvZGVjcy5mb3JFYWNoKGZ1bmN0aW9uKGxDb2RlYykgewogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIHJDb2RlYyA9IHJlbW90ZUNhcGFiaWxpdGllcy5jb2RlY3NbaV07CiAgICAgICAgICBpZiAobENvZGVjLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gckNvZGVjLm5hbWUudG9Mb3dlckNhc2UoKSAmJgogICAgICAgICAgICAgIGxDb2RlYy5jbG9ja1JhdGUgPT09IHJDb2RlYy5jbG9ja1JhdGUgJiYKICAgICAgICAgICAgICBsQ29kZWMubnVtQ2hhbm5lbHMgPT09IHJDb2RlYy5udW1DaGFubmVscykgewogICAgICAgICAgICAvLyBwdXNoIHJDb2RlYyBzbyB3ZSByZXBseSB3aXRoIG9mZmVyZXIgcGF5bG9hZCB0eXBlCiAgICAgICAgICAgIGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MucHVzaChyQ29kZWMpOwoKICAgICAgICAgICAgLy8gRklYTUU6IGFsc28gbmVlZCB0byBkZXRlcm1pbmUgaW50ZXJzZWN0aW9uIGJldHdlZW4KICAgICAgICAgICAgLy8gLnJ0Y3BGZWVkYmFjayBhbmQgLnBhcmFtZXRlcnMKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMuZm9yRWFjaChmdW5jdGlvbihsSGVhZGVyRXh0ZW5zaW9uKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIHJIZWFkZXJFeHRlbnNpb24gPSByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9uc1tpXTsKICAgICAgICAgIGlmIChsSGVhZGVyRXh0ZW5zaW9uLnVyaSA9PT0gckhlYWRlckV4dGVuc2lvbi51cmkpIHsKICAgICAgICAgICAgY29tbW9uQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMucHVzaChySGVhZGVyRXh0ZW5zaW9uKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8vIEZJWE1FOiBmZWNNZWNoYW5pc21zCiAgICAgIHJldHVybiBjb21tb25DYXBhYmlsaXRpZXM7CiAgICB9OwoKICAgIC8vIENyZWF0ZSBJQ0UgZ2F0aGVyZXIsIElDRSB0cmFuc3BvcnQgYW5kIERUTFMgdHJhbnNwb3J0LgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fY3JlYXRlSWNlQW5kRHRsc1RyYW5zcG9ydHMgPQogICAgICAgIGZ1bmN0aW9uKG1pZCwgc2RwTUxpbmVJbmRleCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHZhciBpY2VHYXRoZXJlciA9IG5ldyBSVENJY2VHYXRoZXJlcihzZWxmLmljZU9wdGlvbnMpOwogICAgICB2YXIgaWNlVHJhbnNwb3J0ID0gbmV3IFJUQ0ljZVRyYW5zcG9ydChpY2VHYXRoZXJlcik7CiAgICAgIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGUgPSBmdW5jdGlvbihldnQpIHsKICAgICAgICB2YXIgZXZlbnQgPSB7fTsKICAgICAgICBldmVudC5jYW5kaWRhdGUgPSB7c2RwTWlkOiBtaWQsIHNkcE1MaW5lSW5kZXg6IHNkcE1MaW5lSW5kZXh9OwoKICAgICAgICB2YXIgY2FuZCA9IGV2dC5jYW5kaWRhdGU7CiAgICAgICAgLy8gRWRnZSBlbWl0cyBhbiBlbXB0eSBvYmplY3QgZm9yIFJUQ0ljZUNhbmRpZGF0ZUNvbXBsZXRl4oClCiAgICAgICAgaWYgKCFjYW5kIHx8IE9iamVjdC5rZXlzKGNhbmQpLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgLy8gcG9seWZpbGwgc2luY2UgUlRDSWNlR2F0aGVyZXIuc3RhdGUgaXMgbm90IGltcGxlbWVudGVkIGluIEVkZ2UgMTA1NDcgeWV0LgogICAgICAgICAgaWYgKGljZUdhdGhlcmVyLnN0YXRlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnY29tcGxldGVkJzsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBFbWl0IGEgY2FuZGlkYXRlIHdpdGggdHlwZSBlbmRPZkNhbmRpZGF0ZXMgdG8gbWFrZSB0aGUgc2FtcGxlcyB3b3JrLgogICAgICAgICAgLy8gRWRnZSByZXF1aXJlcyBhZGRJY2VDYW5kaWRhdGUgd2l0aCB0aGlzIGVtcHR5IGNhbmRpZGF0ZSB0byBzdGFydCBjaGVja2luZy4KICAgICAgICAgIC8vIFRoZSByZWFsIHNvbHV0aW9uIGlzIHRvIHNpZ25hbCBlbmQtb2YtY2FuZGlkYXRlcyB0byB0aGUgb3RoZXIgc2lkZSB3aGVuCiAgICAgICAgICAvLyBnZXR0aW5nIHRoZSBudWxsIGNhbmRpZGF0ZSBidXQgc29tZSBhcHBzIChsaWtlIHRoZSBzYW1wbGVzKSBkb24ndCBkbyB0aGF0LgogICAgICAgICAgZXZlbnQuY2FuZGlkYXRlLmNhbmRpZGF0ZSA9CiAgICAgICAgICAgICAgJ2NhbmRpZGF0ZToxIDEgdWRwIDEgMC4wLjAuMCA5IHR5cCBlbmRPZkNhbmRpZGF0ZXMnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBSVENJY2VDYW5kaWRhdGUgZG9lc24ndCBoYXZlIGEgY29tcG9uZW50LCBuZWVkcyB0byBiZSBhZGRlZAogICAgICAgICAgY2FuZC5jb21wb25lbnQgPSBpY2VUcmFuc3BvcnQuY29tcG9uZW50ID09PSAnUlRDUCcgPyAyIDogMTsKICAgICAgICAgIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgPSBTRFBVdGlscy53cml0ZUNhbmRpZGF0ZShjYW5kKTsKICAgICAgICB9CgogICAgICAgIHZhciBjb21wbGV0ZSA9IHNlbGYudHJhbnNjZWl2ZXJzLmV2ZXJ5KGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgICByZXR1cm4gdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIgJiYKICAgICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2NvbXBsZXRlZCc7CiAgICAgICAgfSk7CiAgICAgICAgLy8gRklYTUU6IHVwZGF0ZSAubG9jYWxEZXNjcmlwdGlvbiB3aXRoIGNhbmRpZGF0ZSBhbmQgKHBvdGVudGlhbGx5KSBlbmQtb2YtY2FuZGlkYXRlcy4KICAgICAgICAvLyAgICAgVG8gbWFrZSB0aGlzIGhhcmRlciwgdGhlIGdhdGhlcmVyIG1pZ2h0IGVtaXQgY2FuZGlkYXRlcyBiZWZvcmUgbG9jYWxkZXNjcmlwdGlvbgogICAgICAgIC8vICAgICBpcyBzZXQuIFRvIG1ha2UgdGhpbmdzIHdvcnNlLCBnYXRoZXIuZ2V0TG9jYWxDYW5kaWRhdGVzIHN0aWxsIGVycm9ycyBpbgogICAgICAgIC8vICAgICBFZGdlIDEwNTQ3IHdoZW4gbm8gY2FuZGlkYXRlcyBoYXZlIGJlZW4gZ2F0aGVyZWQgeWV0LgoKICAgICAgICBpZiAoc2VsZi5vbmljZWNhbmRpZGF0ZSAhPT0gbnVsbCkgewogICAgICAgICAgLy8gRW1pdCBjYW5kaWRhdGUgaWYgbG9jYWxEZXNjcmlwdGlvbiBpcyBzZXQuCiAgICAgICAgICAvLyBBbHNvIGVtaXRzIG51bGwgY2FuZGlkYXRlIHdoZW4gYWxsIGdhdGhlcmVycyBhcmUgY29tcGxldGUuCiAgICAgICAgICBpZiAoc2VsZi5sb2NhbERlc2NyaXB0aW9uICYmIHNlbGYubG9jYWxEZXNjcmlwdGlvbi50eXBlID09PSAnJykgewogICAgICAgICAgICBzZWxmLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIucHVzaChldmVudCk7CiAgICAgICAgICAgIGlmIChjb21wbGV0ZSkgewogICAgICAgICAgICAgIHNlbGYuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlci5wdXNoKHt9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShldmVudCk7CiAgICAgICAgICAgIGlmIChjb21wbGV0ZSkgewogICAgICAgICAgICAgIHNlbGYub25pY2VjYW5kaWRhdGUoe30pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgICBpY2VUcmFuc3BvcnQub25pY2VzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHNlbGYuX3VwZGF0ZUNvbm5lY3Rpb25TdGF0ZSgpOwogICAgICB9OwoKICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSBuZXcgUlRDRHRsc1RyYW5zcG9ydChpY2VUcmFuc3BvcnQpOwogICAgICBkdGxzVHJhbnNwb3J0Lm9uZHRsc3N0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgIH07CiAgICAgIGR0bHNUcmFuc3BvcnQub25lcnJvciA9IGZ1bmN0aW9uKCkgewogICAgICAgIC8vIG9uZXJyb3IgZG9lcyBub3Qgc2V0IHN0YXRlIHRvIGZhaWxlZCBieSBpdHNlbGYuCiAgICAgICAgZHRsc1RyYW5zcG9ydC5zdGF0ZSA9ICdmYWlsZWQnOwogICAgICAgIHNlbGYuX3VwZGF0ZUNvbm5lY3Rpb25TdGF0ZSgpOwogICAgICB9OwoKICAgICAgcmV0dXJuIHsKICAgICAgICBpY2VHYXRoZXJlcjogaWNlR2F0aGVyZXIsCiAgICAgICAgaWNlVHJhbnNwb3J0OiBpY2VUcmFuc3BvcnQsCiAgICAgICAgZHRsc1RyYW5zcG9ydDogZHRsc1RyYW5zcG9ydAogICAgICB9OwogICAgfTsKCiAgICAvLyBTdGFydCB0aGUgUlRQIFNlbmRlciBhbmQgUmVjZWl2ZXIgZm9yIGEgdHJhbnNjZWl2ZXIuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl90cmFuc2NlaXZlID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsCiAgICAgICAgc2VuZCwgcmVjdikgewogICAgICB2YXIgcGFyYW1zID0gdGhpcy5fZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTsKICAgICAgaWYgKHNlbmQgJiYgdHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IFt7CiAgICAgICAgICBzc3JjOiB0cmFuc2NlaXZlci5zZW5kU3NyYwogICAgICAgIH1dOwogICAgICAgIHBhcmFtcy5ydGNwID0gewogICAgICAgICAgY25hbWU6IGxvY2FsQ05hbWUsCiAgICAgICAgICBzc3JjOiB0cmFuc2NlaXZlci5yZWN2U3NyYwogICAgICAgIH07CiAgICAgICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyLnNlbmQocGFyYW1zKTsKICAgICAgfQogICAgICBpZiAocmVjdiAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikgewogICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSBbewogICAgICAgICAgc3NyYzogdHJhbnNjZWl2ZXIucmVjdlNzcmMKICAgICAgICB9XTsKICAgICAgICBwYXJhbXMucnRjcCA9IHsKICAgICAgICAgIGNuYW1lOiB0cmFuc2NlaXZlci5jbmFtZSwKICAgICAgICAgIHNzcmM6IHRyYW5zY2VpdmVyLnNlbmRTc3JjCiAgICAgICAgfTsKICAgICAgICB0cmFuc2NlaXZlci5ydHBSZWNlaXZlci5yZWNlaXZlKHBhcmFtcyk7CiAgICAgIH0KICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRMb2NhbERlc2NyaXB0aW9uID0KICAgICAgICBmdW5jdGlvbihkZXNjcmlwdGlvbikgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInKSB7CiAgICAgICAgaWYgKCF0aGlzLl9wZW5kaW5nT2ZmZXIpIHsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy50cmFuc2NlaXZlcnMgPSB0aGlzLl9wZW5kaW5nT2ZmZXI7CiAgICAgICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ09mZmVyOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnYW5zd2VyJykgewogICAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoc2VsZi5yZW1vdGVEZXNjcmlwdGlvbi5zZHApOwogICAgICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7CiAgICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHsKICAgICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgICAgdmFyIGljZUdhdGhlcmVyID0gdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXI7CiAgICAgICAgICB2YXIgaWNlVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0OwogICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0OwogICAgICAgICAgdmFyIGxvY2FsQ2FwYWJpbGl0aWVzID0gdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXM7CiAgICAgICAgICB2YXIgcmVtb3RlQ2FwYWJpbGl0aWVzID0gdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzOwogICAgICAgICAgdmFyIHJlamVjdGVkID0gbWVkaWFTZWN0aW9uLnNwbGl0KCdcbicsIDEpWzBdCiAgICAgICAgICAgICAgLnNwbGl0KCcgJywgMilbMV0gPT09ICcwJzsKCiAgICAgICAgICBpZiAoIXJlamVjdGVkKSB7CiAgICAgICAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24sCiAgICAgICAgICAgICAgICBzZXNzaW9ucGFydCk7CiAgICAgICAgICAgIGljZVRyYW5zcG9ydC5zdGFydChpY2VHYXRoZXJlciwgcmVtb3RlSWNlUGFyYW1ldGVycywgJ2NvbnRyb2xsZWQnKTsKCiAgICAgICAgICAgIHZhciByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbiwKICAgICAgICAgICAgICBzZXNzaW9ucGFydCk7CiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhcnQocmVtb3RlRHRsc1BhcmFtZXRlcnMpOwoKICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGludGVyc2VjdGlvbiBvZiBjYXBhYmlsaXRpZXMuCiAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzZWxmLl9nZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXMpOwoKICAgICAgICAgICAgLy8gU3RhcnQgdGhlIFJUQ1J0cFNlbmRlci4gVGhlIFJUQ1J0cFJlY2VpdmVyIGZvciB0aGlzIHRyYW5zY2VpdmVyCiAgICAgICAgICAgIC8vIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBpbiBzZXRSZW1vdGVEZXNjcmlwdGlvbi4KICAgICAgICAgICAgc2VsZi5fdHJhbnNjZWl2ZSh0cmFuc2NlaXZlciwKICAgICAgICAgICAgICAgIHBhcmFtcy5jb2RlY3MubGVuZ3RoID4gMCwKICAgICAgICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy5sb2NhbERlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247CiAgICAgIHN3aXRjaCAoZGVzY3JpcHRpb24udHlwZSkgewogICAgICAgIGNhc2UgJ29mZmVyJzoKICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdoYXZlLWxvY2FsLW9mZmVyJyk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdhbnN3ZXInOgogICAgICAgICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ3N0YWJsZScpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3Vuc3VwcG9ydGVkIHR5cGUgIicgKyBkZXNjcmlwdGlvbi50eXBlICsgJyInKTsKICAgICAgfQoKICAgICAgLy8gSWYgYSBzdWNjZXNzIGNhbGxiYWNrIHdhcyBwcm92aWRlZCwgZW1pdCBJQ0UgY2FuZGlkYXRlcyBhZnRlciBpdCBoYXMgYmVlbgogICAgICAvLyBleGVjdXRlZC4gT3RoZXJ3aXNlLCBlbWl0IGNhbGxiYWNrIGFmdGVyIHRoZSBQcm9taXNlIGlzIHJlc29sdmVkLgogICAgICB2YXIgaGFzQ2FsbGJhY2sgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJgogICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbic7CiAgICAgIGlmIChoYXNDYWxsYmFjaykgewogICAgICAgIHZhciBjYiA9IGFyZ3VtZW50c1sxXTsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgIGNiKCk7CiAgICAgICAgICBzZWxmLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzKCk7CiAgICAgICAgfSwgMCk7CiAgICAgIH0KICAgICAgdmFyIHAgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgcC50aGVuKGZ1bmN0aW9uKCkgewogICAgICAgIGlmICghaGFzQ2FsbGJhY2spIHsKICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHNlbGYuX2VtaXRCdWZmZXJlZENhbmRpZGF0ZXMuYmluZChzZWxmKSwgMCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIHA7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb24gPQogICAgICAgIGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHN0cmVhbSA9IG5ldyBNZWRpYVN0cmVhbSgpOwogICAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7CiAgICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7CiAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICAgIHZhciBtbGluZSA9IGxpbmVzWzBdLnN1YnN0cigyKS5zcGxpdCgnICcpOwogICAgICAgIHZhciBraW5kID0gbWxpbmVbMF07CiAgICAgICAgdmFyIHJlamVjdGVkID0gbWxpbmVbMV0gPT09ICcwJzsKICAgICAgICB2YXIgZGlyZWN0aW9uID0gU0RQVXRpbHMuZ2V0RGlyZWN0aW9uKG1lZGlhU2VjdGlvbiwgc2Vzc2lvbnBhcnQpOwoKICAgICAgICB2YXIgdHJhbnNjZWl2ZXI7CiAgICAgICAgdmFyIGljZUdhdGhlcmVyOwogICAgICAgIHZhciBpY2VUcmFuc3BvcnQ7CiAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQ7CiAgICAgICAgdmFyIHJ0cFNlbmRlcjsKICAgICAgICB2YXIgcnRwUmVjZWl2ZXI7CiAgICAgICAgdmFyIHNlbmRTc3JjOwogICAgICAgIHZhciByZWN2U3NyYzsKICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXM7CgogICAgICAgIC8vIEZJWE1FOiBlbnN1cmUgdGhlIG1lZGlhU2VjdGlvbiBoYXMgcnRjcC1tdXggc2V0LgogICAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTsKICAgICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVyczsKICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnM7CiAgICAgICAgaWYgKCFyZWplY3RlZCkgewogICAgICAgICAgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMobWVkaWFTZWN0aW9uLAogICAgICAgICAgICAgIHNlc3Npb25wYXJ0KTsKICAgICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0RHRsc1BhcmFtZXRlcnMobWVkaWFTZWN0aW9uLAogICAgICAgICAgICAgIHNlc3Npb25wYXJ0KTsKICAgICAgICB9CiAgICAgICAgdmFyIG1pZCA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9bWlkOicpWzBdLnN1YnN0cig2KTsKCiAgICAgICAgdmFyIGNuYW1lOwogICAgICAgIC8vIEdldHMgdGhlIGZpcnN0IFNTUkMuIE5vdGUgdGhhdCB3aXRoIFJUWCB0aGVyZSBtaWdodCBiZSBtdWx0aXBsZSBTU1JDcy4KICAgICAgICB2YXIgcmVtb3RlU3NyYyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9c3NyYzonKQogICAgICAgICAgICAubWFwKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24ob2JqKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG9iai5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7CiAgICAgICAgICAgIH0pWzBdOwogICAgICAgIGlmIChyZW1vdGVTc3JjKSB7CiAgICAgICAgICByZWN2U3NyYyA9IHBhcnNlSW50KHJlbW90ZVNzcmMuc3NyYywgMTApOwogICAgICAgICAgY25hbWUgPSByZW1vdGVTc3JjLnZhbHVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdvZmZlcicpIHsKICAgICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi5fY3JlYXRlSWNlQW5kRHRsc1RyYW5zcG9ydHMobWlkLCBzZHBNTGluZUluZGV4KTsKCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IFJUQ1J0cFJlY2VpdmVyLmdldENhcGFiaWxpdGllcyhraW5kKTsKICAgICAgICAgIHNlbmRTc3JjID0gKDIgKiBzZHBNTGluZUluZGV4ICsgMikgKiAxMDAxOwoKICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CgogICAgICAgICAgLy8gRklYTUU6IG5vdCBjb3JyZWN0IHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIHN0cmVhbXMgYnV0IHRoYXQgaXMKICAgICAgICAgIC8vIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkIGluIHRoaXMgc2hpbS4KICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayhydHBSZWNlaXZlci50cmFjayk7CgogICAgICAgICAgLy8gRklYTUU6IGxvb2sgYXQgZGlyZWN0aW9uLgogICAgICAgICAgaWYgKHNlbGYubG9jYWxTdHJlYW1zLmxlbmd0aCA+IDAgJiYKICAgICAgICAgICAgICBzZWxmLmxvY2FsU3RyZWFtc1swXS5nZXRUcmFja3MoKS5sZW5ndGggPj0gc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAvLyBGSVhNRTogYWN0dWFsbHkgbW9yZSBjb21wbGljYXRlZCwgbmVlZHMgdG8gbWF0Y2ggdHlwZXMgZXRjCiAgICAgICAgICAgIHZhciBsb2NhbHRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0VHJhY2tzKClbc2RwTUxpbmVJbmRleF07CiAgICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIobG9jYWx0cmFjaywgdHJhbnNwb3J0cy5kdGxzVHJhbnNwb3J0KTsKICAgICAgICAgIH0KCiAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgaWNlR2F0aGVyZXI6IHRyYW5zcG9ydHMuaWNlR2F0aGVyZXIsCiAgICAgICAgICAgIGljZVRyYW5zcG9ydDogdHJhbnNwb3J0cy5pY2VUcmFuc3BvcnQsCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwKICAgICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXM6IGxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM6IHJlbW90ZUNhcGFiaWxpdGllcywKICAgICAgICAgICAgcnRwU2VuZGVyOiBydHBTZW5kZXIsCiAgICAgICAgICAgIHJ0cFJlY2VpdmVyOiBydHBSZWNlaXZlciwKICAgICAgICAgICAga2luZDoga2luZCwKICAgICAgICAgICAgbWlkOiBtaWQsCiAgICAgICAgICAgIGNuYW1lOiBjbmFtZSwKICAgICAgICAgICAgc2VuZFNzcmM6IHNlbmRTc3JjLAogICAgICAgICAgICByZWN2U3NyYzogcmVjdlNzcmMKICAgICAgICAgIH07CiAgICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwUmVjZWl2ZXIgbm93LiBUaGUgUlRQU2VuZGVyIGlzIHN0YXJ0ZWQgaW4gc2V0TG9jYWxEZXNjcmlwdGlvbi4KICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUoc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0sCiAgICAgICAgICAgICAgZmFsc2UsCiAgICAgICAgICAgICAgZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IGRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jyk7CiAgICAgICAgfSBlbHNlIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnYW5zd2VyJyAmJiAhcmVqZWN0ZWQpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyID0gc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF07CiAgICAgICAgICBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgaWNlVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0OwogICAgICAgICAgZHRsc1RyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQ7CiAgICAgICAgICBydHBTZW5kZXIgPSB0cmFuc2NlaXZlci5ydHBTZW5kZXI7CiAgICAgICAgICBydHBSZWNlaXZlciA9IHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyOwogICAgICAgICAgc2VuZFNzcmMgPSB0cmFuc2NlaXZlci5zZW5kU3NyYzsKICAgICAgICAgIC8vcmVjdlNzcmMgPSB0cmFuc2NlaXZlci5yZWN2U3NyYzsKICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzID0gdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXM7CgogICAgICAgICAgc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0ucmVjdlNzcmMgPSByZWN2U3NyYzsKICAgICAgICAgIHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLnJlbW90ZUNhcGFiaWxpdGllcyA9CiAgICAgICAgICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzOwogICAgICAgICAgc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uY25hbWUgPSBjbmFtZTsKCiAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsICdjb250cm9sbGluZycpOwogICAgICAgICAgZHRsc1RyYW5zcG9ydC5zdGFydChyZW1vdGVEdGxzUGFyYW1ldGVycyk7CgogICAgICAgICAgc2VsZi5fdHJhbnNjZWl2ZSh0cmFuc2NlaXZlciwKICAgICAgICAgICAgICBkaXJlY3Rpb24gPT09ICdzZW5kcmVjdicgfHwgZGlyZWN0aW9uID09PSAncmVjdm9ubHknLAogICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpOwoKICAgICAgICAgIGlmIChydHBSZWNlaXZlciAmJgogICAgICAgICAgICAgIChkaXJlY3Rpb24gPT09ICdzZW5kcmVjdicgfHwgZGlyZWN0aW9uID09PSAnc2VuZG9ubHknKSkgewogICAgICAgICAgICBzdHJlYW0uYWRkVHJhY2socnRwUmVjZWl2ZXIudHJhY2spOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRklYTUU6IGFjdHVhbGx5IHRoZSByZWNlaXZlciBzaG91bGQgYmUgY3JlYXRlZCBsYXRlci4KICAgICAgICAgICAgZGVsZXRlIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CgogICAgICB0aGlzLnJlbW90ZURlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247CiAgICAgIHN3aXRjaCAoZGVzY3JpcHRpb24udHlwZSkgewogICAgICAgIGNhc2UgJ29mZmVyJzoKICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdoYXZlLXJlbW90ZS1vZmZlcicpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnYW5zd2VyJzoKICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdzdGFibGUnKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCd1bnN1cHBvcnRlZCB0eXBlICInICsgZGVzY3JpcHRpb24udHlwZSArICciJyk7CiAgICAgIH0KICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHNlbGYub25hZGRzdHJlYW0gIT09IG51bGwgJiYgc3RyZWFtLmdldFRyYWNrcygpLmxlbmd0aCkgewogICAgICAgICAgc2VsZi5yZW1vdGVTdHJlYW1zLnB1c2goc3RyZWFtKTsKICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICBzZWxmLm9uYWRkc3RyZWFtKHtzdHJlYW06IHN0cmVhbX0pOwogICAgICAgICAgfSwgMCk7CiAgICAgICAgfQogICAgICB9LCAwKTsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMV0sIDApOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnRyYW5zY2VpdmVycy5mb3JFYWNoKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgLyogbm90IHlldAogICAgICAgIGlmICh0cmFuc2NlaXZlci5pY2VHYXRoZXJlcikgewogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIuY2xvc2UoKTsKICAgICAgICB9CiAgICAgICAgKi8KICAgICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0KSB7CiAgICAgICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydCkgewogICAgICAgICAgdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydC5zdG9wKCk7CiAgICAgICAgfQogICAgICAgIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFNlbmRlci5zdG9wKCk7CiAgICAgICAgfQogICAgICAgIGlmICh0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikgewogICAgICAgICAgdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIC8vIEZJWE1FOiBjbGVhbiB1cCB0cmFja3MsIGxvY2FsIHN0cmVhbXMsIHJlbW90ZSBzdHJlYW1zLCBldGMKICAgICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ2Nsb3NlZCcpOwogICAgfTsKCiAgICAvLyBVcGRhdGUgdGhlIHNpZ25hbGluZyBzdGF0ZS4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlID0KICAgICAgICBmdW5jdGlvbihuZXdTdGF0ZSkgewogICAgICB0aGlzLnNpZ25hbGluZ1N0YXRlID0gbmV3U3RhdGU7CiAgICAgIGlmICh0aGlzLm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2UgIT09IG51bGwpIHsKICAgICAgICB0aGlzLm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2UoKTsKICAgICAgfQogICAgfTsKCiAgICAvLyBEZXRlcm1pbmUgd2hldGhlciB0byBmaXJlIHRoZSBuZWdvdGlhdGlvbm5lZWRlZCBldmVudC4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkID0KICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgLy8gRmlyZSBhd2F5IChmb3Igbm93KS4KICAgICAgaWYgKHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCAhPT0gbnVsbCkgewogICAgICAgIHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCgpOwogICAgICB9CiAgICB9OwoKICAgIC8vIFVwZGF0ZSB0aGUgY29ubmVjdGlvbiBzdGF0ZS4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX3VwZGF0ZUNvbm5lY3Rpb25TdGF0ZSA9CiAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIG5ld1N0YXRlOwogICAgICB2YXIgc3RhdGVzID0gewogICAgICAgICduZXcnOiAwLAogICAgICAgIGNsb3NlZDogMCwKICAgICAgICBjb25uZWN0aW5nOiAwLAogICAgICAgIGNoZWNraW5nOiAwLAogICAgICAgIGNvbm5lY3RlZDogMCwKICAgICAgICBjb21wbGV0ZWQ6IDAsCiAgICAgICAgZmFpbGVkOiAwCiAgICAgIH07CiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICB9KTsKICAgICAgLy8gSUNFVHJhbnNwb3J0LmNvbXBsZXRlZCBhbmQgY29ubmVjdGVkIGFyZSB0aGUgc2FtZSBmb3IgdGhpcyBwdXJwb3NlLgogICAgICBzdGF0ZXMuY29ubmVjdGVkICs9IHN0YXRlcy5jb21wbGV0ZWQ7CgogICAgICBuZXdTdGF0ZSA9ICduZXcnOwogICAgICBpZiAoc3RhdGVzLmZhaWxlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdmYWlsZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0aW5nID4gMCB8fCBzdGF0ZXMuY2hlY2tpbmcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGluZyc7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdkaXNjb25uZWN0ZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5uZXcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnbmV3JzsKICAgICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGluZyA+IDAgfHwgc3RhdGVzLmNvbXBsZXRlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdjb25uZWN0ZWQnOwogICAgICB9CgogICAgICBpZiAobmV3U3RhdGUgIT09IHNlbGYuaWNlQ29ubmVjdGlvblN0YXRlKSB7CiAgICAgICAgc2VsZi5pY2VDb25uZWN0aW9uU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICBpZiAodGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSgpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZU9mZmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgaWYgKHRoaXMuX3BlbmRpbmdPZmZlcikgewogICAgICAgIHRocm93IG5ldyBFcnJvcignY3JlYXRlT2ZmZXIgY2FsbGVkIHdoaWxlIHRoZXJlIGlzIGEgcGVuZGluZyBvZmZlci4nKTsKICAgICAgfQogICAgICB2YXIgb2ZmZXJPcHRpb25zOwogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzBdICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgb2ZmZXJPcHRpb25zID0gYXJndW1lbnRzWzBdOwogICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMpIHsKICAgICAgICBvZmZlck9wdGlvbnMgPSBhcmd1bWVudHNbMl07CiAgICAgIH0KCiAgICAgIHZhciB0cmFja3MgPSBbXTsKICAgICAgdmFyIG51bUF1ZGlvVHJhY2tzID0gMDsKICAgICAgdmFyIG51bVZpZGVvVHJhY2tzID0gMDsKICAgICAgLy8gRGVmYXVsdCB0byBzZW5kcmVjdi4KICAgICAgaWYgKHRoaXMubG9jYWxTdHJlYW1zLmxlbmd0aCkgewogICAgICAgIG51bUF1ZGlvVHJhY2tzID0gdGhpcy5sb2NhbFN0cmVhbXNbMF0uZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGg7CiAgICAgICAgbnVtVmlkZW9UcmFja3MgPSB0aGlzLmxvY2FsU3RyZWFtc1swXS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aDsKICAgICAgfQogICAgICAvLyBEZXRlcm1pbmUgbnVtYmVyIG9mIGF1ZGlvIGFuZCB2aWRlbyB0cmFja3Mgd2UgbmVlZCB0byBzZW5kL3JlY3YuCiAgICAgIGlmIChvZmZlck9wdGlvbnMpIHsKICAgICAgICAvLyBSZWplY3QgQ2hyb21lIGxlZ2FjeSBjb25zdHJhaW50cy4KICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm1hbmRhdG9yeSB8fCBvZmZlck9wdGlvbnMub3B0aW9uYWwpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoCiAgICAgICAgICAgICAgJ0xlZ2FjeSBtYW5kYXRvcnkvb3B0aW9uYWwgY29uc3RyYWludHMgbm90IHN1cHBvcnRlZC4nKTsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZUF1ZGlvICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID0gb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW87CiAgICAgICAgfQogICAgICAgIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBudW1WaWRlb1RyYWNrcyA9IG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy5sb2NhbFN0cmVhbXMubGVuZ3RoKSB7CiAgICAgICAgLy8gUHVzaCBsb2NhbCBzdHJlYW1zLgogICAgICAgIHRoaXMubG9jYWxTdHJlYW1zWzBdLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHsKICAgICAgICAgIHRyYWNrcy5wdXNoKHsKICAgICAgICAgICAga2luZDogdHJhY2sua2luZCwKICAgICAgICAgICAgdHJhY2s6IHRyYWNrLAogICAgICAgICAgICB3YW50UmVjZWl2ZTogdHJhY2sua2luZCA9PT0gJ2F1ZGlvJyA/CiAgICAgICAgICAgICAgICBudW1BdWRpb1RyYWNrcyA+IDAgOiBudW1WaWRlb1RyYWNrcyA+IDAKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKHRyYWNrLmtpbmQgPT09ICdhdWRpbycpIHsKICAgICAgICAgICAgbnVtQXVkaW9UcmFja3MtLTsKICAgICAgICAgIH0gZWxzZSBpZiAodHJhY2sua2luZCA9PT0gJ3ZpZGVvJykgewogICAgICAgICAgICBudW1WaWRlb1RyYWNrcy0tOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICAgIC8vIENyZWF0ZSBNLWxpbmVzIGZvciByZWN2b25seSBzdHJlYW1zLgogICAgICB3aGlsZSAobnVtQXVkaW9UcmFja3MgPiAwIHx8IG51bVZpZGVvVHJhY2tzID4gMCkgewogICAgICAgIGlmIChudW1BdWRpb1RyYWNrcyA+IDApIHsKICAgICAgICAgIHRyYWNrcy5wdXNoKHsKICAgICAgICAgICAga2luZDogJ2F1ZGlvJywKICAgICAgICAgICAgd2FudFJlY2VpdmU6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgbnVtQXVkaW9UcmFja3MtLTsKICAgICAgICB9CiAgICAgICAgaWYgKG51bVZpZGVvVHJhY2tzID4gMCkgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiAndmlkZW8nLAogICAgICAgICAgICB3YW50UmVjZWl2ZTogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBudW1WaWRlb1RyYWNrcy0tOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlU2Vzc2lvbkJvaWxlcnBsYXRlKCk7CiAgICAgIHZhciB0cmFuc2NlaXZlcnMgPSBbXTsKICAgICAgdHJhY2tzLmZvckVhY2goZnVuY3Rpb24obWxpbmUsIHNkcE1MaW5lSW5kZXgpIHsKICAgICAgICAvLyBGb3IgZWFjaCB0cmFjaywgY3JlYXRlIGFuIGljZSBnYXRoZXJlciwgaWNlIHRyYW5zcG9ydCwgZHRscyB0cmFuc3BvcnQsCiAgICAgICAgLy8gcG90ZW50aWFsbHkgcnRwc2VuZGVyIGFuZCBydHByZWNlaXZlci4KICAgICAgICB2YXIgdHJhY2sgPSBtbGluZS50cmFjazsKICAgICAgICB2YXIga2luZCA9IG1saW5lLmtpbmQ7CiAgICAgICAgdmFyIG1pZCA9IGdlbmVyYXRlSWRlbnRpZmllcigpOwoKICAgICAgICB2YXIgdHJhbnNwb3J0cyA9IHNlbGYuX2NyZWF0ZUljZUFuZER0bHNUcmFuc3BvcnRzKG1pZCwgc2RwTUxpbmVJbmRleCk7CgogICAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcyA9IFJUQ1J0cFNlbmRlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7CiAgICAgICAgdmFyIHJ0cFNlbmRlcjsKICAgICAgICB2YXIgcnRwUmVjZWl2ZXI7CgogICAgICAgIC8vIGdlbmVyYXRlIGFuIHNzcmMgbm93LCB0byBiZSB1c2VkIGxhdGVyIGluIHJ0cFNlbmRlci5zZW5kCiAgICAgICAgdmFyIHNlbmRTc3JjID0gKDIgKiBzZHBNTGluZUluZGV4ICsgMSkgKiAxMDAxOwogICAgICAgIGlmICh0cmFjaykgewogICAgICAgICAgcnRwU2VuZGVyID0gbmV3IFJUQ1J0cFNlbmRlcih0cmFjaywgdHJhbnNwb3J0cy5kdGxzVHJhbnNwb3J0KTsKICAgICAgICB9CgogICAgICAgIGlmIChtbGluZS53YW50UmVjZWl2ZSkgewogICAgICAgICAgcnRwUmVjZWl2ZXIgPSBuZXcgUlRDUnRwUmVjZWl2ZXIodHJhbnNwb3J0cy5kdGxzVHJhbnNwb3J0LCBraW5kKTsKICAgICAgICB9CgogICAgICAgIHRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc3BvcnRzLmljZUdhdGhlcmVyLAogICAgICAgICAgaWNlVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmljZVRyYW5zcG9ydCwKICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwKICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzOiBsb2NhbENhcGFiaWxpdGllcywKICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllczogbnVsbCwKICAgICAgICAgIHJ0cFNlbmRlcjogcnRwU2VuZGVyLAogICAgICAgICAgcnRwUmVjZWl2ZXI6IHJ0cFJlY2VpdmVyLAogICAgICAgICAga2luZDoga2luZCwKICAgICAgICAgIG1pZDogbWlkLAogICAgICAgICAgc2VuZFNzcmM6IHNlbmRTc3JjLAogICAgICAgICAgcmVjdlNzcmM6IG51bGwKICAgICAgICB9OwogICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTsKICAgICAgICBzZHAgKz0gU0RQVXRpbHMud3JpdGVNZWRpYVNlY3Rpb24odHJhbnNjZWl2ZXIsCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLCAnb2ZmZXInLCBzZWxmLmxvY2FsU3RyZWFtc1swXSk7CiAgICAgIH0pOwoKICAgICAgdGhpcy5fcGVuZGluZ09mZmVyID0gdHJhbnNjZWl2ZXJzOwogICAgICB2YXIgZGVzYyA9IG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oewogICAgICAgIHR5cGU6ICdvZmZlcicsCiAgICAgICAgc2RwOiBzZHAKICAgICAgfSk7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMF0sIDAsIGRlc2MpOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlQW5zd2VyID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIGFuc3dlck9wdGlvbnM7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBhbnN3ZXJPcHRpb25zID0gYXJndW1lbnRzWzBdOwogICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMpIHsKICAgICAgICBhbnN3ZXJPcHRpb25zID0gYXJndW1lbnRzWzJdOwogICAgICB9CgogICAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUoKTsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIC8vIENhbGN1bGF0ZSBpbnRlcnNlY3Rpb24gb2YgY2FwYWJpbGl0aWVzLgogICAgICAgIHZhciBjb21tb25DYXBhYmlsaXRpZXMgPSBzZWxmLl9nZXRDb21tb25DYXBhYmlsaXRpZXMoCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXMpOwoKICAgICAgICBzZHAgKz0gU0RQVXRpbHMud3JpdGVNZWRpYVNlY3Rpb24odHJhbnNjZWl2ZXIsIGNvbW1vbkNhcGFiaWxpdGllcywKICAgICAgICAgICAgJ2Fuc3dlcicsIHNlbGYubG9jYWxTdHJlYW1zWzBdKTsKICAgICAgfSk7CgogICAgICB2YXIgZGVzYyA9IG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oewogICAgICAgIHR5cGU6ICdhbnN3ZXInLAogICAgICAgIHNkcDogc2RwCiAgICAgIH0pOwogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCAmJiB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoYXJndW1lbnRzWzBdLCAwLCBkZXNjKTsKICAgICAgfQogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGRlc2MpOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKGNhbmRpZGF0ZSkgewogICAgICB2YXIgbUxpbmVJbmRleCA9IGNhbmRpZGF0ZS5zZHBNTGluZUluZGV4OwogICAgICBpZiAoY2FuZGlkYXRlLnNkcE1pZCkgewogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmICh0aGlzLnRyYW5zY2VpdmVyc1tpXS5taWQgPT09IGNhbmRpZGF0ZS5zZHBNaWQpIHsKICAgICAgICAgICAgbUxpbmVJbmRleCA9IGk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICB2YXIgdHJhbnNjZWl2ZXIgPSB0aGlzLnRyYW5zY2VpdmVyc1ttTGluZUluZGV4XTsKICAgICAgaWYgKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgdmFyIGNhbmQgPSBPYmplY3Qua2V5cyhjYW5kaWRhdGUuY2FuZGlkYXRlKS5sZW5ndGggPiAwID8KICAgICAgICAgICAgU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUoY2FuZGlkYXRlLmNhbmRpZGF0ZSkgOiB7fTsKICAgICAgICAvLyBJZ25vcmUgQ2hyb21lJ3MgaW52YWxpZCBjYW5kaWRhdGVzIHNpbmNlIEVkZ2UgZG9lcyBub3QgbGlrZSB0aGVtLgogICAgICAgIGlmIChjYW5kLnByb3RvY29sID09PSAndGNwJyAmJiBjYW5kLnBvcnQgPT09IDApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gSWdub3JlIFJUQ1AgY2FuZGlkYXRlcywgd2UgYXNzdW1lIFJUQ1AtTVVYLgogICAgICAgIGlmIChjYW5kLmNvbXBvbmVudCAhPT0gJzEnKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vIEEgZGlydHkgaGFjayB0byBtYWtlIHNhbXBsZXMgd29yay4KICAgICAgICBpZiAoY2FuZC50eXBlID09PSAnZW5kT2ZDYW5kaWRhdGVzJykgewogICAgICAgICAgY2FuZCA9IHt9OwogICAgICAgIH0KICAgICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuYWRkUmVtb3RlQ2FuZGlkYXRlKGNhbmQpOwogICAgICB9CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoYXJndW1lbnRzWzFdLCAwKTsKICAgICAgfQogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHByb21pc2VzID0gW107CiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICBbJ3J0cFNlbmRlcicsICdydHBSZWNlaXZlcicsICdpY2VHYXRoZXJlcicsICdpY2VUcmFuc3BvcnQnLAogICAgICAgICAgICAnZHRsc1RyYW5zcG9ydCddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICBpZiAodHJhbnNjZWl2ZXJbbWV0aG9kXSkgewogICAgICAgICAgICBwcm9taXNlcy5wdXNoKHRyYW5zY2VpdmVyW21ldGhvZF0uZ2V0U3RhdHMoKSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB2YXIgY2IgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICBhcmd1bWVudHNbMV07CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgdmFyIHJlc3VsdHMgPSB7fTsKICAgICAgICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbihyZXMpIHsKICAgICAgICAgIHJlcy5mb3JFYWNoKGZ1bmN0aW9uKHJlc3VsdCkgewogICAgICAgICAgICBPYmplY3Qua2V5cyhyZXN1bHQpLmZvckVhY2goZnVuY3Rpb24oaWQpIHsKICAgICAgICAgICAgICByZXN1bHRzW2lkXSA9IHJlc3VsdFtpZF07CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoY2IpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2IsIDAsIHJlc3VsdHMpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KfSBlbHNlIHsKICB3ZWJydGNVdGlscy5sb2coJ0Jyb3dzZXIgZG9lcyBub3QgYXBwZWFyIHRvIGJlIFdlYlJUQy1jYXBhYmxlJyk7Cn0KCi8vIFBvbHlmaWxsIG9udHJhY2sgb24gYnJvd3NlcnMgdGhhdCBkb24ndCB5ZXQgaGF2ZSBpdAppZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSkgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHsKICAgIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLl9vbnRyYWNrOyB9LAogICAgc2V0OiBmdW5jdGlvbihmKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgaWYgKHRoaXMuX29udHJhY2spIHsKICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayk7CiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSk7CiAgICAgIH0KICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2sgPSBmKTsKICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICBpZiAod2VicnRjRGV0ZWN0ZWRCcm93c2VyID09PSAnY2hyb21lJykgewogICAgICAgICAgLy8gb25hZGRzdHJlYW0gZG9lcyBub3QgZmlyZSB3aGVuIGEgdHJhY2sgaXMgYWRkZWQgdG8gYW4gZXhpc3Rpbmcgc3RyZWFtLgogICAgICAgICAgLy8gYnV0IHN0cmVhbS5vbmFkZHRyYWNrIGlzIGltcGxlbWVudGVkIHNvIHdlIHVzZSB0aOOBn3QKICAgICAgICAgIGUuc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHRyYWNrJywgZnVuY3Rpb24odGUpIHsKICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpOwogICAgICAgICAgICBldmVudC50cmFjayA9IHRlLnRyYWNrOwogICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHt0cmFjazogdGUudHJhY2t9OwogICAgICAgICAgICBldmVudC5zdHJlYW1zID0gW2Uuc3RyZWFtXTsKICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBlLnN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7CiAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7CiAgICAgICAgICBldmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgZXZlbnQucmVjZWl2ZXIgPSB7dHJhY2s6IHRyYWNrfTsKICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICB9LmJpbmQodGhpcykpOwogICAgICB9LmJpbmQodGhpcykpOwogICAgfQogIH0pOwp9CgovLyBSZXR1cm5zIHRoZSByZXN1bHQgb2YgZ2V0VXNlck1lZGlhIGFzIGEgUHJvbWlzZS4KZnVuY3Rpb24gcmVxdWVzdFVzZXJNZWRpYShjb25zdHJhaW50cykgewogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKICAgIGdldFVzZXJNZWRpYShjb25zdHJhaW50cywgcmVzb2x2ZSwgcmVqZWN0KTsKICB9KTsKfQoKdmFyIHdlYnJ0Y1Rlc3RpbmcgPSB7fTsKdHJ5IHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2VicnRjVGVzdGluZywgJ3ZlcnNpb24nLCB7CiAgICBzZXQ6IGZ1bmN0aW9uKHZlcnNpb24pIHsKICAgICAgd2VicnRjRGV0ZWN0ZWRWZXJzaW9uID0gdmVyc2lvbjsKICAgIH0KICB9KTsKfSBjYXRjaCAoZSkge30KCmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykgewogIHZhciBSVENQZWVyQ29ubmVjdGlvbjsKICB2YXIgUlRDSWNlQ2FuZGlkYXRlOwogIHZhciBSVENTZXNzaW9uRGVzY3JpcHRpb247CiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7CiAgICBSVENQZWVyQ29ubmVjdGlvbiA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbjsKICAgIFJUQ0ljZUNhbmRpZGF0ZSA9IHdpbmRvdy5SVENJY2VDYW5kaWRhdGU7CiAgICBSVENTZXNzaW9uRGVzY3JpcHRpb24gPSB3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uOwogIH0KICBtb2R1bGUuZXhwb3J0cyA9IHsKICAgIFJUQ1BlZXJDb25uZWN0aW9uOiBSVENQZWVyQ29ubmVjdGlvbiwKICAgIFJUQ0ljZUNhbmRpZGF0ZTogUlRDSWNlQ2FuZGlkYXRlLAogICAgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uOiBSVENTZXNzaW9uRGVzY3JpcHRpb24sCiAgICBnZXRVc2VyTWVkaWE6IGdldFVzZXJNZWRpYSwKICAgIGF0dGFjaE1lZGlhU3RyZWFtOiBhdHRhY2hNZWRpYVN0cmVhbSwKICAgIHJlYXR0YWNoTWVkaWFTdHJlYW06IHJlYXR0YWNoTWVkaWFTdHJlYW0sCiAgICB3ZWJydGNEZXRlY3RlZEJyb3dzZXI6IHdlYnJ0Y0RldGVjdGVkQnJvd3NlciwKICAgIHdlYnJ0Y0RldGVjdGVkVmVyc2lvbjogd2VicnRjRGV0ZWN0ZWRWZXJzaW9uLAogICAgd2VicnRjTWluaW11bVZlcnNpb246IHdlYnJ0Y01pbmltdW1WZXJzaW9uLAogICAgd2VicnRjVGVzdGluZzogd2VicnRjVGVzdGluZywKICAgIHdlYnJ0Y1V0aWxzOiB3ZWJydGNVdGlscwogICAgLy9yZXF1ZXN0VXNlck1lZGlhOiBub3QgZXhwb3NlZCBvbiBwdXJwb3NlLgogICAgLy90cmFjZTogbm90IGV4cG9zZWQgb24gcHVycG9zZS4KICB9Owp9IGVsc2UgaWYgKCh0eXBlb2YgcmVxdWlyZSA9PT0gJ2Z1bmN0aW9uJykgJiYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicpKSB7CiAgLy8gRXhwb3NlIG9iamVjdHMgYW5kIGZ1bmN0aW9ucyB3aGVuIFJlcXVpcmVKUyBpcyBkb2luZyB0aGUgbG9hZGluZy4KICBkZWZpbmUoW10sIGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgUlRDUGVlckNvbm5lY3Rpb246IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwKICAgICAgUlRDSWNlQ2FuZGlkYXRlOiB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlLAogICAgICBSVENTZXNzaW9uRGVzY3JpcHRpb246IHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24sCiAgICAgIGdldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhLAogICAgICBhdHRhY2hNZWRpYVN0cmVhbTogYXR0YWNoTWVkaWFTdHJlYW0sCiAgICAgIHJlYXR0YWNoTWVkaWFTdHJlYW06IHJlYXR0YWNoTWVkaWFTdHJlYW0sCiAgICAgIHdlYnJ0Y0RldGVjdGVkQnJvd3Nlcjogd2VicnRjRGV0ZWN0ZWRCcm93c2VyLAogICAgICB3ZWJydGNEZXRlY3RlZFZlcnNpb246IHdlYnJ0Y0RldGVjdGVkVmVyc2lvbiwKICAgICAgd2VicnRjTWluaW11bVZlcnNpb246IHdlYnJ0Y01pbmltdW1WZXJzaW9uLAogICAgICB3ZWJydGNUZXN0aW5nOiB3ZWJydGNUZXN0aW5nLAogICAgICB3ZWJydGNVdGlsczogd2VicnRjVXRpbHMKICAgICAgLy9yZXF1ZXN0VXNlck1lZGlhOiBub3QgZXhwb3NlZCBvbiBwdXJwb3NlLgogICAgICAvL3RyYWNlOiBub3QgZXhwb3NlZCBvbiBwdXJwb3NlLgogICAgfTsKICB9KTsKfQoKfSx7fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JztPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywiX19lc01vZHVsZSIse3ZhbHVlOnRydWV9KTt2YXIgX2NyZWF0ZUNsYXNzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQscHJvcHMpe2Zvcih2YXIgaT0wO2k8cHJvcHMubGVuZ3RoO2krKyl7dmFyIGRlc2NyaXB0b3I9cHJvcHNbaV07ZGVzY3JpcHRvci5lbnVtZXJhYmxlPWRlc2NyaXB0b3IuZW51bWVyYWJsZXx8ZmFsc2U7ZGVzY3JpcHRvci5jb25maWd1cmFibGU9dHJ1ZTtpZigidmFsdWUiIGluIGRlc2NyaXB0b3IpZGVzY3JpcHRvci53cml0YWJsZT10cnVlO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsZGVzY3JpcHRvci5rZXksZGVzY3JpcHRvcik7fX1yZXR1cm4gZnVuY3Rpb24oQ29uc3RydWN0b3IscHJvdG9Qcm9wcyxzdGF0aWNQcm9wcyl7aWYocHJvdG9Qcm9wcylkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSxwcm90b1Byb3BzKTtpZihzdGF0aWNQcm9wcylkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLHN0YXRpY1Byb3BzKTtyZXR1cm4gQ29uc3RydWN0b3I7fTt9KCk7cmVxdWlyZSgnd2VicnRjLWFkYXB0ZXItdGVzdCcpO3ZhciBfRXZlbnRFbWl0dGVyMj1yZXF1aXJlKCcuLi91dGlscy9FdmVudEVtaXR0ZXInKTt2YXIgX0V2ZW50RW1pdHRlcjM9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRXZlbnRFbWl0dGVyMik7dmFyIF9jb25uZWN0aW9uPXJlcXVpcmUoJy4vY29ubmVjdGlvbicpO3ZhciBfY29ubmVjdGlvbjI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29ubmVjdGlvbik7dmFyIF9wZWVyPXJlcXVpcmUoJy4vcGVlcicpO3ZhciBfcGVlcjI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGVlcik7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmope3JldHVybiBvYmomJm9iai5fX2VzTW9kdWxlP29iajp7ZGVmYXVsdDpvYmp9O31mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsQ29uc3RydWN0b3Ipe2lmKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3Rvcikpe3Rocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpO319ZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZixjYWxsKXtpZighc2VsZil7dGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTt9cmV0dXJuIGNhbGwmJih0eXBlb2YgY2FsbD09PSJvYmplY3QifHx0eXBlb2YgY2FsbD09PSJmdW5jdGlvbiIpP2NhbGw6c2VsZjt9ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLHN1cGVyQ2xhc3Mpe2lmKHR5cGVvZiBzdXBlckNsYXNzIT09ImZ1bmN0aW9uIiYmc3VwZXJDbGFzcyE9PW51bGwpe3Rocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIit0eXBlb2Ygc3VwZXJDbGFzcyk7fXN1YkNsYXNzLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MmJnN1cGVyQ2xhc3MucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6c3ViQ2xhc3MsZW51bWVyYWJsZTpmYWxzZSx3cml0YWJsZTp0cnVlLGNvbmZpZ3VyYWJsZTp0cnVlfX0pO2lmKHN1cGVyQ2xhc3MpT2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcyxzdXBlckNsYXNzKTpzdWJDbGFzcy5fX3Byb3RvX189c3VwZXJDbGFzczt9IC8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLyAvKiBqc2hpbnQgdW5kZWY6IHRydWUgKi8gLyogZ2xvYmFscyBSVENQZWVyQ29ubmVjdGlvbiAqLyAvKiBnbG9iYWxzIFJUQ1Nlc3Npb25EZXNjcmlwdGlvbiAqLyAvKiBnbG9iYWxzIFJUQ0ljZUNhbmRpZGF0ZSAqL3ZhciBDb25uZWN0aW9uQ29udHJvbGxlcj1mdW5jdGlvbihfRXZlbnRFbWl0dGVyKXtfaW5oZXJpdHMoQ29ubmVjdGlvbkNvbnRyb2xsZXIsX0V2ZW50RW1pdHRlcik7ZnVuY3Rpb24gQ29ubmVjdGlvbkNvbnRyb2xsZXIoc3luY2hlcixkb21haW4sY29uZmlndXJhdGlvbil7X2NsYXNzQ2FsbENoZWNrKHRoaXMsQ29ubmVjdGlvbkNvbnRyb2xsZXIpO2lmKCFzeW5jaGVyKXRocm93IG5ldyBFcnJvcignVGhlIHN5bmNoZXIgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7aWYoIWRvbWFpbil0aHJvdyBuZXcgRXJyb3IoJ1RoZSBkb21haW4gaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7aWYoIWNvbmZpZ3VyYXRpb24pdGhyb3cgbmV3IEVycm9yKCdUaGUgY29uZmlndXJhdGlvbiBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTt2YXIgX3RoaXMyPV9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsT2JqZWN0LmdldFByb3RvdHlwZU9mKENvbm5lY3Rpb25Db250cm9sbGVyKS5jYWxsKHRoaXMpKTt2YXIgX3RoaXM9X3RoaXMyO190aGlzLnN5bmNoZXI9c3luY2hlcjtfdGhpcy5tb2RlPSdvZmZlcic7X3RoaXMuX29iamVjdERlc2NVUkw9J2h5cGVydHktY2F0YWxvZ3VlOi8vJytkb21haW4rJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hcy9GYWtlRGF0YVNjaGVtYSc7Y29uc29sZS5pbmZvKGNvbmZpZ3VyYXRpb24pO2NvbnNvbGUuaW5mbyhjb25maWd1cmF0aW9uKTtfdGhpcy5tZWRpYUNvbnN0cmFpbnRzPWNvbmZpZ3VyYXRpb24ubWVkaWFDb25zdHJhaW50cztfdGhpcy5jb25maWd1cmF0aW9uPWNvbmZpZ3VyYXRpb24ud2VicnRjOyAvLyBQcmVwYXJlIHRoZSBQZWVyQ29ubmVjdGlvbgp2YXIgcGVlckNvbm5lY3Rpb249bmV3IFJUQ1BlZXJDb25uZWN0aW9uKF90aGlzLmNvbmZpZ3VyYXRpb24pO3BlZXJDb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ3NpZ25hbGluZ3N0YXRlY2hhbmdlJyxmdW5jdGlvbihldmVudCl7Y29uc29sZS5pbmZvKCdzaWduYWxpbmdzdGF0ZWNoYW5nZScsZXZlbnQuY3VycmVudFRhcmdldC5zaWduYWxpbmdTdGF0ZSk7aWYoZXZlbnQuY3VycmVudFRhcmdldC5zaWduYWxpbmdTdGF0ZT09PSdoYXZlLWxvY2FsLW9mZmVyJyl7X3RoaXMudHJpZ2dlcignY29udHJvbGxlcjpzdGF0ZTpjaGFuZ2UnLF90aGlzLm1vZGUpO31pZihldmVudC5jdXJyZW50VGFyZ2V0LnNpZ25hbGluZ1N0YXRlPT09J2hhdmUtcmVtb3RlLW9mZmVyJyl7X3RoaXMubW9kZT0nYW5zd2VyJztfdGhpcy50cmlnZ2VyKCdjb250cm9sbGVyOnN0YXRlOmNoYW5nZScsX3RoaXMubW9kZSk7fX0pO3BlZXJDb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2ljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZScsZnVuY3Rpb24oZXZlbnQpe2NvbnNvbGUuaW5mbygnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJyxldmVudC5jdXJyZW50VGFyZ2V0LmljZUNvbm5lY3Rpb25TdGF0ZSk7dmFyIGRhdGE9X3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5kYXRhO2lmKGRhdGEuaGFzT3duUHJvcGVydHkoJ2Nvbm5lY3Rpb24nKSl7ZGF0YS5jb25uZWN0aW9uLnN0YXR1cz1ldmVudC5jdXJyZW50VGFyZ2V0LmljZUNvbm5lY3Rpb25TdGF0ZTt9fSk7cGVlckNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignaWNlY2FuZGlkYXRlJyxmdW5jdGlvbihldmVudCl7aWYoIWV2ZW50LmNhbmRpZGF0ZSlyZXR1cm47dmFyIGljZWNhbmRpZGF0ZT17dHlwZTonY2FuZGlkYXRlJyxjYW5kaWRhdGU6ZXZlbnQuY2FuZGlkYXRlLmNhbmRpZGF0ZSxzZHBNaWQ6ZXZlbnQuY2FuZGlkYXRlLnNkcE1pZCxzZHBNTGluZUluZGV4OmV2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4fTt2YXIgZGF0YT1fdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyLmRhdGE7aWYoX3RoaXMubW9kZT09PSdvZmZlcicpe2RhdGEuY29ubmVjdGlvbi5vd25lclBlZXIuaWNlQ2FuZGlkYXRlcy5wdXNoKGljZWNhbmRpZGF0ZSk7fWVsc2Uge2RhdGEucGVlci5pY2VDYW5kaWRhdGVzLnB1c2goaWNlY2FuZGlkYXRlKTt9fSk7IC8vIEFkZCBzdHJlYW0gdG8gUGVlckNvbm5lY3Rpb24KcGVlckNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignYWRkc3RyZWFtJyxmdW5jdGlvbihldmVudCl7Y29uc29sZS5pbmZvKCdBZGQgU3RyZWFtOiAnLGV2ZW50KTtfdGhpcy50cmlnZ2VyKCdzdHJlYW06YWRkZWQnLGV2ZW50KTt9KTtfdGhpcy5wZWVyQ29ubmVjdGlvbj1wZWVyQ29ubmVjdGlvbjtyZXR1cm4gX3RoaXMyO31fY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbkNvbnRyb2xsZXIsW3trZXk6J2NoYW5nZVBlZXJJbmZvcm1hdGlvbicsdmFsdWU6ZnVuY3Rpb24gY2hhbmdlUGVlckluZm9ybWF0aW9uKGRhdGFPYmplY3RPYnNlcnZlcil7dmFyIF90aGlzPXRoaXM7dmFyIGRhdGE9ZGF0YU9iamVjdE9ic2VydmVyLmRhdGE7dmFyIGlzT3duZXI9ZGF0YS5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdGlvbicpO3ZhciBwZWVyRGF0YT1pc093bmVyP2RhdGEuY29ubmVjdGlvbi5vd25lclBlZXI6ZGF0YS5wZWVyO2NvbnNvbGUuaW5mbygnUGVlciBEYXRhOicsSlNPTi5zdHJpbmdpZnkocGVlckRhdGEpKTtpZihwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdGlvbkRlc2NyaXB0aW9uJykpe190aGlzLnByb2Nlc3NQZWVySW5mb3JtYXRpb24ocGVlckRhdGEuY29ubmVjdGlvbkRlc2NyaXB0aW9uKTt9aWYocGVlckRhdGEuaGFzT3duUHJvcGVydHkoJ2ljZUNhbmRpZGF0ZXMnKSl7cGVlckRhdGEuaWNlQ2FuZGlkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uKGljZSl7X3RoaXMucHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihpY2UpO30pO31kYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLGZ1bmN0aW9uKGV2ZW50KXtjb25zb2xlLmluZm8oJ09ic2VydmVyIG9uIGNoYW5nZSBtZXNzYWdlOiAnLGV2ZW50KTtfdGhpcy5wcm9jZXNzUGVlckluZm9ybWF0aW9uKGV2ZW50LmRhdGEpO30pO319LHtrZXk6J3Byb2Nlc3NQZWVySW5mb3JtYXRpb24nLHZhbHVlOmZ1bmN0aW9uIHByb2Nlc3NQZWVySW5mb3JtYXRpb24oZGF0YSl7dmFyIF90aGlzPXRoaXM7Y29uc29sZS5pbmZvKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtpZihkYXRhLnR5cGU9PT0nb2ZmZXInfHxkYXRhLnR5cGU9PT0nYW5zd2VyJyl7Y29uc29sZS5pbmZvKCdQcm9jZXNzIENvbm5lY3Rpb24gRGVzY3JpcHRpb246ICcsZGF0YS5zZHApO190aGlzLnBlZXJDb25uZWN0aW9uLnNldFJlbW90ZURlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oZGF0YSksX3RoaXMucmVtb3RlRGVzY3JpcHRpb25TdWNjZXNzLF90aGlzLnJlbW90ZURlc2NyaXB0aW9uRXJyb3IpO31pZihkYXRhLnR5cGU9PT0nY2FuZGlkYXRlJyl7Y29uc29sZS5pbmZvKCdQcm9jZXNzIEljZSBDYW5kaWRhdGU6ICcsZGF0YSk7X3RoaXMucGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKG5ldyBSVENJY2VDYW5kaWRhdGUoe2NhbmRpZGF0ZTpkYXRhLmNhbmRpZGF0ZX0pLF90aGlzLnJlbW90ZURlc2NyaXB0aW9uU3VjY2VzcyxfdGhpcy5yZW1vdGVEZXNjcmlwdGlvbkVycm9yKTt9fX0se2tleToncmVtb3RlRGVzY3JpcHRpb25TdWNjZXNzJyx2YWx1ZTpmdW5jdGlvbiByZW1vdGVEZXNjcmlwdGlvblN1Y2Nlc3MoKXtjb25zb2xlLmluZm8oJ3JlbW90ZSBzdWNjZXNzJyk7fX0se2tleToncmVtb3RlRGVzY3JpcHRpb25FcnJvcicsdmFsdWU6ZnVuY3Rpb24gcmVtb3RlRGVzY3JpcHRpb25FcnJvcihlcnJvcil7Y29uc29sZS5lcnJvcignZXJyb3I6ICcsZXJyb3IpO319LHtrZXk6J2NyZWF0ZU9mZmVyJyx2YWx1ZTpmdW5jdGlvbiBjcmVhdGVPZmZlcigpe3ZhciBfdGhpcz10aGlzO190aGlzLnBlZXJDb25uZWN0aW9uLmNyZWF0ZU9mZmVyKGZ1bmN0aW9uKGRlc2NyaXB0aW9uKXtfdGhpcy5vbkxvY2FsU2Vzc2lvbkNyZWF0ZWQoZGVzY3JpcHRpb24pO30sX3RoaXMuaW5mb0Vycm9yLF90aGlzLm1lZGlhQ29uc3RyYWludHMpO319LHtrZXk6J2NyZWF0ZUFuc3dlcicsdmFsdWU6ZnVuY3Rpb24gY3JlYXRlQW5zd2VyKCl7dmFyIF90aGlzPXRoaXM7X3RoaXMucGVlckNvbm5lY3Rpb24uY3JlYXRlQW5zd2VyKGZ1bmN0aW9uKGRlc2NyaXB0aW9uKXtfdGhpcy5vbkxvY2FsU2Vzc2lvbkNyZWF0ZWQoZGVzY3JpcHRpb24pO30sX3RoaXMuaW5mb0Vycm9yKTt9fSx7a2V5OidvbkxvY2FsU2Vzc2lvbkNyZWF0ZWQnLHZhbHVlOmZ1bmN0aW9uIG9uTG9jYWxTZXNzaW9uQ3JlYXRlZChkZXNjcmlwdGlvbil7dmFyIF90aGlzPXRoaXM7X3RoaXMucGVlckNvbm5lY3Rpb24uc2V0TG9jYWxEZXNjcmlwdGlvbihkZXNjcmlwdGlvbixmdW5jdGlvbigpe3ZhciBkYXRhPV90aGlzLl9kYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YTt2YXIgc2RwQ29ubmVjdGlvbj17c2RwOmRlc2NyaXB0aW9uLnNkcCx0eXBlOmRlc2NyaXB0aW9uLnR5cGV9O2lmKF90aGlzLm1vZGU9PT0nb2ZmZXInKXtkYXRhLmNvbm5lY3Rpb24ub3duZXJQZWVyLmNvbm5lY3Rpb25EZXNjcmlwdGlvbj1zZHBDb25uZWN0aW9uO31lbHNlIHtkYXRhLnBlZXIuY29ubmVjdGlvbkRlc2NyaXB0aW9uPXNkcENvbm5lY3Rpb247fX0sX3RoaXMuaW5mb0Vycm9yKTt9fSx7a2V5OidpbmZvRXJyb3InLHZhbHVlOmZ1bmN0aW9uIGluZm9FcnJvcihlcnIpe2NvbnNvbGUuZXJyb3IoZXJyLnRvU3RyaW5nKCksZXJyKTt9IC8qKgogICAqIFVzZWQgdG8gYWNjZXB0IGFuIGluY29taW5nIGNvbm5lY3Rpb24gcmVxdWVzdC4KICAgKiBAbWV0aG9kIGFjY2VwdAogICAqIEByZXR1cm4ge1Byb21pc2V9CiAgICovfSx7a2V5OidhY2NlcHQnLHZhbHVlOmZ1bmN0aW9uIGFjY2VwdChzdHJlYW0peyAvLyBUT0RPOiBQYXNzIGFyZ3VtZW50IG9wdGlvbnMgYXMgYSBzdHJlYW0sIGJlY2F1c2UgaXMgc3BlY2lmaWMgb2YgaW1wbGVtZW50YXRpb247CnZhciBfdGhpcz10aGlzO3ZhciBzeW5jaGVyPV90aGlzLnN5bmNoZXI7Y29uc29sZS5sb2coJ1JlbW90ZSBQZWVyIEluZm9ybWF0aW9uOiAnLF90aGlzLl9yZW1vdGVQZWVySW5mb3JtYXRpb24pO3ZhciByZW1vdGVQZWVyPV90aGlzLl9yZW1vdGVQZWVySW5mb3JtYXRpb24uZnJvbTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3RyeXtjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBTeW5jaGVyIENyZWF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFxuJyk7c3luY2hlci5jcmVhdGUoX3RoaXMuX29iamVjdERlc2NVUkwsW3JlbW90ZVBlZXJdLHt9KS50aGVuKGZ1bmN0aW9uKGRhdGFPYmplY3RSZXBvcnRlcil7Y29uc29sZS5pbmZvKCcyLiBSZXR1cm4gdGhlIERhdGEgT2JqZWN0IFJlcG9ydGVyICcsZGF0YU9iamVjdFJlcG9ydGVyKTtfdGhpcy5zdHJlYW09c3RyZWFtO190aGlzLmRhdGFPYmplY3RSZXBvcnRlcj1kYXRhT2JqZWN0UmVwb3J0ZXI7cmVzb2x2ZSgnYWNjZXB0ZWQnKTt9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pe3JlamVjdChyZWFzb24pO30pO31jYXRjaChlKXtyZWplY3QoJ2Vycm9yIGFjY2VwdGluZyBjb25uZWN0aW9uJyk7fX0pO30gLyoqCiAgKiBVc2VkIHRvIGRlY2xpbmUgYW4gaW5jb21pbmcgY29ubmVjdGlvbiByZXF1ZXN0LgogICogQG1ldGhvZCBkZWNsaW5lCiAgKiBAcmV0dXJuIHtQcm9taXNlfQogICovfSx7a2V5OidkZWNsaW5lJyx2YWx1ZTpmdW5jdGlvbiBkZWNsaW5lKCl7dmFyIF90aGlzPXRoaXM7dmFyIHN5bmNoZXI9X3RoaXMuc3luY2hlcjtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3RyeXtjb25zb2xlLmxvZygnc3luY2hlcjogJyxzeW5jaGVyKTtyZXNvbHZlKCdEZWNsaW5lZCcpO31jYXRjaChlKXtyZWplY3QoZSk7fX0pO30gLyoqCiAgICogVXNlZCB0byBjbG9zZSBhbiBleGlzdGluZyBjb25uZWN0aW9uIGluc3RhbmNlLgogICAqIEBtZXRob2QgZGlzY29ubmVjdAogICAqIEByZXR1cm4ge1Byb21pc2V9CiAgICovfSx7a2V5OidkaXNjb25uZWN0Jyx2YWx1ZTpmdW5jdGlvbiBkaXNjb25uZWN0KCl7IC8vIFRPRE86IG9wdGltaXplIHRoZSBkaXNjb25uZWN0IGZ1bmN0aW9uCnZhciBfdGhpcz10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dHJ5e190aGlzLnBlZXJDb25uZWN0aW9uLmNsb3NlKCk7cmVzb2x2ZSh0cnVlKTt9Y2F0Y2goZSl7cmVqZWN0KCdlcnJvciBkaXNjb25uZWN0aW5nIGNvbm5lY3Rpb24nKTt9fSk7fSAvKioKICAgKiBVc2VkIHRvIGFkZC9pbnZpdGUgbmV3IHBlZXJzIG9uIGFuIGV4aXN0aW5nIGNvbm5lY3Rpb24gaW5zdGFuY2UgKGZvciBtdWx0aXBhcnR5IGNvbm5lY3Rpb25zKS4KICAgKiBAbWV0aG9kIGFkZFBlZXIKICAgKiBAcmV0dXJuIHtQcm9taXNlfQogICAqL30se2tleTonYWRkUGVlcicsdmFsdWU6ZnVuY3Rpb24gYWRkUGVlcigpe30gLyoqCiAgICogVXNlZCB0byByZW1vdmUgYSBwZWVyIGZyb20gYW4gZXhpc3RpbmcgY29ubmVjdGlvbiBpbnN0YW5jZS4KICAgKiBAbWV0aG9kIHJlbW92ZVBlZXIKICAgKiBAcmV0dXJuIHtQcm9taXNlfQogICAqL30se2tleToncmVtb3ZlUGVlcicsdmFsdWU6ZnVuY3Rpb24gcmVtb3ZlUGVlcigpe30gLy8gUGVlciBBY3Rpb25zCn0se2tleTonZGlzYWJsZU1pYycsdmFsdWU6ZnVuY3Rpb24gZGlzYWJsZU1pYygpe3ZhciBfdGhpcz10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dHJ5e3ZhciBsb2NhbFN0cmVhbT1fdGhpcy5wZWVyQ29ubmVjdGlvbi5nZXRMb2NhbFN0cmVhbXMoKVswXTt2YXIgYXVkaW9UcmFjaz1sb2NhbFN0cmVhbS5nZXRBdWRpb1RyYWNrcygpWzBdO2F1ZGlvVHJhY2suZW5hYmxlZD1hdWRpb1RyYWNrLmVuYWJsZWQ/ZmFsc2U6dHJ1ZTtyZXNvbHZlKGF1ZGlvVHJhY2suZW5hYmxlZCk7fWNhdGNoKGUpe3JlamVjdChlKTt9fSk7fX0se2tleTonZGlzYWJsZUNhbScsdmFsdWU6ZnVuY3Rpb24gZGlzYWJsZUNhbSgpe3ZhciBfdGhpcz10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dHJ5e3ZhciBsb2NhbFN0cmVhbT1fdGhpcy5wZWVyQ29ubmVjdGlvbi5nZXRMb2NhbFN0cmVhbXMoKVswXTt2YXIgdmlkZW9UcmFjaz1sb2NhbFN0cmVhbS5nZXRWaWRlb1RyYWNrcygpWzBdO3ZpZGVvVHJhY2suZW5hYmxlZD12aWRlb1RyYWNrLmVuYWJsZWQ/ZmFsc2U6dHJ1ZTtyZXNvbHZlKHZpZGVvVHJhY2suZW5hYmxlZCk7fWNhdGNoKGUpe3JlamVjdChlKTt9fSk7fX0se2tleTonbXV0ZScsdmFsdWU6ZnVuY3Rpb24gbXV0ZSgpe3ZhciBfdGhpcz10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dHJ5e3ZhciByZW1vdGVTdHJlYW09X3RoaXMucGVlckNvbm5lY3Rpb24uZ2V0UmVtb3RlU3RyZWFtcygpWzBdO3ZhciBhdWRpb1RyYWNrPXJlbW90ZVN0cmVhbS5nZXRBdWRpb1RyYWNrcygpWzBdO2F1ZGlvVHJhY2suZW5hYmxlZD1hdWRpb1RyYWNrLmVuYWJsZWQ/ZmFsc2U6dHJ1ZTtyZXNvbHZlKGF1ZGlvVHJhY2suZW5hYmxlZCk7fWNhdGNoKGUpe3JlamVjdChlKTt9fSk7fX0se2tleTonc3RyZWFtJyxzZXQ6ZnVuY3Rpb24gc2V0KG1lZGlhU3RyZWFtKXtpZighbWVkaWFTdHJlYW0pdGhyb3cgbmV3IEVycm9yKCdUaGUgbWVkaWFTdHJlYW0gaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7dmFyIF90aGlzPXRoaXM7Y29uc29sZS5pbmZvKCdzZXQgc3RyZWFtOiAnLG1lZGlhU3RyZWFtKTtfdGhpcy5wZWVyQ29ubmVjdGlvbi5hZGRTdHJlYW0obWVkaWFTdHJlYW0pO319LHtrZXk6J2dldExvY2FsU3RyZWFtcycsZ2V0OmZ1bmN0aW9uIGdldCgpe3ZhciBfdGhpcz10aGlzO3JldHVybiBfdGhpcy5wZWVyQ29ubmVjdGlvbi5nZXRMb2NhbFN0cmVhbXMoKTt9fSx7a2V5OidnZXRSZW1vdGVTdHJlYW1zJyxnZXQ6ZnVuY3Rpb24gZ2V0KCl7dmFyIF90aGlzPXRoaXM7cmV0dXJuIF90aGlzLnBlZXJDb25uZWN0aW9uLmdldFJlbW90ZVN0cmVhbXMoKTt9IC8qKgogICAqIFNldCBSZW1vdGUgcGVlciBpbmZvcm1hdGlvbiwgbGlrZSBIeXBlcnR5LgogICAqIEBwYXJhbSAge09iamVjdH0gcmVtb3RlUGVlckluZm9ybWF0aW9uIGluZm9ybWF0aW9uIGFib3V0IHRoZSBwZWVyOwogICAqL30se2tleToncmVtb3RlUGVlckluZm9ybWF0aW9uJyxzZXQ6ZnVuY3Rpb24gc2V0KHJlbW90ZVBlZXJJbmZvcm1hdGlvbil7dmFyIF90aGlzPXRoaXM7X3RoaXMuX3JlbW90ZVBlZXJJbmZvcm1hdGlvbj1yZW1vdGVQZWVySW5mb3JtYXRpb247fSAvKioKICAgKiBHZXQgaW5mb3JtYXRpb24gcmVsYXRpdmUgdG8gdGhlIFJlbW90ZSBQZWVyOwogICAqIEByZXR1cm4ge09iamVjdH0gcmVtb3RlUGVlckluZm9ybWF0aW9uOwogICAqLyxnZXQ6ZnVuY3Rpb24gZ2V0KCl7dmFyIF90aGlzPXRoaXM7cmV0dXJuIF90aGlzLl9yZW1vdGVQZWVySW5mb3JtYXRpb247fSAvKioKICAqIFNldCB0aGUgZGF0YU9iamVjdCBpbiB0aGUgY29udHJvbGxlcgogICogQHBhcmFtIHtDb25uZWN0aW9uRGF0YU9iamVjdH0gZGF0YU9iamVjdCAtIGhhdmUgYWxsIGluZm9ybWF0aW9uIGFib3V0IHRoZSBzeW5jaGVyIG9iamVjdDsKICAqL30se2tleTonZGF0YU9iamVjdFJlcG9ydGVyJyxzZXQ6ZnVuY3Rpb24gc2V0KGRhdGFPYmplY3RSZXBvcnRlcil7aWYoIWRhdGFPYmplY3RSZXBvcnRlcil0aHJvdyBuZXcgRXJyb3IoJ1RoZSBEYXRhIE9iamVjdCBSZXBvcnRlciBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTt2YXIgX3RoaXM9dGhpcztfdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyPWRhdGFPYmplY3RSZXBvcnRlcjt2YXIgZGF0YT1fdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyLmRhdGE7ZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uKGV2ZW50KXtldmVudC5hY2NlcHQoKTt9KTtpZihfdGhpcy5tb2RlPT09J29mZmVyJyl7ZGF0YS5jb25uZWN0aW9uPV9jb25uZWN0aW9uMi5kZWZhdWx0O190aGlzLmNyZWF0ZU9mZmVyKCk7fWVsc2Uge2RhdGEucGVlcj1fcGVlcjIuZGVmYXVsdDtfdGhpcy5jcmVhdGVBbnN3ZXIoKTt9Y29uc29sZS5kZWJ1ZyhfdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyKTt9IC8qKgogICogcmV0dXJuIHRoZSBkYXRhT2JqZWN0IGluIHRoZSBjb250cm9sbGVyCiAgKiBAcmV0dXJuIHtDb25uZWN0aW9uRGF0YU9iamVjdH0gZGF0YU9iamVjdAogICovLGdldDpmdW5jdGlvbiBnZXQoKXt2YXIgX3RoaXM9dGhpcztyZXR1cm4gX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjt9IC8qKgogICogU2V0IHRoZSBkYXRhT2JqZWN0IGluIHRoZSBjb250cm9sbGVyCiAgKiBAcGFyYW0ge0Nvbm5lY3Rpb25EYXRhT2JqZWN0fSBkYXRhT2JqZWN0IC0gaGF2ZSBhbGwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHN5bmNoZXIgb2JqZWN0OwogICovfSx7a2V5OidkYXRhT2JqZWN0T2JzZXJ2ZXInLHNldDpmdW5jdGlvbiBzZXQoZGF0YU9iamVjdE9ic2VydmVyKXtpZighZGF0YU9iamVjdE9ic2VydmVyKXRocm93IG5ldyBFcnJvcignVGhlIERhdGEgT2JqZWN0IE9ic2VydmVyIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO3ZhciBfdGhpcz10aGlzO190aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXI9ZGF0YU9iamVjdE9ic2VydmVyO190aGlzLmNoYW5nZVBlZXJJbmZvcm1hdGlvbihkYXRhT2JqZWN0T2JzZXJ2ZXIpO30gLyoqCiAgKiByZXR1cm4gdGhlIGRhdGFPYmplY3QgaW4gdGhlIGNvbnRyb2xsZXIKICAqIEByZXR1cm4ge0Nvbm5lY3Rpb25EYXRhT2JqZWN0fSBkYXRhT2JqZWN0CiAgKi8sZ2V0OmZ1bmN0aW9uIGdldCgpe3ZhciBfdGhpcz10aGlzO3JldHVybiBfdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyO319XSk7cmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyO30oX0V2ZW50RW1pdHRlcjMuZGVmYXVsdCk7ZXhwb3J0cy5kZWZhdWx0PUNvbm5lY3Rpb25Db250cm9sbGVyO21vZHVsZS5leHBvcnRzPWV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi91dGlscy9FdmVudEVtaXR0ZXIiOjgsIi4vY29ubmVjdGlvbiI6NiwiLi9wZWVyIjo3LCJ3ZWJydGMtYWRhcHRlci10ZXN0IjozfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JztPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywiX19lc01vZHVsZSIse3ZhbHVlOnRydWV9KTt2YXIgX2NyZWF0ZUNsYXNzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQscHJvcHMpe2Zvcih2YXIgaT0wO2k8cHJvcHMubGVuZ3RoO2krKyl7dmFyIGRlc2NyaXB0b3I9cHJvcHNbaV07ZGVzY3JpcHRvci5lbnVtZXJhYmxlPWRlc2NyaXB0b3IuZW51bWVyYWJsZXx8ZmFsc2U7ZGVzY3JpcHRvci5jb25maWd1cmFibGU9dHJ1ZTtpZigidmFsdWUiIGluIGRlc2NyaXB0b3IpZGVzY3JpcHRvci53cml0YWJsZT10cnVlO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsZGVzY3JpcHRvci5rZXksZGVzY3JpcHRvcik7fX1yZXR1cm4gZnVuY3Rpb24oQ29uc3RydWN0b3IscHJvdG9Qcm9wcyxzdGF0aWNQcm9wcyl7aWYocHJvdG9Qcm9wcylkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSxwcm90b1Byb3BzKTtpZihzdGF0aWNQcm9wcylkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLHN0YXRpY1Byb3BzKTtyZXR1cm4gQ29uc3RydWN0b3I7fTt9KCk7ZXhwb3J0cy5kZWZhdWx0PWFjdGl2YXRlO3ZhciBfSHlwZXJ0eURpc2NvdmVyeT1yZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9kaXN0L0h5cGVydHlEaXNjb3ZlcnknKTt2YXIgX0h5cGVydHlEaXNjb3ZlcnkyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0h5cGVydHlEaXNjb3ZlcnkpO3ZhciBfU3luY2hlcj1yZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9kaXN0L1N5bmNoZXInKTt2YXIgX0V2ZW50RW1pdHRlcjI9cmVxdWlyZSgnLi4vdXRpbHMvRXZlbnRFbWl0dGVyJyk7dmFyIF9FdmVudEVtaXR0ZXIzPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0V2ZW50RW1pdHRlcjIpO3ZhciBfdXRpbHM9cmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMnKTt2YXIgX0Nvbm5lY3Rpb25Db250cm9sbGVyPXJlcXVpcmUoJy4vQ29ubmVjdGlvbkNvbnRyb2xsZXInKTt2YXIgX0Nvbm5lY3Rpb25Db250cm9sbGVyMj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Db25uZWN0aW9uQ29udHJvbGxlcik7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmope3JldHVybiBvYmomJm9iai5fX2VzTW9kdWxlP29iajp7ZGVmYXVsdDpvYmp9O31mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsQ29uc3RydWN0b3Ipe2lmKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3Rvcikpe3Rocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpO319ZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZixjYWxsKXtpZighc2VsZil7dGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTt9cmV0dXJuIGNhbGwmJih0eXBlb2YgY2FsbD09PSJvYmplY3QifHx0eXBlb2YgY2FsbD09PSJmdW5jdGlvbiIpP2NhbGw6c2VsZjt9ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLHN1cGVyQ2xhc3Mpe2lmKHR5cGVvZiBzdXBlckNsYXNzIT09ImZ1bmN0aW9uIiYmc3VwZXJDbGFzcyE9PW51bGwpe3Rocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIit0eXBlb2Ygc3VwZXJDbGFzcyk7fXN1YkNsYXNzLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MmJnN1cGVyQ2xhc3MucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6c3ViQ2xhc3MsZW51bWVyYWJsZTpmYWxzZSx3cml0YWJsZTp0cnVlLGNvbmZpZ3VyYWJsZTp0cnVlfX0pO2lmKHN1cGVyQ2xhc3MpT2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcyxzdXBlckNsYXNzKTpzdWJDbGFzcy5fX3Byb3RvX189c3VwZXJDbGFzczt9IC8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLyAvKiBqc2hpbnQgdW5kZWY6IHRydWUgKi8gLy8gU2VydmljZSBGcmFtZXdvcmsKLy8gVXRpbHMKLy8gSW50ZXJuYWxzCi8qKgoqIEh5cGVydHkgQ29ubmVjdG9yOwoqIEBhdXRob3IgVml0b3IgU2lsdmEgW3ZpdG9yLXQtc2lsdmFAdGVsZWNvbS5wdF0KKiBAdmVyc2lvbiAwLjEuMAoqL3ZhciBIeXBlcnR5Q29ubmVjdG9yPWZ1bmN0aW9uKF9FdmVudEVtaXR0ZXIpe19pbmhlcml0cyhIeXBlcnR5Q29ubmVjdG9yLF9FdmVudEVtaXR0ZXIpOyAvKioKICAqIENyZWF0ZSBhIG5ldyBIeXBlcnR5IENvbm5lY3RvcgogICogQHBhcmFtICB7U3luY2hlcn0gc3luY2hlciAtIFN5bmNoZXIgcHJvdmlkZWQgZnJvbSB0aGUgcnVudGltZSBjb3JlCiAgKi9mdW5jdGlvbiBIeXBlcnR5Q29ubmVjdG9yKGh5cGVydHlVUkwsYnVzLGNvbmZpZ3VyYXRpb24pe19jbGFzc0NhbGxDaGVjayh0aGlzLEh5cGVydHlDb25uZWN0b3IpO2lmKCFoeXBlcnR5VVJMKXRocm93IG5ldyBFcnJvcignVGhlIGh5cGVydHlVUkwgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7aWYoIWJ1cyl0aHJvdyBuZXcgRXJyb3IoJ1RoZSBNaW5pQnVzIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO2lmKCFjb25maWd1cmF0aW9uKXRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7dmFyIF90aGlzMj1fcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLE9iamVjdC5nZXRQcm90b3R5cGVPZihIeXBlcnR5Q29ubmVjdG9yKS5jYWxsKHRoaXMsaHlwZXJ0eVVSTCxidXMsY29uZmlndXJhdGlvbikpO3ZhciBfdGhpcz1fdGhpczI7X3RoaXMuX2h5cGVydHlVUkw9aHlwZXJ0eVVSTDtfdGhpcy5fYnVzPWJ1cztfdGhpcy5fY29uZmlndXJhdGlvbj1jb25maWd1cmF0aW9uO190aGlzLl9kb21haW49KDAsX3V0aWxzLmRpdmlkZVVSTCkoaHlwZXJ0eVVSTCkuZG9tYWluO190aGlzLl9vYmplY3REZXNjVVJMPSdoeXBlcnR5LWNhdGFsb2d1ZTovLycrX3RoaXMuX2RvbWFpbisnLy53ZWxsLWtub3duL2RhdGFzY2hlbWFzL0Zha2VEYXRhU2NoZW1hJztfdGhpcy5fY29udHJvbGxlcnM9e307X3RoaXMuaHlwZXJ0eURpc2NvdmVyeT1uZXcgX0h5cGVydHlEaXNjb3ZlcnkyLmRlZmF1bHQoaHlwZXJ0eVVSTCxidXMpO3ZhciBzeW5jaGVyPW5ldyBfU3luY2hlci5TeW5jaGVyKGh5cGVydHlVUkwsYnVzLGNvbmZpZ3VyYXRpb24pO3N5bmNoZXIub25Ob3RpZmljYXRpb24oZnVuY3Rpb24oZXZlbnQpe190aGlzLl9vbk5vdGlmaWNhdGlvbihldmVudCk7fSk7X3RoaXMuX3N5bmNoZXI9c3luY2hlcjtyZXR1cm4gX3RoaXMyO31fY3JlYXRlQ2xhc3MoSHlwZXJ0eUNvbm5lY3Rvcixbe2tleTonX29uTm90aWZpY2F0aW9uJyx2YWx1ZTpmdW5jdGlvbiBfb25Ob3RpZmljYXRpb24oZXZlbnQpe3ZhciBfdGhpcz10aGlzO2NvbnNvbGUuaW5mbygnLS0tLS0tLS0tLS0tIEFja25vd2xlZGdlcyB0aGUgUmVwb3J0ZXIgLS0tLS0tLS0tLS0tIFxuJyk7ZXZlbnQuYWNrKCk7Y29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gRU5EIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gXG4nKTtpZihfdGhpcy5fY29udHJvbGxlcnNbZXZlbnQuZnJvbV0pe190aGlzLl9hdXRvU3Vic2NyaWJlKGV2ZW50KTt9ZWxzZSB7X3RoaXMuX2F1dG9BY2NlcHQoZXZlbnQpO319fSx7a2V5OidfYXV0b1N1YnNjcmliZScsdmFsdWU6ZnVuY3Rpb24gX2F1dG9TdWJzY3JpYmUoZXZlbnQpe3ZhciBfdGhpcz10aGlzO3ZhciBzeW5jaGVyPV90aGlzLl9zeW5jaGVyO2NvbnNvbGUuaW5mbygnLS0tLS0tLS0tLS0tLS0tLSBTeW5jaGVyIEF1dG8gU3Vic2NyaWJlIC0tLS0tLS0tLS0tLS0tLS0gXG4nKTtjb25zb2xlLmluZm8oJ1N1YnNjcmliZSBVUkwgT2JqZWN0ICcsZXZlbnQsc3luY2hlcik7c3luY2hlci5zdWJzY3JpYmUoX3RoaXMuX29iamVjdERlc2NVUkwsZXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uKGRhdGFPYmplY3RPYnNlcnZlcil7Y29uc29sZS5pbmZvKCcxLiBSZXR1cm4gU3Vic2NyaWJlIERhdGEgT2JqZWN0IE9ic2VydmVyJyxkYXRhT2JqZWN0T2JzZXJ2ZXIpO2NvbnNvbGUubG9nKF90aGlzLl9jb250cm9sbGVycyk7X3RoaXMuX2NvbnRyb2xsZXJzW2V2ZW50LmZyb21dLmRhdGFPYmplY3RPYnNlcnZlcj1kYXRhT2JqZWN0T2JzZXJ2ZXI7fSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtjb25zb2xlLmVycm9yKHJlYXNvbik7fSk7fX0se2tleTonX2F1dG9BY2NlcHQnLHZhbHVlOmZ1bmN0aW9uIF9hdXRvQWNjZXB0KGV2ZW50KXt2YXIgX3RoaXM9dGhpczt2YXIgc3luY2hlcj1fdGhpcy5fc3luY2hlcjtjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tIFN5bmNoZXIgU3Vic2NyaWJlIChBdXRvIEFjY2VwdCkgLS0tLS0tLS0tLS0tLSBcbicpO2NvbnNvbGUuaW5mbygnU3Vic2NyaWJlIFVSTCBPYmplY3QgJyxldmVudCxzeW5jaGVyKTtzeW5jaGVyLnN1YnNjcmliZShfdGhpcy5fb2JqZWN0RGVzY1VSTCxldmVudC51cmwpLnRoZW4oZnVuY3Rpb24oZGF0YU9iamVjdE9ic2VydmVyKXtjb25zb2xlLmluZm8oJzEuIFJldHVybiBTdWJzY3JpYmUgRGF0YSBPYmplY3QgT2JzZXJ2ZXInLGRhdGFPYmplY3RPYnNlcnZlcik7dmFyIGNvbm5lY3Rpb25Db250cm9sbGVyPW5ldyBfQ29ubmVjdGlvbkNvbnRyb2xsZXIyLmRlZmF1bHQoc3luY2hlcixfdGhpcy5fZG9tYWluLF90aGlzLl9jb25maWd1cmF0aW9uKTtjb25uZWN0aW9uQ29udHJvbGxlci5yZW1vdGVQZWVySW5mb3JtYXRpb249ZXZlbnQ7Y29ubmVjdGlvbkNvbnRyb2xsZXIuZGF0YU9iamVjdE9ic2VydmVyPWRhdGFPYmplY3RPYnNlcnZlcjtfdGhpcy50cmlnZ2VyKCdjb25uZWN0b3I6Y29ubmVjdGVkJyxjb25uZWN0aW9uQ29udHJvbGxlcik7X3RoaXMudHJpZ2dlcignaGF2ZTpub3RpZmljYXRpb24nLGV2ZW50KTtjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBFTkQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBcbicpO30pLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7Y29uc29sZS5lcnJvcihyZWFzb24pO30pO30gLyoqCiAgKiBFc3RhYmxpc2ggY29ubmVjdGlvbiB3aXRoIG90aGVyIGNsaWVudCBpZGVudGlmaWVyCiAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMfSBIeXBlcnR5VVJMIC0gRGVmaW5lIHRoZSBpZGVudGlmaWVyIG9mIHRoZSBvdGhlciBjb21wb25lbnQKICAqIEBwYXJhbSAge09iamVjdH0gb3B0aW9ucyAtIE9iamVjdCB3aXRoIG9wdGlvbnMgdG8gaW1wcm92ZSB0aGUgY29ubmVjdAogICovfSx7a2V5Oidjb25uZWN0Jyx2YWx1ZTpmdW5jdGlvbiBjb25uZWN0KGh5cGVydHlVUkwsc3RyZWFtKXsgLy8gVE9ETzogUGFzcyBhcmd1bWVudCBvcHRpb25zIGFzIGEgc3RyZWFtLCBiZWNhdXNlIGlzIHNwZWNpZmljIG9mIGltcGxlbWVudGF0aW9uOwovLyBUT0RPOiBDSGFuZ2UgdGhlIGh5cGVydHlVUkwgZm9yIGEgbGlzdCBvZiBVUkxTCnZhciBfdGhpcz10aGlzO3ZhciBzeW5jaGVyPV90aGlzLl9zeW5jaGVyO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dmFyIGNvbm5lY3Rpb25Db250cm9sbGVyPXZvaWQgMDtjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBTeW5jaGVyIENyZWF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFxuJyk7c3luY2hlci5jcmVhdGUoX3RoaXMuX29iamVjdERlc2NVUkwsW2h5cGVydHlVUkxdLHt9KS50aGVuKGZ1bmN0aW9uKGRhdGFPYmplY3RSZXBvcnRlcil7Y29uc29sZS5pbmZvKCcxLiBSZXR1cm4gQ3JlYXRlIERhdGEgT2JqZWN0IFJlcG9ydGVyJyxkYXRhT2JqZWN0UmVwb3J0ZXIpO2Nvbm5lY3Rpb25Db250cm9sbGVyPW5ldyBfQ29ubmVjdGlvbkNvbnRyb2xsZXIyLmRlZmF1bHQoc3luY2hlcixfdGhpcy5fZG9tYWluLF90aGlzLl9jb25maWd1cmF0aW9uKTtjb25uZWN0aW9uQ29udHJvbGxlci5zdHJlYW09c3RyZWFtO2Nvbm5lY3Rpb25Db250cm9sbGVyLmRhdGFPYmplY3RSZXBvcnRlcj1kYXRhT2JqZWN0UmVwb3J0ZXI7X3RoaXMuX2NvbnRyb2xsZXJzW2h5cGVydHlVUkxdPWNvbm5lY3Rpb25Db250cm9sbGVyO3Jlc29sdmUoY29ubmVjdGlvbkNvbnRyb2xsZXIpO2NvbnNvbGUuaW5mbygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEVORCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gXG4nKTt9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pe2NvbnNvbGUuZXJyb3IocmVhc29uKTtyZWplY3QocmVhc29uKTt9KTt9KTt9fV0pO3JldHVybiBIeXBlcnR5Q29ubmVjdG9yO30oX0V2ZW50RW1pdHRlcjMuZGVmYXVsdCk7ZnVuY3Rpb24gYWN0aXZhdGUoaHlwZXJ0eVVSTCxidXMsY29uZmlndXJhdGlvbil7cmV0dXJuIHtuYW1lOidIeXBlcnR5Q29ubmVjdG9yJyxpbnN0YW5jZTpuZXcgSHlwZXJ0eUNvbm5lY3RvcihoeXBlcnR5VVJMLGJ1cyxjb25maWd1cmF0aW9uKX07fW1vZHVsZS5leHBvcnRzPWV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi91dGlscy9FdmVudEVtaXR0ZXIiOjgsIi4uL3V0aWxzL3V0aWxzIjo5LCIuL0Nvbm5lY3Rpb25Db250cm9sbGVyIjo0LCJzZXJ2aWNlLWZyYW1ld29yay9kaXN0L0h5cGVydHlEaXNjb3ZlcnkiOjEsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlciI6Mn1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIl9fZXNNb2R1bGUiLHt2YWx1ZTp0cnVlfSk7IC8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLyAvLyBkYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YSA9IHsKLy8gICAgc3RhdHVzIDogImNvbm5lY3RlZCIsCi8vICAgIG93bmVyIDogImh5cGVydHk6Ly9leGFtcGxlLmNvbS9hbGljZWh5IiwKLy8gICAgcGVlciA6ICJjb25uZWN0aW9uOi8vZXhhbXBsZS5jb20vYWxpY2UvYm9iMjcwMTIwMTYiLAovLyAgICBvd25lclBlZXIgOiB7Ci8vICAgICAgICAgIGNvbm5lY3Rpb25EZXNjcmlwdGlvbjogewovLyAgICAgICAgICAgICBzZHA6ICdzNGRmYWYxc2EzZjFhc2Q1ZjRzZGFmYScsCi8vICAgICAgICAgICAgIHR5cGU6ICdvZmZlcicKLy8gICAgICAgICAgfSwKLy8gICAgICAgICAgaWNlQ2FuZGlkYXRlczogW3sKLy8gICAgICAgICAgICAgIHR5cGU6ICdjYW5kaWRhdGUnLAovLyAgICAgICAgICAgICAgY2FuZGlkYXRlOiBldmVudC5jYW5kaWRhdGUuY2FuZGlkYXRlLAovLyAgICAgICAgICAgICAgc2RwTWlkOiBldmVudC5jYW5kaWRhdGUuc2RwTWlkLAovLyAgICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXgKLy8gICAgICAgICAgICB9LAovLyAgICAgICAgICAgIHsKLy8gICAgICAgICAgICAgIHR5cGU6ICdjYW5kaWRhdGUnLAovLyAgICAgICAgICAgICAgY2FuZGlkYXRlOiBldmVudC5jYW5kaWRhdGUuY2FuZGlkYXRlLAovLyAgICAgICAgICAgICAgc2RwTWlkOiBldmVudC5jYW5kaWRhdGUuc2RwTWlkLAovLyAgICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXgKLy8gICAgICAgICAgICB9LAovLyAgICAgICAgICAgIC4uLi4uCi8vICAgICAgICBdCi8vICAgICAgfQovLyAgfQp2YXIgY29ubmVjdGlvbj17bmFtZTonJyxzdGF0dXM6ImNvbm5lY3RlZCIsb3duZXI6Imh5cGVydHk6Ly9leGFtcGxlLmNvbS9hbGljZWh5IixwZWVyOiJjb25uZWN0aW9uOi8vZXhhbXBsZS5jb20vYWxpY2UvYm9iMjcwMTIwMTYiLG93bmVyUGVlcjp7Y29ubmVjdGlvbkRlc2NyaXB0aW9uOnt9LGljZUNhbmRpZGF0ZXM6W119fTtleHBvcnRzLmRlZmF1bHQ9Y29ubmVjdGlvbjttb2R1bGUuZXhwb3J0cz1leHBvcnRzWydkZWZhdWx0J107Cgp9LHt9XSw3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnO09iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCJfX2VzTW9kdWxlIix7dmFsdWU6dHJ1ZX0pOyAvKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi92YXIgcGVlcj17bmFtZTonJyxjb25uZWN0aW9uRGVzY3JpcHRpb246e30saWNlQ2FuZGlkYXRlczpbXX07ZXhwb3J0cy5kZWZhdWx0PXBlZXI7bW9kdWxlLmV4cG9ydHM9ZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjtPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywiX19lc01vZHVsZSIse3ZhbHVlOnRydWV9KTt2YXIgX2NyZWF0ZUNsYXNzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQscHJvcHMpe2Zvcih2YXIgaT0wO2k8cHJvcHMubGVuZ3RoO2krKyl7dmFyIGRlc2NyaXB0b3I9cHJvcHNbaV07ZGVzY3JpcHRvci5lbnVtZXJhYmxlPWRlc2NyaXB0b3IuZW51bWVyYWJsZXx8ZmFsc2U7ZGVzY3JpcHRvci5jb25maWd1cmFibGU9dHJ1ZTtpZigidmFsdWUiIGluIGRlc2NyaXB0b3IpZGVzY3JpcHRvci53cml0YWJsZT10cnVlO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsZGVzY3JpcHRvci5rZXksZGVzY3JpcHRvcik7fX1yZXR1cm4gZnVuY3Rpb24oQ29uc3RydWN0b3IscHJvdG9Qcm9wcyxzdGF0aWNQcm9wcyl7aWYocHJvdG9Qcm9wcylkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSxwcm90b1Byb3BzKTtpZihzdGF0aWNQcm9wcylkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLHN0YXRpY1Byb3BzKTtyZXR1cm4gQ29uc3RydWN0b3I7fTt9KCk7ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLENvbnN0cnVjdG9yKXtpZighKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKXt0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTt9fSAvKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8gLyoqCiAqIEV2ZW50RW1pdHRlcgogKiBBbGwgY2xhc3NlcyB3aGljaCBleHRlbmRzIHRoaXMsIGNhbiBoYXZlIGFkZEV2ZW50TGlzdGVuZXIgYW5kIHRyaWdnZXIgZXZlbnRzOwogKi92YXIgRXZlbnRFbWl0dGVyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gRXZlbnRFbWl0dGVyKCl7X2NsYXNzQ2FsbENoZWNrKHRoaXMsRXZlbnRFbWl0dGVyKTt9X2NyZWF0ZUNsYXNzKEV2ZW50RW1pdHRlcixbe2tleToiYWRkRXZlbnRMaXN0ZW5lciIsIC8qKgogICAqIGFkZEV2ZW50TGlzdGVuZXIgbGlzdGVuIGZvciBhbiBldmVudFR5cGUKICAgKiBAcGFyYW0gIHtzdHJpbmd9ICAgICAgICAgZXZlbnRUeXBlIC0gbGlzdGVuaW5nIGZvciB0aGlzIHR5cGUgb2YgZXZlbnQKICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gICAgICAgY2IgICAgICAgIC0gY2FsbGJhY2sgZnVuY3Rpb24gd2lsbCBiZSBleGVjdXRlZCB3aGVuIHRoZSBldmVudCBpdCBpcyBpbnZva2VkCiAgICovdmFsdWU6ZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsY2Ipe3ZhciBfdGhpcz10aGlzO190aGlzW2V2ZW50VHlwZV09Y2I7fSAvKioKICAgKiBJbnZva2UgdGhlIGV2ZW50VHlwZQogICAqIEBwYXJhbSAge3N0cmluZ30gZXZlbnRUeXBlIC0gZXZlbnQgd2lsbCBiZSBpbnZva2VkCiAgICogQHBhcmFtICB7b2JqZWN0fSBwYXJhbXMgLSBwYXJhbWV0ZXJzIHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBhZGRFdmVudExpc3RlbmVyCiAgICovfSx7a2V5OiJ0cmlnZ2VyIix2YWx1ZTpmdW5jdGlvbiB0cmlnZ2VyKGV2ZW50VHlwZSxwYXJhbXMpe3ZhciBfdGhpcz10aGlzO2lmKF90aGlzW2V2ZW50VHlwZV0pe190aGlzW2V2ZW50VHlwZV0ocGFyYW1zKTt9fX1dKTtyZXR1cm4gRXZlbnRFbWl0dGVyO30oKTtleHBvcnRzLmRlZmF1bHQ9RXZlbnRFbWl0dGVyO21vZHVsZS5leHBvcnRzPWV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0se31dLDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIl9fZXNNb2R1bGUiLHt2YWx1ZTp0cnVlfSk7ZXhwb3J0cy5kaXZpZGVVUkw9ZGl2aWRlVVJMO2V4cG9ydHMuZGVlcENsb25lPWRlZXBDbG9uZTtleHBvcnRzLmdldENvbmZpZz1nZXRDb25maWc7ZXhwb3J0cy5nZXRVc2VyTWVkaWE9Z2V0VXNlck1lZGlhO2V4cG9ydHMuc2VyaWFsaXplPXNlcmlhbGl6ZTtleHBvcnRzLmdldFRlbXBsYXRlPWdldFRlbXBsYXRlOyAvKioKICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqKi8gLy8ganNoaW50IGJyb3dzZXI6dHJ1ZSwganF1ZXJ5OiB0cnVlCi8vIGpzaGludCB2YXJzdG10OiB0cnVlCi8qIGdsb2JhbCBIYW5kbGViYXJzICovIC8qKgogKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsCiAqIEBtb2R1bGUgdXRpbHMKICovIC8qKgogKiBAdHlwZWRlZiBkaXZpZGVVUkwKICogQHR5cGUgT2JqZWN0CiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB0eXBlIFRoZSB0eXBlIG9mIFVSTAogKiBAcHJvcGVydHkge3N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZGVudGl0eSBUaGUgaWRlbnRpdHkgb2YgVVJMCiAqLyAvKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovZnVuY3Rpb24gZGl2aWRlVVJMKHVybCl7IC8vIGxldCByZSA9IC8oW2EtekEtWi1dKik/OlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIpKihcL1tcL1xkXHdcLi1dKikqKD86W1w/XSkqKC4rKSovZ2k7CnZhciByZT0vKFthLXpBLVotXSopOlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTt2YXIgc3Vic3Q9JyQxLCQyLCQzJzt2YXIgcGFydHM9dXJsLnJlcGxhY2UocmUsc3Vic3QpLnNwbGl0KCcsJyk7IC8vIElmIHRoZSB1cmwgaGFzIG5vIHByb3RvY29sLCB0aGUgZGVmYXVsdCBwcm90b2NvbCBzZXQgaXMgaHR0cHMKaWYocGFydHNbMF09PT11cmwpe3BhcnRzWzBdPSdodHRwcyc7cGFydHNbMV09dXJsO312YXIgcmVzdWx0PXt0eXBlOnBhcnRzWzBdLGRvbWFpbjpwYXJ0c1sxXSxpZGVudGl0eTpwYXJ0c1syXX07cmV0dXJuIHJlc3VsdDt9IC8qKgogKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQogKiBAcGFyYW0gIHtPYmplY3R9ICBvYmogLSBvYmplY3QgdG8gYmUgY2xvbmVkCiAqIEByZXR1cm4ge09iamVjdH0KICovZnVuY3Rpb24gZGVlcENsb25lKG9iail7IC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KaWYob2JqKXJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpO30gLyoqCiAqIEdldCB0aGUgY29uZmlndXJhdGlvbiBmcm9tIGFuIGpzb24gZmlsZTsKICogQHBhcmFtICB7SlNPTk9iamVjdH0ganNvbkZpbGUKICogQHJldHVybiB7b2JqZWN0fQogKi9mdW5jdGlvbiBnZXRDb25maWcoSlNPTk9iamVjdCl7Y29uc29sZS5sb2coJ3Byb2R1Y3Rpb24nKTtyZXR1cm4gSlNPTk9iamVjdFsncHJvZHVjdGlvbiddO30gLyoqCiAqIEdldCBXZWJSVEMgQVBJIHJlc291cmNlcwogKiBAcGFyYW0gIHtPYmplY3R9ICAgICBvcHRpb25zIE9iamVjdCBjb250YWluaW5nIHRoZSBpbmZvcm1hdGlvbiB0aGF0IHJlc291cmNlcyB3aWxsIGJlIHVzZWQgKGNhbWVyYSwgbWljLCByZXNvbHV0aW9uLCBldGMpOwogKiBAcmV0dXJuIHtQcm9taXNlfQogKi9mdW5jdGlvbiBnZXRVc2VyTWVkaWEoY29uc3RyYWludHMpe3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7bmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24obWVkaWFTdHJlYW0pe3Jlc29sdmUobWVkaWFTdHJlYW0pO30pLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7cmVqZWN0KHJlYXNvbik7fSk7fSk7fWZ1bmN0aW9uIHNlcmlhbGl6ZSgpeyQuZm4uc2VyaWFsaXplT2JqZWN0PWZ1bmN0aW9uKCl7dmFyIG89e307dmFyIGE9dGhpcy5zZXJpYWxpemVBcnJheSgpOyQuZWFjaChhLGZ1bmN0aW9uKCl7aWYob1t0aGlzLm5hbWVdIT09dW5kZWZpbmVkKXtpZighb1t0aGlzLm5hbWVdLnB1c2gpe29bdGhpcy5uYW1lXT1bb1t0aGlzLm5hbWVdXTt9b1t0aGlzLm5hbWVdLnB1c2godGhpcy52YWx1ZXx8JycpO31lbHNlIHtvW3RoaXMubmFtZV09dGhpcy52YWx1ZXx8Jyc7fX0pO3JldHVybiBvO307JC5mbi5zZXJpYWxpemVPYmplY3RBcnJheT1mdW5jdGlvbigpe3ZhciBvPXt9O3ZhciBhPXRoaXMuc2VyaWFsaXplQXJyYXkoKTskLmVhY2goYSxmdW5jdGlvbigpe2lmKG9bdGhpcy5uYW1lXSE9PXVuZGVmaW5lZCl7aWYoIW9bdGhpcy5uYW1lXS5wdXNoKXtvW3RoaXMubmFtZV09W29bdGhpcy5uYW1lXV07fW9bdGhpcy5uYW1lXS5wdXNoKHRoaXMudmFsdWV8fCcnKTt9ZWxzZSB7aWYoIW9bdGhpcy5uYW1lXSlvW3RoaXMubmFtZV09W107b1t0aGlzLm5hbWVdLnB1c2godGhpcy52YWx1ZXx8JycpO319KTtyZXR1cm4gbzt9O31mdW5jdGlvbiBnZXRUZW1wbGF0ZShwYXRoLHNjcmlwdCl7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtpZihIYW5kbGViYXJzLnRlbXBsYXRlcz09PXVuZGVmaW5lZHx8SGFuZGxlYmFycy50ZW1wbGF0ZXNbbmFtZV09PT11bmRlZmluZWQpe0hhbmRsZWJhcnMudGVtcGxhdGVzPXt9O31lbHNlIHtyZXNvbHZlKEhhbmRsZWJhcnMudGVtcGxhdGVzW25hbWVdKTt9dmFyIHRlbXBsYXRlRmlsZT0kLmFqYXgoe3VybDpwYXRoKycuaGJzJyxzdWNjZXNzOmZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSl7SGFuZGxlYmFycy50ZW1wbGF0ZXNbbmFtZV09SGFuZGxlYmFycy5jb21waWxlKGRhdGEpO30sZmFpbDpmdW5jdGlvbiBmYWlsKHJlYXNvbil7cmV0dXJuIHJlYXNvbjt9fSk7dmFyIHNjcmlwdEZpbGU9JC5nZXRTY3JpcHQoc2NyaXB0KTt2YXIgcmVxdWVzdHM9W107aWYocGF0aClyZXF1ZXN0cy5wdXNoKHRlbXBsYXRlRmlsZSk7aWYoc2NyaXB0KXJlcXVlc3RzLnB1c2goc2NyaXB0RmlsZSk7UHJvbWlzZS5hbGwocmVxdWVzdHMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtyZXNvbHZlKEhhbmRsZWJhcnMudGVtcGxhdGVzW25hbWVdKTt9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pe3JlamVjdChyZWFzb24pO30pO30pO30KCn0se31dfSx7fSxbNV0pKDUpCn0pOw==",
      "sourceCodeClassname": "HypertyConnector",
      "encoding": "base64",
      "signature": ""
    },
    "cguid": 10001,
    "type": "Hyperties",
    "version": "0.1",
    "description": "Description of HypertyConnector",
    "objectName": "HypertyConnector",
    "configuration": {},
    "sourcePackageURL": "/sourcePackage",
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "dataObjects": [],
    "accessControlPolicy": "somePolicy"
  }
}
